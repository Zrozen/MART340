<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>The Echoes of the Unknown</title>
<style title="Twine CSS">@keyframes appear{0%{opacity:0}to{opacity:1}}@keyframes fade-in-out{0%,to{opacity:0}50%{opacity:1}}@keyframes rumble{25%{top:-0.1em}75%{top:.1em}0%,to{top:0px}}@keyframes shudder{25%{left:.1em}75%{left:-0.1em}0%,to{left:0px}}@keyframes buoy{25%{top:.25em}75%{top:-0.25em}0%,to{top:0px}}@keyframes sway{25%{left:.25em}75%{left:-0.25em}0%,to{left:0px}}@keyframes pulse{0%{transform:scale(0, 0)}20%{transform:scale(1.2, 1.2)}40%{transform:scale(0.9, 0.9)}60%{transform:scale(1.05, 1.05)}80%{transform:scale(0.925, 0.925)}to{transform:scale(1, 1)}}@keyframes zoom-in{0%{transform:scale(0, 0)}to{transform:scale(1, 1)}}@keyframes shudder-in{0%,to{transform:translateX(0em)}5%,25%,45%{transform:translateX(-1em)}15%,35%,55%{transform:translateX(1em)}65%{transform:translateX(-0.6em)}75%{transform:translateX(0.6em)}85%{transform:translateX(-0.2em)}95%{transform:translateX(0.2em)}}@keyframes rumble-in{0%,to{transform:translateY(0em)}5%,25%,45%{transform:translateY(-1em)}15%,35%,55%{transform:translateY(1em)}65%{transform:translateY(-0.6em)}75%{transform:translateY(0.6em)}85%{transform:translateY(-0.2em)}95%{transform:translateY(0.2em)}}@keyframes fidget{0%,8.1%,82.1%,31.1%,38.1%,44.1%,40.1%,47.1%,74.1%,16.1%,27.1%,72.1%,24.1%,95.1%,6.1%,36.1%,20.1%,4.1%,91.1%,14.1%,87.1%,to{left:0px;top:0px}8%,82%,31%,38%,44%{left:-1px}40%,47%,74%,16%,27%{left:1px}72%,24%,95%,6%,36%{top:-1px}20%,4%,91%,14%,87%{top:1px}}@keyframes slide-right{0%{transform:translateX(-100vw)}}@keyframes slide-left{0%{transform:translateX(100vw)}}@keyframes slide-up{0%{transform:translateY(100vh)}}@keyframes slide-down{0%{transform:translateY(-100vh)}}@keyframes fade-right{0%{opacity:0;transform:translateX(-1em)}to{opacity:1}}@keyframes fade-left{0%{opacity:0;transform:translateX(1em)}to{opacity:1}}@keyframes fade-up{0%{opacity:0;transform:translateY(1em)}to{opacity:1}}@keyframes fade-down{0%{opacity:0;transform:translateY(-1em)}to{opacity:1}}@keyframes flicker{0%,29%,31%,63%,65%,77%,79%,86%,88%,91%,93%{opacity:0}30%{opacity:.2}64%{opacity:.4}78%{opacity:.6}87%{opacity:.8}92%,to{opacity:1}}@keyframes blur{0%{filter:blur(2rem);opacity:0}25%{opacity:1}to{filter:blur(0rem);opacity:1}}.dom-debug-mode tw-story,.dom-debug-mode tw-passage,.dom-debug-mode tw-sidebar,.dom-debug-mode tw-include,.dom-debug-mode tw-hook,.dom-debug-mode tw-expression,.dom-debug-mode tw-link,.dom-debug-mode tw-dialog,.dom-debug-mode tw-columns,.dom-debug-mode tw-column,.dom-debug-mode tw-align{outline:1px solid #f5a3da;min-height:32px;display:block !important}.dom-debug-mode tw-story::before,.dom-debug-mode tw-passage::before,.dom-debug-mode tw-sidebar::before,.dom-debug-mode tw-include::before,.dom-debug-mode tw-hook::before,.dom-debug-mode tw-expression::before,.dom-debug-mode tw-link::before,.dom-debug-mode tw-dialog::before,.dom-debug-mode tw-columns::before,.dom-debug-mode tw-column::before,.dom-debug-mode tw-align::before{position:absolute;top:0;left:0;height:16px;background-color:#f5a3da;color:#000;font-size:16px;font-weight:normal;font-style:normal;font-family:monospace;display:inline-block;line-height:100%;white-space:pre;z-index:999997}.dom-debug-mode tw-story:hover,.dom-debug-mode tw-passage:hover,.dom-debug-mode tw-sidebar:hover,.dom-debug-mode tw-include:hover,.dom-debug-mode tw-hook:hover,.dom-debug-mode tw-expression:hover,.dom-debug-mode tw-link:hover,.dom-debug-mode tw-dialog:hover,.dom-debug-mode tw-columns:hover,.dom-debug-mode tw-column:hover,.dom-debug-mode tw-align:hover{outline:1px solid #fc9}.dom-debug-mode tw-story:hover::before,.dom-debug-mode tw-passage:hover::before,.dom-debug-mode tw-sidebar:hover::before,.dom-debug-mode tw-include:hover::before,.dom-debug-mode tw-hook:hover::before,.dom-debug-mode tw-expression:hover::before,.dom-debug-mode tw-link:hover::before,.dom-debug-mode tw-dialog:hover::before,.dom-debug-mode tw-columns:hover::before,.dom-debug-mode tw-column:hover::before,.dom-debug-mode tw-align:hover::before{background-color:#fc9;transition:background-color 1s}.dom-debug-mode tw-passage,.dom-debug-mode tw-include,.dom-debug-mode tw-hook,.dom-debug-mode tw-expression,.dom-debug-mode tw-link,.dom-debug-mode tw-dialog,.dom-debug-mode tw-columns,.dom-debug-mode tw-column,.dom-debug-mode tw-align{padding:1em;margin:0}.dom-debug-mode tw-story::before{content:'<tw-story tags="' attr(tags) '">'}.dom-debug-mode tw-passage::before{top:-16px;content:'<tw-passage tags="' attr(tags) '">'}.dom-debug-mode tw-sidebar::before{top:-16px;content:"<tw-sidebar>"}.dom-debug-mode tw-hook::before{content:'<tw-hook name="' attr(name) '">'}.dom-debug-mode tw-expression::before{content:'<tw-expression name="' attr(name) '">'}.dom-debug-mode tw-link::before{content:'<tw-link name="' attr(name) '">'}.dom-debug-mode tw-dialog::before{content:"<tw-dialog>"}.dom-debug-mode tw-columns::before{content:"<tw-columns>"}.dom-debug-mode tw-column::before{content:"<tw-column>"}.dom-debug-mode tw-align::before{content:"<tw-align>"}.dom-debug-mode tw-include::before{content:'<tw-include type="' attr(type) '" name="' attr(name) '">'}tw-open-button[goto]{display:none}.debug-mode tw-open-button[replay],.debug-mode tw-open-button[goto]{display:inline}.debug-mode tw-expression{display:inline-block !important}.debug-mode tw-expression[type=variable]::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"$" attr(name)}.debug-mode tw-expression[type=tempVariable]::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"_" attr(name)}.debug-mode tw-expression[return=boolean]{background-color:rgba(179,179,179,.2)}.debug-mode tw-expression[return=array]{background-color:rgba(255,102,102,.2)}.debug-mode tw-expression[return=dataset]{background-color:rgba(255,128,0,.2)}.debug-mode tw-expression[return=number]{background-color:rgba(255,179,102,.2)}.debug-mode tw-expression[return=datamap]{background-color:rgba(255,255,102,.2)}.debug-mode tw-expression[return=changer]{background-color:rgba(179,255,102,.2)}.debug-mode tw-expression[return=lambda]{background-color:rgba(102,255,102,.2)}.debug-mode tw-expression[return=hookname]{background-color:rgba(102,255,204,.2)}.debug-mode tw-expression[return=string]{background-color:rgba(102,255,255,.2)}.debug-mode tw-expression[return=datatype]{background-color:rgba(102,153,255,.2)}.debug-mode tw-expression[return=gradient],.debug-mode tw-expression[return=colour]{background-color:rgba(204,102,255,.2)}.debug-mode tw-expression[return=instant],.debug-mode tw-expression[return=macro]{background-color:rgba(240,117,199,.2)}.debug-mode tw-expression[return=command]{background-color:rgba(153,153,255,.2)}.debug-mode tw-expression.false{background-color:rgba(255,0,0,.2) !important}.debug-mode tw-expression[type=macro]::before{content:"(" attr(name) ":)";padding:0 .5rem;font-size:1rem;vertical-align:middle;line-height:normal;background-color:inherit;border:1px solid rgba(255,255,255,.5)}.debug-mode tw-expression[title]:not([title=""]){cursor:help}.debug-mode tw-hook{background-color:rgba(0,85,255,.1) !important}.debug-mode tw-hook::before{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"["}.debug-mode tw-hook::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"]"}.debug-mode tw-hook[name]::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"]<" attr(name) "|"}.debug-mode tw-pseudo-hook{background-color:rgba(255,170,0,.1) !important}.debug-mode tw-collapsed::before{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"{"}.debug-mode tw-collapsed::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"}"}.debug-mode tw-verbatim::before,.debug-mode tw-verbatim::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"`"}.debug-mode tw-align[style*="text-align: center"]{background:linear-gradient(to right, hsla(14, 100%, 87%, 0) 0%, hsla(14, 100%, 87%, 0.25) 50%, hsla(14, 100%, 87%, 0) 100%)}.debug-mode tw-align[style*="text-align: left"]{background:linear-gradient(to right, hsla(14, 100%, 87%, 0.25) 0%, hsla(14, 100%, 87%, 0) 100%)}.debug-mode tw-align[style*="text-align: right"]{background:linear-gradient(to right, hsla(14, 100%, 87%, 0) 0%, hsla(14, 100%, 87%, 0.25) 100%)}.debug-mode tw-column{background-color:rgba(189,228,255,.2)}.debug-mode tw-enchantment{animation:enchantment .5s infinite;border:1px solid}.debug-mode tw-link::after,.debug-mode tw-broken-link::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:attr(passage-name)}.debug-mode tw-include{background-color:rgba(204,128,51,.1)}.debug-mode tw-include::before{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:attr(type) ' "' attr(name) '"'}.debug-dialogs tw-backdrop:not(.eval-replay):not(.harlowe-crash){pointer-events:none;opacity:.1}tw-eval-replay tw-eval-code,tw-eval-replay tw-eval-explanation{max-height:20vh;overflow:auto;margin:10px auto}tw-eval-replay tw-eval-code{display:block;font-family:monospace;padding-bottom:1ex;border-bottom:2px solid gray}tw-eval-replay tw-eval-explanation{display:block;text-align:center}tw-eval-replay tw-eval-explanation>code{white-space:pre-wrap}tw-eval-replay tw-eval-explanation>code.from-block{width:40%;display:inline-block;text-align:left;max-height:4em;overflow-wrap:anywhere;overflow-y:scroll}tw-eval-replay tw-eval-explanation>code.from-block~.to-desc{width:calc(40% - 2em);margin-left:2em;display:inline-block}tw-eval-replay tw-eval-explanation>code.from-block+span::after{content:"..."}tw-eval-replay tw-eval-explanation>code.from-inline{text-align:right}tw-eval-replay tw-eval-explanation>:nth-child(2){white-space:pre}tw-eval-replay tw-eval-explanation>.to-desc{text-align:left}tw-eval-replay tw-eval-explanation>table{width:100%;margin-top:1em}tw-eval-replay tw-eval-explanation>table td{white-space:pre-wrap !important;word-wrap:anywhere}tw-eval-replay tw-eval-reason{text-align:center;font-size:80%;font-style:italic;display:block}tw-eval-replay tw-eval-it{text-align:center;font-size:80%;display:block}tw-eval-replay tw-dialog-links{display:-ms-flexbox;display:flex;-ms-flex-pack:distribute;justify-content:space-around}@keyframes enchantment{0%,to{border-color:#ffb366}50%{border-color:#6fc}}tw-debugger{position:fixed;box-sizing:border-box;bottom:0;right:0;z-index:999999;min-width:14em;min-height:1em;padding:0em .5em .5em 1em;font-size:1.25em;font-family:sans-serif;color:#262626;background-color:#fff;border-left:solid #262626 2px;border-top:solid #262626 2px;border-top-left-radius:.5em;opacity:1}tw-debugger.fade-panel:not(:hover){opacity:.33}tw-debugger.theme-dark{color:#d9d9d9;background-color:#000}tw-debugger.theme-dark{border-color:#d9d9d9 rgba(0,0,0,0) rgba(0,0,0,0) #d9d9d9}tw-debugger select{margin-right:1em;width:12em}tw-debugger button,tw-debugger tw-link{border-radius:3px;border:solid #999 1px;margin:auto 4px;color:#262626;background-color:#fff;cursor:pointer}tw-debugger button.enabled,tw-debugger tw-link.enabled{color:#000;background-color:#d9d9d9;box-shadow:inset #999 3px 5px .5em}tw-debugger.theme-dark button,tw-debugger.theme-dark tw-link{color:#d9d9d9;background-color:#000;border-color:#666}tw-debugger.theme-dark button.enabled,tw-debugger.theme-dark tw-link.enabled{color:#e6e6e6;background-color:#424242;box-shadow:inset #666 3px 5px .5em}tw-debugger button{font-size:1em;overflow-x:hidden;text-overflow:ellipsis;white-space:pre}tw-debugger tw-link{font-size:1.25em;border-radius:16px;border-style:solid;border-width:2px;text-align:center;padding:0px 8px;display:block}tw-debugger tw-link:hover{border-color:#262626;color:#262626}tw-debugger.theme-dark tw-link:hover{border-color:#d9d9d9;color:#d9d9d9}tw-debugger tw-dialog{background-color:#fff;color:#000;font-size:1.25em}tw-debugger.theme-dark tw-dialog{background-color:#000;color:#e6e6e6}tw-debugger .panel{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;position:absolute;bottom:100%;left:-2px;right:0;padding:1em;overflow-y:scroll;overflow-x:hidden;border:inherit;box-sizing:content-box;background-color:#fff;border-bottom:solid #999 2px;border-top-left-radius:.5em;border-bottom-left-radius:.5em;font-size:.8em}tw-debugger .panel:empty,tw-debugger .panel[hidden]{display:none}tw-debugger.theme-dark .panel{background-color:#000;border-bottom-color:#666}tw-debugger .panel-source .panel-row-buttons{width:2rem}tw-debugger .panel-source .source-tags{width:20%;font-style:italic}tw-debugger .panel-row-source td{font-family:monospace;font-size:1rem;white-space:pre-wrap;overflow-wrap:anywhere;max-height:8rem;padding:1rem}tw-debugger .panel-rows{width:100%;overflow-x:scroll}tw-debugger .panel-rows>*{display:table-row}tw-debugger .panel-rows>div:nth-of-type(2n){background-color:#e6e6e6}tw-debugger .panel-tools .panel-rows>*,tw-debugger .panel-options .panel-rows>*{margin-top:.4rem;display:block}tw-debugger.theme-dark .panel-rows>div:nth-of-type(2n){background-color:#212121}tw-debugger .panel-row-buttons{text-align:right}tw-debugger .panel-variables .panel-rows:empty::before{content:"~ No variables ~";font-style:italic;color:#575757;text-align:center}tw-debugger .panel-enchantments .panel-rows:empty::before{content:"~ No enchantments ~";font-style:italic;color:#575757;text-align:center}tw-debugger .panel-errors .panel-rows:empty::before{content:"~ No errors... for now. ~";font-style:italic;color:#575757;text-align:center}tw-debugger .panel-errors .panel-rows:empty+.panel-errors-bottom{display:none}tw-debugger.theme-dark .panel-variables .panel-rows:empty::before,tw-debugger.theme-dark .panel-enchantments .panel-rows:empty::before,tw-debugger.theme-dark .panel-errors .panel-rows:empty::before{color:#a8a8a8}tw-debugger .panel-rows:empty+.panel-variables-bottom{display:none}tw-debugger th[data-col]{text-decoration:underline;cursor:pointer}tw-debugger th[data-col][data-order=asc]::after{content:"↓"}tw-debugger th[data-col][data-order=desc]::after{content:"↑"}tw-debugger .panel-storylets:not(.panel-exclusive) .storylet-exclusive,tw-debugger .panel-storylets:not(.panel-urgent) .storylet-urgent{display:none}tw-debugger .storylet-exclusive,tw-debugger .storylet-urgent,tw-debugger .storylet-open{text-align:center}tw-debugger .panel-variables-bottom{padding-top:5px}tw-debugger .enchantment-row{min-height:1.5em}tw-debugger .variable-path{opacity:.4}tw-debugger .temporary-variable-scope,tw-debugger .enchantment-local{font-family:sans-serif;font-weight:normal;opacity:.8;font-size:.75em}tw-debugger .temporary-variable-scope:not(:empty)::before,tw-debugger .enchantment-local:not(:empty)::before{content:" in "}tw-debugger .variable-name,tw-debugger .enchantment-name{font-family:monospace;font-weight:bold}tw-debugger .variable-type{color:#575757;font-weight:normal;text-overflow:ellipsis;overflow:hidden;max-width:10em}tw-debugger.theme-dark .variable-type{color:#a8a8a8}tw-debugger .error-row{display:table-row;background-color:rgba(230,101,204,.3)}tw-debugger .error-row:nth-of-type(2n){background-color:rgba(237,145,219,.3)}tw-debugger .error-row>*{display:table-cell;padding:.25em .5em}tw-debugger .error-row .error-message[title]:not([title=""]){cursor:help}tw-debugger .error-row .error-passage{color:#575757}tw-debugger.theme-dark .error-row .error-passage{color:#a8a8a8}tw-debugger .storylet-row{background-color:rgba(193,240,225,.3)}tw-debugger .storylet-row:nth-child(2n){background-color:rgba(152,231,204,.3)}tw-debugger .storylet-row.storylet-closed{font-style:italic;background-color:#fff}tw-debugger .storylet-row.storylet-closed:nth-child(2n){background-color:#e6e6e6}tw-debugger .storylet-row.storylet-closed>:not(.storylet-lambda){opacity:.6}.storylet-error tw-debugger .storylet-row{background-color:rgba(230,101,204,.3)}.storylet-error tw-debugger .storylet-row:nth-child(2n){background-color:rgba(237,145,219,.3)}tw-debugger .storylet-row .storylet-name,tw-debugger .storylet-row .storylet-value{display:inline-block;width:50%}tw-debugger .storylet-row .storylet-lambda{font-family:monospace;font-size:1rem;white-space:pre-wrap;overflow-wrap:anywhere}tw-debugger.theme-dark .storylet-row.storylet-closed{background-color:#000}tw-debugger.theme-dark .storylet-row.storylet-closed:nth-child(2n){background-color:#212121}tw-debugger .tabs{padding-bottom:.5em}tw-debugger .tab{border-radius:0px 0px .5em .5em;border-top:none;top:-2px}tw-debugger .resizer-h{position:absolute;height:14em;border-left:2px solid #999;border-right:2px solid #999;top:10px;left:4px;width:8px;cursor:ew-resize}tw-debugger.theme-dark .resizer-h{border-color:rgba(0,0,0,0) #666}tw-debugger .resizer-v{position:absolute;height:8px;border-top:2px solid #999;border-bottom:2px solid #999;margin-bottom:4px;top:4px;left:10px;width:95%;cursor:ns-resize;box-sizing:border-box}tw-debugger.theme-dark .resizer-v{border-color:#666 rgba(0,0,0,0)}tw-debugger mark{color:inherit;background-color:rgba(101,230,230,.3) !important}tw-dialog{z-index:999997;border:#fff solid 2px;padding:2em;color:#fff;background-color:#000;display:block}@media(min-width: 576px){tw-dialog{max-width:50vw}}tw-dialog input[type=text]{font-size:inherit;width:100%;border:solid #fff !important}tw-dialog-links{text-align:right;display:-ms-flexbox;display:flex;-ms-flex-pack:end;justify-content:flex-end}tw-backdrop{z-index:999996;position:fixed;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,.8);display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}tw-backdrop~tw-backdrop{display:none}tw-link,.enchantment-link{cursor:pointer;color:#4169e1;font-weight:bold;text-decoration:none;transition:color .2s ease-in-out}tw-passage [style^=color] tw-link:not(:hover),tw-passage [style*=" color"] tw-link:not(:hover),tw-passage [style^=color][hover=true] tw-link:hover,tw-passage [style*=" color"][hover=true] tw-link:hover,tw-passage [style^=color] .enchantment-link:not(:hover),tw-passage [style*=" color"] .enchantment-link:not(:hover),tw-passage [style^=color][hover=true] .enchantment-link:hover,tw-passage [style*=" color"][hover=true] .enchantment-link:hover{color:inherit}tw-link:hover,.enchantment-link:hover{color:#00bfff}tw-link:active,.enchantment-link:active{color:#dd4b39}.visited{color:#6941e1}tw-passage [style^=color] .visited:not(:hover),tw-passage [style*=" color"] .visited:not(:hover),tw-passage [style^=color][hover=true] .visited:hover,tw-passage [style*=" color"][hover=true] .visited:hover{color:inherit}.visited:hover{color:#e3e}tw-broken-link{color:#933;border-bottom:2px solid #933;cursor:not-allowed}tw-passage [style^=color] tw-broken-link:not(:hover),tw-passage [style*=" color"] tw-broken-link:not(:hover),tw-passage [style^=color][hover=true] tw-broken-link:hover,tw-passage [style*=" color"][hover=true] tw-broken-link:hover{color:inherit}tw-link.enchantment-mouseover,.link.enchantment-mouseover,tw-expression.enchantment-mouseover>tw-link{color:inherit;font-weight:inherit;transition:none;cursor:inherit;border-bottom:2px dashed #999}tw-link.enchantment-mouseover:hover,tw-link.enchantment-mouseover:active,.link.enchantment-mouseover:hover,.link.enchantment-mouseover:active,tw-expression.enchantment-mouseover>tw-link:hover,tw-expression.enchantment-mouseover>tw-link:active{color:inherit}tw-link.enchantment-mouseover.enchantment-button,.link.enchantment-mouseover.enchantment-button,tw-expression.enchantment-mouseover>tw-link.enchantment-button{border-style:dashed}tw-link.enchantment-mouseout,.link.enchantment-mouseout,tw-expression.enchantment-mouseout>tw-link{color:inherit;font-weight:inherit;transition:none;cursor:inherit;border:rgba(64,149,191,.6) 1px solid;border-radius:.2em}tw-link.enchantment-mouseout:hover,tw-link.enchantment-mouseout:active,.link.enchantment-mouseout:hover,.link.enchantment-mouseout:active,tw-expression.enchantment-mouseout>tw-link:hover,tw-expression.enchantment-mouseout>tw-link:active{color:inherit}tw-link.enchantment-mouseout:hover,.link.enchantment-mouseout:hover,tw-expression.enchantment-mouseout>tw-link:hover{background-color:rgba(175,197,207,.75);border:rgba(0,0,0,0) 1px solid}tw-link.enchantment-dblclick,.link.enchantment-dblclick,tw-expression.enchantment-dblclick>tw-link{color:inherit;font-weight:inherit;transition:none;cursor:inherit;cursor:pointer;border:2px solid #999;border-radius:0}tw-link.enchantment-dblclick:hover,tw-link.enchantment-dblclick:active,.link.enchantment-dblclick:hover,.link.enchantment-dblclick:active,tw-expression.enchantment-dblclick>tw-link:hover,tw-expression.enchantment-dblclick>tw-link:active{color:inherit}tw-link.enchantment-dblclick:active,.link.enchantment-dblclick:active,tw-expression.enchantment-dblclick>tw-link:active{background-color:#999}tw-link.enchantment-button,.link.enchantment-button,.enchantment-button:not(.link) tw-link,.enchantment-button:not(.link) .link{border-radius:16px;border-style:solid;border-width:2px;text-align:center;padding:0px 8px;display:block}.enchantment-button{display:block}.enchantment-clickblock{cursor:pointer;width:100%;height:100%;display:block}.enchantment-clickblock>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;color:rgba(65,105,225,.5);transition:color .2s ease-in-out}.enchantment-clickblock>:not(tw-enchantment):hover::after{color:rgba(0,191,255,.5)}.enchantment-clickblock>:not(tw-enchantment):active::after{color:rgba(222,78,59,.5)}.enchantment-clickblock>:not(tw-enchantment)::after{box-shadow:inset 0 0 0 .5vmax}.enchantment-clickblock>tw-passage::after,.enchantment-clickblock>tw-sidebar::after{box-shadow:0 0 0 .5vmax}.enchantment-mouseoverblock>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;border:2px dashed #999}.enchantment-mouseoutblock>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;border:rgba(64,149,191,.6) 2px solid}.enchantment-mouseoutblock:hover>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;background-color:rgba(175,197,207,.75);border:rgba(0,0,0,0) 2px solid;border-radius:.2em}.enchantment-dblclickblock>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;cursor:pointer;border:2px solid #999}tw-dialog-links{padding-top:1.5em}tw-dialog-links tw-link{border-radius:16px;border-style:solid;border-width:2px;text-align:center;padding:0px 8px;display:block;display:inline-block}html{margin:0;height:100%;overflow-x:hidden}*,:before,:after{position:relative;box-sizing:inherit}body{margin:0;height:100%}tw-storydata{display:none}tw-story{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;font:100% Georgia,serif;box-sizing:border-box;width:100%;min-height:100%;font-size:1.5em;line-height:1.5em;padding:5% 5%;overflow:hidden;background-color:#000;color:#fff}tw-story [style*=content-box] *{box-sizing:border-box}@media(min-width: 576px){tw-story{padding:5% 20%}}tw-story tw-consecutive-br{display:block;height:1.6ex;visibility:hidden}tw-story select{background-color:rgba(0,0,0,0);font:inherit;border-style:solid;padding:2px}tw-story select:not([disabled]){color:inherit}tw-story textarea{resize:none;background-color:rgba(0,0,0,0);font:inherit;color:inherit;border-style:none;padding:2px}tw-story input[type=text]{background-color:rgba(0,0,0,0);font:inherit;color:inherit;border-style:none}tw-story input[type=checkbox]{transform:scale(1.5);margin:0 .5em .5em .5em;vertical-align:middle}tw-story tw-noscript{animation:appear .8s}tw-passage{display:block}tw-sidebar{text-align:center;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between}@media(min-width: 576px){tw-sidebar{left:-5em;width:3em;position:absolute;-ms-flex-direction:column;flex-direction:column}tw-enchantment[style*=width]>tw-sidebar{width:inherit}}tw-icon{display:inline-block;margin:.5em 0;font-size:66px;font-family:"Verdana",sans-serif}tw-icon[alt]{opacity:.2;cursor:pointer}tw-icon[alt]:hover{opacity:.4}tw-icon[data-label]::after{font-weight:bold;content:attr(data-label);font-size:20px;bottom:-20px;left:-50%;white-space:nowrap}tw-meter{display:block}tw-hook:empty,tw-expression:empty{display:none}tw-error{display:inline-block;border-radius:.2em;padding:.2em;font-size:1rem;cursor:help;white-space:pre-wrap}tw-error.error{background-color:rgba(223,58,190,.6);color:#fff}tw-error.warning{background-color:rgba(223,140,58,.6);color:#fff;display:none}.debug-mode tw-error.warning{display:inline}tw-error-explanation{display:block;font-size:.8rem;line-height:1rem}tw-open-button,tw-folddown{cursor:pointer;line-height:0em;border-radius:4px;border:1px solid rgba(255,255,255,.5);font-size:.8rem;margin:0 .2rem;padding:3px;white-space:pre}tw-folddown::after{content:"▶"}tw-folddown.open::after{content:"▼"}tw-open-button[replay]{display:none}tw-error tw-open-button,tw-eval-replay tw-open-button{display:inline !important}tw-open-button::after{content:attr(label)}tw-notifier{border-radius:.2em;padding:.2em;font-size:1rem;background-color:rgba(223,182,58,.4);display:none}.debug-mode tw-notifier{display:inline}tw-notifier::before{content:attr(message)}tw-colour{border:1px solid #000;display:inline-block;width:1em;height:1em}tw-enchantment:empty{display:none}h1{font-size:3em}h2{font-size:2.25em}h3{font-size:1.75em}h1,h2,h3,h4,h5,h6{line-height:1em;margin:.3em 0 .6em 0}pre{font-size:1rem;line-height:initial}small{font-size:70%}big{font-size:120%}mark{color:rgba(0,0,0,.6);background-color:#ff9}ins{color:rgba(0,0,0,.6);background-color:rgba(255,242,204,.5);border-radius:.5em;box-shadow:0em 0em .2em #ffe699;text-decoration:none}center{text-align:center;margin:0 auto;width:60%}blink{text-decoration:none;animation:fade-in-out 1s steps(1, end) infinite alternate}tw-align{display:block}tw-columns{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:justify;justify-content:space-between}.transition-in{animation:appear 0ms step-start}.transition-out{animation:appear 0ms step-end}[data-t8n^=dissolve].transition-in,[data-t8n=fade].transition-in{animation:appear .8s}[data-t8n^=dissolve].transition-out,[data-t8n=fade].transition-out{animation:appear .8s reverse}[data-t8n^=shudder].transition-in{display:inline-block !important;animation:shudder-in .8s}[data-t8n^=shudder].transition-out{display:inline-block !important;animation:shudder-in .8s reverse}[data-t8n^=rumble].transition-in{display:inline-block !important;animation:rumble-in .8s}[data-t8n^=rumble].transition-out{display:inline-block !important;animation:rumble-in .8s reverse}[data-t8n^=pulse].transition-in{animation:pulse .8s;display:inline-block !important}[data-t8n^=pulse].transition-out{animation:pulse .8s reverse;display:inline-block !important}[data-t8n^=zoom].transition-in{animation:zoom-in .8s;display:inline-block !important}[data-t8n^=zoom].transition-out{animation:zoom-in .8s reverse;display:inline-block !important}[data-t8n^=blur].transition-in{animation:blur .8s;display:inline-block !important}[data-t8n^=blur].transition-out{animation:blur .8s reverse;display:inline-block !important}[data-t8n^=slideleft].transition-in{animation:slide-left .8s;display:inline-block !important}[data-t8n^=slideleft].transition-out{animation:slide-right .8s reverse;display:inline-block !important}[data-t8n^=slideright].transition-in{animation:slide-right .8s;display:inline-block !important}[data-t8n^=slideright].transition-out{animation:slide-left .8s reverse;display:inline-block !important}[data-t8n^=slideup].transition-in{animation:slide-up .8s;display:inline-block !important}[data-t8n^=slideup].transition-out{animation:slide-down .8s reverse;display:inline-block !important}[data-t8n^=slidedown].transition-in{animation:slide-down .8s;display:inline-block !important}[data-t8n^=slidedown].transition-out{animation:slide-up .8s reverse;display:inline-block !important}[data-t8n^=fadeleft].transition-in{animation:fade-left .8s;display:inline-block !important}[data-t8n^=fadeleft].transition-out{animation:fade-right .8s reverse;display:inline-block !important}[data-t8n^=faderight].transition-in{animation:fade-right .8s;display:inline-block !important}[data-t8n^=faderight].transition-out{animation:fade-left .8s reverse;display:inline-block !important}[data-t8n^=fadeup].transition-in{animation:fade-up .8s;display:inline-block !important}[data-t8n^=fadeup].transition-out{animation:fade-down .8s reverse;display:inline-block !important}[data-t8n^=fadedown].transition-in{animation:fade-down .8s;display:inline-block !important}[data-t8n^=fadedown].transition-out{animation:fade-up .8s reverse;display:inline-block !important}[data-t8n^=flicker].transition-in{animation:flicker .8s}[data-t8n^=flicker].transition-out{animation:flicker .8s reverse}
</style>
</head>
<body>
<tw-story><noscript><tw-noscript>JavaScript needs to be enabled to play The Echoes of the Unknown.</tw-noscript></noscript></tw-story>
<tw-storydata name="The Echoes of the Unknown" startnode="216" creator="Twine" creator-version="2.9.2" format="Harlowe" format-version="3.3.9" ifid="583C8050-5BB7-44D9-A063-313C0A9E17CD" options="" tags="" zoom="0.3" hidden><style role="stylesheet" id="twine-user-stylesheet" type="text/twine-css"></style><script role="script" id="twine-user-script" type="text/twine-javascript"></script><tw-tag name="Ending" color="green"></tw-tag><tw-tag name="ending" color="green"></tw-tag><tw-tag name="True-ending" color="blue"></tw-tag><tw-tag name="Major-choice" color="red"></tw-tag><tw-passagedata pid="1" name="Start" tags="" position="2400,200" size="100,100">It’s an ordinary weekday. The hum of city life surrounds you—the distant chatter of pedestrians, honking cars, and the rhythmic hum of engines reverberating through the streets. The weather is mild, making your usual afternoon stroll through the park something you look forward to after work. It’s your routine, your comfort zone.

But today, something feels off. It’s subtle, like a faint hum in the back of your mind that you can’t quite shake. The familiar sights and sounds seem slightly distorted, as if you’re watching the world from a step outside yourself.

Your phone vibrates in your pocket, pulling you from your thoughts. As you glance at the screen, it flickers, static interference cutting through like an old TV show. Then, just for a second, you see it—a set of coordinates flashing in bright, blocky text, accompanied by a cryptic phrase: &#39;&#39;&quot;The Clock is Ticking.&quot;&#39;&#39;

You unlock your phone again, hoping the glitch was just a trick of your imagination. But no—it’s still there. The coordinates linger, glowing faintly against the usual background. Your pulse quickens. This isn’t some random glitch. The coordinates are real, and so are the words below them: &#39;&#39;&quot;The Clock is Ticking.&quot;&#39;&#39;

A chill runs down your spine. You try to dismiss it, convincing yourself it’s probably just an app malfunction or a prank. But unease gnaws at you. Why these coordinates? And what’s this clock counting down to?

You hesitate, debating whether to look up the location. It could be nothing, just a random point on a map. Or it could be something… more. With trembling fingers, you open your maps app and input the numbers.

A pin drops. The location appears—a place just outside the city, one you’ve never visited, yet somehow it feels oddly familiar. A wave of déjà vu washes over you, unsettling in its intensity. The name of the area blurs on the map, as if your mind is struggling to make sense of it. It’s like the place has been pulled from the edges of a forgotten dream.

Curiosity flares within you, bright and undeniable, but it’s tinged with something darker—a flicker of dread. The kind that creeps in when you know something isn’t right. You can’t pinpoint it, but there’s a heaviness in your chest, an instinctual warning to turn back. Yet, the coordinates still glow on your phone, a beacon demanding your attention.

There’s no clear reason why this place would show up on your phone, or why it feels like an unspoken challenge has been issued. One you can’t refuse, even if part of you wants to.

You glance around at the bustling city, the normalcy of it all, but there’s a growing sense that your ordinary day is about to take a sharp, irreversible turn. The words &#39;&#39;&quot;The Clock is Ticking&quot; &#39;&#39;echo in your mind, louder than the traffic, louder than your doubts.

The only question left is... will you follow?

   [[ Ignore It]] — It’s probably just a glitch, right? You continue on your way, pretending like nothing happened.
   [[ Investigate the Coordinates]] — You’re curious. Maybe this is some kind of prank, but something in your gut tells you to find out where these coordinates lead.
    [[Take the Phone to a Specialist]] — This feels too weird. You decide to consult a expert to figure out what’s really going on with your phone.</tw-passagedata><tw-passagedata pid="2" name=" Ignore It" tags="Ending" position="2750,200" size="100,100">You shake your head, deciding it’s just a glitch and not worth your time. “It’s probably nothing,” you mutter to yourself as you continue down the street, trying to shake off the feeling that something unusual lurks beneath the surface.

You move through your usual routine—work feels mundane, and you can’t quite recall the specifics of your tasks. What was your job again? The stroll through the park doesn’t offer its usual comfort; the rustling leaves and distant laughter blend into the background noise of the city. The sound of traffic surrounds you, but the nagging thought of the glitch lingers in your mind.

As the day progresses, you find yourself glancing at your phone more often, half-expecting it to flicker again. But it remains calm, just as it should. Still, the phrase &#39;&#39;“The Clock is Ticking”&#39;&#39; echoes in your thoughts, leaving you feeling slightly unsettled.

By the time you get home, you can’t shake the feeling that you might have missed something important—or had you simply forgotten? The idea of an unseen danger gnaws at you, making you wonder if you should have investigated after all. You stand at your front door, hesitating—should you brush it off and go to bed, allowing the day’s unease to fade, or should you follow your instincts and look deeper into the glitch that set this unsettling feeling in motion?

The quiet of the night surrounds you, but inside, a sense of urgency builds. You could check online for reports about similar glitches or anomalies, maybe consult forums where others share strange experiences. Or you might dig out your old tech manuals and see if anything stands out that could explain the glitch.

With your heart racing, you weigh your options, knowing that whatever choice you make will shape the night ahead. Do you embrace the mystery or retreat to the safety of routine?

But even as you think that, everything starts to feel foggy. What were you doing again? A wave of confusion washes over you, and the mundane details of your day slip away, replaced by an unsettling haze. You struggle to recall the specifics of your tasks and the path you took home.

Was it time for bed? You shake your head, fighting the disorientation, but the thought is too tempting. You turn and head to your bedroom, letting the familiar routine guide you. As you prepare for sleep, the weight of the day settles heavily on you.

Lying in bed, you pull the covers up, but you can’t quite remember why you felt so uneasy. The phrase “The Clock is Ticking” flits through your mind, nagging at you like a forgotten dream~~. //You always told him that when he...//~~

But the thought drifts away, slipping through your fingers as sleep finally takes you. The night envelops you in comforting darkness, and by morning, all of it—the unease, the glitch, the memories—seems to have vanished. You wake up feeling oddly refreshed, but a lingering sense of something important is buried just beneath the surface, waiting to resurface when you least expect it.

As you go through your morning routine, you catch yourself glancing at your phone, half-expecting it to flicker to life. But everything appears normal, and you can’t shake the feeling that something is still off, hiding in the corners of your mind.

[[Start]]</tw-passagedata><tw-passagedata pid="3" name=" Investigate the Coordinates" tags="" position="1975,425" size="100,100">You hesitate for a moment, staring at the glitching screen of your phone. The coordinates are still there, blinking. You know it’s strange—something like this shouldn’t happen—but your curiosity gets the better of you. Quickly, you copy the coordinates before the screen flickers and goes black again.

Opening your maps app, you input the numbers. To your surprise, the location isn’t far—just a few miles away on the outskirts of the city, near an old abandoned factory you’ve heard rumors about but never visited.

The air feels colder than usual as you head toward the coordinates. The streets are oddly quiet, as if the world is holding its breath. When you finally arrive, you stand before the crumbling walls of the factory, long shut down and left to decay. The coordinates lead directly inside.

An eerie silence hangs over the place, as though time itself has stopped. As you take a step closer, a strange sense of familiarity washes over you. The factory’s rusted exterior and broken windows stir something deep in your memory, but you can’t grasp why it feels so recognizable. You shake your head, trying to focus.

Suddenly, a low hum fills the air. A hidden door in the factory wall opens with a soft click, as if it was expecting you. A chill runs down your spine, and you glance around, half-expecting someone to appear. But no one does. The silence deepens, and an undeniable pull urges you to enter.

[[Enter the Factory]] — Whatever’s inside was hidden for a reason, but you’ve come this far. You push the door open and step inside.

[[Look Around First]] — This feels too easy. You decide to check the area, see if anyone’s watching or if there’s something unusual about the factory itself.

[[Check Your Phone Again]] — The situation feels wrong. Maybe you should involve someone else before stepping into something dangerous.</tw-passagedata><tw-passagedata pid="4" name="Take the Phone to a Specialist" tags="" position="5600,100" size="100,100">You decide that the glitch is too strange to simply brush aside. The unsettling phrase, “The Clock is Ticking,” sticks in your mind as you make your way to a nearby tech specialist you trust.

As you enter the small shop, the smell of electronics and coffee fills the air. The specialist, a young woman named Mia, greets you with a friendly smile. You quickly explain the glitch and show her your phone. You watch as Mia examines your device, her fingers deftly navigating the screen. After a few moments, she looks up, a puzzled expression on her face.

“I can’t find anything wrong with the software,” she says, shaking her head. “It looks like it’s functioning normally. The coordinates you provided lead to an old part of the city; nothing important is there, but I wouldn’t take it too seriously. It might just be some kind of prank.”

You feel a mix of relief and disappointment. The tension of the unknown fades a bit, but the lingering thought of “The Clock is Ticking” still rattles in your mind.

“Are you sure? It felt… weird,” you reply, still uneasy.

“Honestly, it’s probably nothing, you don’t need to worry about hi— it,” Mia reassures you with an odd smile, but you’re not sure why it unsettles you. “But if it continues, you can always bring it back. Just keep an eye on it; no need to be dealing with unpleasant things.”

You thank her, though the strange feeling lingers. As you leave the shop, the weight of uncertainty still hangs in the air. You can’t shake the feeling that something isn’t right, that there’s more to this glitch than meets the eye.

Just as you start to shake off the unease, you notice a small, peculiar shop tucked away between two larger buildings. Its sign swings gently in the breeze, reading “Curiosities &amp; Oddities.” The window displays an assortment of strange items—old clocks, jars filled with unidentifiable substances, and intricate trinkets that seem to shimmer in the light.

[[Enter the Shop]] — The allure of the “Curiosities &amp; Oddities” shop is too strong to resist.
[[Keep walking]] — You decide to keep walking, sensing that something about the shop feels off</tw-passagedata><tw-passagedata pid="5" name="Enter the Factory" tags="Major-choice" position="2450,625" size="100,100">The door shuts behind you with a soft thud, sealing you inside the dimly lit and oddly familiar hallway. As you venture deeper into the abandoned factory, the sound of your footsteps echoes eerily against the walls. A faint blue light ahead draws you in, illuminating the outlines of ancient machinery, all coated in dust and grime.

You finally reach a large circular chamber at the end of the hall. At its center stands a massive machine surrounded by intricate gears and glowing circuits. The machine hums with energy, its vibrations resonating through the air. Above it, a swirling portal of blue light forms, flickering and pulsating like a heartbeat. It’s as if the machine is generating the portal, harnessing some unknown power to create a gateway to another place.

The atmosphere is thick with anticipation, and the portal seems to beckon you closer, revealing fleeting glimpses of colors and shapes beyond the swirling light. You can’t shake the feeling that this place holds secrets—answers to questions you didn’t even know you had.

[[Enter the Portal]] — You feel a powerful urge to step through, eager to discover what lies beyond this gateway.

[[Inspect the Machine]] — You decide to examine the machinery generating the portal, curious about how it works and what powers it.

[[Look for a Control Panel]] — Perhaps there’s a way to interact with the machine or control the portal. You search the room for any panels or switches.</tw-passagedata><tw-passagedata pid="6" name="Look Around First" tags="" position="3100,550" size="100,100">You take a moment to look around, noting how the factory stands in stark contrast to the normalcy of the street. The nearby houses are quiet, their lights flickering on and off, but nothing seems out of the ordinary—except for the unsettling presence of the factory looming ahead.

Cautiously, you approach the door, acutely aware of the feeling that something is off. The low hum resonates more clearly now, almost as if it’s calling to you, drawing you closer with an irresistible pull.

[[Enter the Factory]] — Whatever’s inside was hidden for a reason, but you’ve come this far. You push the door open and step inside.

[[Check Your Phone Again]] — The situation feels wrong. Maybe you should get someone involved—&#39;&#39;him&#39;&#39;—before you step into something dangerous.

[[Decide Not to Enter]] — You rethink your choice entirely and decide it’s best not to go in at all.</tw-passagedata><tw-passagedata pid="7" name="Check Your Phone Again" tags="" position="2700,350" size="100,100">You pull out your phone, feeling the weight of uncertainty pressing on you. The coordinates were accurate, leading you directly to this hidden door, but something still feels off.

Before stepping inside, you decide to call a friend who has some experience with general weirdness;// after all, he—//. You dial quickly, and after a few rings, they pick up.

“Hey, it’s me. I found this factory at these coordinates, and it looks… strange. I think I might go inside, but I wanted to let you know just in case,” you say, trying to keep your voice steady.

Your friend’s tone shifts from concern to urgency. “Seriously, you shouldn’t go there alone. There are too many unknowns. It’s better to just steer clear of that place.”

They pause, clearly worried about your safety. “What do you plan to do?”

You open your mouth to respond but suddenly realize this isn’t the person you meant to call. A haze of confusion settles over you as you struggle to recall who you had intended to reach out to instead. It’s like a crucial piece of your memory has slipped away.

“Uh, I…” You falter, the words stuck in your throat, but the urgency in your friend’s voice pulls you back to the moment.

“Listen, just be careful, okay? If you go in there, let me know the second you’re out. Promise?”

You nod, even though they can’t see you. “Yeah, I promise.”

As the call ends, you feel the weight of your decision pressing down even harder. What were you going to do next?

[[Go Alone but Keep Them Updated-&gt;Enter the Factory]] — You tell your friend you’ll go in alone but promise to keep them updated on what you find.
[[Decide Not to Enter]] — You rethink your choice entirely and decide it’s best not to go in at all.</tw-passagedata><tw-passagedata pid="8" name="Enter the Portal" tags="" position="1200,500" size="100,100">Without hesitation, you step forward and cross the threshold of the swirling blue light. Instantly, a wave of energy washes over you, and the world around you warps and distorts. Colors clash violently, shapes twist, and a chilling sensation grips you.

As you emerge on the other side, you find yourself in a nightmarish realm. The sky is an unsettling shade of crimson, casting an eerie glow over the landscape. Jagged black mountains loom in the distance, and the ground beneath your feet is cracked and barren.

But as you take in your surroundings, the landscape shifts—mountains bend and twist like molten wax, while the ground ripples as if it’s alive. Shadows flicker and morph into grotesque figures that seem to watch you, their features ever-changing and disconcerting. An overwhelming sense of dread washes over you, as if the very fabric of this realm is steeped in despair and chaos.

You take a cautious step forward, and suddenly, the ground beneath you quakes, creating fissures that split the earth. The whispers around you grow louder, echoing in a cacophony of voices, each trying to lure you deeper into the ever-shifting horrors of this realm.
[[Explore the Nightmarish Landscape]] — You decide to brave the changing horrors ahead, hoping to find answers or a way back home.
[[Call Out for Help]] — You shout into the chaos, seeking any sign of life or guidance amidst the shifting madness.
[[Look for a Way Back Through the Portal]] — You reconsider your choice and search for a way to return to the familiar chamber, hoping the portal hasn’t closed.</tw-passagedata><tw-passagedata pid="9" name="Inspect the Machine" tags="" position="2300,900" size="100,100">You step cautiously toward the massive machine at the center of the chamber, drawn in by its humming energy. The surface is cold and metallic, and as you run your fingers along it, you can feel the vibrations coursing through. The blue light from the portal casts flickering shadows across the machine, highlighting intricate gears and tubes, some of which pulse with energy.

However, as you examine the machine more closely, you notice that there are no visible controls or interfaces. It seems designed for something beyond your understanding. You reach out to touch one of the glowing circuits, but as soon as you make contact, a surge of energy sparks through your fingertips.

Suddenly, alarms blare to life, and the machine begins to tremble. The portal flickers violently, and you hear a series of mechanical clicks as the machine&#39;s systems engage, but they do not respond to your touch. It’s clear that tampering with this machinery was a mistake.

Just as you consider your next move, the ground beneath you shakes, and you realize you need to act quickly before the situation escalates.
[[Enter the Portal]]  the Portal — Despite the chaos, you decide to take the plunge and step through the portal before it destabilizes completely.
[[Try to Escape the Chamber]] — You turn back to look for another way out, hoping to escape the potential danger of the machine.
[[Look for Emergency Shut-off]] — You frantically search the area for an emergency shut-off, hoping to stabilize the machine and the portal before it’s too late.</tw-passagedata><tw-passagedata pid="10" name="Look for a Control Panel" tags="" position="2700,800" size="100,100">You decide to search the room for any controls that might allow you to interact with the machine generating the portal. Moving cautiously, you scan the walls and the base of the machine.

After a few moments, you find a dusty control panel nestled in the shadows on one side of the room. It’s covered in grime, and the lights are dim, but you can make out a series of buttons and switches. Some are labeled with strange symbols, while others seem to have faded completely.

You wipe the dust off the panel, and the moment you do, a faint glow emanates from the buttons. The symbols seem to pulse gently, as if reacting to your presence. You feel a sense of urgency; you might be able to control the portal or stabilize the machine.
As you study the panel, you notice two distinct sections:

   [[ Activation Controls]] — These buttons seem to relate to powering the machine and the portal.
    [[Safety Override]] — One button stands out, labeled with a caution symbol, potentially shutting everything down if needed.</tw-passagedata><tw-passagedata pid="11" name="Try to Escape the Chamber" tags="" position="2300,1000" size="100,100">Panic grips you as the alarms blare louder and the ground shakes beneath your feet. You turn on your heel, eyes darting around the chamber for a way out. The pulsating blue light from the portal casts eerie shadows, but your focus is on finding an exit.

You spot the narrow passageway you noticed earlier, barely visible in the dim light. Without hesitating, you sprint toward it, heart racing. The ground continues to tremble, and you can hear the machine groaning ominously behind you.

As you reach the passageway, you dive through just as a powerful surge of energy bursts from the machine, sending a shockwave that rattles the walls. You narrowly avoid being thrown back as you pull yourself into the cramped corridor.
Inside the Passageway:

The narrow corridor is dark and cold, with walls lined in a metallic sheen. You push forward, adrenaline propelling you as you try to distance yourself from the chaos behind. The passage twists and turns, leading deeper into the factory.

Suddenly, you hear a loud crash from behind you—the machine has malfunctioned, and the sound echoes down the corridor. You quicken your pace, trying to stay calm despite the fear that creeps in.

After what feels like an eternity, you stumble into another room, this one filled with ancient relics and strange devices. The air is thick with dust, and you can see faint light filtering through cracks in the walls.

[[Search the Room for Clues ]]— You want to investigate the relics and devices, hoping to find something that can help you understand what’s happening.
[[Find Another Exit]] — You prioritize your escape and look for another way out of this room, wanting to put as much distance as possible between you and the chaos.
[[Stay and Hide]] — You decide to hide in the room, hoping the turmoil behind you will pass and you can figure out your next move in safety.</tw-passagedata><tw-passagedata pid="12" name="Look for Emergency Shut-off" tags="" position="2800,900" size="100,100">Panic surges through you as the alarms wail louder. You frantically search for an emergency shut-off switch, hoping to halt the chaos before it escalates further. Your hands tremble as you scan the control panel and the machine, but nothing stands out.

Finally, you spot a large red button at the base of the machine, clearly labeled “Emergency Stop.” With no time to lose, you press it down with all your strength. For a brief moment, it seems like the machine might respond—the alarms quiet, the vibrations lessen, and the portal flickers.

But then, a deafening roar erupts from the machine, and the portal flares wildly. The energy backfires, sending a shockwave through the room. You stumble back, and the world around you dissolves into a whirlpool of colors and sounds.

You close your eyes, feeling yourself being pulled apart and stitched back together, like a jigsaw puzzle gone wrong. When you open them again, you find yourself lying in your own bed, drenched in sweat.

Was it all just a dream? The remnants of the factory linger in your mind—images of the portal, the machine, the swirling energy. You look around your room, everything familiar yet unsettling. The world outside looks normal, but you can’t shake the feeling that something has changed, that your life is on the brink of something unimaginable.

As you sit up, your phone buzzes on the bedside table. You pick it up, and a new notification catches your eye—coordinates, just like before.
Was it all just a dream, or has something shifted in your reality? The journey has only just begun...

[[Start]] </tw-passagedata><tw-passagedata pid="13" name="Safety Override" tags="Ending" position="2900,800" size="100,100">You take a deep breath, knowing that shutting everything down might be the safest option. With determination, you reach for the button labeled with a caution symbol. The moment your finger presses down, the machine emits a loud, warning beep, but you hold steady, hoping for the best.

The moment the button activates, the alarms escalate to a deafening roar. The portal flickers erratically, colors swirling chaotically as the energy begins to destabilize. For a split second, it seems like the machine is responding, but then—without warning—the entire structure shudders violently.

The ground beneath you trembles, and the portal erupts into a blinding flash of light. You’re thrown backward as the shockwave knocks you off your feet. Everything around you begins to dissolve, the air thickening with a surreal energy.

In a panic, you realize that the override didn’t stabilize anything; instead, it triggered a catastrophic feedback loop. As the room spins out of control, you close your eyes, bracing for impact.
When you finally open your eyes again, you find yourself lying in your own bed, heart racing and drenched in sweat. The familiar surroundings feel oddly surreal. The remnants of the factory haunt your mind—the swirling portal, the chaos of the machine.

You sit up, glancing around your room, trying to make sense of what just happened. Was it all just a dream? The question lingers in the air. As you reach for your phone, a notification flashes across the screen—coordinates, just like before.

The journey is far from over.
[[Start]] </tw-passagedata><tw-passagedata pid="14" name=" Activation Controls" tags="" position="2600,900" size="100,100">With a deep breath, you press the activation controls, feeling a rush of adrenaline. The moment your finger makes contact, the panel lights up fully, and the machine responds with a deep, resonating hum. The portal’s blue light flickers violently, swirling chaotically as the energy flows through the machine.

Instead of stabilizing, the portal’s turbulence increases, casting erratic shadows across the chamber. You catch glimpses of distorted landscapes and fleeting images—some familiar, some utterly alien. The atmosphere grows charged, and the ground beneath you vibrates, making it hard to maintain your balance.

Suddenly, warning alarms blare loudly, and the machine starts to shake uncontrollably. You can feel the walls of the factory shudder, and the pulsing portal feels like it might explode at any moment. The energy surges, creating an overwhelming sense of urgency.

[[Enter the Portal]] — You decide to take the plunge and step through the chaotic portal, hoping to find safety or answers on the other side.
[[Try to Escape the Chamber]] — Realizing the danger, you quickly search for another way out of the factory before it collapses.
[[Look for Emergency Shut-off]]  — You want to stop the machine from further destabilizing, looking for an emergency shut-off switch.</tw-passagedata><tw-passagedata pid="15" name="Search the Room for Clues " tags="" position="2300,1100" size="100,100">You step cautiously into the dimly lit room, your eyes scanning the scattered relics and strange devices. The air is thick with dust, and you can barely make out the shapes of objects shrouded in shadow. As you move deeper into the space, you catch sight of various doomsday images etched into the walls—frightening depictions of apocalyptic scenarios.

One mural shows a chaotic landscape, filled with swirling storms and collapsing cities. Another depicts a great machine unleashing a torrent of energy, with figures fleeing in terror. Each image resonates with the chaos you just experienced, and it feels as though the room holds secrets about the factory&#39;s purpose.

You approach a large, cracked panel displaying a complex diagram. It looks like a blueprint of the machine you encountered, with annotations in a language you don’t understand. Symbols of warning and danger surround the machine, hinting at its catastrophic potential.

Among the scattered debris, you also find a small, metallic device that resembles a remote. It has a single glowing button on it, and a faint hum emanates from within.
[[Take the Remote Device]] — You decide to take the mysterious device with you, curious about what it might control or influence.
[[Study the Blueprint More Closely]] — You want to examine the diagram further, hoping to decipher its meaning and learn more about the machine.
[[Investigate the Doomsday Images]] — You feel drawn to the murals and want to examine them more closely, searching for any hidden messages or clues.</tw-passagedata><tw-passagedata pid="16" name="Find Another Exit" tags="" position="2400,1100" size="100,100">Panic resurfaces as you quickly scan the room for any potential escape routes. You rush to each wall, feeling for hidden doors or cracks that might lead you out. Dusty relics and strange devices loom in the shadows, but they offer no way out.

Your heart races as you realize there’s no exit here. The walls are solid, the only sound your own breathing and the distant chaos behind you. The loud crash from the machine echoes in your ears, a grim reminder that danger is still close.

With no way out, you take a moment to collect yourself. The room feels suffocating, and you know you must act quickly. You glance at the relics surrounding you, weighing your options.
Choices:

    [[Search the Room for Clues ]]  the Room for Clues — You decide to investigate the relics and devices, hoping to find something useful that can help you understand the situation or aid your escape.
    [[Stay and Hide]]  and Hide — You choose to find a good hiding spot in the room, hoping the turmoil behind you will pass so you can figure out your next move in safety.</tw-passagedata><tw-passagedata pid="17" name="Stay and Hide" tags="" position="2200,1100" size="100,100">You quickly find a shadowy corner behind a stack of old crates and crouch down, hoping to stay unnoticed. The distant chaos of the factory fades into a low rumble, and you hold your breath, listening intently.

Minutes drag on, and the silence becomes suffocating. Your heart pounds in your chest, but the initial adrenaline begins to wane, replaced by an unsettling boredom. You glance around, observing the relics and strange devices, feeling a growing impatience.

As the stillness stretches, you start to question your decision. The room, once a refuge, now feels claustrophobic. You wonder if hiding was the right choice or if you should have explored further.

Finally, you realize you can’t just sit here waiting. You need to take action before the situation becomes even more dire.
[[Search the Room for Clues ]]  the Room for Clues — You decide to investigate the relics and devices, hoping to find something useful that can help you understand the situation or aid your escape.
[[Try to Listen for Sounds Outside]] — You cautiously move closer to the door, straining to hear if the chaos has subsided or if anything else is happening outside.</tw-passagedata><tw-passagedata pid="18" name="Take the Remote Device" tags="" position="2100,1300" size="100,100">Curiosity piqued, you reach for the small metallic device. As you lift it, the faint hum grows louder, vibrating in your hand. The glowing button pulses with an enticing light, and you can’t help but wonder what it might control or influence.

You notice faint words etched into the surface of the device, but they’re obscured by age and grime. Leaning closer, you strain to decipher the inscriptions, but a sudden headache pulls your focus away. Absentmindedly, you put the device back in your pocket, feeling its weight pressing against you—~~//strangely normal and forgettable//~~—and decide to push forward, leaving the mystery for later.
As you step further into the depths of the factory, the rumbling grows louder, urging you to discover what lies ahead. You take a deep breath and continue, your senses heightened and your heart racing.
[[Study the Blueprint More Closely]]  the Blueprint More Closely — You decide to examine the diagram further, hoping to decipher its meaning and learn more about the machine.
[[Investigate the Doomsday Images]]  the Doomsday Images — You feel drawn to the murals and want to examine them more closely, searching for any hidden messages or clues.
[[Find Another Exit]]  — You choose to exit the room and investigate another part of the factory, feeling the urgency of the rumble.</tw-passagedata><tw-passagedata pid="19" name="Study the Blueprint More Closely" tags="" position="2300,1300" size="100,100">You turn your attention back to the large, cracked panel displaying the complex diagram. As you examine it closely, the intricate lines and symbols begin to reveal a disturbing story.

The blueprint outlines the design of the very machine you encountered earlier, detailing its components and functions. Scrawled in the margins are frantic notes from a scientist—one who seems to have been deeply troubled by his work.

You decipher the words: “Deception,” “Gateway,” “Containment Failure.” The scientist’s handwriting grows more erratic as you read, detailing how he was lured into building the machine by promises of greatness and knowledge. Instead, he unwittingly forged a connection between this world and an eldritch being, a threat far beyond his understanding.

There’s a brief reference to someone else, a name crossed out and surrounded by frantic scribbles, as if the scientist wished to erase that part of his past guilt. Something had happened to them—an incident that haunted his notes and seemed to contribute to his unraveling state of mind.
The notes explain that the machine and the portal are intrinsically linked, functioning as both a gateway and a means of control. The scientist believed he could contain the entity, but the more he worked, the clearer it became that the machine was weakening the barriers between dimensions.

A chilling realization washes over you: the factory was never just a place of industry; it was something elce,, a means to bring forth a force far beyond human understanding. The eldritch being’s return would not only endanger your world but could unravel reality itself.

[[Look for a Way to Disable the Machine]] — Armed with the knowledge you’ve gained, you resolve to find a way to disable the machine and prevent the entity’s emergence.
[[Find Another Exit]]  Another Exit — With the knowledge of the danger looming, you decide it’s best to escape and figure out your next steps from a safe distance.</tw-passagedata><tw-passagedata pid="20" name="Investigate the Doomsday Images" tags="" position="2400,1300" size="100,100">You step closer to the murals, your heart pounding as you take in the chaotic scenes depicted. Each image seems to pulse with an energy of its own, as if the very fabric of the room is alive with ancient fears.

One particularly striking mural shows an thing, a colossal being shrouded in darkness and chaos. Its many eyes seem to stare into your soul, filled with a malevolent intelligence. Around it, figures—some resembling humans, others grotesque—struggle against a tide of destruction.

The captions beneath the images are cryptic, but you can make out phrases like “Awakening the Forgotten” and “The Balance Disturbed.” The artwork suggests that this being was once imprisoned, and its return would spell doom for reality itself.

You feel a chill run down your spine as you realize the connection to the machine—could it be that the factory is a gateway or a tool to unleash this entity back into the world? The implications weigh heavily on you, making your next decision all the more critical.

[[Take the Remote Device]]  the Remote Device — You decide to take the mysterious device you found earlier, hoping it might help control or contain the eldritch being.
[[Study the Blueprint More Closely]]  the Blueprint More Closely — You want to examine the diagram of the machine again, searching for a way to prevent a catastrophe.
[[Find Another Exit]]  Another Exit — With the terrifying revelations in mind, you prioritize your escape and look for a way out of this room, wanting to get as far away from the chaos as possible.</tw-passagedata><tw-passagedata pid="21" name="Look for a Way to Disable the Machine" tags="" position="2300,1400" size="100,100">Determined to prevent the eldritch entity from being unleashed, you quickly scan the blueprint for any hints on how to disable the machine. Your eyes dart across the intricate lines and annotations, searching for a weak point or an emergency shut-off.

In one corner of the blueprint, you notice a series of symbols representing “power conduits” and “safety mechanisms.” One section catches your eye—marked with a red warning symbol, it indicates a manual override that could potentially disrupt the energy flow and close the portal.

With newfound purpose, you make your way back toward the main chamber, where the machine still hums ominously. As you approach, you feel the energy in the air crackle with tension, but you push through the fear, focusing on the task ahead.

You find the power conduits and safety mechanisms you identified in the blueprint. Several wires snake out from the machine, pulsating with energy, and you notice a panel that seems to conceal the manual override.
[[Attempt to Access the Manual Override]] — You pry open the panel, trying to access the override mechanism and disrupt the machine&#39;s energy flow.
[[Cut the Power Conduits]] — You decide to sever the power conduits, hoping to cut off the machine&#39;s energy supply and prevent the portal from functioning.

</tw-passagedata><tw-passagedata pid="22" name="Attempt to Access the Manual Override" tags="" position="2200,1500" size="100,100">
With urgency driving you, you pry open the panel concealing the manual override. The interior is a tangle of wires and circuitry, illuminated by flickering lights. You spot a large lever marked “Emergency Shutdown” alongside several switches labeled with warning symbols.

Taking a deep breath, you grasp the lever firmly and pull it down. Instantly, the alarms blare again, but this time, a deep, resonating sound follows as the machine begins to respond. The energy coursing through the room starts to stabilize, and the chaotic flicker of the portal begins to fade.

As you continue to hold the lever down, you notice the portal shrinking, its swirling energy slowly retracting back into the machine. The oppressive tension in the air eases, and you can feel the vibrations lessening beneath your feet.
With the portal retracting, you hold the lever firmly, feeling the weight of your decision. The blaring alarms gradually fade into a steady hum, and the chaotic energy surrounding you begins to settle. The swirling blue light of the portal shrinks further until it disappears entirely, leaving behind an eerie calm.

As the vibrations in the room diminish, you step back from the control panel, catching your breath. You’ve managed to avert a disaster, but the implications of what you’ve learned linger heavily in your mind.

Just as you begin to process your victory, a low, echoing voice reverberates through the chamber, causing your heart to race again.

“You think you’ve contained it, but the true game has just begun.”

The voice seems to resonate from the machine itself, sending chills down your spine. You glance around, searching for the source, but the room remains empty.

“Knowledge has its price, and power can be a double-edged sword. Will you step back, or will you delve deeper?”

[[Decline the Voice’s Offer]] — You refuse to engage further with whatever entity is trying to manipulate you, wanting to focus on finding a way out.
[[Ask for More Information]] — You decide to ask the voice what it means, seeking clarity on its intentions before making a decision.
[[Accept the Offer]]  — You decide to embrace the enticing opportunity for knowledge and power, intrigued by what lies beyond.</tw-passagedata><tw-passagedata pid="23" name="Cut the Power Conduits" tags="Ending" position="2600,1400" size="100,100">With a surge of determination, you reach for the nearest power conduit, hoping to sever its connection to the machine. You grab a metal tool you found among the debris and, with a swift motion, slice through the pulsating wire.

At first, it seems like you’ve succeeded—the machine sputters, and the humming sound begins to fade. But then, without warning, alarms blare louder than ever, and the entire structure starts to tremble violently.

The blue portal flickers ominously, swirling faster as if reacting to the disruption. You realize that cutting the conduits triggered a catastrophic feedback loop within the machine. The energy builds rapidly, and a series of sparks erupt from the panel where you severed the wire.

In an instant, the ground shakes violently, and you are thrown off balance as the machine begins to implode. The portal flares with an intense light, and you can feel the fabric of reality beginning to warp around you.

In an instant, the ground shakes violently, and you are thrown off balance as the machine begins to implode. The portal flares with an intense light, and you can feel the fabric of reality beginning to warp around you. Amidst the chaos, you think you hear someone scream your name, their voice strained and desperate, cutting through the cacophony of destruction.

As the chaos escalates, you realize it’s too late to escape. You close your eyes against the blinding light, bracing for impact as the energy from the portal surges forth. When the light dissipates, you find yourself lying in your own bed, heart racing and drenched in sweat.

Was it all just a dream? The haunting images of the eldritch being and the machine linger in your mind, suggesting a deeper truth. As you reach for your phone, a notification flashes across the screen—coordinates. Your heart races as you try to recall if you had forgotten something important.

You sit up, glancing around your room, trying to shake off the remnants of the nightmare. The coordinates lead to an abandoned factory, a place that feels eerily familiar, as if it’s calling you back. The dream might have felt surreal, but the urgency in those coordinates is palpable.

Could it be connected to the chaos you experienced? You sense that this isn’t just a coincidence; it feels like a thread pulling you toward something you need to confront. 

Do you follow the coordinates to uncover the truth, or do you dismiss it as a figment of your imagination and try to move on?
[[Start]] </tw-passagedata><tw-passagedata pid="24" name="Decline the Voice’s Offer" tags="Ending" position="2100,1600" size="100,100">Gathering your resolve, you snarl, “I won’t let you trick me into allowing you into my world.”

The voice falls silent for a moment, and the tension in the chamber thickens. Then it responds, rage boiling beneath its words. “So be it! But remember this: your ignorance will be your undoing! One day, another fool will let me in, and then you will see the consequences!”

With a final echo of its presence, the voice fades away, leaving you alone in the dim light of the chamber. You feel a wave of relief wash over you, and the oppressive weight of the entity’s influence lifts.

Determined to escape, you turn your attention back to the control panel. You recall the layout of the factory and remember a service exit that might lead you to safety. You move quickly, retracing your steps through the now-quiet hallways.

Navigating the corridors feels strangely liberating now that you’ve resisted the entity&#39;s pull. You reach the service exit, and as you push it open, a cool breeze washes over you, bringing with it the sounds of the outside world.

You take a deep breath, letting the cool night air fill your lungs as you pull out your phone. With your heart still racing from the encounter, you dial your friend&#39;s number.

“Hey, it’s me,” you say when they pick up. “You won’t believe what just happened.”

You explain the entity’s attempt to manipulate you, how you stood your ground, and your escape from the factory. Your friend listens intently, a mix of concern and admiration in their voice.

“That sounds terrifying! I’m glad you got out,” they reply. “But what now? Are you going to go back?”

You look back at the factory, shadows flickering in the corners of your vision. The thought sends a shiver down your spine, but the curiosity remains strong. What secrets lie buried within the factory, and what other forces might be at play in the shadows?

Yet as you stand there, a chilling sensation grips you—a nagging feeling that in your defiance, you may have inadvertently doomed someone important to you. A name lingers just out of reach, teasing the edges of your memory, but you can&#39;t recall who it was. The uncertainty gnaws at you, amplifying the dread that something is terribly wrong. You can&#39;t shake the feeling that the encounter has set off a chain of events beyond your control, leaving you feeling more isolated than ever.
[[Start]] </tw-passagedata><tw-passagedata pid="25" name="Ask for More Information" tags="" position="2200,1600" size="100,100">Determined to understand the situation, you ask, “What do you mean by that? What are your intentions?”

The voice pauses, a sly undertone creeping in. “Ah, a curious mind! I like that. You see, I’m the gatekeeper of knowledge and power, tied to this machine you’ve bravely subdued. But here’s the twist: I can offer you insights and abilities that will set you apart from the rest, if you’re willing to play along.”

A chuckle echoes in the chamber, oozing charm. “You’ve barely scratched the surface, my friend. The true power of this portal can connect you to realms untold, giving you the chance to reshape your very reality. Sure, knowledge can be overwhelming, and power can have its quirks, but it’s all part of the adventure! Don’t let a little uncertainty hold you back. After all, isn’t that what makes life exciting?”

The voice leans closer, as if sharing a secret. “One day, someone else will let me in, and you’ll wish you’d seized this opportunity. Think carefully—are you ready to unlock what lies beyond?”
[[Accept the Offer]]  the Offer — You decide to embrace the enticing opportunity for knowledge and power, intrigued by what lies beyond.
[[Decline the Voice’s Offer]]  the Offer — You refuse to engage further with the entity, prioritizing your safety and focusing on finding a way out.
[[Press for More Details ]]— You want to know more about what the entity is offering, probing for specifics before making a decision.</tw-passagedata><tw-passagedata pid="26" name="Accept the Offer" tags="Ending" position="2300,1600" size="100,100">With a mix of curiosity and determination, you respond to the voice. “I want to understand. Show me what lies beyond.”

A deep, rumbling laughter fills the chamber, echoing ominously off the metallic walls. The voice deepens, dripping with malice. “You naive soul! In your eagerness to understand, you’ve unwittingly unleashed your own doom! The very forces you sought to control are now free, and they will consume you and your world!”

Suddenly, the ground begins to tremble violently. The machine rattles, and you feel a surge of energy pulse through the air, growing more intense by the second. You realize too late that your choice has triggered something far beyond your control.

The portal reopens with a blinding flash of light, its swirling chaos returning more powerful than before. As the light coalesces, dark tendrils reach out, and you see glimpses of the eldritch entity you had glimpsed in the murals—a massive, shadowy figure with countless eyes and limbs.

“Welcome back to your world!” it bellows, its voice a cacophony of despair. “Now, witness the end! Last time, you were not so foolish, and that is why I got rid of you! I lured your precious scientist into my grasp, and he paid the price for your ignorance this time! You think you can resist me now? Your defiance will only lead to greater suffering! You’re not a very good &#39;&#39;//partner//&#39;&#39;, are you?”

As the entity breaks through the portal, a wave of energy washes over you, filling the room with a deafening roar. You try to back away, but it’s too late. The darkness engulfs you, and the last thing you hear is the echo of the entity’s laughter, promising chaos and destruction. Each note resonates with the weight of impending doom.

The realization hits you like a stone: your actions have not only endangered yourself but also those you care about. In your quest for understanding, you’ve unwittingly opened the door to horrors that may never be contained again.
[[Start]] </tw-passagedata><tw-passagedata pid="27" name="Press for More Details " tags="" position="2200,1700" size="100,100">Intrigued yet cautious, you say, “Alright, but I want to know more. What exactly are you offering?”

The voice bursts forth with enthusiasm, almost theatrically. “Ah, now we’re getting somewhere! Picture this: untold power at your fingertips! The ability to manipulate the very fabric of reality!”

It continues, voice rising with excitement. “Imagine wielding knowledge that few can fathom! You could bend time, alter your surroundings, even command the forces of nature! The possibilities are endless! What’s a little risk compared to the grand tapestry of destiny you could weave?”

The voice chuckles, as if caught up in its own fervor. “Of course, there may be minor… complications along the way. But think of it as a thrilling rollercoaster ride! Would you let a little bump ruin your fun? Embrace the adventure! There’s a world of wonders waiting for you!”

With a flourish, it adds, “And remember, every moment you hesitate is an opportunity lost! You could be the architect of your own fate! So, what do you say? Ready to seize your destiny?”
[[Accept the Offer]]  the Offer — You decide to embrace the wildly tempting opportunity for knowledge and power, ready to take the plunge.
[[Decline the Voice’s Offer]]  the Offer — You refuse to engage further with the entity, choosing safety and clarity over temptation.
[[Ask for Examples]] — You want specific examples of what this power could allow you to do before making a decision.</tw-passagedata><tw-passagedata pid="28" name="Ask for Examples" tags="" position="2200,1800" size="100,100">You maintain your resolve and say, “I need specific examples of what this power could allow me to do.”

The voice’s enthusiasm falters, annoyance creeping in. “Specifics? Really? You want me to spell it out for you?” It lets out an exasperated sigh, as if your hesitation is an affront to its grandiose promises.

“Fine!” it snaps, the tone shifting sharply. “You could bend the laws of nature! Imagine summoning storms at will, controlling shadows, or peering into the future! You could influence minds, reshape landscapes, or even pull creatures from other realms! The power is beyond comprehension!”

The voice’s frustration grows, its tone almost pleading now. “Why must you be so cautious? This is a rare opportunity! Countless others would leap at the chance without a second thought! But here you are, hesitating over every little detail!”

The urgency in its voice returns, dripping with desperation. “Time is running out! One day, someone else will embrace this chance, and you’ll be left wondering what could have been! Don’t let this slip away!”

[[Accept the Offer]]  the Offer — You decide to embrace the wildly tempting opportunity for knowledge and power, ready to take the plunge.
[[Decline the Voice’s Offer]]  the Offer — You refuse to engage further with the entity, choosing safety and clarity over temptation.
[[Demand More Clarity]] — You push back further, wanting to know the true cost of this power and what the risks really entail.</tw-passagedata><tw-passagedata pid="29" name="Demand More Clarity" tags="" position="2200,1900" size="100,100">Refusing to be swayed by its urgency, you press on. “I need to know the true cost of this power. What are the real risks involved?”

The voice recoils, fury igniting within it. “You think you can just demand answers from me? You’re in over your head!”

Suddenly, the air around you crackles with malevolent energy, and a rift opens in the shadows, revealing the entity behind the voice. As it manifests, the alluring façade crumbles, revealing a monstrous figure twisted with rage and power.

“You dare question me? I’ve offered you a chance to rise above the pitiful limitations of your existence! Yet here you stand, quibbling and questioning!”

The ground trembles beneath you as dark tendrils of energy swirl around the entity, the air thick with a palpable menace. “Fools like you always want guarantees! But let me make this clear: life is fraught with danger, and your hesitation only strengthens my resolve! I could crush your will in an instant!”

It leans closer, its voice a menacing whisper. “You will either seize your destiny or be left behind in your mediocrity! Make your choice, and do so quickly, or you will come to regret your defiance in ways you cannot imagine!”

[[Accept the Offer]]  the Offer — You decide to embrace the dark opportunity for knowledge and power, ready to take the plunge.
[[Decline the Voice’s Offer]]  the Offer — You refuse to engage further with the entity, choosing to escape the impending threat.</tw-passagedata><tw-passagedata pid="30" name="Try to Listen for Sounds Outside" tags="" position="2100,1200" size="100,100">You inch closer to the door, pressing your ear against the cold metal. You listen intently, hoping to catch any sign of movement or commotion outside the room. But the only thing you hear is the echo of your own heartbeat and the unsettling stillness around you.

Minutes pass, and the silence grows heavier, amplifying your sense of isolation. You shift your weight, trying to ease the tension in your muscles, but the stillness only deepens your anxiety.

Feeling restless and increasingly uneasy, you realize you can’t remain hidden forever. You need to make a choice before you’re trapped by indecision and boredom.
Choices:

    [[Search the Room for Clues ]]  the Room for Clues — You decide to investigate the relics and devices, hoping to find something useful that can help you understand the situation or aid your escape.
[[Find Another Exit]] — You prioritize your escape and look for another way out of this room, wanting to put as much distance as possible between you and the chaos.</tw-passagedata><tw-passagedata pid="31" name="Explore the Nightmarish Landscape" tags="Ending" position="1100,300" size="100,100">You decide to brave the horrors of the nightmarish landscape, pushing forward despite the overwhelming dread that wraps around you like a shroud. Each step feels heavier, the ground shifting beneath your feet, as if it too is alive and resisting your progress. The whispers grow louder, curling around your mind like tendrils, threatening to unravel your resolve.

As you venture deeper, grotesque figures emerge from the shadows, their forms writhing and twisting in unnatural ways. Their hollow eyes seem to follow you, and you try to focus on finding answers, but the cacophony of voices becomes unbearable. They murmur secrets and taunts, drowning out your thoughts, gnawing at your sanity.

Suddenly, the ground beneath you splits open, revealing a chasm filled with an impenetrable darkness. Before you can react, a powerful force yanks you toward the abyss. You struggle against it, but the shadows grasp at you, their cold fingers pulling you into the depths.

As you fall, the darkness envelops you completely. In that moment, you hear the echoes of the whispers—mocking, laughing, celebrating your fear. It feels like they’re feasting on your despair, each taunt twisting the knife deeper.

The last thing you feel is an overwhelming chill, a sensation of being utterly alone. The last sound you hear is a distorted chorus of voices calling your name, their tone a haunting blend of familiarity and malice, as you descend into the void.
[[Start]] </tw-passagedata><tw-passagedata pid="32" name="Call Out for Help" tags="" position="900,500" size="100,100">You take a deep breath and shout into the chaotic void, “Is anyone there? I need help!” Your voice reverberates against the crimson sky, but initially, it seems to vanish into the swirling madness around you.

For a moment, silence envelops you, and a cold chill runs down your spine. Just when you begin to doubt your decision, you think you hear a faint echo—a whisper that dances at the edge of your consciousness. “Help… find me…”

But was it real? The words could have been a trick of the mind, a cruel jest from the shadows that surround you. You strain your ears, trying to discern any clarity amid the cacophony of distorted voices swirling in the air. The chilling uncertainty gnaws at you.

As the landscape shifts again, you spot what appears to be a flickering light in the distance, shimmering like a beacon in the chaos. But is it a sign of hope, or another illusion meant to lead you astray?
[[Follow the Flickering Light]] — You decide to move toward the light, hoping it leads you to the source of the voice and possibly to safety, despite your doubts.
[[Continue Shouting for Help]] — You persist in calling out, uncertain of whether you truly heard a response, hoping to clarify the message or attract more attention.
[[Investigate the Source of the Sound-&gt;Investigate the Source of the Whispers]] — You turn your attention to the shadows around you, seeking to confront whatever is whispering, even though you’re not sure what you’ll find.</tw-passagedata><tw-passagedata pid="33" name="Look for a Way Back Through the Portal" tags="" position="1050,500" size="100,100">Panic sets in as you turn to retrace your steps, desperately searching for the portal you just came through. You scan the ever-shifting landscape, but to your horror, the portal is nowhere to be found.

The crimson sky pulses with energy, and the ground beneath your feet trembles ominously. The jagged mountains twist and warp, creating an impossible labyrinth that seems to mock your attempts to escape. Shadows swirl around you, and the grotesque figures whisper louder, their voices blending into a maddening chorus.

You stumble backward, overwhelmed by the realization that you are trapped in this nightmarish realm with no clear way out. The landscape shifts again, and a chasm opens beside you, revealing a glimpse of something dark and chaotic swirling below.

[[Explore the Nightmarish Landscape]] — You decide to brave the changing horrors ahead, hoping to find answers or a way back home.
[[Call Out for Help]] — You shout into the chaos, seeking any sign of life or guidance amidst the shifting madness.</tw-passagedata><tw-passagedata pid="34" name="Follow the Flickering Light" tags="Ending" position="1000,300" size="100,100">Driven by a mix of hope and uncertainty, you make your way toward the flickering light. Each step feels heavier as the ground beneath you shifts unpredictably. The light dances ahead, drawing you closer, but the shadows around you seem to close in, whispering ominous words that send chills down your spine.

As you approach, the light reveals itself to be a strange, pulsating orb, hovering in mid-air. Just as you reach out to touch it, the ground beneath you crumbles away, and you find yourself falling into a void of darkness.

The orb flickers and fades as you plummet, and the whispers grow louder, echoing your name. Panic sets in as you flail in the abyss, but there&#39;s no ground to catch you, no escape from the shadows that surround you. Suddenly, a deep, malevolent laughter rings out, filling the void with a chilling resonance. 

“Hahaha! Did you really think it would be that easy?” the voice taunts, dripping with malice. 

Everything goes silent as the last remnants of light vanish, and you are enveloped in an all-consuming darkness. The laughter echoes around you, a haunting reminder of your folly. The whispers fade, replaced by an overwhelming sense of despair and helplessness. You realize too late that the light was a lure, a deceptive trick leading you into the depths of this nightmare, as the laughter continues to reverberate, celebrating your descent into the abyss.
[[Start]]</tw-passagedata><tw-passagedata pid="35" name="Continue Shouting for Help" tags="Ending" position="900,300" size="100,100">With determination, you call out again, your voice ringing through the chaos. “Is anyone there? Please, I need help!” The echoes of your voice bounce back at you, mingling with the eerie whispers that swirl around. For a fleeting moment, hope flickers within you, a desperate yearning that someone—or something—might respond.

But the whispers grow more chaotic, twisting around you like serpents, drowning out your words. They mock you, their tones shifting from hushed tones to a cacophony of derision, as if the very shadows are savoring your desperation. You strain to listen, but all you can hear are the dissonant murmurs, swelling louder, more frantic, like a storm about to break.

In your desperation, you shout once more, “I’m not giving up! Help me!” But the response is not what you hoped for. The ground beneath you begins to shake violently, and the shadows coalesce into twisted shapes that writhe and undulate like grotesque puppets. They surge toward you, their presence filling the air with a chilling laughter that reverberates through the nightmarish landscape.

Panic grips you as you realize your cries have only drawn their attention. The figures close in, their forms shifting in unsettling ways—faces contorted in agony and ecstasy, eyes that glimmer with hunger. You feel the weight of despair settling over you, a suffocating shroud that threatens to crush your spirit. 

You turn to flee, but the landscape warps, becoming a maze of shifting darkness. The shadows stretch and elongate, forming walls that close in around you. As you run, the whispers intensify, swirling into a tempest of terror, filling your mind with a cacophony of fears and doubts.

The ground beneath you suddenly gives way, and you find yourself plummeting into an abyss. The chilling laughter follows you down, echoing in your ears as you descend into a void of chaos. You’ve called out in vain, luring the shadows closer until they engulf you completely, wrapping you in their cold embrace.

In this realm of madness and despair, you realize the true horror lies not just in the darkness, but in the haunting laughter that echoes your failures, a symphony of anguish that binds you to your fate forever.
[[Start]]</tw-passagedata><tw-passagedata pid="36" name="Investigate the Source of the Whispers" tags="" position="900,625" size="100,100">Summoning your courage, you turn your attention to the shifting shadows that seem to beckon you closer. The whispers grow louder, swirling around you, carrying fragments of words that hint at fear and desperation. “Find… the truth… must warn…”

As you push deeper into the darkness, a figure begins to materialize—a man, gaunt and worn, his face etched with despair. It’s the scientist, the one whose reckless ambition unleashed this chaos upon the world. He adjusts his glasses, which slide down his nose as he stares at you, his eyes flickering between hope and dread, and for a fleeting moment, you think you see a glimmer of recognition.

“How are you here?” he asks, his voice trembling with a mix of relief and fear. “I tried to contain it, but the portal… it changed everything! I thought I could control it, but it let in something—something terrible!”

You take a step closer, urgency fueling your questions. “Who are you?”

He looks devastated for a moment, a shadow of despair crossing his face. Then he pulls himself together, his posture shifting to one of resolve. The shadows pulse around him, but he stands firm, as if bracing against the darkness.

“You must understand, this entity—it feeds on fear and chaos. It hungers for souls, and it won’t stop until it claims what it wants. I thought I could master it, but I was wrong!” He pushes his glasses back up, a gesture that conveys both determination and regret.

He hesitates, his expression turning pained. “I thought it was my ally, my friend. I believed it could help me unlock the secrets of the universe, but it betrayed me. It used my ambitions against me, turning my research into a weapon. Now, it’s become a force I can’t control!”

You see the weight of his failure pressing down on him. “You have to leave this place! There’s still time to escape, but we need to act quickly!”

His gaze sharpens, the urgency in his voice rising. “If we don’t find a way to close the portal and stop the entity, it will consume everything. You need to trust me; we have to work together to set things right!”

[[Ask the Scientist for a Plan]] — You seek clarity from him, wanting to understand how you can escape this nightmare together.
[[Try to Convince Him to Leave with You]] — You urge him to come with you, believing that two can find a way out more effectively than one.
</tw-passagedata><tw-passagedata pid="37" name="Ask the Scientist for a Plan" tags="" position="1100,700" size="100,100">You take a moment to process the scientist&#39;s words. “So, you’re saying we need to distract the entity while you activate your machine?”

He nods, urgency in his eyes. “Exactly. I’ve been working on a device that can disrupt its core, but it requires time to charge. If we can draw its attention away from me, I might have a chance to finish it.”

“Do you have a plan for how we can distract it?” you ask, feeling the weight of responsibility settle on your shoulders.

“I can create a diversion with some of the materials I have,” he replies, glancing around at the remnants of your surroundings. “There are some volatile compounds and noise-generating devices I used for my experiments. If I set them up correctly, they’ll create both sound and light—something that should capture its attention.”

He gestures to the scattered debris, his mind racing with possibilities. “I’ll need to rig them into a sort of makeshift explosive, not harmful to us, but enough to create a disturbance. If I can time it right, the flashes and noise should draw the entity away from me, giving me the window I need to charge the machine.”
[[Help Him Gather Materials for the Diversion]] — You decide to assist him in finding what he needs to create the distraction.</tw-passagedata><tw-passagedata pid="38" name="Try to Convince Him to Leave with You" tags="" position="900,1000" size="100,100">Desperation fuels your voice as you say, “We need to get out of here! I can’t find a way on my own. You have to come with me!”

The scientist hesitates, uncertainty flickering in his eyes. “I… I can’t just abandon this place,” he replies, glancing around at the encroaching shadows. “I was the one who opened the portal. I have to try to fix what I’ve done.”

“Fixing it could take too long!” you urge, stepping closer. “We might not have the time. If you stay here, it’ll consume you just like it did before. We’re stronger together. Please, we can find another way to deal with it!”

He meets your gaze, weighing your words. The shadows behind him shift ominously, as if reacting to his indecision. “You’re right,” he finally admits, his voice wavering. “But if we leave, I might lose my chance to correct my mistake. I can’t let that happen!”

“Staying here won’t help anyone,” you insist, frustration bubbling beneath the surface. “What if this place is beyond repair? What if the entity has already won? We can’t afford to gamble on your redemption when our lives are at stake!”

The scientist clenches his fists, torn between guilt and the need for survival. “I know it’s reckless. But I thought—if I could just make one more attempt, if I could find the right way to channel my energy—”

“Your energy?” you interject, shaking your head. “That’s what brought this chaos to begin with! You can’t take that risk again. You have to think about the bigger picture.”

He looks at you, a flicker of recognition igniting in his gaze, as if he sees a reflection of his own fears and desires. “What if I’m too far gone? What if this is my only chance to set things right?”

[[Reassure Him of the Importance of Escape]] — You emphasize that escaping is the priority, and you can find another way to confront the entity later.
[[Offer to Help Him Find a Solution Together]] — Suggest that you can work together to find a way to fix the portal after escaping the immediate danger.
[[Insist on Leaving Now]] — You firmly state that there’s no time for hesitation, urging him to make a choice before it’s too late.</tw-passagedata><tw-passagedata pid="39" name="Reassure Him of the Importance of Escape" tags="" position="825,1150" size="100,100">
“Then let’s set things right together!” you say, voice firm yet reassuring. “We can find a new way. You don’t have to carry this burden alone.”

The shadows seem to recede slightly as your words sink in, and the scientist takes a deep breath, the tension easing from his shoulders. “You really believe we can find another way?”

“I do,” you reply, determination shining through. “But we have to leave now. We can figure it out on the way—just promise me you’ll trust me.”

He hesitates, then nods slowly, resignation mixing with newfound resolve. “Okay. Let’s go. But I won’t give up on finding a way to fix this. I owe it to everyone..”

With that, you turn, leading him toward the path of escape, hearts racing as the shadows linger behind you, a reminder of the chaos you’re both determined to leave behind.

[[Follow the Direction You Came From]] — You decide to retrace your steps, hoping to find a way back to the chamber with the portal.
[[Search for a Hidden Passage ]]— You look for any secret exits or hidden routes in the shadows, hoping to discover an alternative way out.
[[Ask the Scientist for His Insight]] — You turn to the scientist, asking if he remembers any other routes or options for escape that might help you.</tw-passagedata><tw-passagedata pid="40" name="Offer to Help Him Find a Solution Together" tags="" position="1000,900" size="100,100">

[[Agree to Help Him Confront the Entity-&gt;Ask the Scientist for a Plan]] — You nod, ready to support him in this mission, understanding the stakes.
</tw-passagedata><tw-passagedata pid="41" name="Insist on Leaving Now" tags="" position="800,1000" size="100,100">You stand firm, urgency in your voice. “We have to go now! There’s no time to waste. If you hesitate, we’ll both be trapped here!”

The scientist’s expression falters as he glances back at the shadows creeping closer. “I understand your concern, but I can’t just abandon my responsibility! What if we leave and it only gets worse?”

You shake your head, frustration rising. “Staying here won’t help anyone! We can figure out the next steps after we’re safe. Please, just trust me!”

He seems torn, caught between his sense of duty and the escalating danger surrounding you both. The shadows pulse ominously, almost as if they’re aware of his indecision. “But what if I lose my chance to make things right?” he says, his voice trembling slightly. “What if this is my only opportunity to contain the entity?”

The shadows flicker, inching closer as if feeding off his uncertainty. You can see the internal struggle playing out in his eyes, the weight of responsibility pressing down on him. “I’ve already made so many mistakes. If I turn my back on this… what kind of scientist would that make me?”

“Right now, being a scientist doesn’t matter if we’re both consumed by the entity!” you plead, stepping closer. “You can’t fix this alone. It’s too dangerous, and we’re out of time. Please, we need to leave together!”

His gaze flickers between the encroaching darkness and your earnest expression. “I want to trust you, I really do,” he admits, doubt still lingering in his eyes. “But what if we leave and it all spirals out of control? I can’t just run away from my mistakes.”

[[Ask the Scientist for a Plan]]  the Scientist for a Plan — You seek clarity from him, wanting to understand how you can escape this nightmare together.
[[Reassure Him of the Importance of Escape]] —  You emphasize that escaping is the priority, and you can find another way to confront the entity later.</tw-passagedata><tw-passagedata pid="42" name="Follow the Direction You Came From" tags="" position="700,1300" size="100,100">Determined, you lead the way back, hoping to retrace your steps to the chamber with the portal. However, as you move through the ever-changing landscape, confusion begins to set in. The once-familiar passage twists and contorts, the shadows shifting in ways that disorient you.

“Wait, I think we came this way,” you say, glancing back at the scientist. But the path seems entirely different now, and the echoes of your footsteps grow eerie in the thick silence.

The landscape morphs around you, darkened walls closing in and the distant whispers growing louder, almost mocking your attempts to find your way back. Panic bubbles up as you realize you can no longer discern the direction you came from.

You turn to the scientist, urgency in your voice. “What do we do now? This place is a maze!”

He looks around, his brow furrowing in concentration. “This realm… it shifts constantly. It’s designed to confuse and trap anyone who enters. The paths change, and landmarks can vanish or appear in an instant.”

You feel a chill run down your spine as his words sink in. “So, you’re saying we can’t rely on our memories of the way we came?” you ask, your heart racing.

“Exactly,” he replies, his voice low. “We need to find something stable—an anchor point—to guide us. There must be a way to navigate this chaos.”

He glances at you, a hint of something like nostalgia in his eyes. “I realize this must all be new to you,” he says, his voice tinged with a bittersweet note. “But there are threads of connection in this chaos. I wish I could explain everything, but it’s complicated.”

You can see that he’s grappling with memories that seem to weigh heavily on him, memories that you can’t grasp. “Just tell me what you know,” you urge, trying to pierce through the fog of uncertainty.
With that realization, you both scan the environment for anything that might help. The shadows around you seem to pulse and whisper, urging you to take action.

[[Search for a Hidden Passage ]]  for a Hidden Passage — You decide to look for any secret exits or hidden routes in the shadows, hoping to find something stable.
[[Look for an Anchor Point]] — You search for any significant relics or markings that might serve as a guide in this shifting landscape.</tw-passagedata><tw-passagedata pid="43" name="Search for a Hidden Passage " tags="" position="1025,1325" size="100,100">You scan the shifting shadows around you, determined to find a way out. “There has to be another route here,” you say, your voice steadying your racing heart. The scientist nods in agreement, his gaze darting nervously as the darkness seems to pulse around you.

Moving cautiously, you press against the cold walls, searching for any irregularities or hidden crevices. The whispers grow louder, a mix of urgency and fear, as if urging you to look closer. You run your fingers along the edges of the shadows, feeling for any sign of an escape.

Suddenly, you spot a faint outline of a doorway partially concealed by darkness, almost blending into the chaotic landscape. “Over there!” you point, excitement bubbling up as you rush toward it. The scientist follows closely behind, his expression shifting to one of hope.

As you reach the doorway, you pull it open, revealing a narrow passageway bathed in a faint, eerie light. A rush of cool air escapes from within, and you can feel a sense of potential safety beyond.

“Let’s go!” you say, stepping into the passage. The scientist hesitates for a moment, looking back at the swirling chaos behind you.

[[Enter the Passageway]] — You step inside, eager to see where this new route leads.
[[Check for Traps or Dangers First]] — You cautiously inspect the passageway for any signs of danger before proceeding.</tw-passagedata><tw-passagedata pid="44" name="Ask the Scientist for His Insight" tags="" position="1100,1100" size="100,100">You turn to the scientist, urgency in your voice. “Do you remember any other routes or options for escape? We need to get out of here as quickly as possible.”

He hesitates for a moment, then his expression shifts, revealing the weight of his thoughts. “There’s something I need to explain. The entity controlling this realm isn’t just a threat to us—it’s a threat to everything. If we don’t stop it now, it could spill into other dimensions, causing chaos and destruction far beyond this place.”

A chill runs down your spine. “So, you’re saying we need to confront it?”

“Yes,” he replies, his voice steadying with resolve. “We can’t just escape. We have to defeat it here and now. If we can disrupt its power source—the anchor points we talked about—it might weaken the entity and give us a fighting chance.”

The shadows around you seem to pulse in response to his words, as if they sense the determination building between you. “But how do we find these anchor points?” you ask, your mind racing with possibilities. “Do you have any idea where they might be located?”

He nods, his expression growing more focused. “I’ve identified several potential locations from my research, but we’ll need to be cautious. Each anchor point is guarded by the entity’s minions, manifestations of its power. If we can reach them and disrupt their energy, we could weaken the entity significantly.”

The realization hits you like a surge of adrenaline. “So, it’s a fight, then. We’re going to have to face whatever horrors it’s created to protect those points.”

“Exactly,” he says, his voice tinged with both fear and determination. “But if we work together, we can do this. I know how to navigate this realm, and with your strength and quick thinking, we can take them by surprise.”
The shadows around you seem to pulse in response to his words, almost as if they sense the determination building between you.

[[Agree to Help Him Confront the Entity-&gt;Ask the Scientist for a Plan]] — You nod, ready to support him in this mission, understanding the stakes.

[[Ask Him for More Details About the Entity]] — You want to know more about what you’re up against before making a decision.</tw-passagedata><tw-passagedata pid="45" name="Enter the Passageway" tags="" position="900,1500" size="100,100">As you prepare to step into the passageway, the scientist places a hand on your arm. “Hold on a moment,” he says, his voice low but urgent. “It’s wise to check for any traps or dangers first. Many of these passages can play tricks on those who aren’t careful. Let’s just say, I’ve had some unfortunate experiences.” He rubs his arm awkwardly, as if recalling a particularly uncomfortable memory.

His serious expression hints at the gravity of the situation, and you understand the need for caution in this unpredictable realm. Nodding in agreement, you both approach the entrance of the passageway, peering into the dim light that flickers within.

[[Proceed with Caution]] — You decide to enter the passage slowly, watching for any changes.
[[Look for a Way to Disable Any Possible Trap]] — You search for a way to ensure the passage is safe before entering.
[[Decide Against the Passage]] — You decide it’s better not to risk entering the passage and look for another way out instead.</tw-passagedata><tw-passagedata pid="46" name="Check for Traps or Dangers First" tags="" position="1125,1500" size="100,100">You nod at the scientist, your instinct telling you caution is key. “Let’s check for traps or dangers first,” you suggest, moving carefully toward the passageway.

You crouch down to inspect the floor, running your fingers over the surface, feeling for any irregularities. The cool metal is smooth, but your eyes catch a glimmer of something shiny just beyond the threshold. You lean in closer, scanning for any mechanisms or hidden traps.

The scientist watches intently, clearly relieved that you took this precaution. “I’ve seen these passages trick the unwary before,” he murmurs, rubbing his arm slightly, a hint of unease in his demeanor. “I’m glad you’re being careful.”

After a thorough examination, you notice a faint outline along the edges of the entrance—possibly a hidden threshold mechanism. You also hear a soft clicking noise, barely perceptible, as if something is just waiting to be triggered.

“This might be a trap,” you warn, straightening up. “We should proceed carefully.”

[[Proceed with Caution]] — You decide to enter the passage slowly, watching for any changes.
[[Look for a Way to Disable Any Possible Trap]] — You search for a way to ensure the passage is safe before entering.
[[Decide Against the Passage]] — You decide it’s better not to risk entering the passage and look for another way out instead.</tw-passagedata><tw-passagedata pid="47" name="Look for an Anchor Point" tags="" position="200,1600" size="100,100">Determined to find something stable amidst the chaos, you begin to examine your surroundings closely. “Let’s look for anything that might stand out—something that can guide us,” you say, your voice steady despite the growing unease.

The scientist nods, and together you scan the dimly lit landscape for any relics or markings that could provide a sense of direction. As you move deeper into the shadows, you spot a large, ornate symbol carved into the wall. It glows faintly, pulsating in a rhythmic pattern.

“Over here!” you call, pointing to the symbol. The scientist approaches, his expression shifting as he studies it. “This… it’s a sigil I added to the factory after realizing the entity’s betrayal. I thought it could help contain its influence and stabilize the environment around it.”

He brushes his fingers against the symbol, astonished. “I never thought I’d see one of these functioning outside our home dimension. It’s designed to create a safe zone by counteracting the chaos. In this place, things can get… a bit strange. Reality shifts and bends, making the familiar feel foreign, and the shadows can play tricks on the mind. This sigil could be our best chance to regain some control.”

You touch the symbol, feeling a surge of energy pulse through your fingertips. As you concentrate on it, the whispers around you quiet down, and the landscape appears to stabilize momentarily, the chaos ebbing away just enough for you to see a clearer path ahead.

“This might be our way out,” he says, his voice filled with a mix of hope and determination. “If we can follow the path indicated by the sigil, we might find a way back to safety.”

[[Attempt to Activate the Sigils]] — You decide to focus your energy on the symbols, hoping to awaken their dormant power.
[[Search the Area Around the Sigil]] — You want to look for additional clues or artifacts nearby that might further aid your escape.</tw-passagedata><tw-passagedata pid="48" name="Search the Area Around the Sigil" tags="" position="200,1700" size="100,100">You decide to investigate the area surrounding the sigil, hoping to find additional clues or artifacts that could aid your escape. As you move cautiously, you notice more markings etched into the walls, similar to the sigil’s design. They seem to resonate with energy, pulsing softly in the dim light.

The scientist&#39;s eyes widen as he examines the markings. “These… they’re part of the foundational architecture I used when creating the factory. Each one serves a different purpose—some stabilize energy, while others control the flow of the environment. I can’t believe they’re still intact here!”

He brushes his fingers over one of the symbols, a look of excitement on his face. “If we can activate these, we might be able to harness their power to further stabilize this realm and navigate our way through it. It’s risky, but it could work!”

You nod, feeling the weight of the decision ahead. The markings flicker as if urging you to choose wisely. The atmosphere is charged with possibility, and you sense that the knowledge the scientist holds could be crucial for your survival.

[[Attempt to Activate the Sigils]] — You decide to focus your energy on the symbols, hoping to awaken their dormant power.
[[Discuss the Sigils with the Scientist]] — You turn to the scientist, eager to hear more about how these sigils function and if there’s a specific way to activate them.
[[Look for More Sigils in the Area ]]— You choose to search the surrounding landscape for additional anchor points or symbols, thinking more might enhance your chances of stabilizing your path.
</tw-passagedata><tw-passagedata pid="49" name="Proceed with Caution" tags="" position="900,1600" size="100,100">You take a deep breath and step toward the passageway, feeling a mix of excitement and trepidation.

The scientist suddenly puts a hand on your arm, concern flashing in his eyes. “Wait! Are you sure we should just go in? We haven’t checked for traps thoroughly yet. There could be hidden dangers we’re not seeing.”

His voice is steady but tinged with urgency. “I’ve learned the hard way that rushing into unknown places can have dire consequences. It might be wiser to take a bit more time to inspect this area before committing.”

You can sense the sincerity in his plea, the weight of his past experiences coloring his caution. The shifting shadows seem to react to his words, swirling restlessly around you both.
[[Reassure Him and Proceed Anyway]] — You tell him that you feel confident enough to go ahead, trusting your instincts.
[[Heed His Warning and Check More Thoroughly]] — You decide to take a step back and conduct a more comprehensive search for traps.
[[Decide Against the Passage]] — You decide it’s better not to risk entering the passage and look for another way out instead.</tw-passagedata><tw-passagedata pid="50" name="Look for a Way to Disable Any Possible Trap" tags="" position="1000,1600" size="100,100">Recognizing the sheer number of traps scattered throughout the entrance, you nod resolutely. “There are too many traps here to disable safely. It’s not worth the risk.”

The scientist looks relieved, his tension easing slightly. “Exactly. We need to be smart about this.”

You both step back, taking in the passageway now blocked by an impenetrable barrier. It seems the realm is pushing back against your approach, challenging your resolve.

“Let’s search the surrounding area for another way,” you suggest. The scientist agrees, and you start scanning the landscape for any other possible routes or signs of anchor points that might help stabilize this chaotic dimension.

As you move further away from the blocked passage, you notice a glimmering light in the distance, beckoning you with a strange allure.

[[Look for Other Paths-&gt;Decide Against the Passage]] — You focus on finding a different route, avoiding any potential pitfalls.
</tw-passagedata><tw-passagedata pid="51" name="Reassure Him and Proceed Anyway" tags="Ending" position="1100,1700" size="100,100">You take a deep breath and turn to the scientist, determination igniting your resolve. “I appreciate your concern, but I feel confident enough to go ahead. We can’t let fear hold us back.”

His expression softens momentarily, but the flicker of doubt in his eyes remains, a warning you choose to ignore. With a surge of adrenaline, you step into the passage, your heart racing with a mix of excitement and dread.

As you move deeper inside, the air grows heavier, thick with an oppressive energy that clings to your skin like a suffocating shroud. The shadows pulse and ripple, closing in around you like a living entity, whispering dark promises in a language that slithers into your mind, sowing seeds of doubt. Suddenly, you hear a sinister click beneath your foot, and before you can react, the ground gives way, plunging you into a yawning chasm of inky blackness.

The sensation of falling is disorienting, a twisting spiral that seems to stretch on forever. The darkness wraps around you, squeezing the breath from your lungs, and the temperature drops, sending icy tendrils creeping across your skin. The last thing you hear is the scientist&#39;s desperate scream echoing through the passage, a haunting sound filled with panic and concern.

“NO! Not again! I just got you back!” he shouts, his voice ricocheting off the walls, but it’s swallowed by the abyss, leaving only a deafening silence in its wake.

As you plummet, the shadows twist and writhe around you, forming grotesque shapes that leer and mock. Their laughter rises, a chilling symphony of despair that reverberates through the void, clawing at your sanity. In those final moments, a cold grip wraps around your heart, the fear of the unknown paralyzing you as the darkness engulfs you, pulling you deeper into its insatiable embrace.

You’re surrounded by a suffocating silence, the weight of your choice pressing heavily on your mind. Memories of the scientist’s horrified scream haunt you, echoing in your thoughts like a morbid lullaby, as everything fades away. In the chilling grip of the void, you understand that fear has not only led you here but has forged a path into a nightmare from which there may be no escape—a reminder that some choices carve scars deeper than the darkness itself.

[[Start]] </tw-passagedata><tw-passagedata pid="52" name="Decide Against the Passage" tags="" position="700,1800" size="100,100">You step back from the doorway, a sense of caution washing over you. “I think it’s too risky to go in,” you decide, glancing at the scientist.

He nods, his expression one of relief. “That’s a good call. I have a better idea of what we can look for. The symbols and structures we need to find will stabilize the realm around us. I’ve been here long enough to know that they can help us navigate this chaos safely.”

With a shared sense of purpose, you both begin scanning the shadows for any signs of these anchor points.
[[Look for Patterns in the Environment]] — You decide to examine the surroundings closely, searching for any patterns or structures that might indicate the presence of anchor points.
[[Ask the Scientist for More Details]] — You turn to him, eager to learn more about how to identify these anchor points.
[[Follow Your Instincts]] — You trust your gut feeling and choose a direction that seems promising, hoping it leads you to safety.
</tw-passagedata><tw-passagedata pid="53" name="Heed His Warning and Check More Thoroughly" tags="" position="900,1700" size="100,100">Recognizing the sheer number of traps scattered throughout the entrance, you nod resolutely. “There are too many traps here to disable safely. It’s not worth the risk.”

The scientist looks relieved, his tension easing slightly. “Exactly. We need to be smart about this.”

You both step back, taking in the passageway now blocked by an impenetrable barrier. It seems the realm is pushing back against your approach, challenging your resolve.

“Let’s search the surrounding area for another way,” you suggest. The scientist agrees, and you start scanning the landscape for any other possible routes or signs of anchor points that might help stabilize this chaotic dimension.

As you move further away from the blocked passage, you notice a glimmering light in the distance, beckoning you with a strange allure.

[[Look for Other Paths-&gt;Decide Against the Passage]] — You focus on finding a different route, avoiding any potential pitfalls.
</tw-passagedata><tw-passagedata pid="54" name="Look for Patterns in the Environment" tags="" position="500,1900" size="100,100">You focus on your surroundings, scanning the chaotic landscape for any signs of the anchor points the scientist described. You pay close attention to the flickering shadows and the eerie whispers that seem to carry hints of the realm’s secrets.

As you move, you notice subtle changes in the environment. One area appears slightly brighter than the rest, with a shimmering quality to the air, almost as if the fabric of reality is less dense there. You approach cautiously, heart racing with anticipation.

“Over here,” you call to the scientist, pointing to the glowing patch. He joins you, his eyes wide with interest. “This might be one of the anchor points!”

You both step closer, and as you do, the energy in the air intensifies, wrapping around you like a warm embrace. Symbols begin to shimmer faintly along the ground, their shapes intricate and beautiful, resembling ancient runes intertwined with flowing designs.

“This is incredible!” the scientist exclaims, his voice filled with awe. “These symbols are definitely connected to the stabilization of this realm. We should investigate further.”

As you kneel to examine the shimmering symbols, a sense of familiarity washes over you. These are the same intricate sigils the scientist used to stabilize the factory in your home dimension. You trace the patterns with your fingers, recognizing the delicate curves and angles that echo the design of the machinery you encountered.

“This is remarkable,” you say, glancing up at the scientist. “These sigils are just like the ones you placed around the factory.”

He nods, excitement glimmering in his eyes. “Exactly! They’re designed to create pockets of stability within chaotic environments. If we can activate them, it might help us navigate through this realm more safely.”

You feel a surge of determination. If these symbols have the potential to guide you, then finding a way to activate them could be crucial for your survival.

[[Attempt to Activate the Sigils]] — You decide to focus your energy on the symbols, hoping to awaken their dormant power.
[[Discuss the Sigils with the Scientist]] — You turn to the scientist, eager to hear more about how these sigils function and if there’s a specific way to activate them.
[[Look for More Sigils in the Area ]]— You choose to search the surrounding landscape for additional anchor points or symbols, thinking more might enhance your chances of stabilizing your path.
</tw-passagedata><tw-passagedata pid="55" name="Ask the Scientist for More Details" tags="" position="500,1700" size="100,100">You turn to the scientist, excitement bubbling up as you ask, “Can you tell me more about these anchor points? How do we identify them?”

He brightens at the opportunity to discuss his research, his previous worries momentarily forgotten. “Of course! Anchor points are often marked by specific symbols or formations. I’ve found a wide variety of types during my time here. Some resemble ancient runes, while others might be natural formations that resonate with the energy of this realm.”

He pauses, glancing around as if searching for examples. “They tend to have a certain energy about them—like a pulse that resonates with the surrounding chaos. You might notice subtle changes in the environment, such as a shift in the air pressure or a glow in the darkness.”

His enthusiasm is infectious, and you find yourself more eager to explore. “So, we’ll need to keep our eyes peeled for anything unusual?”

“Exactly!” he replies, nodding vigorously. “And if we’re lucky, we might find one nearby.”

[[Look for Patterns in the Environment]] — You decide to examine the surroundings closely, searching for any patterns or structures that might indicate the presence of anchor points.
[[Follow Your Instincts]] — You trust your gut feeling and choose a direction that seems promising, hoping it leads you to safety.</tw-passagedata><tw-passagedata pid="56" name="Follow Your Instincts" tags="" position="700,2000" size="100,100">Trusting your instincts, you step forward, your senses heightened as you navigate through the swirling shadows. The air feels charged, as if the landscape is alive and responsive to your presence.

You tread carefully, following a faint, rhythmic pulse in the ground beneath your feet. The path seems to draw you in, leading you to a series of jagged rocks that rise like sentinels from the chaos. As you approach, you notice that some of the rocks are covered in faint, glowing sigils—the same kind the scientist described.

“Look!” you call back to the scientist, pointing at the symbols. “These might be the anchor points we need!”

He joins you, his eyes widening with recognition. “Yes! If we can decipher their meaning, we might be able to stabilize this area and find more anchor points.”

[[Attempt to Activate the Sigils]] — You decide to focus your energy on the sigils, hoping to awaken their dormant power.
[[Discuss the Sigils with the Scientist]] — You turn to the scientist, eager to hear more about how these sigils function and if there’s a specific way to activate them.
[[Look for More Sigils in the Area ]]— You choose to search the surrounding landscape for additional anchor points or symbols, thinking more might enhance your chances of stabilizing your path.</tw-passagedata><tw-passagedata pid="57" name="Attempt to Activate the Sigils" tags="" position="500,2200" size="100,100">As you concentrate, you imagine your energy merging with the sigil’s glow, pouring all your intention into the connection. But nothing happens. The glow remains faint, and the sigil feels cold under your fingertips. Frustration bubbles up within you, and you pull away, glancing at the scientist, who watches with a mix of concern and encouragement.

The scientist observes your attempt and nods knowingly. “It can be tricky,” he explains. “To activate the sigil, you need to attune yourself to its energy. Start by centering your thoughts—clear your mind of distractions. Then, visualize the sigil’s design, feeling the energy it emanates.”

He continues, his tone encouraging. “Next, imagine your energy merging with the sigil’s glow. It’s about forming a connection; you need to resonate with it. Sometimes, intent can help focus your energy as well.”

His eyes gleam with enthusiasm as he adds, “I know you can do this. You have the strength within you to connect with it. Just trust yourself.”

With his words ringing in your ears, you feel a renewed sense of determination. You contemplate your next move, the shadows around you seemingly holding their breath in anticipation.

[[Ask the Scientist for More Clarification]] — You seek further details or examples to ensure you fully understand how to harmonize your energy with the sigils.</tw-passagedata><tw-passagedata pid="58" name="Discuss the Sigils with the Scientist" tags="" position="600,2100" size="100,100">YYou turn to the scientist, eager to hear more about how these sigils function. “Can you explain how we might activate them? Is there a specific method we should use?”

He steps closer, his enthusiasm palpable. “Each sigil has its own unique properties, but they all respond to the energy of the environment and our own intentions. To activate them, we need to channel our energy in a way that resonates with their design.”

He gestures to the nearest symbol. “By focusing on its shape and purpose, we can create a connection. The more we understand about each sigil, the more effectively we can harness their power. I primarily used the barrier sigils around the factory, which helped protect it from the entity’s influence.”

[[Look for More Sigils in the Area ]]— You choose to search the surrounding landscape for additional anchor points or symbols, thinking more might enhance your chances of stabilizing your path.

[[Attempt to Activate the Sigils]] — You decide to focus your energy on the symbols, hoping to awaken their dormant power.</tw-passagedata><tw-passagedata pid="59" name="Look for More Sigils in the Area " tags="" position="300,2000" size="100,100">You suggest continuing the search for additional symbols, believing that the more you find, the greater your chances of success. However, the scientist shakes his head firmly, his voice laced with apprehension. “I understand your reasoning, but we might not find any more sigils. If we leave this group and can’t locate it again, we’ll lose our chance to stabilize our path.”

He glances around, worry etching deeper lines on his face. “Let’s focus on these sigils for now. Activating them could provide the guidance we need, and it’s safer to work with what we have rather than risk wandering off in search of more.” His hands fidget slightly, betraying his nervousness as he looks back at the symbol, as if it holds the key to your escape.

You nod, recognizing the weight of his experience and the feel of the chaotic energy swirling around you. His caution seems justified, and you can feel the tension in the air, amplifying the urgency of the moment.
[[Attempt to Activate the Sigils]]  to Activate the Sigils — You decide to focus your energy on the shimmering symbols, eager to see if you can awaken their power.
</tw-passagedata><tw-passagedata pid="60" name="Attempt to Activate the Sigils Again" tags="" position="700,2400" size="100,100">You take a deep breath, grounding yourself as you focus on the nearest sigil. Remembering the scientist’s advice, you clear your mind, letting go of any distractions. You visualize the intricate design of the sigil, its glowing patterns pulsing gently in the dim light.

As you concentrate, you feel a subtle shift in the air around you, a slight hum that seems to resonate with your presence. You imagine your energy flowing toward the sigil, merging with its glow. This time, instead of forcing it, you gently guide your energy, letting it intertwine with the sigil&#39;s essence.

To your delight, the sigil begins to respond. The light intensifies, swirling around the intricate patterns, and suddenly, a warm pulse of energy radiates from it, enveloping you in a comforting embrace. The chaotic whispers in the air quiet, replaced by a harmonious resonance.

The scientist watches in awe, a broad smile spreading across his face. “You did it! The sigil is activated!” He steps closer, clearly impressed. “Now, let’s see what it can do.”

As the sigil stabilizes, a glowing pathway forms in front of you, illuminating the way forward. The air feels lighter, and you sense that the chaotic forces around you have diminished slightly.

[[Follow the Glowing Pathway]] — You decide to trust the sigil’s guidance and move forward along the illuminated path.
</tw-passagedata><tw-passagedata pid="61" name="Ask the Scientist for More Clarification" tags="" position="700,2300" size="100,100">You take a moment to gather your thoughts before asking the scientist, “Can you tell me why these sigils exist?”

He nods, excitement bubbling in his voice. “Ah, the sigils! They’re absolutely fascinating! They function as foundational elements in maintaining stability across chaotic dimensions. Think of them as stabilizers in a turbulent sea—each sigil has its own unique properties that help to mitigate the unpredictable energies swirling around us.”

His eyes light up as he continues, “Depending on their design and the specific activation method, these sigils can fulfill countless functions! Some might create protective barriers, while others can amplify energy or even guide us through the maze-like landscape. Each one plays a critical role in counteracting the chaos and re-establishing order!”

He glances at the glowing sigil, a hint of relief washing over his face. “Fortunately, in this set, we’re in luck! There’s only one main sigil we need to activate for stabilization. It simplifies our task considerably, as we can focus our energy on this single point rather than worrying about multiple sigils.”

You absorb this information, feeling a mix of hope and urgency. “So if we can activate this sigil, we could find a way out?”

Turning to the scientist, you’re eager to learn how to channel your energy effectively. “Can you guide me on the best way to focus my energy for activating the sigils?”

He nods, his eyes lighting up with enthusiasm. “Of course! First, it’s important to find a sense of calm. The energy in this realm can be erratic, so we need to center ourselves. Close your eyes for a moment and take a few deep breaths.”

Following his advice, you close your eyes and inhale deeply, allowing the chaotic energy around you to fade into the background. You feel a growing sense of focus as you exhale slowly.

“Now, visualize your energy as a stream of light,” he continues. “Picture it flowing through you and outwards, connecting with the sigil. You want to match the rhythm of its energy; feel its pulse and align your intent with it. It’s about harmony, not force.”

You open your eyes, feeling more prepared. “I think I understand,” you say, a renewed determination surging within you.
[[Attempt to Activate the Sigils-&gt;Attempt to Activate the Sigils Again]] — With the scientist’s advice in mind, you decide to try activating the sigils once more.</tw-passagedata><tw-passagedata pid="62" name="Follow the Glowing Pathway" tags="" position="700,2525" size="100,100">As you follow the glowing pathway, the light casts flickering shadows along the walls, illuminating your surroundings. The scientist walks beside you, his expression a mix of excitement and curiosity.

“This pathway feels different,” he remarks, glancing at the shimmering edges. “It’s almost as if the energy is guiding us, rather than just reacting to our presence.”

You nod, feeling the warmth radiating from the path. “Do you think it could lead us to a way out of this realm?”

He looks ahead, a thoughtful expression crossing his face. “It’s possible. This place is unpredictable, but there’s a chance it might take us somewhere stable.”

After a few moments of walking, you notice a faint light ahead. As you approach, the glow intensifies, revealing a large archway framed by intricate designs that pulse with energy.

“This must be it!” you exclaim, stepping closer. The air hums with power, and you can feel a magnetic pull drawing you toward the archway.

The scientist’s eyes widen with wonder. “It looks like a portal! We may finally have a way back.”

With a shared sense of urgency, you both stand before the portal, the energy swirling around you, ready to take the next step.

[[Enter the Portal Together]]— You decide to step through the archway, eager to see where it leads. [[Pause and Discuss Next Steps]] — You take a moment to discuss with the scientist what to expect before entering.</tw-passagedata><tw-passagedata pid="63" name="Pause and Discuss Next Steps" tags="" position="800,2700" size="100,100">You pause before the portal, a mix of excitement and caution bubbling within you. “What do you think we should expect once we enter?” you ask the scientist, glancing at the shimmering archway.

He steps closer, studying the energy radiating from the portal. “It’s hard to say. Portals can lead to many places—some familiar, others completely alien. We need to be prepared for anything. This realm has a way of twisting expectations.”

You nod, taking a deep breath to steady your nerves. “Should we have a plan once we get through? Like a destination or a way to regroup?”

“Definitely,” he replies, his brow furrowing in concentration. “If we can identify any anchor points or familiar structures on the other side, we might stand a better chance of stabilizing our situation. Let’s agree to stick together and assess our surroundings immediately.”

With a reassuring smile, you feel a sense of determination. “Alright, let’s do this together.”

Together, you take a step closer to the glowing portal, feeling the energy pulse around you, ready to embrace whatever lies beyond.

[[Enter the Portal Together]] — You both step through the archway, prepared for whatever awaits you. [[Double-Check for Readiness]] — You take one last moment to ensure you’re both fully prepared before entering.</tw-passagedata><tw-passagedata pid="64" name="Enter the Portal Together" tags="" position="700,2800" size="100,100">You take a moment to assess your supplies and mental readiness before stepping through the portal. “Let’s make sure we have everything we need,” you say, scanning your belongings. The scientist nods, checking his equipment and ensuring he has his notes.

“Good thinking,” he replies, adjusting his pack. “We should also mentally prepare ourselves. Whatever we encounter could challenge our expectations.”

You both take a deep breath, grounding yourselves in the present moment. “Okay, I feel ready,” you say, looking at him with determination.

“Me too,” he responds, a spark of excitement in his eyes. “Let’s stick to our plan and remain alert once we get through.”

With a final nod of agreement, you step toward the portal, feeling the energy thrumming around you. Together, you move forward, hands steadying as you approach the shimmering archway.

Finally, you both step through the portal, a rush of light enveloping you as you’re pulled into the unknown.
The sights and sounds of the factory envelop you, bringing a sense of relief and safety. The scientist stands beside you, his eyes wide with astonishment as he takes in the surroundings.

“This place… it’s incredible,” he breathes, almost in disbelief. “I didn’t expect to find it intact after everything that’s happened.”

You nod, feeling a mix of pride and concern. “Now we need to shut down the portal,” you say firmly, your gaze shifting to the swirling energy at its center. “We can’t risk it being used again.”

The scientist’s expression changes, a look of seriousness overtaking his astonishment. “Yes, without proper safeguards, it could be catastrophic. We need to ensure it’s closed for good.”

As you both move deeper into the factory, the reality of your mission settles in. The chaotic forces you encountered in the realm are now a stark reminder of what’s at stake.
[[Discuss things with the scientist ]] </tw-passagedata><tw-passagedata pid="65" name="Double-Check for Readiness" tags="" position="900,2800" size="100,100">You take a moment to assess your supplies and mental readiness before stepping through the portal. “Let’s make sure we have everything we need,” you say, scanning your belongings. The scientist nods, checking his equipment and ensuring he has his notes.

“Good thinking,” he replies, adjusting his pack. “We should also mentally prepare ourselves. Whatever we encounter could challenge our expectations.”

You both take a deep breath, grounding yourselves in the present moment. “Okay, I feel ready,” you say, looking at him with determination.

“Me too,” he responds, a spark of excitement in his eyes. “Let’s stick to our plan and remain alert once we get through.”

With a final nod of agreement, you step toward the portal, feeling the energy thrumming around you. Together, you move forward, hands steadying as you approach the shimmering archway.

Finally, you both step through the portal, a rush of light enveloping you as you’re pulled into the unknown.
The sights and sounds of the factory envelop you, bringing a sense of relief and safety. The scientist stands beside you, his eyes wide with astonishment as he takes in the surroundings.

“This place… it’s incredible,” he breathes, almost in disbelief. “I didn’t expect to find it intact after everything that’s happened.”

You nod, feeling a mix of pride and concern. “Now we need to shut down the portal,” you say firmly, your gaze shifting to the swirling energy at its center. “We can’t risk it being used again.”

The scientist’s expression changes, a look of seriousness overtaking his astonishment. “Yes, without proper safeguards, it could be catastrophic. We need to ensure it’s closed for good.”

As you both move deeper into the factory, the reality of your mission settles in. The chaotic forces you encountered in the realm are now a stark reminder of what’s at stake.
[[Discuss things with the scientist ]]
</tw-passagedata><tw-passagedata pid="66" name="Discuss things with the scientist " tags="" position="800,2900" size="100,100">You turn to the scientist, wanting to get his thoughts before moving forward. “What’s our best course of action? Do you have any insight on how we can shut down the portal effectively?”

The scientist, still in awe of the factory but now focused on the task at hand, takes a deep breath. “This portal… it should never have been built in the first place,” he mutters, shaking his head. “It connects to realms that aren’t meant to interact with our dimension. We’re dealing with something far beyond the original scope of my designs.”

He pauses, clearly thinking through your options. “The first thing we need to do is find the primary control room. If I can access the main systems, I might be able to shut it down from there. But… I suspect it won’t be that simple. The portal’s energy signatures have likely caused damage or distortions in the factory itself.”

You raise an eyebrow. “What kind of distortions?”

“Unpredictable fluctuations. Areas of the factory may have shifted or been corrupted by the portal’s influence. We’ll have to be cautious as we move forward, but I’m confident that the systems I built originally will still be in place—if we can reach them.”

You nod, taking in his assessment. “And if we can’t?”

“If we can’t access the control room, we may need to disable the portal manually—essentially cutting off its power source,” the scientist adds, his voice grave. “But doing so could be risky. It might cause a collapse of the surrounding structure or worse.”

The gravity of the situation sinks in further. Shutting down the portal is the only way forward, but the dangers are very real.
[[Search for the Control Room]] — You decide to follow the scientist’s plan and find the control room, where the portal systems can hopefully be disabled.
[[Explore the Factory for a Power Source]] — You consider the option of cutting off the portal’s power directly and decide to search the factory for a potential energy source.</tw-passagedata><tw-passagedata pid="67" name="Search for the Control Room" tags="" position="800,3100" size="100,100">You nod in agreement. &quot;Let&#39;s head to the control room, then. If we can shut it down from there, it&#39;s our best bet.&quot;

The scientist gives a resolute nod. “Follow me. The control room should be deep within the factory. We’ll need to pass through several sectors, but if the systems are intact, I should be able to navigate us there.”

As the two of you proceed through the factory’s corridors, the air feels different, thick with an unnatural energy—likely the result of the portal’s influence. The once orderly structure of the factory now seems slightly distorted, as if some sections had been warped or shifted.

The scientist occasionally mutters under his breath, examining certain areas with concern. “The dimensional interference is worse than I expected,” he says, his voice tense. “We need to move quickly before things destabilize any further.”

Eventually, you reach a large, rusted door at the end of a long hallway. The scientist hesitates before opening it, taking a deep breath. “This should lead us directly into the control room. But be prepared—there’s no telling what we might encounter.”

With a heavy creak, the door swings open, revealing a vast, dark chamber filled with towering machinery. Consoles line the walls, many of them still flickering with faint lights. The hum of dormant systems fills the air, but something feels wrong—like a presence lurking just out of sight.

“Let’s see if the systems are still operational,” the scientist says, hurrying over to one of the consoles. He begins tapping rapidly on the interface, his brow furrowed in concentration. “If I can re-establish the connection, we should be able to initiate the shutdown process.”

Suddenly, a low, menacing rumble shakes the room, and the flickering lights intensify, casting long shadows across the walls.

“Something’s reacting to the portal,” the scientist mutters. “We need to act fast.”

[[Help the Scientist Work the Console]] — You decide to assist the scientist, working together to restore control to the systems.
[[Investigate the Room for Danger]] — Feeling uneasy, you begin scanning the room for any signs of what caused the rumble or potential threats.</tw-passagedata><tw-passagedata pid="68" name="Explore the Factory for a Power Source" tags="" position="1400,3300" size="100,100">You consider the risks associated with accessing the control room and decide that finding a power source might be the more straightforward option. “Let’s search the factory for a way to cut off the portal’s power directly,” you suggest.

The scientist looks at you, concern etched on his face. “That could be dangerous. If we’re not careful, we might trigger a collapse or other unpredictable consequences.”

“I understand the risks,” you reply firmly. “But if we can find the source, we can shut it down without having to navigate any damaged systems.”

With a reluctant nod, the scientist agrees, though his expression remains grave. Together, you make your way deeper into the factory, the air thick with tension. You pass through dimly lit corridors, the hum of machinery echoing in the background, and the atmosphere feels increasingly unstable.

After a while, you come across a large chamber filled with intricate machinery, pulsating with energy. The walls are lined with power conduits that seem to pulse with a faint glow.

“This must be it,” you say, stepping closer to examine the machinery. “If we can identify the main power source, we might be able to disable it.”

The scientist scans the room, his brow furrowed. “We need to be cautious. If we disrupt the wrong component, it could trigger a chain reaction.”

You approach the central console, trying to decipher the controls. “Can you help me figure out which part to disable?”

He nods, stepping beside you as you both examine the complex array of switches and dials. After a few tense moments, he points to a large, glowing core at the center of the machinery. “That’s likely the main energy source. If we can shut it down without causing a surge, we might succeed.”

You take a deep breath, feeling the weight of the decision.

[[Attempt to Shut Down the Energy Core]] — You decide to focus on disabling the energy core directly, following the scientist&#39;s guidance.

[[Look for a Backup Power Source]] — You suggest checking for any backup systems first, thinking it might be safer to disable those before tackling the main source.</tw-passagedata><tw-passagedata pid="69" name="Help the Scientist Work the Console" tags="" position="800,3300" size="100,100">You hurry over to where he’s standing at the console, a series of panels open in front of him. His fingers fly over the controls, but there’s clear frustration on his face. “The system’s more damaged than I thought. I need you to hold this override key while I manually route the power. It’ll keep the control link stable for long enough to start the shutdown.”

He hands you a small, glowing device that hums faintly in your palm. &quot;Hold it steady, and make sure it stays in sync with the readout here,” he says, pointing to a screen displaying a constantly shifting set of numbers and symbols. “This might be tricky.”
[[Hold the Device and Focus on Keeping it Stable]] — You focus on maintaining the stability of the override key while the scientist works.
[[Ask the Scientist What Happens if It Fails]] — You ask him about the risks if the override doesn&#39;t hold and what to expect if the system destabilizes further.</tw-passagedata><tw-passagedata pid="70" name="Investigate the Room for Danger" tags="" position="900,3200" size="100,100">
You scan the room, your eyes darting between the shadows and the towering machinery, but there’s nothing immediately visible that could have caused the rumble. The unsettling feeling lingers, but you don’t detect any clear signs of danger.

Just as you’re about to move further into the room, the scientist’s voice calls out to you, breaking your focus. “Hey! I could use an extra pair of hands here.”

His tone is urgent, and it pulls you back to the task at hand. There’s a strange sense of familiarity in the way he commands the room, yet you’re not quite sure where it comes from. You remember the way he worked with a blend of intensity and focus, but the connection feels deeper—like you’ve navigated challenges like this before.

“What do you need?” you ask, ready to dive in, the unease from moments before fading slightly in the face of action.

“Just help me stabilize this panel. We need to reroute power before the next cycle hits,” he explains, gesturing to a flickering console.

You position yourself beside him, falling into a rhythm as you work side by side. The tension in the air remains, but now it’s fueled by a sense of camaraderie as you tackle the challenge together. You can’t quite put your finger on why this feels so natural, but it drives you to give it your all.
[[Help the Scientist Work the Console]]</tw-passagedata><tw-passagedata pid="71" name="Hold the Device and Focus on Keeping it Stable" tags="" position="700,3400" size="100,100">You move the device with instinctive precision, feeling an odd sense of familiarity as you adjust its position. It’s only when you notice the scientist hasn’t had to guide you at all that you realize how seamlessly it’s all coming together. He coughs awkwardly, glancing away for a moment before continuing.

“Good. Just keep that momentum. The timing is crucial,” he explains, focusing back on his control panel.

As the portal’s energy begins to dissipate, you watch the flickering lights slow, the swirling vortex gradually unraveling until nothing remains but the faint hum of the factory’s machinery. The atmosphere feels charged with a mix of relief and lingering caution.

The portal is gone, and with it, the immediate threat of the entity crossing into your world. The scientist’s fingers fly over the controls, his concentration intense. “We’ll have to double-check the systems once we’re finished,” he adds, keeping the conversation flowing as he works.

You nod, feeling the urgency of his words. The faint hum of the machinery fills the space, and you share a moment of silent acknowledgment that the threat of the entity using the portal to cross into this dimension has been neutralized. There’s a sense of accomplishment between you, a bond formed through the chaos, and now it feels like the real work is just beginning.

[[Discuss Next Steps with the Scientist]] — Now that the portal is closed, you need to figure out the next course of action.

[[Inspect the Control Panel for Any Remaining Anomalies]] — You decide to take a closer look at the control panel, just to be certain everything is stable.</tw-passagedata><tw-passagedata pid="72" name="Ask the Scientist What Happens if It Fails" tags="" position="900,3400" size="100,100">You glance down at the glowing device in your hand, feeling the faint vibration and sensing the tension in the air. “What happens if this fails?” you ask, your voice betraying a hint of concern.

The scientist doesn’t look up from the console, but you notice the tightness in his expression. “If it fails… well, we won’t just lose control of the shutdown. The factory itself could destabilize, which might trigger a cascade failure through the entire structure.”

He pauses, finally glancing your way with a grave look. &quot;Then the portal could let the entity break through. Once it gets access, it could use the portal to spread into other dimensions. We can&#39;t let that happen. The portal was a mistake from the start, and we can&#39;t afford to leave it open.&quot;

The weight of his words sinks in, and you grip the device tighter, focusing on keeping it steady. “That would be very bad,” you murmur, the reality of the situation crystallizing in your mind.

“Still summoning your usual flair for understatement, I see,” he replies, a hint of humor cutting through the tension. You hear some of what he said, but you’re lost in the gravity of the moment. Then, realizing the situation requires urgency and hoping you didn’t catch his earlier comment, he quickly continues, “But seriously, we’re in this together. Just keep that key aligned, and we can ensure the portal stays closed for good.”

You nod, determination surging within you. You can’t afford to make any mistakes. As the machinery hums around you, it feels like the stakes have never been higher. You focus intently on your task, ready to see it through.

   [[Hold the Device and Focus on Keeping it Stable]] — You decide to concentrate fully on maintaining the stability of the override key, realizing the gravity of the situation.
 </tw-passagedata><tw-passagedata pid="73" name="Discuss Next Steps with the Scientist" tags="" position="700,3600" size="100,100">You turn to the scientist, the reality of your situation settling in. “Now that the portal is closed, what do you think our next steps should be?”

He leans against the control panel, deep in thought. “First, we need to analyze any data we collected during our journey. Understanding what we encountered could help us prevent similar situations in the future. We also need to consider how to reinforce the factory&#39;s defenses against potential threats from that realm.”

You nod, feeling a sense of urgency. “And what about the entity? We can’t be sure it won’t try to breach this dimension again.”

“Exactly,” he replies, looking serious. “We should develop a plan to monitor for any unusual activity, possibly set up additional safeguards. This experience has shown us just how unpredictable that chaos can be.”

He pauses, then adds, “We might also need to collaborate with other experts—people who understand dimensional anomalies or entities. The more knowledge we have, the better equipped we’ll be to handle any future threats.”

You consider his words, the weight of the responsibility settling on your shoulders. “Do you think we should reach out to anyone specific?”

“Yes,” he says, straightening up. “There are researchers in the field I’ve worked with before. They might have insights or technologies that could help us. We could set up a meeting to discuss our findings and develop a comprehensive strategy.”
[[Offer to help him]]
[[Go home]]</tw-passagedata><tw-passagedata pid="74" name="Inspect the Control Panel for Any Remaining Anomalies" tags="" position="800,3500" size="100,100">The scientist moves swiftly to his control panel, eyes scanning the readouts. After a few tense moments, he lets out a relieved breath. “It&#39;s confirmed—the portal is fully deactivated. Everything&#39;s stable.”

You start scanning the readouts on your end, feeling a surge of focus. “Everything looks stable on my end as well,” you say without thinking, the words flowing out as you absorb the data.

He steps back, shaking his head in disbelief. &quot;I still can’t believe we made it out of that. But at least now, the portal can’t be used to spread chaos any further.&quot;

You exchange a glance, both of you feeling the weight of what you&#39;ve just prevented, but also the relief of being back in your home dimension. The air feels lighter, and a shared understanding passes between you; you&#39;ve faced something formidable together and emerged victorious.

“Now we can focus on ensuring that it stays this way,” you say, your voice steady. The scientist nods, determination flickering in his eyes as he contemplates the work ahead.

[[Discuss Next Steps with the Scientist]] — Now that the portal is closed, you need to figure out the next course of action.</tw-passagedata><tw-passagedata pid="75" name="Offer to help him" tags="Ending" position="600,3800" size="100,100">You take a moment to collect your thoughts, then turn to the scientist with newfound determination. “Now that the portal is closed, I’ve been thinking... I want to help you. I’d like to become your assistant.”

The scientist looks taken aback, his expression shifting from surprise to genuine warmth. “Are you sure? This work can be dangerous and demanding.”

You nod firmly. “I know that, but I believe in the importance of what you’re doing. I want to learn and contribute, to help prevent what happened with the portal from ever happening again.”

He studies you for a moment, a mix of gratitude and uncertainty flickering in his eyes. “Very well. I would be honored to have you bac—uh, partner.” He stumbles over the word, almost as if he’s testing it out, and you catch the faintest blush creeping up his neck.

“Partner?” you echo, a playful smile creeping onto your lips. His cheeks flush deeper, and he fidgets with the hem of his lab coat, his gaze darting around the room as if searching for an escape from the sudden awkwardness.

Yes! As my partner! For the first time,” he reiterates, emphasizing “first” in a way that seems rather odd, leaving you to wonder if he’s trying to convince himself. Was this not the first time you had worked together?

You arch an eyebrow, a playful smirk forming on your lips. “Right, the first time. Just the first time we’re officially partners, then?”

He nods vigorously, his eyes darting around as if searching for something to latch onto. “Right! So, um, what should we do next?” The subject change is anything but graceful, and you can see him mentally scrambling for a solid idea.

“Maybe we could outline our goals?” you suggest, trying to help him find his footing.
Goals! Yes! Goals are important!” he exclaims, almost too loudly, his voice echoing off the lab walls. “Um, so, we need to ensure that... we don’t, uh, accidentally open any more portals? And maybe—” he pauses, biting his lip as he fumbles with a nearby stack of papers. “We should research more about the entity to understand what we’re really dealing with. Yes, that’s good! But, um, how about more about how it affected this dimension and, uhh... memories?” He says that last word in almost a whisper, as if the very idea frightens him.

You raise an eyebrow at his sudden shift in tone, sensing a deeper concern behind his words. “Memories? You think it’s impacting people’s memories?”

He nods vigorously, his face a mixture of worry and determination. “I mean, it makes sense, doesn’t it? If it can distort reality, what’s to say it can’t influence how we remember things? We might have lost important knowledge in the process, things we need to fix this situation!”

“Okay, so we research the effects on this dimension and the memory aspect,” you reply, trying to keep your own thoughts organized amid his frantic energy. “That sounds like a solid approach.”

“Right! Solid! Yes!” He relaxes slightly, visibly relieved that you’re on board. “I—um, I can compile a list of resources. Just give me a moment.” As he starts scribbling notes, you can’t help but smile at how endearing his nervous energy is, a strange blend of brilliance and awkwardness.
As he scribbles furiously, you find yourself lost in thought, reflecting on how comfortable it feels to be by his side. There’s a warmth in his presence, a sense of familiarity that makes the chaos around you seem a little less daunting.



[[Start]] </tw-passagedata><tw-passagedata pid="76" name="Go home" tags="" position="900,3700" size="100,100">You take a deep breath, feeling the weight of the choices ahead. “I appreciate everything you’ve done and all that I’ve learned, but I think it’s time for me to go home,” you say firmly.

The scientist’s eyes widen in surprise, and he steps forward, urgency in his voice. “Please, you’ve been invaluable. I could really use your help with analyzing the data and reinforcing the defenses. We’ve seen the chaos that can spill into our realm!”

You shake your head gently, a mix of gratitude and resolve in your heart. “I know, but I need to focus on my own life now. This experience has been incredible, but I have to go home.&quot;

He takes a step back, shadows flickering across his face, his expression darkening. “You don’t understand. This isn’t over. The entity—what we encountered—if we don’t prepare, it could return. We’re exposed now!”

A sense of foreboding washes over you, and you hesitate. But deep down, you know this isn’t your fight anymore. “I can’t be part of this. I have to think about my own life.”

His eyes search yours, desperation etched in every line of his face. “You think leaving will keep you safe? It could come after you. You’ve seen what it can do! How could you—”  He cuts himself off, swallowing hard, and you see a glimmer of tears in his eyes, threatening to spill over.

The sight tugs at your heart, and you feel a wave of guilt wash over you. You take a small step closer, your voice softening. “I’m really grateful for everything. You’ve done so much for me.”

But he shakes his head, the vulnerability in his expression making it hard to hold his gaze. “You don’t get it. I need you here. You’re… you’re the only one I can rely on.”
[[Change your Mind]]
[[ Leave]]</tw-passagedata><tw-passagedata pid="77" name="Attempt to Shut Down the Energy Core" tags="" position="1300,3500" size="100,100">
The scientist nods, his features set with concentration. “Let’s work together. I’ll guide you through the shutdown sequence, but we have to be precise. One wrong move, and we could destabilize the entire factory.”

You step closer to the console, your heart racing as you prepare to execute the shutdown. The scientist points to various controls, explaining their functions in a rapid but steady voice. You follow his instructions, each action feeling critical.

As you get closer to the final step, a low rumble echoes through the chamber, making you both freeze. The machinery around you trembles, and the lights flicker ominously.

“It’s reacting to our presence!” the scientist exclaims, urgency in his voice. “We need to complete this now!”

With the scientist&#39;s guidance, you make the final adjustments. You press the last switch, and a blinding light erupts from the core. The energy stabilizes, but then it starts to spiral uncontrollably.

“Hold on!” the scientist shouts as you brace for the aftermath.

Just as the energy seems to reach a critical point, the light suddenly extinguishes, leaving you in darkness. The hum of the machinery dies down, replaced by an eerie silence.

You exchange a glance with the scientist, both of you unsure of what to expect next. The tension in the air feels palpable.
[[Assess the Situation]] — You decide to carefully inspect the machinery and the area for any signs of what just happened.

[[Check the Portal]] — You feel a strong urge to see if the portal has been affected, wanting to ensure it’s fully shut down.</tw-passagedata><tw-passagedata pid="78" name="Look for a Backup Power Source" tags="" position="1500,3400" size="100,100">You suggest checking for any backup systems, hoping to find a safer way to disable the portal&#39;s power. The scientist shakes his head, a hint of frustration in his expression. “There are no backup systems in this factory. It was designed to rely solely on that energy core. If we want to shut down the portal, we have to disable it directly.”

The reality of the situation weighs heavily on you. With no other options, you turn your focus back to the pulsating core. “Still say you should have built one,” you say, determination firming your resolve.

He glances at you, a mix of annoyance and acknowledgment in his eyes. “Hindsight is always clearer, isn’t it?”

You hum absently, then shake your head as if to clear the fog. “What was I talking about again?” you ask, the question lingering awkwardly in the air.

The scientist looks briefly hurt, but he quickly masks it, returning to the task at hand. “Doesn’t matter. Let’s focus on what we can do now.”

With a determined nod, you shift your focus back to the task. There’s no time to dwell on what could have been. You take a deep breath, steeling yourself for what’s to come. The pulsating energy from the core feels almost alive, and you know that disabling it will require every ounce of focus and courage you can muster.

“Let’s do this,” you say, and he responds with a tight nod, both of you ready to face the challenge together.
[[Attempt to Shut Down the Energy Core]]</tw-passagedata><tw-passagedata pid="79" name="Assess the Situation" tags="" position="1300,3700" size="100,100">You carefully assess the situation, taking in the now-still machinery and the faint echoes of the factory&#39;s hum fading into silence. Everything seems intact, but an unsettling energy lingers in the air, making the hairs on your neck stand on end.

Suddenly, the scientist&#39;s expression shifts to one of alarm. “We need to leave now!” He grabs your hand, urgency fueling his movements as he pulls you toward the exit.

You both sprint through the factory&#39;s winding corridors, adrenaline surging through your veins. Each step feels like it carries the weight of impending chaos, but the exit grows closer with every heartbeat.

As you burst through the doors and into the open air, you turn around, expecting to see the factory behind you. But instead, there’s nothing—just empty ground where the structure once stood. A thick fog begins to roll in, swallowing the space where the factory had been.

You exchange wide-eyed glances with the scientist, the disbelief slowly melting into laughter. The tension of the moment dissipates as you both realize the gravity of what just happened.

“That was too close!” you say between breaths, laughter bubbling up.

“Close? That was a miracle!” he replies, still chuckling. “I can’t believe we made it out!”

The two of you stand there, relieved and exhilarated, the chaos of the realm now just a memory. The adventure may have left its mark, but for now, you’re both safe.

[[Reflect on the Experience]] — Take a moment to discuss what you learned from this ordeal and how it might shape your future.

[[Plan Your Next Steps]] — Talk about what you want to do next, whether it’s continuing the scientist’s research or exploring other realms.</tw-passagedata><tw-passagedata pid="80" name="Reflect on the Experience" tags="" position="1325,3900" size="100,100">You take a moment to process the scene before you. The factory has vanished without a trace, swallowed by the shifting chaos of the dimensions. You turn to the scientist, who stands beside you, his eyes wide with disbelief.

“Did that just happen?” you ask, laughter bubbling up despite the lingering tension.

He shakes his head, a grin breaking through his astonishment. “I can’t believe we made it out! I never expected the entire factory to disappear.”

You both share a moment of relief, the weight of your experience lifting as you stand together in the street.

“Whatever happens next, at least we got out together,” you say, your heart still racing from the adrenaline of your escape.

He nods, still chuckling. “I suppose we’ll have to figure out what to do next—together.”

As the laughter fades, a sense of camaraderie settles in. The world around you feels bright and full of possibilities, a stark contrast to the chaos you just escaped. You glance down the street, pondering your next move. “So, where do we even start?”

He looks thoughtful, his excitement returning. “We could dive into the data we collected, or maybe explore some of the other areas around here. There’s always more to discover.”
[[Plan Your Next Steps]] — Talk about what you want to do next, whether it’s continuing the scientist’s research or exploring other realms.</tw-passagedata><tw-passagedata pid="81" name="Plan Your Next Steps" tags="" position="1600,3800" size="100,100">You take a deep breath, feeling a mix of excitement and curiosity about the endless possibilities before you. “So, what’s next for us?” you ask the scientist, eager to hear his thoughts.

He looks thoughtful for a moment, glancing at the swirling chaos around you. “There’s so much we can explore,” he replies. “I could dive deeper into the research—there are countless dimensions to study, and each one holds secrets that could expand our understanding of reality.”

You nod, considering the potential discoveries. “Or we could focus on ensuring that no other entities breach our dimension again. Developing safeguards would be crucial.”

“True,” he agrees. “But if we explore other realms, we might find new ways to protect our own. Learning from these dimensions could lead to innovative solutions.”

You both ponder the choices, weighing the allure of exploration against the need for security.

[[“What if we do both?]] —  We could set up initial safeguards while also preparing for some exploratory missions. That way, we’re protecting ourselves while still pursuing knowledge.”

[[Return Home]] — You express a desire to go back home</tw-passagedata><tw-passagedata pid="82" name="Return Home" tags="" position="1600,4000" size="100,100">You pause for a moment, a feeling of longing washing over you. “You know, I think I’d like to go back home for a bit,” you say, the words surprising even yourself.

The scientist’s expression shifts, a flicker of disappointment crossing his face. “Home? I thought we were just starting an adventure,” he replies, his voice tinged with concern.

You nod, feeling a twinge of uncertainty. “Yeah, but… I can’t quite remember why I was so interested in exploring these dimensions in the first place. Maybe I need some time to think about it.”

He stares at you, the worry deepening. “You don’t know why you were interested? Or why you wanted to explore?”

A sudden realization hits you—amid the chaos and urgency, you don’t even know his name. “Wait… what’s your name?” you ask, the question slipping out before you can second-guess yourself.
He blinks, clearly taken aback. “You don’t know my name? It’s—” He pauses, uncertainty creeping into his expression. “I—I’m not sure I can remember. Don’t you know?”
A flicker of confusion crosses your mind. “Why would I know? This is the first time I’ve ever been here,” you say, your voice laced with uncertainty.

The scientist&#39;s expression grows more distressed. “But you came to the factory and through the portal to get me—and you don’t remember?” He shifts awkwardly, his eyes darting as if searching for the right words.

As he speaks, a sudden ache pulses in your head, a dull throb that intensifies the more you try to focus. You wince, rubbing your temples. “I—I don’t know,” you admit, feeling disoriented.

He looks even more concerned, a hint of devastation creeping into his expression. “I thought that after it was gone, you might remember—” His voice trails off, cut short by the blinding pain in your head.

You stagger slightly, grasping at the air for balance as the world around you spins. The discomfort clouds your thoughts, making it hard to concentrate. You can feel the scientist’s worried gaze on you, urging you to find a way through the haze.

[[next-&gt;next_2]]</tw-passagedata><tw-passagedata pid="83" name="Check the Portal" tags="" position="1700,3575" size="100,100">You take a deep breath, the weight of the moment settling on your shoulders. “I think we should check the portal,” you say, your instinct urging you to confirm its status.

The scientist nods, his expression serious. “That’s a good idea. We need to ensure it’s completely shut down before we do anything else.”

You both make your way through the dimly lit chamber, the air thick with tension. As you approach the portal’s previous location, you notice a faint glow where the portal once stood, flickering like a distant star.

The scientist inspects the area closely. “It seems the portal’s energy is still lingering,” he murmurs, frowning. “But it’s different—less chaotic, almost… dormant.”

You exchange a concerned glance. “Does that mean it’s still a threat?”
The scientist’s eyes widen in realization. “Not right now, but it could reactivate if we don’t get out of here quickly!”

Without another word, he grabs your hand and starts sprinting toward the exit, pulling you along. The urgency in his movements propels you both forward, adrenaline coursing through your veins.

As you navigate the dimly lit corridors, the atmosphere feels charged, almost alive. You can hear the low hum of machinery behind you, and the faint glow of the portal lingers in your peripheral vision, a reminder of the chaos that almost engulfed you.

Finaly you burst through the doors and into the open air, you turn around, expecting to see the factory behind you. But instead, there’s nothing—just empty ground where the structure once stood. A thick fog begins to roll in, swallowing the space where the factory had been.

You exchange wide-eyed glances with the scientist, the disbelief slowly melting into laughter. The tension of the moment dissipates as you both realize the gravity of what just happened.

“That was too close!” you say between breaths, laughter bubbling up.

“Close? That was a miracle!” he replies, still chuckling. “I can’t believe we made it out!”

The two of you stand there, relieved and exhilarated, the chaos of the other dimension now just a memory. The adventure may have left its mark, but for now, you’re both safe. The weight of the moment transforms into a shared joy, a bond forged in the heat of uncertainty, as the fog swirls around you, holding the remnants of your experience like a secret.
[[Reflect on the Experience]] — Take a moment to discuss what you learned from this ordeal and how it might shape your future.

[[Plan Your Next Steps]] — Talk about what you want to do next, whether it’s continuing the scientist’s research or exploring other realms.</tw-passagedata><tw-passagedata pid="84" name="Ask Him for More Details About the Entity" tags="" position="1200,1000" size="100,100">You take a deep breath, feeling the weight of the moment. “Before we make any plans, can you tell me more about this entity? What are we really up against?”

The scientist takes a moment to gather his thoughts. “The entity is a manifestation of chaos itself. It feeds on fear and instability, using the energy of this dimension to grow stronger. It can manipulate reality, creating illusions and traps to ensnare anyone who dares to confront it.”

He glances around, as if the shadows are listening. “I’ve been building a machine that can disrupt its power. It’s designed to disrupt its essence and destroy it once and for all. But I need to finish it, and for that, we need to buy some time.”

Your heart races at the revelation. “So this machine can actually defeat it?”

“Yes,” he replies, his voice steadying with resolve. “But we need to act quickly. If we can locate its anchor points and disrupt them while I finalize the machine, we might just stand a chance.”

You feel a mix of hope and apprehension. “What do we need to do?”

[[Agree to Help Him Confront the Entity-&gt;Ask the Scientist for a Plan]] — You nod, ready to support him in this mission, understanding the stakes.
</tw-passagedata><tw-passagedata pid="85" name="Help Him Gather Materials for the Diversion" tags="" position="1600,700" size="100,100">You nod, determination surging within you. “Let’s get this diversion ready. We need to act fast.”

The scientist’s eyes light up with gratitude. “Thank you! If we can create a loud noise or something flashy, it’ll buy me the time I need.”

You scan the area, searching for anything useful. After a moment, you spot some old machinery half-buried under debris, rusted but still intact. Nearby, you see a collection of empty canisters and metal scraps.

“Over there!” you call, leading the scientist to the pile. Together, you begin rummaging through the debris, gathering anything that could serve as a distraction.

The scientist quickly assembles the materials into a makeshift device. “If we can rig this to produce a loud bang and some bright lights, it should draw the entity’s attention away from me while I work on the machine.”

After a few tense minutes, you finish putting together the diversion. It’s a haphazard creation, but it looks promising. The scientist takes a deep breath, glancing at you with a mix of hope and anxiety.

“Are you ready to set this off?” he asks. “Once we do, we’ll need to move quickly to avoid being caught.”
[[Activate the Diversion]] — You decide to trigger the distraction now and get ready to confront the entity.
[[Discuss Your Next Steps]] — You want to quickly go over the plan one more time to ensure you’re both on the same page.</tw-passagedata><tw-passagedata pid="86" name="Activate the Diversion" tags="" position="1500,800" size="100,100">With determination, you nod. “Let’s do this. It’s time to activate the diversion.”

You move to the makeshift device you assembled, feeling a rush of adrenaline. The scientist positions himself a short distance away, ready to start setting up his machine.

As you trigger the diversion, a loud bang reverberates through the tunnel, followed by flashes of light that dance across the walls. The noise echoes ominously, drawing the attention of the entity lurking in the shadows.

You see the shadows shift and pulse, responding to the sound. A moment later, you hear a low growl, and the air thickens with a dark energy that churns violently.

“Now!” the scientist shouts, and you sprint away from the diversion, making sure to keep the entity’s focus on the noise.

You glance back to see the entity surge toward the source of the sound, its form twisting and writhing in anger. This is your chance.

The scientist races to set up his machine, fingers flying over the controls. You stay alert, keeping an eye on the shadows for any sign of the entity returning.

As the minutes tick by, you can hear the sounds of the diversion growing fainter.

[[Prepare to Confront the Entity]] — You steel yourself for the possibility that the entity may return before the machine is ready.</tw-passagedata><tw-passagedata pid="87" name="Discuss Your Next Steps" tags="" position="1600,800" size="100,100">You take a moment to gather your thoughts. “Before we activate the diversion, let’s quickly go over the plan one more time to make sure we’re both ready.”

The scientist nods, grateful for the chance to clarify. “Right. Here’s the idea: I’ll set up my machine a little further in the tunnel. When I give the signal, you’ll activate the diversion to draw the entity’s attention. It should create enough noise and light to keep it occupied while I work.”

“Got it,” you say, mentally picturing the layout. “Once you start the machine, how long do you think you’ll need?”

“Hopefully just a few minutes, but I’ll be relying on you to keep the entity distracted. If it seems to come back towards me, we’ll have to improvise,” he explains, a hint of tension in his voice.

You nod, feeling the weight of the responsibility on your shoulders. “We’ll make it work. Just focus on your machine, and I’ll handle the distraction.”

His eyes meet yours, and you can see the flicker of hope in them. “You’ve got this. I wouldn’t want anyone else by my side. Just remember to stay alert. The moment you see it turning back, shout. I’ll adapt. Together, we can outsmart it.”

With the plan set, you both take a deep breath, preparing yourselves for the challenge ahead. The shadows around you feel heavier, and you can sense the entity lurking nearby, aware of your presence.

“Ready?” he asks, glancing at the diversion device. “I know it’s daunting, but you’re stronger than you realize. We’ve faced chaos before, and we’re going to beat it again.”

“Yeah,” you reply, feeling a surge of determination. “I’m ready. We’ve come this far together. Let’s do this.”

He gives you a reassuring nod, and with one last deep breath, you steel yourselves for the confrontation ahead.
[[Activate the Diversion]] — You decide to trigger the distraction now and get ready to confront the entity.</tw-passagedata><tw-passagedata pid="88" name="Prepare to Confront the Entity" tags="" position="1500,900" size="100,100">You steel yourself, realizing that the entity could return at any moment. “We need to be ready in case it comes back,” you say, preparing for a confrontation.

The scientist nods, his focus unwavering as he adjusts the settings on his machine. “You’re right. Keep an eye on the shadows.”

You take a defensive stance, scanning the dark corners of the tunnel for any sign of the entity. The atmosphere is thick with tension, and the remnants of the diversion’s noise fade into an eerie silence.

Suddenly, the shadows ripple, and you feel a cold wind sweep through the tunnel. The entity’s form begins to materialize, its grotesque shape twisting and distorting as it approaches, drawn back by the disruption.

“Stay alert!” you warn, your heart racing as the creature draws closer, its eyes glinting with malice.

The scientist works frantically at his machine, but you can see the anxiety etched on his face. “I’m almost there!” he calls out, fingers flying over the controls.

You take a deep breath, ready to confront the entity. “I’ll try to keep it at bay!”

As the entity lunges forward, you shout, attempting to draw its attention away from the scientist. “Hey! Over here!”

It pauses, turning its malevolent gaze towards you. The air crackles with dark energy, and you can feel its intent, a hunger for chaos.

[[Engage the Entity]] — You decide to confront the entity directly, using anything at hand to defend yourself.</tw-passagedata><tw-passagedata pid="89" name="Engage the Entity" tags="" position="1500,1000" size="100,100">You start talking quickly, your voice rising above the tension. “You think you can scare us? We know your tricks! You thrive on fear, but we won’t give you that satisfaction!”

The entity hesitates, its grotesque form wavering as if your words are having an effect. Encouraged, you continue, your words tumbling out in a rush. “You’re nothing but a shadow in the dark! We’ve seen your kind before, and we won’t let you control us!”

It seems to react, the shadows flickering as you speak. You notice a brief flash of confusion in its eyes, and you push harder. “You want to feed on our fear? Well, here’s the truth: we’re not afraid of you! We’re going to stop you!”

The creature shifts, its focus seemingly split between you and the scientist. You can feel the energy in the air crackling, but your words are holding its attention, if only for a moment.

“Almost there!” the scientist calls out, his fingers racing over the controls. You glance at him, seeing the determination in his eyes, and you know he’s close to activating the machine.

The entity growls lowly, its form twisting and curling as it struggles against your words, caught between its hunger and the challenge you pose.
[[Keep Talking to Distract It]] — You decide to keep your focus on the entity, continuing to taunt and challenge it.
[[Signal the Scientist to Hurry]] — You glance at the scientist and urge him to finish his work quickly.</tw-passagedata><tw-passagedata pid="90" name="Keep Talking to Distract It" tags="" position="1400,1100" size="100,100">You dive back into your fast-paced taunts, hoping to keep the entity off-balance. “What’s the matter? Can’t handle a little light? You thrive on fear, but look at you—nothing but a coward hiding in the shadows!”

The entity roars, the sound echoing through the tunnel, but you can sense a flicker of uncertainty in its movements. “You’re just a pathetic creature clinging to chaos. You think you can control us? We won’t let you!”

The air around you hums with rage as each word you speak sends the shadows convulsing. In the corner of your eye, you catch the entity seething, its form twisting violently in fury. The machine&#39;s glow intensifies, ready to unleash its full power, and the entity, now trembling with anger, grows more erratic, as though every word you utter only fans its wrath.

“You think you can scare us?” you shout, stepping forward. “We’ve faced worse than you. You’re nothing but a failure—a fading shadow!”

“Almost there!” the scientist shouts, his voice strained but determined.

You double down, your voice steady and sharp. &quot;You&#39;re just a shadow, and your time is up.&quot;

With one final roar of defiance, the entity lunges toward you, but you’re ready. You sense the scientist’s moment is near.

With a blinding flash, the machine roars to life, firing a concentrated beam of searing light that slices through the entity. You watch as the dark form recoils, shrieking in fury as the beam tears into its very essence.

The air hums with raw power, and the shadows begin to retreat, their hold on the tunnel slipping. The entity thrashes wildly, but the beam’s relentless energy tears through it, breaking apart its chaotic form.

&quot;Hold on!&quot; the scientist shouts, his eyes locked on the controls, his face tense with determination. &quot;It’s working!&quot;

The entity roars in defiance, but it’s clear the light is weakening it. You feel a rush of exhilaration as the darkness retreats, unable to withstand the power of the machine. The whispers of the shadows grow fainter, and the oppressive atmosphere starts to lift.

With one final, desperate howl, the entity dissolves into wisps of shadow, scattering into nothingness. As the darkness recedes, you suddenly realize—you’re standing in a tunnel. The chaotic energy that had engulfed your surroundings evaporates, revealing walls and a path stretching ahead. The tunnel brightens, the heavy tension lifting as calm settles over the space.

You and the scientist lock eyes, both stunned by the sudden clarity. Relief washes over you.

“We did it,” he breathes, a smile breaking across his face.

You nod, heart pounding. &quot;We actually did it.&quot;

The last traces of the shadows fade, leaving the tunnel clear and safe. You stand together in the aftermath, the echoes of chaos replaced by a quiet, growing sense of hope.
[[next]]
</tw-passagedata><tw-passagedata pid="91" name="Signal the Scientist to Hurry" tags="" position="1600,1100" size="100,100">You glance back at the scientist, urgency driving your next words. “Hurry! We need that machine ready now!”

He meets your gaze, and you can see the determination etched on his face as he works faster. “Just a bit longer!” he calls out, fingers flying over the controls.

The entity growls again, its twisted form flickering as it tries to break free from your verbal grasp. You keep your focus on it, trying to maintain its attention while the scientist finishes his work.

“Your time is running out!” you shout at the entity, pushing it to react. “You think you can hold us here forever? We’re not afraid of the dark!”

The shadows around you seem to pulse in response, and for a moment, the entity hesitates, caught between anger and confusion. You can feel the tension in the air thickening as it considers your words.

“Just a few more seconds!” the scientist urges, sweat glistening on his brow as he focuses on the machine.

Finally, you see the device hum to life, lights blinking as it charges up. The entity snarls, its patience wearing thin as it lunges toward you, sensing that its time is almost up.

[[Keep Talking to Distract It]] — You decide to keep your focus on the entity, continuing to taunt and challenge it.</tw-passagedata><tw-passagedata pid="92" name="next" tags="" position="1400,1200" size="100,100">You take a deep breath, feeling the weight of the ordeal begin to lift. “Let’s find a way out of this tunnel,” you say, glancing around at the now-illuminated space.

The scientist nods, still catching his breath. “Good idea. We should make sure we’re completely safe before celebrating.”

You both start moving cautiously through the tunnel, your eyes scanning the walls for any sign of an exit. The flickering lights from the machine have left a warm glow, illuminating the previously hidden passages.

As you continue, you notice a faint light emanating from a small opening at the far end of the tunnel. You quicken your pace, hope surging within you.

“Over there!” you call to the scientist, pointing toward the glow. He follows your gaze, and a smile spreads across his face.

Together, you approach the opening, your heart racing with anticipation. As you get closer, the light grows brighter, revealing a narrow passageway that seems to lead outside.

“Let’s go!” the scientist urges, and you both slip through the opening.

As you emerge into the daylight, you find yourselves on a grassy hillside overlooking the landscape of your home dimension. The air is fresh, and you can see the familiar shapes of trees and hills stretching before you.

You both take a moment to soak it in, relief washing over you.

Turning to the scientist, curiosity bubbling up inside you, you ask, “How are we home? I thought we were stuck in that chaotic dimension for good.”

He furrows his brow, looking out over the familiar landscape. “I don’t know,” he admits, running a hand through his hair. “I’ve spent so much time trying to understand the connections between dimensions, but this... this is beyond anything I anticipated.”

He furrows his brow, looking out over the landscape, wonder and confusion etched on his face. “I don’t know,” he admits, running a hand through his wild hair. “The last thing I remember is defeating the entity. It’s as if we were pulled back without any explanation.”

His eyes scan the horizon, filled with intrigue. “It’s fascinating, really. One moment we’re engulfed in chaos, and the next, we find ourselves back in a world we recognize. I need to analyze this further. The implications for dimensional theory could be monumental.”

You nod, feeling a twinge of unease. “It’s strange. We were so deep in that chaos. How did we just... end up here?”

The scientist shakes his head, a spark of frustration igniting his passion. “We must investigate this phenomenon. If there’s a way back, we need to understand how it happened. This could revolutionize everything I’ve been studying.”

Standing together in the sunlight, you feel a mix of relief and curiosity. 
[[Explore the Area]] — You suggest taking a look around to see if there are any signs or clues that could explain your return.</tw-passagedata><tw-passagedata pid="93" name="Explore the Area" tags="" position="1400,1300" size="100,100">You suggest, “Maybe we should explore the area a bit. There might be signs or clues that can explain how we ended up back here.”

The scientist nods, intrigued by the idea. “That makes sense. We might find something that could shed light on the situation.”

You both begin walking down the hillside, the familiar sounds of nature surrounding you. As you venture further, you keep an eye out for anything unusual—a disturbance in the ground, strange markings, or anything that seems out of place.

After a few minutes, you come across a patch of earth that looks different from the rest, as if it had been disturbed recently. The soil is darker and looser, and there are faint, glowing sigils etched into the ground.

“Look at this!” you exclaim, kneeling down to get a closer look. The sigils shimmer slightly, reminding you of the ones the scientist had mentioned earlier.

He crouches beside you, examining the markings. “These are similar to the anchor points I’ve been studying,” he murmurs, fascination evident in his voice. “It’s possible they’re tied to our return.”

You both continue to inspect the area, your minds racing with possibilities.
[[He has a question]]</tw-passagedata><tw-passagedata pid="94" name="He has a question" tags="Ending" position="1600,1300" size="100,100">The scientist looks at you, his expression a mix of excitement and nervousness. He fidgets with his glasses for a moment before speaking. “Um, you know, these discoveries could lead to incredible insights about dimensions and the nature of that entity. Would you... consider being my partner in this? I mean, if you&#39;re interested, of course. We could explore the mysteries behind this together.”

You feel a thrill at the idea. The prospect of diving deeper into the unknown with someone who shares your passion is enticing. “Absolutely,” you reply, enthusiasm bubbling up. “I’m in. This is too important to tackle alone. But, just to be clear—no more portals, right?”

His eyes widen for a moment before he chuckles nervously. “Yes, no more portals. Let’s stick to, um, more conventional methods. Perhaps we can study the symbols or analyze the environment instead. That sounds much safer, doesn’t it?”

You can’t help but feel a twinge of curiosity about his past work, though. “I have to admit, I don’t remember much about you. I know you’re important, but it’s all a blur.”

He nods, a sadness flickering in his eyes. “I understand. The entity’s presence has warped reality itself; it did something to people’s memories of me . I’m sorry you don’t remember. It’s... it’s hard to accept.”

You ponder the weight of those words, a tinge of concern creeping in. What did you forget? What experiences or knowledge have been lost to you? It feels unsettling, like an itch in the back of your mind, urging you to dig deeper. The idea that pieces of your past might be hidden away, obscured by the entity’s influence, makes you wonder about the adventures and discoveries that could have shaped you.

“Is there anything I can do to help recover those memories?” you ask, your voice barely above a whisper.

The scientist looks thoughtful for a moment, his brow furrowing. “Perhaps, but it may take time. We need to understand the entity’s effects fully first. There might be clues in the symbols or in the places we explore.”

With that, a sense of resolve settles in your chest. You’re not just here to uncover the mysteries of dimensions; you’re also on a quest to rediscover the pieces of yourself that have been lost. And with the scientist by your side, you feel ready to face whatever challenges lie ahead.
[[Start]] </tw-passagedata><tw-passagedata pid="95" name="Decide Not to Enter" tags="Ending" position="3300,375" size="100,100">You take a step back, your instincts urging you to reconsider. The factory looms before you, its strange energy palpable, and the unsettling signs around it deepen your sense of unease, creating an atmosphere thick with bad vibes. Shadows seem to flicker at the edges of your vision, and an inexplicable chill runs down your spine.

“No, this isn’t right,” you murmur to yourself. The whispers of doubt grow louder, reminding you of the potential dangers inside. You decide it’s better to leave and get some help before exploring further.

As you turn away, the hum from the factory fades, replaced by the familiar sounds of the quiet street. You pull out your phone, determined to call ~~//him//~~ and share what you’ve discovered.
But as you begin to dial, the name of the person you intended to call slips from your mind, and instead, you find yourself calling a different friend
You can’t quite recall why you called them instead, but the nagging feeling that this was~~ not the right person~~ lingers even as you start talking about what you’ve encountered. You describe the factory and the unsettling vibes, but a sense of doubt creeps in, making you question whether this friend can help you.

[[Start]] </tw-passagedata><tw-passagedata pid="96" name="Enter the Shop" tags="" position="5600,250" size="100,100">Something about the shop draws you in, a curiosity ignited by the day&#39;s events. You hesitate for a moment, then decide to step inside.
You step inside the shop, and the air is thick with the scent of incense and something earthy. The walls are lined with shelves overflowing with oddities from around the world. A bell jingles as you enter, and an older man with a twinkle of mischief in his eyes looks up from behind the counter.

“Welcome! What brings you to my little corner of the world?” he asks, gesturing for you to browse.

You glance around, feeling both intrigued and slightly uneasy.

[[Ask About the Coordinates]] — You decide to inquire if he knows anything about the coordinates you received.

[[Browse the Oddities]] — You take a moment to explore the strange items on display, hoping something will catch your eye.

[[Leave the Shop]] — You feel a sudden urge to leave, sensing that this place might be more than it seems.</tw-passagedata><tw-passagedata pid="97" name="Ask About the Coordinates" tags="" position="5475,400" size="100,100">You turn to the shopkeeper, your curiosity bubbling to the surface. “Do you know anything about these coordinates I found on my phone? They lead to an old part of the city.”

His expression shifts slightly, a flicker of concern crossing his face. “Ah, those coordinates. I’d advise against digging too deep into that particular area. Some things are better left undiscovered, if you catch my drift. Sometimes remembering isn’t worth it.”

Before you can press for more details, he smoothly transitions the conversation. “But while you’re here, perhaps you’d like to browse some of my wares? I have fascinating items that could pique your interest—objects with unique histories, charms, and trinkets that might even bring you luck.”

He gestures toward a shelf filled with an assortment of curious items: an ornate key, a small glass vial filled with a glowing liquid, and a beautifully crafted compass that seems to spin aimlessly.

You’re torn between wanting to know more about the coordinates and the allure of the intriguing items before you. Each object seems to hold a story, yet the warning about the coordinates lingers in your mind. Do you choose to inquire further about the coordinates, or do you let your curiosity lead you to explore the strange items on display?

[[Press for More Information]] — You decide to push him for more details about the coordinates, feeling it’s important to know.

[[Browse the Items]] — You take a closer look at the items on display, intrigued by the potential treasures.

[[Thank Him and Leave]] — You choose to respect his warning and decide to leave the shop, not wanting to get caught up in anything dangerous.</tw-passagedata><tw-passagedata pid="98" name="Browse the Oddities" tags="" position="5700,600" size="100,100">You lean in closer to the display, your curiosity piqued by the array of peculiar items. The shopkeeper watches you with a glimmer of amusement as you inspect each piece.

First, you pick up the ornate key. It’s heavy and intricately designed, with strange symbols etched into the metal. “This key is said to unlock hidden doors,” the shopkeeper says with a hint of mystery. “But be careful—some doors are meant to remain closed.”

Next, you notice the small glass vial filled with a glowing liquid. The contents swirl with an otherworldly light, casting soft reflections on your hand. “That’s a potion of clarity,” he explains. “A few drops can help reveal hidden truths. But use it wisely.”

Finally, you turn your attention to the beautifully crafted compass. Its needle spins erratically, not pointing in any particular direction. “Ah, this compass is special,” he says, a twinkle in his eye. “It doesn’t lead you to a location; it leads you to what you truly seek.”

You feel a tug of temptation to buy one of these intriguing items, but you also remember the shopkeeper&#39;s warning about digging into the coordinates.

[[Ask About the Items]] — You want to know more about the stories behind these items and their potential uses.

[[Purchase an Item]] — You decide to buy one of the items, feeling drawn to its potential.

[[Thank Him and Leave]] — You choose to step back and leave the shop, realizing it’s best not to get involved.</tw-passagedata><tw-passagedata pid="99" name="Leave the Shop" tags="" position="5400,200" size="100,100">You take a step back, feeling a sudden urge to leave the shop. The strange atmosphere and the oddities surrounding you make you uneasy, and you decide it’s best to step out into the fresh air.

As you exit, the bell jingles softly behind you, and the scents of the outside world wash over you. You walk away from the shop, your heart rate slowly returning to normal. While curiosity pulled you in, the instinct to protect yourself prevails.

Back on the familiar street, you take a deep breath, feeling the tension of the day begin to dissipate. You decide to put your phone issue aside for now. Perhaps some things are better left unexplored.

With the evening ahead of you, you return to your usual routine, reflecting on the day’s oddities. The city continues to hum with life around you, and while the encounter was strange, you feel a sense of closure for now.

You know that tomorrow is another day, and the mysteries of life will still be there waiting for you, should you choose to delve into them again.
[[Start]] </tw-passagedata><tw-passagedata pid="100" name="Keep walking" tags="" position="6050,100" size="100,100">You decide to keep walking, sensing that something about the shop feels off. The oddities on display intrigue you, but the unease from your earlier encounter lingers in your mind. You can’t shake the feeling that exploring this shop might lead to more questions than answers.

As you move on, the city buzzes with life around you, yet the strange energy from the glitch still clings to you. You focus on the familiar sights, hoping to ground yourself in the routine of your surroundings.

After a few moments, you find yourself at a crossroads—literally and figuratively. You can either continue on your path home or take a different route that leads deeper into the city, perhaps toward those coordinates.

[[Continue Home]] — You decide it’s best to head home and unwind, letting the day’s events settle.

[[Investigate the Coordinates]] — Curiosity pulls you toward the old part of the city, and you feel compelled to uncover what lies there.</tw-passagedata><tw-passagedata pid="101" name="Press for More Information" tags="" position="5600,500" size="100,100">You decide to Press for More Information. “I understand your caution,” you say, “but I really need to know more about those coordinates. What’s in that area that makes it so dangerous?”

The shopkeeper’s gaze shifts, a hint of worry clouding his features. “Let’s just say that some places in this city have a history that doesn’t sit well with those who dare to explore it. The old part of the city isn’t just forgotten buildings; it’s a nexus of energies and events that can attract... unwanted attention.”

He leans in slightly, lowering his voice. “There are stories of people disappearing in that area, as well as strange occurrences—things that defy explanation. Whatever lies beneath those coordinates is tied to the past in ways that are better left undisturbed.”

You can sense his sincerity, but it only fuels your curiosity further. “What kind of things? What happened to those who went looking?”

“Curiosity is a double-edged sword,” he replies, his tone somber. “Some say they encountered shadows or whispers that lured them deeper. Others claim to have seen figures that weren’t quite human. And the scientist... well, he vanished under circumstances that still puzzle everyone.”

His words resonate with you, and you realize that this isn’t just about the coordinates anymore; it’s about uncovering the truth behind the city’s hidden past.

[[Ask More About the Scientist]] — You press him for details on the scientist’s disappearance.

[[Thank Him and Browse the Items-&gt;Browse the Oddities]] — You decide to thank him for the information and take a look at the intriguing items, thinking they might be useful on your journey.

[[Thank Him and Leave]] — You choose to heed his warning and leave, feeling the weight of the unknown pressing on you.</tw-passagedata><tw-passagedata pid="102" name="Browse the Items" tags="" position="5425,600" size="100,100">You lean in closer to the display, your curiosity piqued by the array of peculiar items. The shopkeeper watches you with a glimmer of amusement as you inspect each piece.

First, you pick up the ornate key. It’s heavy and intricately designed, with strange symbols etched into the metal. “This key is said to unlock hidden doors,” the shopkeeper says with a hint of mystery. “But be careful—some doors are meant to remain closed.”

Next, you notice the small glass vial filled with a glowing liquid. The contents swirl with an otherworldly light, casting soft reflections on your hand. “That’s a potion of clarity,” he explains. “A few drops can help reveal hidden truths. But use it wisely.”

Finally, you turn your attention to the beautifully crafted compass. Its needle spins erratically, not pointing in any particular direction. “Ah, this compass is special,” he says, a twinkle in his eye. “It doesn’t lead you to a location; it leads you to what you truly seek.”

You feel a tug of temptation to buy one of these intriguing items, but you also remember the shopkeeper&#39;s warning about digging into the coordinates.

[[Ask About the Items]] — You want to know more about the stories behind these items and their potential uses.

[[Purchase an Item]] — You decide to buy one of the items, feeling drawn to its potential.

[[Thank Him and Leave]] — You choose to step back and leave the shop, realizing it’s best not to get involved.</tw-passagedata><tw-passagedata pid="103" name="Thank Him and Leave" tags="Ending" position="3450,200" size="100,100">
You decide to respect the shopkeeper’s warning. “Thanks for the advice,” you say with a nod, feeling that it’s best not to press further. The strange atmosphere in the shop, combined with his unease, makes you reconsider your curiosity.

As you step back from the counter, he gives you a knowing smile. “Sometimes, the mysteries we encounter are best left untouched. But if you think it’s worth it, you know where to find me.”

You exit the shop, the bell jingling softly behind you. The cool evening air feels refreshing, and you take a deep breath as you walk away from the Curiosities &amp; Oddities shop. While part of you is still curious about the coordinates, you feel a sense of relief in stepping away from potential danger.

Back on the bustling street, you allow yourself to settle into the rhythm of the city. Tomorrow is another day, and the mysteries of life can wait for now. You turn your focus to the familiar comforts of your routine, letting the day’s events drift into the background.

In this moment, you feel a neutral sense of peace, ready to face whatever comes next without the weight of unknown dangers on your shoulders. Yet, an odd feeling of betrayal gnaws at you, a sense that you’re leaving something important unresolved.

[[Start]] </tw-passagedata><tw-passagedata pid="104" name="Ask About the Items" tags="" position="4900,500" size="100,100">You place the items back on the shelf and turn to the shopkeeper, eager to learn more. “Can you tell me about the stories behind these items? They seem really unique.”

He leans in slightly, a conspiratorial smile spreading across his face. “Each of these items has a tale to tell. The ornate key, for instance, was once part of an ancient lock that supposedly opened a gateway to another realm. Many have searched for it, but the door was lost to time.”

His eyes twinkle as he continues. “The glowing potion? It was crafted by a forgotten alchemist who sought to uncover the truths hidden within the human heart. Those who have taken it claim to have experienced revelations, but the effects can be unpredictable.”

Finally, he gestures to the compass. “Ah, this beauty is said to have belonged to an explorer who lost their way—not just in the world, but in their own heart. It points not to the north, but to what you truly desire. Some say it has guided seekers to their deepest longings, while others have found it leads to unexpected paths.”

You absorb his words, captivated by the history behind the items. Each seems to hold potential for adventure or danger, depending on how you choose to use them.
[[Purchase an Item]] — You feel drawn to one of the items and want to buy it.

[[Thank Him and Leave]] — After hearing the stories, you decide it’s best not to get involved and leave the shop.</tw-passagedata><tw-passagedata pid="105" name="Purchase an Item" tags="" position="5600,700" size="100,100">You feel a strong pull toward the ornate key, its intricate design calling to you. “I’d like to buy the key,” you say, reaching for it.

The shopkeeper’s expression shifts, and he shakes his head gently. “Ah, I’m afraid I cannot sell you that key. It’s meant for someone else, someone who is not yet ready to wield its power.”

You furrow your brow, disappointment mingling with curiosity. “Then what about the potion or the compass?”

With a sly grin, he replies, “Those, too, are not quite what you need. You see, I have something special in mind—something just for you.”

He motions for you to follow him deeper into the shop. You tread carefully, the air thick with anticipation. He leads you to a small, dimly lit alcove filled with an array of hidden treasures, each covered with a soft cloth.

“Here,” he says, pulling back a cloth to reveal a small, intricately carved box. “This is what you need. It holds something powerful, something that can guide you through the uncertainties you’ve been facing. But remember, with great power comes great responsibility.”

You look at the box, your heart racing with a mix of excitement and caution.
[[Open the Box]] — You want to see what’s inside the box, feeling compelled to discover its contents.

[[Thank Him and Leave]] — You feel uncertain about this special item and decide it’s best to leave after all.</tw-passagedata><tw-passagedata pid="106" name="Open the Box" tags="" position="5500,825" size="100,100">You take a deep breath, driven by curiosity, and reach for the small carved box. As you lift the lid, a soft glow emanates from within, illuminating your face. Inside, you find a delicate amulet resting on a bed of velvet. Its design is intricate, featuring swirling patterns that seem to shift subtly as you gaze at them.

The shopkeeper watches you closely, a look of approval in his eyes. “This amulet is said to grant insight into the unseen. It can help you navigate the challenges you face, especially those shrouded in mystery. But be cautious; it will reveal truths you may not be ready to confront.”

You feel the weight of the amulet in your hand, its energy pulsing gently as if it resonates with your own heartbeat. This could be the key to understanding the strange events surrounding you, but it also carries the potential for unforeseen consequences.

“Will you take it?” the shopkeeper asks, his tone both encouraging and warning.

[[Take the Amulet]] — You decide to accept the amulet, feeling that it may help you uncover the truths you seek.
[[Close the Box and Leave]] — You feel a wave of uncertainty and decide it’s best not to take the amulet after all.</tw-passagedata><tw-passagedata pid="107" name="Take the Amulet" tags="Major-choice" position="4900,1000" size="100,100">You nod, feeling a sense of determination wash over you. “Yes, I’ll take it,” you say, your voice steady despite the lingering uncertainty.

The shopkeeper’s expression shifts to one of satisfaction. He carefully hands the amulet to you, his fingers lingering just a moment longer than necessary. “May it serve you well,” he murmurs, his tone almost reverent.

As you slip the amulet around your neck, a warm energy radiates from it, and the swirling patterns seem to come alive against your skin. You can’t help but feel a connection to something greater, as if the amulet is now a part of you.

“Be mindful,” the shopkeeper adds, a hint of caution in his voice. “The insights it grants may reveal more than you expect. Trust your instincts.”

With a nod of appreciation, you turn to leave the shop. As you step outside, the world feels different—charged with potential and a tinge of danger. The evening air is cooler, and the city around you hums with an energy you hadn’t noticed before.

[[Explore the City]] — You decide to wander through the streets, curious to see what the amulet might reveal.
[[Seek a Safe Haven]] — You look for a place where you can regroup and gather your thoughts away from the immediate tension.
[[Home]] Its late time to head home.</tw-passagedata><tw-passagedata pid="108" name="Close the Box and Leave" tags="" position="5675,850" size="100,100">You carefully close the box, the soft glow of the amulet dimming as you set it back inside. “I think I need to think this through,” you say, your voice steady despite the curiosity tugging at you.

The shopkeeper nods, a hint of understanding in his eyes. “That’s wise. The path you’re on is fraught with uncertainty, and sometimes the best decision is to step back and assess.”

You step away from the alcove, feeling the weight of the decision you just made. As you walk toward the exit, the atmosphere of the shop shifts slightly, as if it, too, recognizes your choice.

Once outside, the cool evening air hits your face, refreshing and invigorating. The street is alive with the sounds of the city, a comforting reminder of normalcy amidst the mysteries you’ve encountered.
You glance at your phone, expecting to see the coordinates still lingering on the screen. Instead, it&#39;s blank. A wave of unease washes over you. You spin around, the bustling city fading into a surreal quiet, and find that the shop has vanished. Where the Curiosities &amp; Oddities shop stood moments ago is now just an empty space, as if it never existed.

A shiver runs down your spine. The streets feel unfamiliar now, shadows lengthening and twisting around you. You take a few cautious steps, trying to make sense of your surroundings, but everything seems altered. The air is thick with an unshakeable sense of something lurking just out of sight.

[[Ask Passersby]] — You approach people nearby, hoping someone might have seen the shop or knows what’s going on.

[[Head Home]] — You feel the day has become too strange and retreat back to the safety of your home.</tw-passagedata><tw-passagedata pid="109" name="Ask Passersby" tags="" position="5500,1000" size="100,100">You decide to approach the few passersby lingering on the street, a mix of curiosity and urgency driving you. You spot a couple walking their dog and an older man sitting on a nearby bench, watching the world go by.

As you approach the couple first, you clear your throat. “Excuse me, did you happen to see a shop around here? It was… unusual, kind of out of place?”

The woman looks at you quizzically, her brow furrowing. “A shop? No, I haven’t seen anything like that. Just the usual stores.” Her partner shakes his head, and they continue walking, glancing back at you with mild concern.

Undeterred, you turn to the older man on the bench. “Sir, have you seen a strange shop nearby? It just disappeared from right in front of me.”

He looks up, a glimmer of recognition in his eyes. “Strange shop? There’s always been something odd about this street,” he mutters. “But no shop like that. You’re not the first to ask about it, though.”

“Not the first?” you ask, intrigued.

He nods slowly. “A few days ago, someone mentioned a similar shop, but it was gone before they could even get a good look. They seemed… shaken.” He leans closer, lowering his voice. “You should be careful. Some things are best left undisturbed.”

A chill runs down your spine at his words. You thank him, feeling a sense of urgency mixed with unease.

As you walk away, the unsettling feeling deepens. The city feels more like a web of secrets than a place of comfort, and you can’t shake the sensation that you’ve stumbled into something far larger than you realized.
[[Head Home]] — You feel the day has become too strange and retreat back to the safety of your home.
[[Investigate Further]] — You decide to dig deeper into the mystery, returning to the area where the shop was.</tw-passagedata><tw-passagedata pid="110" name="Head Home" tags="Ending" position="3400,600" size="100,100">You shake your head, deciding it’s best to retreat from the strangeness that’s enveloped you. This day has already taken enough unexpected turns, and you’re not willing to plunge deeper into the unknown.

Turning on your heel, you head back home, but as you walk, the familiar streets feel subtly altered. Shadows stretch longer, and whispers echo in the corners of your mind. The city seems to hold its breath, as if aware of the mysteries brushing against the edges of your reality.

Once you’re back in the safety of your home, you lock the door behind you, but the sense of unease lingers like a weight in your chest. You lean against the door for a moment, the silence inside your apartment amplifying the faint sounds of the world outside—a distant siren, the rustle of leaves, and something else, a whisper just beyond your comprehension.

Taking a seat on your couch, you allow yourself to relax, but the events of the day swirl in your mind like an unfinished puzzle. The glitch on your phone, the coordinates that led to nowhere, and the shop that vanished as if it had never existed at all.

As night falls, the city lights twinkle outside your window, but they feel less comforting now. The shadows seem to watch, the darkness thickening, and you can’t shake the feeling that you’ve only scratched the surface of something far more sinister.

With a shiver, you pull the curtains shut, but the sense of being observed lingers. You wonder if you truly escaped the chaos or if it’s simply biding its time, waiting for the right moment to draw you back in, along with the growing certainty that you’ve forgotten something ~~//important//~~.
[[Start]] </tw-passagedata><tw-passagedata pid="111" name="Investigate Further" tags="" position="5000,800" size="100,100">Determined to uncover more about the mysterious shop, you decide to investigate further. You wander through the nearby streets, your eyes scanning for anything unusual. After a few minutes of searching, you find yourself drawn to a narrow alley that seems to pulse with an odd energy.

As you step into the alley, the atmosphere shifts. The air is thick with an otherworldly presence, and you feel a strange pull guiding you deeper into the shadows. Your heart races as you navigate through the dimly lit passage, and then you spot it—a glimmer of light reflecting off something on the ground.

You approach cautiously and kneel down to get a better look. It’s the amulet you saw earlier, the same one that had captivated you in the shop. It lies there, gleaming faintly as if inviting you to pick it up. The intricate designs shimmer in the low light, and you can’t help but feel that it holds some significance, perhaps a connection to the events of the day.

You hesitate, weighing your options.

[[Pick Up the Amulet]] — You reach for the amulet, curious about its powers and what it might reveal.

[[Leave It There-&gt;Head Home]] — You decide it’s best to leave the amulet undisturbed, sensing it could lead to more trouble.</tw-passagedata><tw-passagedata pid="112" name="Pick Up the Amulet" tags="Major-choice" position="6100,900" size="100,100">You take a deep breath, your curiosity overpowering your hesitation. Reaching out, you grasp the amulet, feeling its cool surface beneath your fingers. As soon as you pick it up, a jolt of energy surges through you, and the intricate designs seem to pulse in rhythm with your heartbeat.

The alley around you begins to shimmer, and the air grows electric. You can almost hear whispers echoing in your mind, hints of knowledge waiting to be unlocked. It feels as if the amulet is responding to your presence, inviting you to explore its potential.

With the amulet in hand, you sense a new path unfolding before you. But there’s also an undercurrent of caution; the warnings from the shopkeeper flash through your mind.

[[Explore the City]] — You decide to wander through the streets, curious to see what the amulet might reveal.
[[Seek a Safe Haven]] — You look for a place where you can regroup and gather your thoughts away from the immediate tension.
[[Home]] Its late time to head home.</tw-passagedata><tw-passagedata pid="113" name="Explore the City" tags="" position="3950,1000" size="100,100">With a sense of excitement and curiosity, you step out into the night, the amulet nestled securely against your chest. The city feels different now, each street and alley shimmering with potential. As you walk, you pay closer attention to the details around you—the flickering streetlights, the distant sounds of laughter, and the soft rustle of leaves in the cool breeze.

As you explore, the amulet begins to pulse gently, almost as if it’s guiding you. You find yourself drawn down a narrow alleyway, dimly lit and filled with the scent of rain-soaked pavement. The atmosphere shifts, and you feel a tingling sensation as the amulet’s glow intensifies.

Suddenly, you notice a faded mural on the wall—a depiction of a celestial scene, stars swirling around a central figure that seems to watch you. The amulet vibrates in response, and you instinctively reach out to touch the mural.

In that moment, a vision washes over you: fragments of memories, whispers of ancient knowledge, and fleeting images of the shopkeeper, the factory, and the coordinates. You catch snippets of a message, hinting at hidden connections between these experiences and the truths waiting to be uncovered.

As the vision fades, you step back, breathless. The alley feels alive, filled with secrets just waiting for someone to discover them.

[[Examine the Mural Further]] — You want to investigate the mural closely, searching for any clues or additional details.

[[Follow the Amulet’s Guidance]] — Trusting the amulet, you decide to let it lead you wherever it wants to go next.</tw-passagedata><tw-passagedata pid="114" name="Home" tags="Ending" position="3000,200" size="100,100">You decide it’s best to head home, needing some time to process everything that’s happened. As you make your way through the city streets, the cool night air brushes against your skin, and the faint glow of streetlights casts long shadows on the pavement.

Once you reach your apartment, you close the door behind you, leaning against it for a moment to catch your breath. The events of the day rush back—your phone glitching, the strange shop, and now the amulet hanging around your neck.

You take a seat on your couch, pulling the amulet out to examine it closely. Its intricate designs shimmer in the dim light, and you can almost feel it humming softly in your hands.

Choosing to let the day&#39;s events settle, you place the amulet on the table, its glow softly illuminating the room. You take a moment to reflect on everything that has happened, realizing that while you may not have all the answers yet, you hold the key to unlocking them.

With a sense of calm washing over you, you decide to go to bed, leaving the mysteries for tomorrow. As you drift off to sleep, the amulet’s glow lingers in your mind, hinting at the adventures yet to come.

In the days ahead, you’ll uncover more about the amulet, the coordinates, and perhaps even the elusive shopkeeper. But for now, you rest, knowing you’ve taken a step into the unknown.
[[Start]] </tw-passagedata><tw-passagedata pid="115" name="Examine the Mural Further" tags="" position="3475,1500" size="100,100">You lean in closer to examine the mural, studying the intricate details and the way the paint seems to shimmer under the light. There’s a certain energy emanating from it that feels both inviting and unsettling. The swirling stars and the central figure draw you in, but something about the expression on the figure’s face makes you uneasy—it’s almost as if it knows more than it’s letting on.

As you trace the outlines with your fingers, you notice subtle differences in the texture. Some areas feel rough, while others are smooth and warm, as if they’ve absorbed the energy of the amulet. It dawns on you that this mural may hold more significance than just a piece of art; it could be a message or a warning.

Suddenly, the amulet begins to pulse rapidly, and you hear a faint whisper, almost too quiet to discern. “Seek the truth… but beware…”

A shiver runs down your spine. The vibrant colors seem to darken momentarily, and the alley feels colder. You step back, heart racing.

[[Look for Hidden Symbols]] — You search the mural and surrounding area for any additional symbols or signs that could provide more insight.

[[Try to Communicate with the Mural]] — You attempt to connect with the mural in hopes of gaining further understanding or clarity about its message.</tw-passagedata><tw-passagedata pid="116" name="Follow the Amulet’s Guidance" tags="" position="4250,1200" size="100,100">Feeling the amulet’s energy radiate through you, you decide to trust its guidance. You take a step back from the mural and allow it to pull you forward, feeling a magnetic force guiding your movements.

As you walk, the alley transforms, the world around you blurring with vibrant colors and shapes. The amulet pulses in rhythm with your heartbeat, each beat sending a surge of energy through your veins. You follow its lead, the winding path drawing you deeper into the night.

The alley opens up into a hidden courtyard, surrounded by old brick buildings adorned with ivy and glowing lanterns. The atmosphere feels charged, alive with potential. In the center of the courtyard stands a weathered stone pedestal, bathed in the soft light from the amulet.

As you approach the pedestal, the energy intensifies, and you realize this place is significant—a focal point for whatever forces are at play. You sense that something important awaits you here.

[[Inspect the Pedestal]] — You decide to examine the pedestal closely, searching for any inscriptions or artifacts that might connect to the amulet and the mural.

[[Call Out to the Energy]] — You choose to reach out mentally, attempting to communicate with the energy surrounding you and see if it responds to your presence.</tw-passagedata><tw-passagedata pid="117" name="Look for Hidden Symbols" tags="" position="3300,1700" size="100,100">You carefully inspect the mural, and your eyes catch sight of subtle sigils hidden among the swirling stars and the central figure. At first glance, they seem like random shapes, but as you focus, you begin to recognize a pattern—ancient symbols that resonate with a sense of power and mystery.

Each sigil appears to be intricately carved into the mural, almost as if they were etched into the surface long ago. They pulse faintly in rhythm with the amulet, and a sense of urgency washes over you. You recall hearing about these symbols in the context of rituals and gateways—signs that could lead to hidden knowledge or, conversely, dangerous realms.

As you trace one of the sigils with your finger, the amulet vibrates more intensely, and the alley around you seems to shimmer. You feel a pull, as if the sigil is beckoning you to understand its purpose.

[[Attempt to Activate the Sigil]] — You decide to press the sigil, hoping it will reveal something or trigger a response.

[[Look for Other Clues in the Alley]] — You shift your focus from the mural to the surrounding area, searching for anything else that might be connected to the sigils.</tw-passagedata><tw-passagedata pid="118" name="Try to Communicate with the Mural" tags="" position="3800,1700" size="100,100">You take a deep breath and focus on the mural, channeling your thoughts and intentions toward it. You close your eyes for a moment, letting the world around you fade away, and concentrate on the pulsating energy of the sigils.

“Show me what you mean,” you whisper, willing your energy to connect with the mural’s ancient power. As you visualize the connection forming, you can almost feel the warmth of the sigils radiating toward you, responding to your call.

Suddenly, a shimmering wave flows through the mural, and the swirling stars begin to rearrange themselves, forming images and symbols that dance in your mind. You sense fragments of knowledge breaking free, whispers of past rituals and the echoes of those who sought to harness the energy of the sigils.

A vision forms—images of gateways opening and closing, of travelers stepping through to other realms, both wondrous and perilous. You feel a surge of urgency as you realize the power contained within the mural can guide you, but it requires trust and intent.

[[Attempt to Tap into the Energy]] — You decide to push deeper, hoping to harness the energy of the mural to reveal more secrets.

[[Step Back and Reflect]] — You choose to take a moment to absorb what you’ve seen, wanting to process the information before making any further moves.</tw-passagedata><tw-passagedata pid="119" name="Attempt to Activate the Sigil" tags="" position="3400,2000" size="100,100">You take a deep breath and press the sigil firmly. For a moment, nothing happens, but then a soft hum fills the air, and the sigil glows brightly. Suddenly, the ground beneath you begins to ripple, and a glowing path materializes, stretching into the depths of the alley.

The light is mesmerizing, casting a warm glow around you, but as you watch the path take shape, you feel the amulet in your hand go cold and lifeless. The pulsing energy fades away, leaving you feeling strangely unmoored. The connection you had with the amulet is severed, and a sense of foreboding settles in.

You glance back at the mural, now eerily quiet, the sigils dimming as if the energy has shifted. The path before you beckons, glowing invitingly, but you can’t shake the feeling that you’ve lost something important.

[[Step onto the Glowing Path]] — You decide to follow the path, drawn by the promise of discovery despite your unease.

[[Turn Back]] — The loss of the amulet&#39;s energy concerns you, and you think it might be best to retreat and regroup.</tw-passagedata><tw-passagedata pid="120" name="Look for Other Clues in the Alley" tags="" position="3600,1900" size="100,100">You shift your focus from the mural, scanning the dim alley for any other signs or clues that might help you understand the sigils. You search through the shadows and debris, your heart racing with anticipation. However, despite your thorough investigation, you find nothing—no hidden artifacts, no markings, no traces of any further secrets.

Frustration begins to set in, but you remind yourself that the mural itself holds potential. The faint pulsations of the sigils still resonate in the air, their energy drawing you back. You can’t shake the feeling that this isn’t the end of the search; it’s just the beginning.

Returning your attention to the mural, you realize you need to dive deeper into its mystery.

[[Attempt to Activate the Sigil]] — You decide to press the sigil, hoping it will reveal something or trigger a response.

[[Try to Communicate with the Mural]] — You attempt to connect with the mural in hopes of gaining further understanding or clarity about its message.</tw-passagedata><tw-passagedata pid="121" name="Step onto the Glowing Path" tags="" position="3300,2300" size="100,100">
As you walk along the glowing path, its light pulses gently beneath your feet, casting strange, shifting shadows on the surroundings. You squint ahead, and there, standing at the end of the path, is the scientist. He’s watching you, motionless, his face partially obscured by the bright glow surrounding him.

Curiosity and unease gnaw at you, so you glance behind you. The path you’ve been walking on has vanished, dissolving into the air, leaving nothing but an empty void. There&#39;s no turning back. The only way forward is toward him.

Your chest tightens as conflicting thoughts swirl in your mind. You&#39;ve been angry at him—angry for the danger, the uncertainty, the reckless experiment. Yet now, with the past behind and him standing there, waiting for you, there&#39;s a moment where you wonder:// Could I forgive him//?

As you approach the scientist, a sense of intrigue washes over you. He appears engrossed in his surroundings, examining the ethereal patterns that swirl around him. His attire suggests a mix of academic and adventurer—practical but slightly worn.

“Who are you?” you ask, curiosity piqued.

He looks up, startled, but then relaxes, his expression shifting to one of cautious friendliness. “I’m… well, let’s just say I’m someone who has been studying this realm for quite some time. I didn’t expect anyone else to find their way here.”

You glance around, trying to gauge the situation. “What is this place?

The scientist takes a deep breath, his gaze reflecting a mix of frustration and determination. “I’ve been here longer than I intended. It’s a long story, but I got sucked into this anomaly accidentally while researching a way to destroy the portal. I thought I could gather information, but things spiraled out of control. I did escape that place, but now I can’t find a way back.”

He runs a hand through his hair, visibly agitated. “Every time I think I’m making progress, something else goes wrong. This landscape is unpredictable, and the energy here is volatile. I need to understand its patterns if I’m ever going to find a way to stabilize a path back.” His eyes lock onto yours, a flicker of hope mingling with desperation.

“If you’re willing to help me, we might just figure this out together,” he continues, then hesitates. “I kn—can tell you’re… capable. I mean, I didn’t expect anyone to have the resolve to come here and—” He cuts himself off, a moment of vulnerability passing over him. “But never mind that. We really need to focus on the task at hand.”

His sincerity is palpable, and you can sense the weight of his predicament pressing upon him. The scientist’s plea for partnership feels genuine, as if he believes you might be the key to navigating the challenges ahead.

“Together, we can analyze the energy fluctuations, look for patterns in the landscape, and maybe even unlock the secrets that will lead us back,” he adds, his eyes brightening with a spark of hope. “What do you say? Are you willing to take this journey with me?”

[[Offer to Help Him]] — You decide to join forces, eager to assist him in navigating this realm and finding a way out.

[[Ask More Questions]] — You want to know more about his experiences in this realm before making a decision.

[[Express Doubts]] — You share your concerns about teaming up with someone you just met, considering the risks involved.</tw-passagedata><tw-passagedata pid="122" name="Turn Back" tags="" position="3600,2100" size="100,100">You take a step back, intending to retreat, but as you turn, a strange force grips you. The ground beneath you feels unsteady, as if the very fabric of reality is resisting your choice. You glance back at the glowing path, which now seems to pulse more insistently, urging you to move forward.

A moment of panic washes over you. It’s as if the alley itself is holding you in place, refusing to let you leave.

[[Attempt to Break Free]] — You struggle against the unseen force, determined to regain control.

[[Reluctantly Move Forward-&gt;Step onto the Glowing Path]] — Realizing you may have no choice, you step onto the glowing path, curiosity overcoming your fear.</tw-passagedata><tw-passagedata pid="123" name="Offer to Help Him" tags="" position="2575,2600" size="100,100">You can see the passion igniting in him; his eyes shine with a new light, the fear that once clouded his expression replaced by a flicker of hope and determination. He speaks with an intensity that draws you in, and you feel a sense of purpose growing within yourself as well.

“Let’s move quickly,” he urges, glancing around as if sensing unseen dangers lurking in the shadows. “We can’t afford to linger here too long.”

The swirling landscape around you shifts ominously, colors blending in a chaotic dance that feels alive. You share a look of understanding, the urgency of the moment pressing against both of you. Together, you step into the unknown, ready to navigate the labyrinth of uncertainty.

As you begin to traverse the uneven ground, the air crackles with energy, sending shivers down your spine. You keep close to the scientist, who leads the way, his pace quickening with each stride. He occasionally pauses to check his notes, eyes darting as he searches for signs of stability in the chaos.

[[Follow His Lead]] — You let him take the lead as you both head toward the less volatile section he mentioned.

[[Ask for More Details]] — You want to clarify his plan further before proceeding.</tw-passagedata><tw-passagedata pid="124" name="Express Doubts" tags="" position="2800,2500" size="100,100">You hesitate, the weight of the moment pressing down on you. “I don’t know, this is all a bit overwhelming. How can I trust you? We’ve just met, and this place… it feels dangerous.”

The scientist’s expression shifts from hope to desperation, his features tightening as he senses your reluctance. “Please, you have to understand! I didn’t intend to end up here, and I’m not a threat. I just want to find a way back home. This place is unpredictable; I’ve seen things… terrible things,” he says, his voice trembling slightly. “There are energies here that can manipulate reality, create illusions, and I’ve had to survive in the midst of chaos. If we work together, we might stand a chance. Alone, I’m just a target.”

He runs a hand through his hair again, visibly shaken as memories flash across his face—shadows of encounters he’s had in this dimension, moments of terror etched into his mind. “I promise I won’t put you in harm’s way. I just need someone to help me think clearly. I can’t do this alone. I know that now.”

The urgency in his tone pulls at your heartstrings, making you reconsider your doubts. You look into his eyes, searching for signs of deception, but all you find is sincerity mixed with fear. The swirling patterns of the landscape seem to echo his emotions, shifting and undulating as if they reflect the turmoil within him.

“Look,” he continues, voice steadier now. “I know this is a lot to take in, but you’re here, and that’s something. We can figure it out—there’s more to this place than meets the eye. If you’re willing to join me, we might just uncover the answers we need.”

You can feel the gravity of the situation weighing on you, and the choice looms before you like a glowing path in the darkness.

[[Offer to Help Him]] — You decide to put your concerns aside and join forces with him.

[[Ask More Questions]] — You want to know more about his experiences in this realm before making a decision.

[[Walk Away]] — You decide it’s best to leave him behind and seek your own way out.</tw-passagedata><tw-passagedata pid="125" name="Ask More Questions" tags="" position="2800,2600" size="100,100">You take a moment to collect your thoughts, feeling the weight of the decision before you. The scientist’s desperation resonates with something deep inside you. “Alright,” you say, your voice firm but gentle. “I’ll help you, but first, I need to know more about what you’ve experienced here. What exactly are we up against?”

His eyes widen with gratitude, and he takes a breath, steadying himself. “Thank you! The entity that lurks in this realm is not just a mindless force; it’s cunning and manipulative. It preys on fears and weaknesses. I’ve seen it twist reality and warp the minds of those who get too close.”

He gestures to the swirling patterns around you. “These anomalies can be used to our advantage if we understand them. I’ve been trying to chart the landscape, looking for anchor points where the chaos stabilizes. But I haven’t found one yet, and time is running out.”

As he speaks, you can sense the urgency in his words, the weight of his experience pressing on him. “I’ve been alone for too long. If we work together, I believe we can find a way out. But we must remain vigilant; the entity won’t let us escape easily.”

[[Offer to Help Him]] — You decide to join forces with him and search for a way out together.

[[Walk Away]] — You decide it’s best to leave him behind and seek your own way out.</tw-passagedata><tw-passagedata pid="126" name="Walk Away" tags="" position="3000,2600" size="100,100">s you step back, the scientist’s face crumples in despair. Tears glisten in his eyes, and his voice breaks as he pleads, “Please… I’ve been lost in this chaos for so long. I’ve seen too many things that can’t be unseen. I’m terrified of what might happen if I’m left here alone. I just want to go home!”

His vulnerability catches you off guard, and a wave of sympathy washes over you. It’s hard to turn away from someone in such distress, especially when you can see how genuinely afraid he is. The trembling in his hands, the way he shifts his weight from one foot to the other, it all speaks to the desperation he feels.

You look around at the swirling, chaotic landscape that surrounds you both—shadows dancing at the edges of your vision, strange sounds echoing in the distance. The weight of the unknown presses down on you, and the thought of navigating this perilous realm alone feels daunting.

You stand there, torn between your instincts and the emotion laid bare before you. The scientist&#39;s anguish pulls at something deep inside you, a sense of empathy that feels almost instinctual. Memories of your own fears bubble to the surface: the times you felt isolated, lost, and powerless. You know what it’s like to be afraid of the dark, to feel utterly alone.

But still, doubt lingers in the back of your mind. Can you truly trust him? What if helping him only leads you deeper into danger? You take a moment to breathe, weighing the risks.

His eyes remain fixed on you, searching for a glimmer of hope. “I wouldn’t ask if I had any other choice,” he murmurs, his voice cracking again. “I’m not asking for much—just a chance to find my way home. Together, we could make it out.”
[[Offer to Help Him]] — You choose to comfort him and agree to help, feeling that everyone deserves a chance.

[[Ask for a Plan]] — You still have your reservations and want to know how he plans to escape before committing.

[[Leave Him Behind]] — You decide that you can’t risk getting involved and turn to find your own way out.</tw-passagedata><tw-passagedata pid="127" name="Leave Him Behind" tags="Ending" position="3125,2700" size="100,100">You turn away from the scientist, your heart heavy with doubt. The sound of his sobs echoes in the air, a haunting melody of despair as you walk back toward where you came from. Each step feels like a weight dragging you down, the gravity of your choice pressing against your chest. The world around you blurs, and the amulet suddenly pulses with light, a brief flash illuminating the darkness before everything fades.

In an instant, you find yourself back in the alleyway, the shop gone, the scientist’s desperate pleas fading into memory. The last thing you hear is a desperate, broken voice—“I’m sorry, please don’t leave me. I didn’t mean to—” The words linger in the air, echoing in your mind like a haunting refrain.

A sinking feeling settles in your stomach as you realize the weight of your choice. You can’t shake the feeling that you’ve made a terrible mistake, leaving someone in need behind in a realm of chaos. The echoes of his vulnerability tug at your conscience, and regret curls tightly around your heart.

As you stand alone in the cold, dim light, questions flood your mind. What might have happened if you had chosen to help him? What dangers does he now face alone? You can almost see him, standing amidst the swirling shadows, feeling abandoned and terrified. The unsettling reality of your decision hangs heavy in the air, a haunting reminder of the path not taken.

You walk slowly down the empty street, each footfall a reminder of the weight of your choice. The chill of the night seeps into your bones, amplifying your sense of isolation. The world feels distant, muted, as if the very air is thick with sorrow. The vibrant colors of the amulet seem dimmer now, its glow a pale echo of the hope you once felt.

The thought of him lost in that chaotic realm, facing unspeakable horrors alone, gnaws at you. You replay his desperate expression in your mind, the sincerity in his voice, the way he seemed to crumble under the weight of his fear. “What if I could have helped him?” you whisper to the shadows. But there’s no answer, only the oppressive silence of your surroundings, amplifying your regret.

You realize, then, that some choices reverberate beyond their moment, echoing into the vast unknown. And in that realization, a deep sense of sorrow settles within you, intertwining with the remnants of hope you once held. The weight of your decision feels heavier, as if it carries the burden of the unknown fates he may now endure. You begin to remember the warning signs you had dismissed, the unease that had flickered in the back of your mind before you turned away.

What had you forgotten? The flicker of danger in his eyes when he spoke of the energies that twisted reality, the urgency in his plea that had struck a chord deep within you. The night stretches on, and you walk alone, the path behind you shrouded in darkness. The shadows seem to stretch and deepen, mirroring the despair settling in your heart. You feel as though you’ve left a piece of yourself behind, a fragment tethered to the chaos from which you fled.

With each step, the distance from that moment grows, but the ache remains, echoing in the silence. You ponder the choices still ahead, the possibility of redemption or perhaps a second chance to make things right. But for now, you are left to grapple with the weight of what could have been, as the night envelops you in its cold embrace.
[[Start]] </tw-passagedata><tw-passagedata pid="128" name="Ask for a Plan" tags="" position="2850,2750" size="100,100">You pause, taking a breath to steady your racing thoughts. “Wait,” you say, turning back to the scientist. “Before I decide anything, I want to understand more about what you’ve been through. What exactly happened to you here?”

He wipes his eyes, trying to regain some composure. “It’s… it’s complicated. When I first arrived, I thought I could study the anomaly and gather data. But the moment I stepped through the portal, I realized it was more than I expected. The landscape shifts constantly, and the entity that controls it feeds on fear and despair. I’ve seen things that defy explanation.”

You nod, sensing the weight of his words. “What else? Have you encountered this entity?”

“Yes,” he replies, his voice trembling slightly. “It can manipulate reality, creating illusions that prey on your deepest fears. It’s relentless. I tried to escape, but the more I resist, the stronger it becomes. I’ve been running and hiding, searching for a way back home, but I feel like I’m losing my grip on reality.”

His eyes lock onto yours, filled with urgency. “I need someone to help me decipher the patterns, to figure out how to defeat it or at least distract it long enough to escape. Together, we might stand a chance.”

You weigh his words carefully. There’s a mix of desperation and genuine need in his plea, and the choice before you feels monumental.

[[Agree to Help Him-&gt;Offer to Help Him]] — You feel compelled to join him in this fight against the entity.

[[Decline and Leave-&gt;Leave Him Behind]] — You’ve heard enough and choose to part ways, prioritizing your own safety.</tw-passagedata><tw-passagedata pid="129" name="Follow His Lead" tags="" position="2700,2900" size="100,100">You nod, ready to follow his lead. “Okay, let’s find this anchor point together.”

The scientist&#39;s face lights up with a mix of relief and determination. “Thank you! This will make all the difference.” He gestures for you to follow as he begins moving cautiously through the shifting landscape.

As you navigate the surreal terrain, the environment pulsates with energy, and the air feels charged with potential. The scientist points out features that could indicate a nearby anchor point—patterns in the ground, subtle shifts in the colors around you.

After a while, you come across a clearing where the ground is smoother, and a faint glow pulses from a cluster of unusual stones arranged in a circle. The symbols etched into the stones shimmer slightly, matching the descriptions he provided.

“This has to be it!” he exclaims, his eyes wide with excitement. “If we can harness the energy from these stones, we might be able to open a portal.”

Just as he begins to approach the stones, a chilling wind sweeps through the clearing, and the glow intensifies, casting eerie shadows all around you. You both feel a shift in the atmosphere, as if something is awakening in the darkness.

[[Approach the Stones]] — You decide to move closer to the stones, feeling a pull toward their energy.

[[Step Back and Assess the Area]] — You hesitate, sensing that something is off, and want to check the surroundings for any potential threats.

[[Encourage the Scientist to Proceed]] — You urge him to go ahead while you keep a watchful eye on the area.</tw-passagedata><tw-passagedata pid="130" name="Ask for More Details" tags="" position="2700,2800" size="100,100">ou pause for a moment, wanting to clarify his plan before diving in. “Can you explain a bit more about these anchor points? What exactly are we looking for?”

The scientist nods, grateful for your cautious approach. “Right. Anchor points are stable locations within this chaotic realm. They act like beacons, allowing us to connect with our own dimension. If we can find one, we can potentially create a temporary portal to escape.”

He runs a hand through his hair, collecting his thoughts. “I’ve noticed that anchor points often have unique symbols or patterns associated with them. They might glow or have a specific energy that sets them apart from the surrounding chaos. Once we find one, we can use it to amplify the energy of the portal I was trying to create earlier.”

His excitement is palpable, but there’s also a trace of anxiety in his voice. “But we need to be careful. The area around anchor points can be unpredictable, and we might encounter dangers. We have to stay alert.”

You nod, feeling more informed and prepared for what lies ahead. “So, we’re looking for something that stands out visually, something that feels different?”

“Exactly,” he replies, his eyes brightening. “We’ll need to rely on both our instincts and observation. The anchor points might have a calming effect in the midst of all this chaos. If we can sense that, we’re likely getting close.”

[[Follow His Lead]] — You let him take the lead as you both head toward the less volatile section he mentioned.
</tw-passagedata><tw-passagedata pid="131" name="Approach the Stones" tags="" position="2400,3300" size="100,100">Feeling an undeniable pull toward the glowing stones, you step forward. “Let’s see what they can do,” you say, your curiosity igniting as you draw closer. The energy emanating from the stones vibrates in the air, a hum that resonates with something deep inside you.

As you approach, the symbols etched into the stones shimmer and pulse with a rhythm that feels almost alive. The scientist moves beside you, his excitement palpable. “This is incredible! If we can tap into this energy, it could help us navigate back home.”

Suddenly, the chilling wind swells, swirling around you, and you hear a distant, echoing voice whispering through the shadows. “You dare to disturb my domain?”

The atmosphere thickens, and the glow from the stones flickers uncertainly. The shadows around you deepen, coiling like serpents. You exchange a glance with the scientist, and the urgency of the moment becomes clear.
[[Touch the Stones]]: You decide to reach out and touch the stones, hoping to connect with their energy.</tw-passagedata><tw-passagedata pid="132" name="Step Back and Assess the Area" tags="" position="2700,3000" size="100,100">You take a cautious step back, feeling the weight of something lurking just beyond the edges of the clearing. “Wait,” you say, raising a hand. “Something feels off.”

The scientist looks at you, confusion flickering in his eyes. “What do you mean?”

You scan the surroundings, focusing on the shadows that stretch and twist in unnatural ways. The wind howls again, a low, haunting sound that sends a chill down your spine. “I don’t know. Just… something’s not right.”

As you watch, the shadows seem to shift, coalescing into a form that makes your heart race. The air thickens, and you can almost hear whispers carried by the wind—echoes of something ancient and powerful.

“Maybe we should go back,” you suggest, glancing at the scientist. But he shakes his head, a mix of fear and determination in his eyes.

“No, this is important! We need to understand these stones!”

Before you can respond, a sudden gust of wind sweeps through the clearing, extinguishing the faint glow from the stones. In the dim light, the entity&#39;s voice reverberates through the clearing. “You tread in my domain. Leave now, or suffer the consequences!”

Your heart races as you realize you may have attracted its attention.

[[Defend the Scientist]]: You step in front of him, ready to confront whatever comes next.</tw-passagedata><tw-passagedata pid="133" name="Encourage the Scientist to Proceed" tags="" position="2600,3000" size="100,100">You encourage the scientist, saying, “Go ahead, I’ll keep an eye on things.” He looks back at you, appreciation shining in his eyes, and steps closer to the glowing stones.

As he begins to examine the symbols, you scan the area, feeling a sense of unease creeping in. The wind howls softly, and the shadows seem to elongate, shifting in ways that make your instincts alert.

“Look at these markings,” the scientist calls, excitement creeping into his voice. “They’re incredibly intricate. If I can just—”

Suddenly, a low rumble echoes from the shadows, and you feel the ground tremble beneath your feet. The energy from the stones fluctuates, and you see the glow pulse erratically.

“Get back!” you shout, instinctively stepping in front of him. The shadows coalesce, forming a menacing shape that seems to pulse with anger.

The scientist stumbles back, fear flashing across his face. “I didn’t think—”

Just then, the entity’s voice reverberates through the clearing, a deep, echoing sound that sends chills down your spine. “You dare to tamper with my domain?”

The atmosphere thickens with tension as you both brace yourselves for whatever comes next.
[[Stand Your Ground]] — You decide to confront the entity directly, ready to defend the scientist and the stones.

[[Help the Scientist Focus on the Stones]] — You urge him to concentrate on the stones, hoping their energy can fend off the entity.</tw-passagedata><tw-passagedata pid="134" name="Stand Your Ground" tags="" position="2800,3000" size="100,100">You shout to the scientist, “Focus on the stones! Their energy might be the key to pushing it back!”

He nods, quickly gathering his wits, and steps closer to the glowing symbols. You can see the determination building in him as he raises his hands, feeling the vibrations radiating from the stones. “I think I can channel this energy, but I’ll need your help!”

You glance back at the swirling shadows, the entity&#39;s presence growing more menacing. “What do you need me to do?”

“Keep it distracted! I can amplify the stones’ power, but I need to concentrate. Keep talking to it or provoke it somehow!”

With a deep breath, you turn your attention to the entity, summoning your courage. “You think you can scare us? We won’t let you control this place any longer!”

The entity roars, and the shadows flicker as if momentarily stunned. “You are mere mortals! You cannot comprehend the forces at play here!”

As you keep it engaged, you notice the scientist’s brow furrow in concentration, the glow of the stones intensifying. You hear him mumbling under his breath, his hands weaving intricate gestures.

The energy in the air shifts, and the shadows begin to quiver. “What are you doing?” you demand, trying to maintain the entity’s focus on you.

“Just a little more,” the scientist replies, sweat beading on his forehead. “I need to channel the energy toward it!”

As the glowing symbols pulse brighter, the shadows writhe in agitation.


[[Keep Distracting the Entity]] — You keep taunting and provoking the entity, determined to keep it focused on you.

[[Help Amplify the Energy]] — You join the scientist in channeling energy toward the entity, believing that unity might give you the strength needed.</tw-passagedata><tw-passagedata pid="135" name="Help the Scientist Focus on the Stones" tags="" position="2600,3100" size="100,100">“Focus on the stones! They might be the key!” you shout, trying to cut through the tension. The scientist looks startled for a moment but nods, determination taking over his fear. He steps closer to the glowing symbols, his fingers trembling with excitement.

As he begins to trace the intricate markings, you keep your gaze fixed on the entity, ready to defend him at a moment’s notice. The shadows writhe, but you stand firm, channeling your own resolve into the atmosphere.

“Your actions disturb the balance,” the entity growls, its voice resonating like thunder. “You cannot hope to comprehend my domain!”

Ignoring its threat, the scientist murmurs to himself, his voice blending with the pulsing energy of the stones. “These symbols… they resonate with power. If I can just align them…”

The ground beneath you continues to tremble, and the entity shifts closer, its form growing darker and more defined. Just as panic begins to seep in, the stones flare brightly, responding to the scientist&#39;s focus.

“Almost there!” he exclaims, and you see the colors of the symbols intertwining, creating a beautiful, chaotic dance of light.

Suddenly, the entity roars, its fury palpable. “You will regret this intrusion!”

You take a deep breath, ready to face whatever happens next as the stones pulse stronger, fueling the scientist&#39;s work.
[[Defend the Scientist]]: You prepare to confront the entity directly, willing to buy him time.</tw-passagedata><tw-passagedata pid="136" name="Keep Distracting the Entity" tags="" position="2800,3100" size="100,100">You keep your focus on the entity, your voice steady as you taunt it. “You think you’re powerful, but you’re just a shadow. We’re not afraid of you!”

The entity roars in anger, its form twisting in fury. “You cannot comprehend the forces you’re dealing with! I will consume you both!”

As you continue to distract it, you catch a glimpse of the scientist behind you, his face alight with determination. The glowing symbols begin to hum, resonating with the energy you’re helping to amplify. The air crackles around you as the stones pulse with power.

“Almost there!” the scientist shouts, sweat glistening on his brow. The ground shakes as the stones’ energy builds, and a bright light bursts forth, illuminating the darkened chamber.

The shadows recoil, their sinister forms writhing as the energy intensifies. You can feel the weight of the entity’s anger pressing down on you, but you hold your ground, continuing to provoke it. “Is this all you’ve got? You’re nothing but a fading echo!”

With a final surge, the stones erupt in a blinding flash, sending a wave of energy cascading toward the entity. The shadows screech in protest, and for a moment, time seems to freeze. The entity’s form flickers and contorts as the power strikes it.

“Now!” the scientist yells. “We need to channel everything we have!”
[[Help Amplify the Energy]] — You join the scientist in channeling energy toward the entity, believing that unity might give you the strength needed.</tw-passagedata><tw-passagedata pid="137" name="Help Amplify the Energy" tags="" position="2950,3125" size="100,100">You lock eyes with the scientist, and together you focus your energy on the stones, channeling every ounce of determination you possess. The symbols blaze brighter, and a harmonious vibration fills the air, resonating with your collective will.

“Keep pushing!” the scientist urges, his voice steady amidst the chaos. You feel the energy coursing through you, igniting a fire of resolve. The glowing stones pulsate rhythmically, creating a barrier against the entity’s wrath.

The shadows convulse as your combined strength takes hold, the light expanding outward. You can see the entity’s form wavering, its power diminishing as it thrashes against the radiant force you’ve unleashed.

“Don’t let up!” you shout, feeling a surge of adrenaline. With each pulse of energy, the entity shrieks in fury, its dark tendrils retreating from the brilliant light.

Suddenly, a blinding flash erupts from the stones, and the entity lets out a final, desperate roar before being engulfed in the radiance. The oppressive darkness shatters, fragments scattering like ash in the wind.

As the light subsides, the chamber is transformed. The shadows that once loomed large have dissipated, and you and the scientist stand amidst a serene, luminous landscape. The danger has passed, and a sense of peace settles over the space.

“I can’t believe it worked,” the scientist breathes, awe evident in his eyes. “We did it!”

Relief washes over you, but lingering questions remain. You turn to the scientist, ready to explore this new reality together.
[[Search for an Exit]] — You think it might be wise to find a way back home while you can.

[[Ask About His Experiences]] — You want to learn more about what he’s been through and the knowledge he’s gained.</tw-passagedata><tw-passagedata pid="138" name="Search for an Exit" tags="" position="3000,3300" size="100,100">You decide that finding a way back home should be your priority. “Let’s focus on searching for an exit while we can,” you say, glancing around at the shifting landscape.

The scientist nods, his expression shifting to one of determination. “There are areas I’ve explored that might lead us to a portal or a pathway back to the other dimension. We need to be cautious, though. This place can be deceptive.”

You begin to navigate through the eerie terrain, your senses heightened. Shadows flicker at the edges of your vision, and the air hums with a strange energy. As you walk, you keep an eye out for anything that resembles a pathway or an exit point.

After a few moments of searching, you spot a faint shimmer in the distance. It looks like a doorway, surrounded by a series of swirling patterns that almost seem to pulse with life.

“Over there!” you exclaim, pointing it out to the scientist.

He squints in the direction you’re indicating, a glimmer of hope in his eyes. “That could be it. But we need to approach carefully.”

As you get closer, the shimmer intensifies, revealing intricate designs etched into the doorway, glowing softly against the chaotic backdrop. It feels like something significant, a potential way out of this nightmare.

[[Step Through the Doorway Together]] — You cautiously move closer, intrigued by what lies beyond.

[[Discuss with the Scientist-&gt;_talk]] — You want to hear his thoughts on the doorway before making any decisions.</tw-passagedata><tw-passagedata pid="139" name="Ask About His Experiences" tags="" position="3100,3150" size="100,100">You nod, feeling the weight of his experiences pressing down on both of you. “So, what do we do now? We need to find a way back home,” you say, trying to keep the tone light despite the gravity of the situation.

The scientist glances around, his expression distant. “I… I don’t really know. I’ve been trapped here for so long, I lost sight of what I was doing. This place… it changes you. I tried to gather data, but all I found were horrors. I thought I could control it, but…”

His voice trails off, haunted by memories that flicker behind his eyes. You can see the toll it has taken on him—how the chaos of this dimension has seeped into his very being.

“Let’s focus on finding a way out,” you suggest, hoping to anchor him in the present. “You mentioned there might be pathways or something? Maybe we can find one.”

He nods slowly, as if the idea is just beginning to take root. “There are some routes I’ve mapped out in my mind, but… they’re dangerous. I can’t guarantee safety.”

You can sense the hesitation in his voice, but you also feel a flicker of determination. “We’ve faced something terrible together already. I think we can handle whatever comes next.”

The scientist takes a deep breath, his resolve hardening. “Alright. Let’s explore. We need to stay close, and I’ll guide you as best I can.”

With that, you set off together, stepping into the unknown once more, the promise of escape pushing you forward.

[[Search for an Exit]] — You think it might be wise to find a way back home while you can.</tw-passagedata><tw-passagedata pid="140" name="_talk" tags="" position="3300,3400" size="100,100">You turn to the scientist, gauging his reaction as you approach the shimmering doorway. “What do you think? Is this the way out?”

He steps closer, his eyes wide with a mixture of hope and dread. “It certainly appears to be a portal… but I can’t shake the fear that it might not be safe. The last time I stepped through something like this, I ended up here.” His voice trembles slightly, and you can see the anxiety etched on his face.

“Do you think it’s worth the risk?” you ask, trying to gauge his comfort level.

He hesitates, looking back at the chaotic landscape behind you. “I… I believe this is our best chance, but I can’t guarantee what will happen on the other side. The anomalies here are unpredictable.”

You feel the weight of his uncertainty and the gravity of the decision ahead. The glow of the doorway pulsates, beckoning you both closer, but the unknown looms large. 

Taking a deep breath, you weigh the options in your mind. The chaotic landscape is fraught with danger, but stepping through the portal could lead to safety—or at least a new path to explore. You glance back at him, hoping to find a spark of confidence in his expression.

“Whatever happens, we face it together,” you reassure him, determined to keep the fear at bay. His eyes meet yours, and for a moment, the tension in the air lessens, replaced by a shared resolve.

“Right,” he replies, his voice steadier now. “Together.” 

With a nod, you both step closer to the glowing doorway, ready to embrace whatever lies ahead. The hum of energy intensifies, filling the air with an electric anticipation. As you prepare to leap into the unknown, you can&#39;t help but feel that this moment is a turning point—a chance to reclaim your ~~//self//~~.

[[Step Through the Doorway Together]] — You decide to take the risk and step through, trusting in the potential for escape.

[[Encourage the Scientist]] — You reassure him that you can face whatever lies beyond together, bolstering his courage.</tw-passagedata><tw-passagedata pid="141" name="Step Through the Doorway Together" tags="Ending" position="3100,3500" size="100,100">You take a deep breath, feeling the energy of the doorway pulling you in. “We can do this,” you say, your voice steady. “Whatever awaits us on the other side, we’ll face it together.”

The scientist nods, though you can see the flicker of fear in his eyes. “You’re right. If we stick together, we’ll find a way through.”

With a shared glance of determination, you both step closer to the shimmering portal. The light envelops you, warm and inviting, and as you reach out, you can feel the hum of energy vibrating through your fingertips.

“On three?” you suggest, trying to keep the mood light despite the tension. He nods, swallowing hard.

“One… two… three!”

In unison, you leap forward, crossing the threshold of the glowing doorway. The world around you blurs into a whirl of colors, sensations cascading over you like a wave. For a moment, everything feels disjointed, as if time and space are bending around you.

Then, with a sudden jolt, you land on solid ground. You blink against the brightness, taking in your new surroundings. The air is fresh, filled with the scent of blooming flowers and rich earth. Lush greenery stretches out before you, vibrant colors painting a landscape unlike anything you’ve ever seen.

The scientist gasps, his awe evident as he surveys the scene. “We… we made it!” He laughs, the sound ringing with pure joy. His excitement is infectious, and you can’t help but smile at the beauty around you.

Together, you look out over this new world, feeling a mix of relief and excitement. The challenges you faced have only strengthened your bond, and the mysteries of this dimension beckon you forward.

“What do you think we should explore first, partner?” he asks, his eyes sparkling with enthusiasm. You raise an eyebrow, questioning him on that term. He stutters slightly, a flicker of devastation crossing his face before he quickly tries to regain his cheer.

“Oh, uh, I just meant… you know, as in, um, someone who’s working with me on this,” he stammers, his smile wavering. “It’s just a term, really! Anyway, what do you think we should check out first?”

He shifts the conversation, but you can still sense the lingering tension in the air. You take a moment to consider his words, feeling the weight of the moment. Despite the awkwardness, there&#39;s an undeniable bond forming between you both, and you can’t help but feel excited about the journey ahead.

Yet, in the back of your mind, a nagging thought persists—had you forgotten something important? The feeling tugs at you, a whisper of unease that something crucial is missing from this picture. You shake it off for now, focusing on the vibrant world around you and the potential adventures that await. But that lingering doubt hangs in the air, a reminder that there’s more to uncover.
[[Start]] </tw-passagedata><tw-passagedata pid="142" name="Encourage the Scientist" tags="" position="3400,3500" size="100,100">You place a hand on the scientist&#39;s shoulder, looking him in the eye. “We’ve come this far together. Whatever lies beyond this doorway, we can handle it as a team. You’re not alone anymore.”

His expression softens slightly, revealing the weight of his burdens. There’s a flicker of hope in his gaze, but it’s overshadowed by a deep-seated insecurity. “You’re right,” he replies, his voice quivering as if he’s afraid to believe it. “We’ve already faced so much. If we can confront those horrors, we can surely face whatever comes next.”

With a hesitant nod, he steps closer to the glowing portal, his hands trembling slightly. “Let’s do this. Together,” he murmurs, though you can hear the faint tremor of doubt beneath his words.

You both take a deep breath and step forward, hand in hand, crossing the threshold of the shimmering doorway. The moment you do, a rush of energy engulfs you, and the chaotic landscape around you begins to swirl and blur.

As the world distorts, you hold onto the scientist, feeling the warmth of his presence beside you. The sensation is dizzying, and you brace yourself for whatever awaits.

Suddenly, the world snaps back into focus, and you find yourselves standing in a serene meadow bathed in golden sunlight. The air is fresh, and the sounds of nature fill your ears, a stark contrast to the horrors you’ve just escaped. It feels almost too good to be true.

“Is this… home?” the scientist whispers, glancing around in disbelief. His eyes dart from the flowers to the sky, an expression of longing mixed with confusion crossing his features.

You look around, feeling a sense of peace wash over you, but there’s something unsettling about the way he holds himself—so small, almost fragile in this vast expanse. You feel a twinge of familiarity, as if you’ve seen this side of him before, a shadow of a man burdened by his past.
He looks at you, his eyes wide with vulnerability, waiting for you to remember something  important. The longing in his gaze is palpable, and the urge to comfort him grows stronger, even as you can’t quite place why.

“It’s beautiful here,” you say, trying to fill the silence, to ground both of you in this moment of peace. “We made it through together.”

[[Ask the Scientist About This Place]] — You turn to the scientist, eager to hear if he recognizes where you’ve ended up and what it might mean for both of you.</tw-passagedata><tw-passagedata pid="143" name="Ask the Scientist About This Place" tags="" position="3400,3600" size="100,100">The scientist’s eyes widen as he takes in the meadow. “I know this place! It’s just a few miles from the city—our lab is not far from here!”

Excitement and disbelief mingle in his expression as he begins to pace. “I never thought I’d see this spot again. This is where I first began my research on dimensional anomalies. It feels like… like a sign.”

You take a moment to absorb the significance of this location. It’s familiar to you, too—a place you’d often visited for peace and quiet away from the bustle of the city. But now, it carries a weight of memories, trials faced, and the bond forged between you and the scientist.

“What does it mean?” you ask, curiosity sparking within you.

“It could mean we’re safe… at least for now,” he replies, his voice steadier. “Or it could be a temporary reprieve. We need to stay vigilant; the entity might not be far behind us. But for the first time in a long time, I feel… free.”

He turns to you, gratitude shining in his eyes. “Thank you for helping me find my way back. I wouldn’t have made it without you.”

A warmth spreads in your chest at his words. You’ve both come so far, and this moment feels like a new beginning.

The scientist looks at you, his expression earnest, almost vulnerable. “Would you… would you come with me to my lab? I really don’t want to go alone. I could use your support. It’s been so long since I’ve felt safe, and I don’t want to face whatever’s waiting there by myself.”

You can see the weight of his experiences heavy on his shoulders, and the sense of camaraderie forged in the fires of your shared trials binds you closer. 

“Of course,” you reply, nodding. “We’ll go together.”

Relief floods his face as he gestures for you to lead the way. As you both set off, the meadow feels alive around you—birds chirping, the wind rustling through the grass—contrasting sharply with the chaos you’ve just escaped.

The path to the lab is familiar, and as you walk, he starts to share snippets of his research. His passion ignites as he describes the experiments he conducted before everything went awry. “I’ve gathered data on dimensional rifts and anchor points,” he explains, his eyes lighting up. “But there’s still so much I don’t understand. I’ve always believed there’s a way to stabilize them, to prevent them from becoming a danger.”

His enthusiasm is infectious, and you find yourself intrigued by the possibilities, feeling a connection deepen between you. 

As you approach the lab, a modest building surrounded by overgrown foliage, he pauses, taking a deep breath. “This place has been my refuge, but also my prison. I hope it still holds answers.”

[[Ask About His Research]] — You take a moment to ask more about his research, wanting to understand what he’s been working on.</tw-passagedata><tw-passagedata pid="144" name="Ask About His Research" tags="" position="3400,3700" size="100,100">You pause for a moment, curiosity getting the better of you. “What exactly have you been researching here?” you ask, eager to delve deeper into his experiences and discoveries.

A look of confused devastation flashes across the scientist’s face, almost too quick to notice, before he begins to explain. His eyes light up, a spark of enthusiasm breaking through his earlier apprehension. “We’ve—I&#39;ve been focused on dimensional anomalies, particularly those that manifest as portals. My aim was to understand how they form and whether they could be controlled or stabilized.”

He gestures toward the lab, his voice growing animated. “I’ve documented countless readings and samples. The key lies in the anchor points—specific locations that seem to resonate with the energies of these dimensions. If we can identify and manipulate them, we might be able to create stable passageways instead of chaotic rifts.”

His passion is palpable, and you can see how deeply this work means to him. “But it’s not without risks. I’ve witnessed the consequences of unstable rifts—people getting lost—forgotten.” He glances quickly at you, then away, the weight of his words hanging heavily in the air. “Entire areas becoming uninhabitable. That’s why I need your help. Together, we can gather more data and hopefully find a solution.”

The urgency in his voice strikes a chord within you. You feel the gravity of the situation, recognizing that this is about more than just science; it’s about lives affected by the chaos unleashed by the rifts. His vulnerability, coupled with his determination, draws you in further.
His vulnerability, coupled with his determination, draws you in further.~~// He did always need help, the fool.//~~ It’s a reminder of how far he’s come and the challenges he’s faced alone.

You step closer, feeling the weight of his words. “We can’t let fear dictate our choices. Let’s make sure no one else gets lost or forgotten.”

He nods, the flicker of hope returning to his gaze. “Together, we can change things. I won’t let this happen again.”

With that resolve, you push open the door to the lab, ready to uncover the mysteries within and confront whatever awaits.


[[Enter the Lab]] — You step inside together, eager to see what secrets await.

[[Ask More About the Risks]] — You express your concerns and ask him to elaborate on the dangers involved in his research.</tw-passagedata><tw-passagedata pid="145" name="Enter the Lab" tags="" position="3350,3800" size="100,100">You take a deep breath, steeling yourself for what lies ahead. “Okay, let’s see what you’ve been working on,” you say, stepping into the lab beside the scientist.

The interior is cluttered with papers, strange devices, and flickering screens displaying complex data. The air is filled with the faint hum of machinery, and various tools are scattered across the workbenches. You can tell he’s dedicated a significant amount of time to this place.

“Here,” he says, gesturing to a large screen. “This is where I’ve been compiling my findings on the dimensional anomalies.” He taps a few buttons, and the display shifts to show a map filled with glowing markers, each representing a different anchor point he’s identified.

“This is incredible,” you reply, taking in the data. “But it looks like there are a lot of them. How do we know which ones are stable?”

He nods, clearly excited to explain. “That’s where our analysis comes in. I’ve been tracking fluctuations in energy levels at each point. If we can compare these readings with the anchor points, we might be able to identify which ones are safe to approach.”

As you delve into the data together, the urgency of the situation becomes clear. This is a pivotal moment in both of your lives, and the knowledge you uncover could shape your understanding of these anomalies.

Hours pass as you sift through the information, piecing together patterns and making connections. Just as you feel like you’re on the verge of a breakthrough, the lab’s lights flicker ominously, and the room grows colder.

“What was that?” you ask, glancing around, sensing the atmosphere shift.

The scientist’s expression darkens. “I don’t know, but it’s not good. We should—”

Suddenly, the ground shakes, and the screens around you flash erratically. A low rumble echoes through the lab, sending a shiver down your spine.
[[Stay Calm and Analyze the Data Further]] — You try to remain focused on the data, believing it might hold the key to understanding the disturbance.</tw-passagedata><tw-passagedata pid="146" name="Ask More About the Risks" tags="" position="3450,3800" size="100,100">You furrow your brow, feeling a sense of foreboding as you respond, “What exactly are the risks we’re talking about? You mentioned people getting lost and areas becoming uninhabitable. That sounds serious.”

The scientist nods gravely, his earlier enthusiasm dimming. “Yes, the potential consequences of dimensional instability are severe. When a portal forms, it can draw in everything around it—energy, matter, even people—into the unknown. There have been cases of individuals entering a rift and never returning, or worse, emerging transformed by whatever lay on the other side.”

He runs a hand through his hair, a gesture of frustration and vulnerability. “I’ve seen the aftermath of these incidents. Entire neighborhoods swallowed up, or the land becoming twisted and unrecognizable. That’s why I’m so desperate to understand it all. If I can find a way to stabilize the anchor points, I might prevent further tragedies.”

You can see the weight of his words pressing on him. “But I don’t want to go back in alone. The lab has critical data, but it could also hold dangers. I need someone to help me navigate it.”

You take a moment to digest his words, the reality of the situation settling in. This isn’t just about scientific curiosity anymore; it’s about the safety of everyone involved. You feel a mix of determination and concern for what lies ahead.

[[Offer to Accompany Him-&gt;Enter the Lab]] — You decide to join him in the lab, despite the risks, feeling a sense of solidarity.
[[Express Hesitation]] — You express your concerns more firmly, suggesting you both find a safer way to gather information.</tw-passagedata><tw-passagedata pid="147" name="Express Hesitation" tags="" position="3400,3900" size="100,100">You take a moment to gather your thoughts, feeling the weight of the situation pressing down on you. “I really think we should reconsider this plan. Heading to the lab could be dangerous, especially if we’re not prepared. Maybe there’s a safer way to gather the information we need without putting ourselves at risk.”

The scientist looks at you, uncertainty flickering across his face, almost like a child caught in a lie. “I understand your hesitation,” he admits, his voice trembling slightly. “This place is unpredictable, and I’ve been so focused on getting back that I haven’t thought about the dangers we might face along the way.”

He runs a hand through his disheveled hair, a gesture that makes him look even more vulnerable. “You’re right; I can’t rush into this without a plan. I just… I just don’t want to feel trapped again.” His eyes dart to the ground, shame washing over his features. “I always seem to need you to pull me back from the edge,” he adds, his voice barely above a whisper, a hint of desperation coloring his words. A flicker of confusion crosses your mind before you shake it off.

Taking a deep breath, he visibly wrestles with his fears, the weight of his experiences evident in his slumped shoulders. “Let’s take a step back. We can explore this area first, look for supplies or information that could help us.” He glances at you, desperation in his eyes. “I don’t want to endanger us both. I couldn’t live with any more accidents… I’ve made enough mistakes already.”

Feeling a bit of relief, you nod in agreement, recognizing the truth in his words. You can sense how much he relies on you.
[[Enter the Lab]] — You decide to enter the lab, despite the risks.

[[Return to the city]]—You make the decision to return to the city, feeling that it’s the best course of action for now</tw-passagedata><tw-passagedata pid="148" name="Return to the city" tags="Ending" position="3500,4000" size="100,100">You make the decision to return to the city, feeling that it’s the best course of action for now. “Let’s head back,” you say, determination in your voice. “We can regroup and figure out our next steps from a place that feels safer.”

The scientist nods, a look of relief washing over his features. “You’re right. I’ve been so focused on my lab that I forgot how important it is to have a secure base. Let’s head back to the city.
As you and the scientist make your way back to the city, the path feels different—more purposeful. The chaos of the dimension begins to fade behind you, and a sense of hope stirs within.

As you both draw closer to the city, you can’t shake the feeling that the portal holds more secrets than you initially thought. The scientist seems to sense your contemplation. “I created the portal with the hope of exploring new dimensions,” he explains, his voice steady but tinged with regret. “But I never anticipated the chaos it could unleash. It was meant to be a bridge to knowledge, not a source of danger.”
You glance at him, noting the weight of his words. “What went wrong?” you ask, your curiosity piqued.
He hesitates for a moment, as if choosing his words carefully.  &quot;the entity tricked me said I was its friend that it would help me.&quot; he glances at you with an guilty look &quot;I-- the mistakes I made hurt people.&quot;

The scientist&#39;s admission hangs heavy in the air, and you can see the turmoil within him. “It tricked you?” you echo, trying to process the implications. “How could you trust it?”

“I was desperate,” he replies, his voice barely above a whisper. “I wanted to prove that my work could be beneficial, that I could uncover new frontiers of understanding. When the entity offered assistance, I believed it was genuine. But I didn’t see its true nature until it was too late.”

The guilt etched on his face deepens as he continues. “The mistakes I made didn’t just affect me; they endangered others. The portal… it  effecting things that went in it it made them gone or wrong or...&quot; he trails off quickly looking away from you once more

You can see how deeply this weighs on him, the weight of unintended consequences pressing down. “What do you mean by ‘made them gone or wrong’?” you press gently, wanting to understand the full scope of what he’s dealt with.

The scientist takes a shaky breath, his eyes fixed on the ground as if trying to find the right words. “Anything that entered the portal… it was transformed. Some were altered beyond recognition, others just vanished. It’s like the portal took what it wanted and discarded the rest. I never intended for that to happen. I&#39;m so sorry”
His voice trembles with regret, and you can feel the weight of his sorrow. “You don’t have to apologize,” you reply, your tone steady. he looks oddly crushed from that response. “What matters now is what we do next. We can’t change the past, but we can try to prevent more damage.”

He nods slowly, wiping his brow as if clearing away the burden of guilt. “You’re right. I’ve been consumed by my failures, but I need to focus on how to fix this.”

The city buzzes around you, a stark contrast to the heavy emotions lingering in the air. “Let’s find some resources,” you suggest. “We could look for records about the portal, talk to anyone who might have encountered it, or even seek out experts who can help us understand its effects better.”

“Good plan,” he agrees, a spark of determination rekindling in his eyes. “I think there might be archives at the university nearby. They could have information on similar experiments or phenomena.”
As you walk toward the university, you notice the scientist’s demeanor shifting slightly. His earlier heaviness still lingers, but now there’s a flicker of resolve in his eyes. He walks with more purpose, each step echoing his determination to rectify his mistakes. You couldn’t help but wonder why he seemed to apologize to you specifically. Was it because he felt a sense of responsibility for dragging you into this chaos, or was there something more personal behind his regret? The thought lingered in your mind as you walked beside him, but you shook it off, focusing instead on what lay ahead.

The university loomed closer, its grand architecture a symbol of knowledge and possibility. You took a deep breath, eager to uncover the resources that might help you both confront the entity and the chaos it had unleashed. With each step, the weight of uncertainty began to lift, replaced by a renewed sense of purpose.

As you entered the building, you felt a surge of determination. Whatever the past held, you were ready to face the challenges ahead—together.
[[Start]] 
</tw-passagedata><tw-passagedata pid="149" name="Stay Calm and Analyze the Data Further" tags="" position="3300,3900" size="100,100">You take a deep breath, pushing aside the rising panic. “Let’s stay focused. There has to be something in the data that can explain this,” you say, determined to analyze the readings further.

The scientist nods, his brow furrowed in concentration. Together, you sift through the information displayed on the screens, trying to make sense of the chaotic readings. The trembling grows stronger, and you can feel the floor vibrating beneath your feet.

“Look here,” you say, pointing to a cluster of readings that suddenly spike. “These fluctuations… they correlate with the disturbances we’re feeling.”

The scientist squints at the screen, his expression shifting from fear to realization. “Yes! This could be an indicator of a rift forming nearby. If we can track its source, we might be able to stabilize it before it opens completely.”

The lab shakes again, and you exchange worried glances. “We don’t have much time. How can we track it?” you ask, urgency lacing your voice.

He gestures to a device on the table, a handheld scanner with various dials and lights. “This can help us locate the epicenter of the disturbance. We’ll need to get outside and move quickly.”

Just as you’re about to grab the scanner, another violent tremor hits, knocking some equipment off the tables. The scientist steadies himself against the wall, and you feel the pressure of the moment intensify.

“Are you ready?” he asks, determination returning to his eyes.

[[Grab the Scanner and Head Outside]] — You take the scanner and prepare to face whatever lies beyond.

[[Take a Moment to Collect Yourself]] — You pause for a moment, trying to steady your nerves before making a move.</tw-passagedata><tw-passagedata pid="150" name="Grab the Scanner and Head Outside" tags="" position="3200,4000" size="100,100">You pick up the scanner, its sleek design feeling reassuring in your hands. “Let’s do this,” you say, determination coursing through you.

The scientist gives you an encouraging nod, his expression a mix of anxiety and hope. “Stay close to me. The readings should help us navigate the dangers outside.”

With the scanner activated, you step through the lab&#39;s door and back into the swirling landscape. The air feels charged, and the colors around you pulse with energy. The scanner hums softly, displaying fluctuating readings as you move, guiding you through the chaos.

As you walk, the atmosphere shifts. The strange patterns of light flicker, and the ground beneath your feet vibrates subtly. The scientist glances at the scanner, his eyes widening. “We’re near a potential anchor point. If we can stabilize it, it might lead us somewhere safer.”

You both press forward, the scanner beeping more rapidly as you approach a cluster of shimmering lights. The scientist’s voice is a mix of excitement and apprehension. “This could be the key to understanding the anomalies. Let’s see what we can do.”

You focus on the anchor point, feeling the energy around you. It’s powerful but chaotic, and you know that tampering with it could have unforeseen consequences.

[[Attempt to Stabilize the Anchor Point]] — You decide to use the scanner’s data to try and stabilize the energy here.

[[Document the Readings]] — You choose to take detailed notes on the readings first before attempting any action, ensuring you gather all possible information.</tw-passagedata><tw-passagedata pid="151" name="Take a Moment to Collect Yourself" tags="" position="3300,4000" size="100,100">You take a moment to breathe, allowing the whirlwind of emotions and information to settle. “Before we act, let’s pause and regroup,” you suggest, seeking a moment of clarity.

The scientist nods, grateful for the break. “That sounds wise. This place can be overwhelming. We need to be focused.”

You both step away from the screens for a moment, taking in your surroundings. The lab, cluttered with papers and equipment, feels charged with potential. You close your eyes and visualize the steps ahead—gathering knowledge, preparing for the unknown, and ensuring your safety.

After a few deep breaths, you turn to the scientist. “Let’s reflect on what we know. We have data indicating unstable energy readings, and we need to approach this carefully. It’s about survival first, right?”

He nods, his expression more composed now. “Exactly. I appreciate your perspective. The risks can’t be ignored, especially after what I’ve seen.”

With a renewed sense of purpose, you look at the data again. “Let’s gather any tools or resources that might help us understand what we’re dealing with when we step outside.”

The scientist agrees, and you both begin to sort through the lab, discussing what could be useful. As you gather supplies, you feel a growing sense of readiness to face whatever lies ahead.

[[Grab the Scanner and Head Outside]] — You take the scanner and prepare to face whatever lies beyond.
</tw-passagedata><tw-passagedata pid="152" name="Attempt to Stabilize the Anchor Point" tags="" position="3100,4100" size="100,100">With determination, you decide to take the plunge. “Let’s try to stabilize it. We can’t just leave this energy unchecked.”

The scientist nods, though his eyes reveal a hint of fear. “Alright, I’ll assist you. We’ll need to focus on the frequencies the scanner is picking up. If we can harmonize with the anchor point, we might be able to bring it under control.”

You both approach the anchor point, the energy swirling around you like a tempest. The scientist adjusts the settings on the scanner, and you feel the vibrations intensifying. You concentrate on the readings, tuning into the rhythms of the energy.

As you reach out, the swirling lights begin to respond, pulsating in sync with your movements. It feels like a delicate dance between chaos and order. You focus on the frequencies, channeling your thoughts into the energy.

Suddenly, the lights stabilize, transforming into a serene glow. The ground stops shaking, and a profound silence envelops the area. The anchor point is now steady, its power contained.

The scientist’s eyes widen in disbelief and awe. “We did it! We actually stabilized it!”

You share a moment of triumph, but the victory feels bittersweet. As you step back, a new sense of awareness washes over you, and you realize that this achievement opens doors to further exploration—and perhaps greater dangers.

“What does this mean for us?” you ask, glancing at the scientist.

“It means we have a foothold,” he replies, excitement bubbling in his voice. “We can study this energy and understand how to manipulate it further. But it also means we need to be vigilant. There are always risks involved.”
[[Plan Your Next Steps-._e]] — You and the scientist discuss what to do next, considering the implications of your success.</tw-passagedata><tw-passagedata pid="153" name="Document the Readings" tags="" position="3200,4100" size="100,100">You pull out a notebook and begin documenting the scanner&#39;s readings, carefully noting the fluctuations in energy and the patterns surrounding the anchor point. The scientist watches, a look of approval on his face. “Good thinking. Gathering data now could provide insights for future attempts.”

As you jot down your observations, the atmosphere around you shifts. The shimmering lights flicker with increasing intensity, and you feel the ground tremble beneath your feet. You glance up at the scientist, who is monitoring the scanner closely.

“This energy… it’s unstable,” he says, his voice tinged with concern. “We need to be cautious. If it reacts poorly to our presence, it could spiral out of control.”

You continue documenting, your mind racing with thoughts of the potential risks. Each note you take feels like a thread connecting you to understanding this chaotic realm. After a few moments, you finish and look back at the anchor point, still shimmering enticingly.

“Alright, I think we have enough data. What now?” you ask, glancing at the scientist.

He takes a deep breath. “Now we need to decide whether to attempt to stabilize it or retreat for more research. The choice is yours.”

[[Attempt to Stabilize the Anchor Point]] — You feel ready to take a risk and try to stabilize the energy.</tw-passagedata><tw-passagedata pid="154" name="Plan Your Next Steps-._e" tags="Ending" position="3000,4100" size="100,100">The scientist can hardly contain his excitement. He turns to you, eyes shining with a mix of gratitude and exhilaration, and wraps you in a quick, enthusiastic hug. “We did it! I can’t believe we actually stabilized the anchor point!”

As he pulls away, he begins to talk rapidly, his words tumbling over each other. “This opens up so many possibilities! We can conduct tests, gather data, and learn how to harness this energy. Imagine what we could achieve together! We could even create stable portals—safe ones! It’s everything we’ve dreamed of.”

His passion is infectious, and you feel a rush of hope and determination. “What’s our first step?” you ask, eager to be part of this journey.

He grins, already moving toward the equipment. “We’ll set up a base here, start collecting samples, and monitor the energy fluctuations. And I’ll need your help with the calculations and observations. We can even document everything we discover!”

As you both set to work, the atmosphere buzzes with anticipation. You can’t shake the feeling that you’re on the brink of something extraordinary.

Days turn into weeks as you and the scientist delve deeper into the mysteries of the anchor point. You find yourselves uncovering incredible insights about dimensional energies and their potential. Your bond strengthens as you share triumphs and face challenges side by side.

Eventually, you both stand at the threshold of a newly stabilized portal, ready to step into uncharted territories. With each discovery, you realize that the adventure has just begun. Together, you’re not just researchers; you’re pioneers in a world filled with endless possibilities.

You glance at the scientist, who meets your gaze with a smile full of hope. “Are you ready?” he asks, excitement dancing in his eyes.

“Absolutely,” you reply, feeling the weight of adventure ahead. But just as you prepare to step forward, a nagging sensation creeps into your mind—a whisper of something ~~//forgotten//~~, something important.

You pause, uncertainty flaring momentarily. What was it that you couldn’t quite grasp? The feeling of having overlooked a crucial detail gnaws at you. The scientist, sensing your hesitation, furrows his brow. “Is everything alright?”

You take a moment to collect your thoughts. “I just… feel like there’s something I am missing. Something I should remember.” The scientist looks briefly thrilled at your statement before concern washes over his face. “I’m sure it will all come back to you now that we’re away from that thing and it’s fixed,” he says, forcing a smile that seems rather pained. He quickly shifts the conversation back on track, eager to focus on the discoveries ahead.
 Let’s focus on the portal! This is a huge step forward for us.”

You nod, trying to push aside the nagging feeling. “Right, the portal.” But his eagerness feels a bit forced, and you can’t shake the sense that he’s trying to avoid something deeper.

“Let’s go through the readings one more time,” he suggests, gesturing toward the equipment. “I want to ensure everything is stable before we step through.”

As he dives into the data, you watch him closely, noting the slight tremor in his hands and the way he avoids your gaze. You sense that beneath his excitement lies an undercurrent of fear, perhaps linked to whatever it is that’s itching at the back of your mind.

Still, you push your concerns aside, focusing on the portal ahead. But the feeling that something important has slipped through your fingers lingers, waiting for the right moment to resurface. As the scientist continues his calculations, you wonder if you’re both ready for the adventure that lies beyond—or if there are shadows from your past that still need to be addressed before you take that leap.


[[Start]] </tw-passagedata><tw-passagedata pid="155" name="Defend the Scientist" tags="" position="2700,3200" size="100,100">You instinctively position yourself between the scientist and the advancing entity, fists clenched and heart racing. “You won’t harm him!” you shout, your voice carrying an intensity fueled by desperation and courage.

The entity pauses, its shadowy form momentarily flickering as if taken aback by your defiance. “You are foolish to challenge me,” it replies, voice dripping with contempt. “You know not the forces you meddle with.”

“Maybe so,” you retort, trying to mask the tremor in your voice, “but I won’t let you take him!”

As the entity draws closer, tendrils of darkness lashing out, you feel the air grow heavy with a sinister energy. Just then, the stones flare even brighter, their light intensifying in response to your resolve.

“Now!” you shout to the scientist. “Keep going! We’re almost there!”

He looks up from the markings, determination shining in his eyes. “I can feel it! Just a bit longer!” He returns to his work, fingers dancing over the symbols as they pulse with a rhythmic energy.

The entity roars in frustration, its form shifting and swirling, a cacophony of shadow and sound. You brace yourself for the worst, ready to intercept any attack.

“Your bravery is commendable,” the entity sneers, “but it will lead to your doom.”

As it lunges toward you, the stones erupt with blinding light, illuminating the entire clearing.
[[Keep Distracting the Entity]] — You keep taunting and provoking the entity, determined to keep it focused on you.

[[Help Amplify the Energy]] — You join the scientist in channeling energy toward the entity, believing that unity might give you the strength needed.</tw-passagedata><tw-passagedata pid="156" name="Touch the Stones" tags="" position="2500,3400" size="100,100">As you reach out to touch the stones, a surge of energy courses through you, igniting the air with a brilliant light. The symbols blaze in response, and you feel a connection forming—a bond that transcends the chaos around you.

In an instant, the world around you dissolves into a kaleidoscope of colors and light. You grip the scientist’s arm tightly, a shared pulse of energy drawing you both into the heart of the glowing stones. The sensation is overwhelming, a rush of warmth and power enveloping you as the landscape shifts.

With a sudden jolt, you find yourselves standing in the familiar confines of the shop. The scent of aged wood and faint incense fills the air, and the soft glow of lanterns casts a warm light over the eclectic assortment of items lining the shelves.

The scientist blinks in surprise, looking around as if waking from a dream. “We made it! But how…?”

Before you can respond, the shopkeeper appears, a bemused expression on their face. “Back so soon? I trust your adventure was enlightening?”

The scientist turns to you, excitement mixed with confusion. “Did the amulet… was it really the anchor point?”

You nod, still processing the transition. “It seems like it was. But now what do we do?”

[[Ask the Shopkeeper for Guidance]]: You turn to the shopkeeper, seeking advice on your next steps.

[[Discuss with the Scientist-&gt; make]]: You focus on the scientist, is he alright.</tw-passagedata><tw-passagedata pid="157" name="Ask the Shopkeeper for Guidance" tags="" position="2500,3600" size="100,100">You turn to the shopkeeper, feeling that their knowledge could provide crucial insights. “Do you have any advice on how we should proceed?” you ask, hoping they can guide you through this next stage of your journey.

The shopkeeper nods thoughtfully, leaning against the counter. “The amulet you activated is a powerful artifact, closely linked to the anchor points. To understand its potential, you must explore both its history and the nature of the symbols you encountered.”

The scientist leans in, eager to hear more. “What do we need to look for?”

“Look for texts or artifacts that detail the properties of the anchor points. Each one has unique characteristics that may interact differently with the energies of the amulet. Additionally, consider experimenting with the energy from the stones. Sometimes, hands-on experience yields the best results.”

You exchange glances with the scientist, the excitement of discovery igniting a spark between you. “Thank you! That’s exactly what we needed to hear,” you say.

The shopkeeper smiles. “Just remember, tread carefully. The forces you’re dealing with are powerful and can have unintended consequences.”

With newfound determination, you turn back to the scientist. “Let’s find some resources—books or tools—that will help us understand more about the amulet and those anchor points.”

He nods, and together you begin to search the shop, excitement bubbling between you as you gather the items that will aid your quest.

[[Gather the Book and Tools]]: You decide to collect both the book and the tools, feeling they will aid your research.
</tw-passagedata><tw-passagedata pid="158" name=" make" tags="" position="2625,3500" size="100,100">ou turn to the scientist, concern etched on your face. “Are you alright? That was quite a ride.”

He takes a deep breath, clearly still processing the experience. “I… I think so,” he replies, running a hand through his hair. The movement is almost reflexive, a sign of his lingering tension. “That was more intense than I expected. But we’re back. That’s what matters, right?”

You nod, but you can see the spark of excitement in his eyes alongside the remnants of fear. “What do you think we should do next?” you ask, wanting to ensure he’s fully grounded after the whirlwind of events.

He glances around the shop, taking in the various curiosities that surround you—the odd trinkets, ancient scrolls, and shimmering stones scattered across the tables. “We need to analyze what just happened. The amulet activated something in the anchor point, but we still don’t know how it connects to our original goal of opening a stable portal.”

His expression shifts to one of determination, and you can see the gears turning in his mind. “If we can figure out how the stones work, maybe we can find a way back to that dimension—or at least learn more about what we’re dealing with.”

[[Ask the Shopkeeper for Guidance]]: You turn to the shopkeeper, seeking advice on your next steps.
[[Explore the Shop for Tools]]: Recommend searching the shop for any tools or items that might assist in your research.</tw-passagedata><tw-passagedata pid="159" name="Explore the Shop for Tools" tags="" position="2400,3600" size="100,100">“Let’s see if we can find something in the shop that could help us,” you suggest, scanning the eclectic shelves filled with mysterious items.

The scientist nods, enthusiasm rekindling. “Good idea. There might be tools or artifacts here that relate to what we just experienced.”

You both begin to explore the shop, moving from one shelf to another. The items are varied—old books, strange crystals, and intricate devices that hum faintly with energy. A dusty tome catches your eye, its cover embossed with symbols similar to those you saw on the stones.

“Look at this!” you exclaim, pulling the book from the shelf. The scientist leans closer, examining the title: Anchors of the Multiverse: A Guide to Transdimensional Energies.

“This could contain valuable information about anchor points and how to manipulate their energies,” he says, flipping through the pages. The illustrations of symbols and diagrams seem to dance with potential.

As he studies the book, you continue to scan the shelves, your eyes falling on a set of curious-looking tools—delicate instruments that might assist in crafting or analyzing energy.

“Should we take these too?” you ask, motioning toward the tools.

“Yes! Anything that might help us understand the amulet or the energy from the stones is worth having,” he replies eagerly.

[[Gather the Book and Tools]]: You decide to collect both the book and the tools, feeling they will aid your research.

[[Ask the Shopkeeper for Guidance]]: You turn to the shopkeeper, seeking advice on your next steps.
</tw-passagedata><tw-passagedata pid="160" name="Gather the Book and Tools" tags="Ending" position="2450,3750" size="100,100">You and the scientist gather the book and tools, bringing them to the counter where the shopkeeper smiles knowingly. Your eyes catch on one book in the stack of purchases. The title reads something like “Returning Erased—,” but before you can glimpse the rest, the shopkeeper shifts your focus back to your purchase, closing the transaction with a nod.

After a brief exchange of coins, you head outside, the fresh air a welcome change from the shop&#39;s stuffy interior. The bustling sounds of the street surround you, grounding you in reality, but the glimpse of that book lingers in your mind.

The scientist pauses, a frown crossing his face. “I just realized… I probably don’t have my apartment anymore. I was so focused on my work that I didn’t think about what happened when the dimension collapsed.”

You sense his distress and quickly respond, “You can stay at my place. It’s not much, but it’ll give you a place to work and recover.”

His expression softens, gratitude replacing the worry. “Thank you. I really appreciate it. I didn’t know what I would do otherwise.”

You start walking toward your home, the weight of the recent events settling around you like a heavy cloak. “Let’s figure this out together,” you say, hoping to instill some confidence in him.

“I’m glad I have you by my side,” he replies, a spark of determination igniting in his eyes. “With your help, I believe we can uncover the secrets of those anchor points and find a way to stabilize the portal.”

As you reach your place, you unlock the door, letting him step inside first. The cozy atmosphere feels reassuring, and you know it’s the right choice to have him stay.

You take a deep breath, the weight of the moment settling around you, and decide it’s time to create a strategy. “Let’s outline our approach,” you say, leading the scientist to a comfortable spot at the table where you can spread out the book and tools.

As you both settle in, you feel a surge of hope. “We’ll start by examining the symbols in the book, comparing them to what we saw in the other dimension. If we can understand their meanings, we might unlock the key to stabilizing the portal.”

The scientist nods enthusiastically, flipping through the pages with newfound determination. “And with these tools, we can experiment with the energies we felt. We may even be able to create a stable connection to the anchor point!”

You spend hours poring over the book, discussing theories and ideas. The atmosphere is filled with laughter and excitement as you work together, the bond between you strengthening with each discovery.

Days turn into weeks, and your collaborative efforts begin to bear fruit. You find a way to harness the energy from the stones, developing a new method to stabilize the portal safely.

One evening, after a long day of research, you both stand before the newly constructed portal in your living room, the glow radiating with promise. “Are you ready for this?” the scientist asks, a mix of excitement and apprehension in his eyes.

You nod, a smile spreading across your face. “Together, we can face whatever lies ahead.”

With a shared look of determination, you step through the portal. Instantly, you’re enveloped in vibrant colors and shimmering lights. The new dimension unfolds before you, teeming with adventure and mystery.

“This is amazing!” the scientist exclaims, and you can’t help but share in his joy. You both step forward, ready to explore this new world together, leaving behind the shadows of the past.

As you venture into the unknown, the promise of countless adventures awaits, and you know that no matter what challenges arise, you’ll face them side by side.

And in that moment, surrounded by the brilliance of a vibrant new dimension, you realize that this journey was only the beginning of something truly extraordinary.

[[Start]] </tw-passagedata><tw-passagedata pid="161" name="Attempt to Break Free" tags="" position="3825,2200" size="100,100">You brace yourself and concentrate, feeling the weight of the unseen force pressing against you. With a fierce determination, you dig your heels into the ground, muscles straining as you pull against the invisible grip.

You feel a surge of energy building within you, a flicker of defiance igniting your spirit. With a final push, you wrench yourself free, stumbling back but regaining your footing.

As you break away, the glow of the path flickers momentarily, as if surprised by your resistance. You take a deep breath, your heart racing, and look around for a way out of the alley.

Suddenly, the ground shakes, and you hear a low rumble from deep within the alley. The glowing path shimmers again, but this time it seems to twist and warp, almost as if reacting to your struggle.

[[Explore the Alley]] — You decide to investigate the alley further, searching for a way to escape the strange forces at play.

[[Return to the Sigil]] — You consider going back to the sigil, hoping it might restore your connection to the amulet or provide another means of escape.</tw-passagedata><tw-passagedata pid="162" name="Explore the Alley" tags="" position="3675,2400" size="100,100">You cautiously move deeper into the alley, scanning your surroundings for any signs of escape or hidden secrets. The walls loom high, casting long shadows in the dim light. The air is thick with a sense of urgency, but despite your efforts, you find nothing—no doors, no windows, no clues.

Just as frustration begins to set in, the ground trembles again, more violently this time. You can feel the energy shifting around you, like the very fabric of this place is in flux.

Turning back toward the glowing path, you notice it flickering more intensely, as if it’s trying to communicate with you. The amulet, though cold and lifeless in your hand, feels as if it’s resonating slightly, almost urging you to make a decision.

[[Return to the Glowing Path-&gt;Step onto the Glowing Path]] — You decide to follow the path, hoping it may lead you to answers despite your earlier doubts.

[[Return to the Sigil]] — You consider going back to the sigil, hoping it might restore your connection to the amulet or provide another means of escape.</tw-passagedata><tw-passagedata pid="163" name="Return to the Sigil" tags="" position="4000,2400" size="100,100">You decide that returning to the sigil might be your best chance at understanding the strange forces at play. Turning back, you navigate through the alley, feeling the ground shake beneath you with each step. The atmosphere feels thick, charged with an energy that seems to pulse with your heartbeat.

As you approach the sigil, the dim light from the mural flickers, almost as if it recognizes your presence. You reach out cautiously, placing your hand against the sigil once more. The warmth you felt earlier is absent, replaced by a cold, distant hum.

You focus on the amulet in your hand, willing it to respond. As you press against the sigil, you close your eyes, imagining the connection rekindling.

Suddenly, the sigil glows brighter, and you feel a rush of energy surge through you. The amulet vibrates gently, and for a fleeting moment, you sense a faint echo of the bond you once had. But just as quickly, it fades, leaving you feeling even more unsettled.

[[Channel Your Energy]] — You decide to try and channel whatever energy is flowing through you to see if it can stabilize the amulet.
</tw-passagedata><tw-passagedata pid="164" name="Channel Your Energy" tags="" position="4000,2500" size="100,100">As the wave of light washes over you, you feel a sudden jolt, but the connection you sought remains elusive. The energy flickers, then falters, and with a deep breath, you step back, feeling a mix of disappointment and determination.

In that moment, you glance down at your phone, instinctively checking for any sign of clarity. To your surprise, the coordinates reappear on the screen, pulsing steadily. They feel familiar.
As you look closer at your phone, the coordinates lead unmistakably to the factory. A wave of realization hits you—this is the place where the scientist had been conducting his research, the very site tied to the anomalies you’ve been experiencing.

The bustling city around you fades into the background as the urgency of the moment takes hold. You know you need to get there quickly; perhaps the factory holds the key to understanding the sigils, the amulet, and the strange energies that have been pulling at you.

You set off, your heart racing with a mix of excitement and apprehension. The streets blur past as you navigate through familiar alleys and paths, the coordinates guiding you like a beacon.

Finally, you arrive at the factory&#39;s imposing structure. The large doors stand ajar, inviting yet foreboding, and the air buzzes with a strange energy, hinting at the chaos and mystery within.

[[Enter the Factory]] — You decide to step inside, ready to confront whatever awaits you.

[[Pause to Reflect]] — You take a moment outside to collect your thoughts and gather your resolve before entering.</tw-passagedata><tw-passagedata pid="165" name="Pause to Reflect" tags="" position="4100,2500" size="100,100">You pause at the threshold of the factory, uncertainty creeping in. The imposing structure looms before you, a reminder of the dangers and mysteries that lie within. You can’t shake the feeling that this place is pivotal to everything you’ve encountered—the sigils, the amulet, and the strange forces pulling you through dimensions.

Taking a deep breath, you ask yourself if you truly want to dive into this unknown. What if you uncover something you’re not ready for? Or worse, what if the chaos within is more than you can handle?

As you contemplate, a sense of resolve begins to form. You remind yourself that knowledge and understanding are powerful tools, and facing your fears might lead to the answers you seek.

With your heart steadying, you realize you can’t turn back now. You have to know what lies inside.

[[Enter the Factory]] — You take a determined step forward, ready to confront whatever awaits you.

[[Leave for Now]] — You decide it’s best to gather more information or resources before delving into the factory’s depths.</tw-passagedata><tw-passagedata pid="166" name="Leave for Now" tags="Ending" position="4100,2600" size="100,100">You step back from the factory, a sense of unfinished business weighing heavily on your shoulders. The structure looms behind you, a reminder of the mysteries yet to be uncovered. Despite your decision to hold off, you can’t shake the feeling that something important awaits inside—knowledge that could change everything.

As you walk away, you glance back one last time, the factory’s shadow stretching across the pavement. The buzzing energy you felt earlier still lingers, urging you to return. The thought of leaving it all behind gnaws at you; the sigils, the amulet, and the chaotic forces remain unresolved, and you know that ignoring them won’t make them disappear.

Finding a quiet spot in the city, you pull out your phone, scrolling through everything you’ve gathered so far. The weight of the unknown presses down on you, an omnipresent reminder that this is far from over. You mentally list the unanswered questions, each one adding to the feeling of urgency: What is the true purpose of the factory? What do the sigils mean? How can you restore the amulet’s power?

But there’s also a deeper sense of loss nagging at you—like you’ve forgotten something or ~~//someone//~~ important. You can’t quite put your finger on it, but the feeling lingers, an echo of something just beyond your grasp. The possibility that you’re missing a crucial piece of the puzzle makes your heart race.

You realize that this moment of pause isn’t an end—it’s merely a precursor to a deeper journey. You’ll need to gather more information, allies, and perhaps even confront those who might have answers to your questions. The factory remains a looming presence in your mind, its secrets waiting for the day you return, ready to dive deeper into the mysteries that have entangled your fate.

The adventure is far from over; it’s merely the calm before the storm, and you can’t shake the feeling that the answers you seek—and the forgotten pieces—are closer than you think.
 
 [[Start]] </tw-passagedata><tw-passagedata pid="167" name="Attempt to Tap into the Energy" tags="Ending" position="4100,1600" size="100,100">As you delve deeper, attempting to tap into the mural’s energy, a sudden chill sweeps through the alley. The shimmering images around you twist and darken, and the warmth of the sigils turns cold and unwelcoming. You realize too late that you’ve crossed a boundary you didn’t fully understand.

The pulsations grow frantic, and a dark force erupts from the mural, taking shape before you. The entity, a swirling mass of shadow and light, emerges, its voice echoing in your mind. “I did not think this would be the way I would break into this dimension,” it rumbles, sending waves of dread coursing through you.

As you stare in horror, the entity&#39;s voice echoes in your mind. “He thought I was his friend, but when he found out otherwise and tried to stop me, I took steps to get him out of the way. Good thing you did not find him.”

The chilling laughter reverberates through the alley, drowning you in a wave of dread. The realization of the deception washes over you, and you understand the true danger that has been unleashed.

Before you can react, everything goes black. The last thing you hear is the sinister cackle of the entity, a reminder of the cost of your curiosity and the perils that lie ahead.

You inadvertently facilitated the entity’s entry into your dimension, unleashing its power and losing your chance to confront the mysteries of the factory and the scientist. The darkness envelops you, a testament to the dangers lurking in the unknown.
[[Start]] </tw-passagedata><tw-passagedata pid="168" name="Step Back and Reflect" tags="" position="3600,1700" size="100,100">As you step back, a nagging sense of unease creeps in. Though you’ve glimpsed the swirling energy of the mural and the potential it holds, there’s an unsettling feeling that something is fundamentally off.

The vibrant colors and pulsating sigils now seem to shift in ways that make you question their true nature. Are they merely guides, or do they conceal darker truths? The air around you feels heavy, charged with a tension that makes your instincts flare.

You realize that while you may not fully understand the knowledge you’ve just glimpsed, there’s an undeniable urgency to tread carefully. Whatever force resides within this mural—and the entity it may be linked to—could be more dangerous than you initially thought.

[[Reconsider Your Approach-&gt;Look for Hidden Symbols]] — You decide to step back from the mural entirely, seeking a different perspective or an alternative way to address the situation.

[[Attempt to Tap into the Energy]] — You decide to push deeper, hoping to harness the energy of the mural to reveal more secrets.
</tw-passagedata><tw-passagedata pid="169" name="Inspect the Pedestal" tags="" position="4200,1300" size="100,100">As you step closer to the pedestal, you notice intricate carvings along its surface, hinting at ancient symbols and warnings. The amulet vibrates more intensely, almost as if it’s trying to convey a message.

You lean in, tracing your fingers over the inscriptions, and suddenly a wave of insight washes over you. The symbols imply connections to powerful forces that could be both enlightening and dangerous. You sense that while the amulet can unlock knowledge and pathways, there are also darker elements tied to it—entities or phenomena that could bring chaos if mishandled.

A sense of foreboding settles in your stomach. The energy around you pulses, urging you to be extremely cautious. It seems the very things that can enhance your understanding might also lead to peril.

[[Call Out to the Energy]] — You choose to reach out mentally, attempting to communicate with the energy surrounding you and see if it responds to your presence.

[[Withdraw and Reflect]] — Feeling the weight of the warnings, you choose to step back and contemplate the implications before proceeding further.</tw-passagedata><tw-passagedata pid="170" name="Call Out to the Energy" tags="" position="4300,1300" size="100,100">You take a deep breath and focus your thoughts, reaching out mentally to the energy surrounding the pedestal. You concentrate on your intent, willing the energy to respond to your presence.

For a moment, silence envelops you, and doubt begins to creep in. But just as you start to pull back, a flicker of energy catches your attention—a soft shimmering wave ripples through the air around you. The amulet pulses in rhythm with the energy, and you feel a subtle shift, as if the atmosphere is becoming more alive.

In that moment, whispers echo through your mind—fragments of thoughts and feelings that feel ancient and wise. The energy hints at both guidance and warning, urging you to tread carefully. It suggests that knowledge comes with a price, and while some connections could be beneficial, others could lead to danger.

You sense a deep understanding of the duality of power; the energy conveys the importance of balance and caution.

[[Inspect the Pedestal]] — You decide to examine the pedestal closely, searching for any inscriptions or artifacts that might connect to the amulet and the mural.
[[Withdraw and Reflect]] — Feeling the weight of the warnings, you choose to step back and contemplate the implications before proceeding further.</tw-passagedata><tw-passagedata pid="171" name="Withdraw and Reflect" tags="" position="4250,1450" size="100,100">You take a step back, allowing yourself to breathe and absorb the weight of the warnings conveyed by the energy. The courtyard feels charged, and you sense that the knowledge you’ve uncovered is both a blessing and a burden.

As you retreat a few paces, you reflect on the amulet and the connections it offers. The potential for discovery is tantalizing, but the dangers lurking in the shadows make you cautious. You recall the fleeting images from your earlier vision—the factory, the shopkeeper, and the entity waiting to break through.

It becomes clear that you must tread carefully. The power of the amulet and the energies tied to it could either lead you to profound truths or unleash chaos beyond your control. You contemplate your next steps, weighing your options and considering how best to proceed.

[[Plan Your Next Move]] — You decide to strategize, thinking about how to harness the amulet’s power safely and what precautions to take.

[[Seek a Safe Haven]] — You choose to leave the courtyard for now, seeking a place where you can regroup and gather your thoughts away from the immediate tension.</tw-passagedata><tw-passagedata pid="172" name="Plan Your Next Move" tags="" position="3700,1500" size="100,100">You take a moment to gather your thoughts, planning your next move with care. You know that to harness the amulet&#39;s power safely, you’ll need to be strategic and prepared.

You consider the information you’ve encountered: the mural, the warnings from the pedestal, and the potential dangers associated with the energy. The factory looms in your mind, a place that might hold the answers you seek but also carries its own risks. You think about how to approach it—perhaps by gathering more information, seeking allies, or finding ways to strengthen your connection to the amulet.
You make your way back through the winding streets, the night air cool against your skin. The city feels different now, charged with the weight of your experiences and the knowledge you&#39;ve uncovered. Eventually, you find yourself in the familiar alleyway, the faded mural still lingering in your memory.

As you step into the alley, the atmosphere seems to shift slightly, as if the shadows are watching your return. The mural stands before you, a silent sentinel filled with secrets, and the amulet hangs against your chest, pulsing gently in the stillness.

You lean in closer to examine the mural, studying the intricate details and the way the paint seems to shimmer under the light. There’s a certain energy emanating from it that feels both inviting and unsettling. The swirling stars and the central figure draw you in, but something about the expression on the figure’s face makes you uneasy—it’s almost as if it knows more than it’s letting on.

As you trace the outlines with your fingers, you notice subtle differences in the texture. Some areas feel rough, while others are smooth and warm, as if they’ve absorbed the energy of the amulet. It dawns on you that this mural may hold more significance than just a piece of art; it could be a message or a warning.

Suddenly, the amulet begins to pulse rapidly, and you hear a faint whisper, almost too quiet to discern. “Seek the truth… but beware…”

A shiver runs down your spine. The vibrant colors seem to darken momentarily, and the alley feels colder. You step back, heart racing.

[[Look for Hidden Symbols]] — You search the mural and surrounding area for any additional symbols or signs that could provide more insight.

[[Try to Communicate with the Mural]] — You attempt to connect with the mural in hopes of gaining further understanding or clarity about its message.</tw-passagedata><tw-passagedata pid="173" name="Seek a Safe Haven" tags="" position="6200,1200" size="100,100">Feeling the weight of the situation, you decide to Seek a Safe Haven. You recognize the need to regroup and gather your thoughts away from the charged energy of the courtyard.

As you turn and make your way out of the courtyard, a wave of familiarity washes over you. The city is still alive around you, the bustling sounds and distant laughter echoing through the streets. You navigate through the maze of alleys and pathways, and before long, the surroundings begin to feel recognizable.

The flickering streetlights and the scent of rain-soaked pavement bring back memories of your earlier explorations. You pass by a small park where children are playing, their laughter blending with the rustle of leaves in the breeze.

You eventually find yourself in front of a café you visited before, its warm lights inviting you in. With a sense of relief, you step inside, the cozy atmosphere offering a refuge from the tension of the night.

As you pull out the amulet, a wave of unease washes over you. To your dismay, it feels cold and lifeless in your hand, the familiar pulse and glow completely gone. The sudden silence of the amulet sends a jolt of panic through you.

You glance around the café, the warm atmosphere now feeling strangely distant. Without the amulet&#39;s energy, you feel unmoored, as if a vital connection has been severed. The whispers of knowledge and the sense of purpose it provided seem to vanish, leaving you with a nagging sense of foreboding.

With your heart racing, you consider your next move. 
Feeling the weight of the situation, you remember the coordinates on your phone. They seem like your only link to whatever might be next in this unfolding mystery. The fact that the amulet has gone cold adds urgency to your decision.

You pull out your phone and examine the coordinates again. They point to the factory, the very place that had lingered in your mind since the beginning of this journey. You realize that despite the amulet’s loss of power, the coordinates might still lead you to answers—or perhaps even a way to restore the amulet’s energy.

Taking a deep breath, you gather your resolve. The factory could hold the secrets you need, and it’s worth the risk to uncover what lies within.

[[Head to the Factory]]— You decide to leave the café and make your way to the factory, trusting that the coordinates will guide you.

[[Pause to Reflect-&gt;goodid]] — You take a moment to think about the implications of heading to the factory, considering what you might face there without the amulet&#39;s power.</tw-passagedata><tw-passagedata pid="174" name="goodid" tags="" position="6400,1400" size="100,100">You choose to reflect, taking a moment to consider the implications of heading to the factory without the amulet&#39;s power.

As you sit in the café, the warm ambiance contrasts sharply with the coldness of the amulet in your pocket. You think about what you might encounter at the factory—possible remnants of the scientist&#39;s experiments, the looming threat of the entity you sensed, and the uncertain nature of the energy that once pulsed through the amulet.

You realize that while the coordinates may lead to answers, they could also lead to danger. The amulet’s loss of power leaves you feeling vulnerable, making the prospect of entering the factory more daunting.

Taking a deep breath, you weigh your options carefully. You could explore the factory and potentially uncover vital truths, or you could seek more information first, ensuring you&#39;re as prepared as possible.
[[Research the Factory Online]] — You could use the café&#39;s Wi-Fi to gather information about the factory&#39;s history and any related events.

[[Ask the Café Staff for Insight]] — You might consider asking the staff if they&#39;ve heard anything about the factory or seen anything unusual.

[[Leave the Café and Head to the Factory-&gt;Head to the Factory]] — You decide that enough is enough and head directly to the factory, trusting your instincts.
</tw-passagedata><tw-passagedata pid="175" name="Head to the Factory" tags="" position="5700,1300" size="100,100">With determination, you pocket your phone and leave the café, the cool night air hitting you as you step outside. The city feels alive around you, but you keep your focus on the factory ahead. Following the coordinates, you navigate through the streets, your heart pounding with anticipation and a hint of anxiety.

The path leads you through familiar alleys and side streets, and eventually, you find yourself in front of the factory. Its imposing structure looms over you, the flickering lights casting eerie shadows on the ground. The atmosphere feels thick with possibility, a mix of excitement and foreboding.

You take a moment to gather your thoughts. Despite the amulet’s loss of energy, you know that the factory may hold the key to understanding its true nature and the mysteries surrounding it.

As you approach the entrance, you notice a set of heavy doors slightly ajar, inviting yet ominous.

[[Enter the Factory]] — Whatever’s inside was hidden for a reason, but you’ve come this far. You push the door open and step inside.

[[Look Around First]] — This seems too easy. You decide to check the area, see if anyone is watching or if there’s something unusual about the factory itself.</tw-passagedata><tw-passagedata pid="176" name="Research the Factory Online" tags="" position="6500,1600" size="100,100">You choose to Research the Factory Online, using the café’s Wi-Fi to dig deeper into its history. As you browse, you come across several articles and forum posts about the factory.

One headline catches your eye: &quot;Mysterious Disappearances Linked to Abandoned Laboratory.&quot; Intrigued, you click through and discover that the facility was originally a research lab, known for its ambitious scientific experiments. However, it has been abandoned for years, and no one has been able to locate the lead scientist, who vanished without a trace.

As you read further, you notice a curious detail: there are no official records indicating that the lab was ever repurposed into a factory. Despite the common belief among locals, the lab’s original function remains shrouded in mystery. Even more perplexing is the fact that the scientist is never named; he’s always referred to simply as “the scientist” or even appears as an oddly blank spot in the accounts. This absence raises questions about why his identity is obscured and what really happened to him.

Chills run down your spine as you ponder the implications of this missing information. The whispers about the factory being haunted, coupled with the scientist’s disappearance, hint at darker secrets lying beneath the surface.

With this new knowledge in mind, you feel a renewed sense of urgency to investigate further. The unanswered questions swirl in your mind, driving you to dig deeper into the shadows of the past.

[[Prepare to Head to the Factory-&gt;Head to the Factory]] — You decide it’s time to confront the unknown and head to the factory.

[[Share Your Findings with the Barista]] — You consider going back to the barista to share what you’ve learned and see if they have any additional insights.
[[Try to Find his name]]</tw-passagedata><tw-passagedata pid="177" name="Ask the Café Staff for Insight" tags="" position="6000,1600" size="100,100">You decide to Ask the Café Staff for Insight. Approaching the counter, you catch the attention of a friendly barista and ask, “Have you heard anything about the factory nearby? I’m curious about its history.”

The barista looks thoughtful for a moment. “The factory? Yeah, it used to be a lab space before it was repurposed. There were all sorts of experiments happening there—some pretty cutting-edge stuff. I’ve heard rumors that they were working on some strange projects. People in the neighborhood have said it’s haunted, too, or that strange things happen around it.”

You nod, feeling a chill run down your spine. “Strange things?”

“Yeah, like lights flickering, odd noises at night. Some say they see shadows moving inside when no one’s supposed to be there. It’s been abandoned for a while now, but the stories linger.”

The barista’s words resonate with you, adding weight to your decision. It’s clear that the factory is not just a simple place of industry; it carries a legacy of experimentation and perhaps danger.

[[Thank the Barista and Prepare to Leave-&gt;Head to the Factory]] — You thank the barista for the information and decide it’s time to head to the factory.
[[Research the Factory Online]] — You could use the café&#39;s Wi-Fi to gather information about the factory&#39;s history and any related events.
</tw-passagedata><tw-passagedata pid="178" name="Share Your Findings with the Barista" tags="" position="6000,1500" size="100,100">You decide to Share Your Findings with the Barista, hoping to gain more insight. You approach the counter again, excitement in your voice. “I found some interesting information online about the factory. It turns out it was actually a lab, and there are no records of it being repurposed. It makes me wonder why everyone thinks of it as a factory.”

The barista chuckles, brushing it off. “Of course it’s a factory! That’s just what we call it around here. Old habits die hard, I guess. People love a good story, and the factory has its share of legends.”

You try to explain your findings further, but they seem to lose interest, focusing on their work instead. “You know how these things go—people see shadows and hear noises, and suddenly it’s a haunted factory. It’s just part of the charm of this neighborhood!”

Feeling a bit dismissed, you step back, frustration bubbling inside you. The barista&#39;s laughter echoes in your mind as you realize they might not be the best source for deeper truths.

eeling the weight of the conversation with the barista, you sense that something deeper is at play. The dismissive laughter and the insistence that it’s just a factory nag at you, as if they’re trying to keep something hidden.

You consider the chilling implications: if there’s a collective belief that this place is merely a factory, what truth lies beneath? The stories of the scientist’s disappearance, the strange occurrences, and the amulet’s connection all weave together into a tapestry of mystery and potential danger.

You glance at your phone again, the coordinates still leading to the factory. The more you think about it, the more convinced you become that this isn’t just a simple investigation anymore; it’s a quest to uncover hidden truths that others might want to keep buried.

With this realization, you decide:

[[Head to the Factory Now-&gt;Head to the Factory]] — You gather your resolve and leave the café, determined to uncover whatever secrets lie within the factory.

[[You decide that it’s best to head home]]—  the unsettling atmosphere of the café weighing heavily on you.</tw-passagedata><tw-passagedata pid="179" name="You decide that it’s best to head home" tags="" position="4275,200" size="100,100">You decide that it’s best to head home, the unsettling atmosphere of the café weighing heavily on you. As you walk through the dimly lit streets, you can’t shake the feeling that you’re being watched. Shadows flicker at the edges of your vision, and the hairs on the back of your neck stand up.

The night feels thick with anticipation, as if something is lurking just out of sight. You quicken your pace, the urge to get to safety driving you forward. Each step seems to echo in the silence, amplifying the sense of dread that clings to you.

Arriving at your door, you take a moment to gather your breath. You hope for the best, but deep down, you know that the mysteries surrounding the factory—and the amulet—are far from over. Whatever is coming feels closer now, a palpable tension in the air.

As you step inside and close the door behind you, the weight of the night settles in. You can’t help but wonder what awaits you in the future and if you’ll ever uncover the truth behind the factory and the secrets it holds.

You settle in at home, the familiar surroundings offering a sense of comfort, but your mind races with unanswered questions. What happened to the scientist? Why is there a collective belief about the factory being just a factory when it w-a-s a l-a-b?

[[Start]] ?</tw-passagedata><tw-passagedata pid="180" name="Ask More About the Scientist" tags="" position="5800,500" size="100,100">You lean in closer, eager for any details about the scientist. “What can you tell me about his disappearance? I need to know what happened.”

The shopkeeper hesitates, his eyes darting to the entrance as if checking for eavesdroppers. “The scientist was a brilliant mind, but he was also reckless. He delved too deep into experiments involving dimensions and energies that the city had long forgotten. People whispered about him conducting tests in that old part of town.”

He pauses, choosing his words carefully. “One day, he simply vanished. Some say he opened a portal to something he couldn’t control, while others believe he was taken by whatever he was trying to harness. After he disappeared, strange happenings in that area increased—people reporting odd noises, flickering lights, and shadows moving on their own.”

You can feel the weight of his words settling in. “Do you think he’s still out there? Is there any way to find him?”

The shopkeeper shakes his head. “I wish I could say. But many who seek the truth about the scientist never return. If you decide to pursue this, you must be prepared for the unknown. Not all knowledge is meant to be uncovered.”

His warning lingers in the air, but your determination only grows stronger. The mysteries surrounding the scientist and the factory feel more urgent than ever.

[[Ask About Possible Leads or Resources]] — You decide to inquire if he knows of any resources or leads that might help you find the scientist.

[[Thank Him and Browse the Items-&gt;Browse the Oddities]] — You choose to take a look at the intriguing items, thinking they might aid you in your quest.

[[Thank Him and Leave]] — You decide to leave, feeling the weight of the unknown pressing on you.</tw-passagedata><tw-passagedata pid="181" name="Ask About Possible Leads or Resources" tags="" position="5825,750" size="100,100">He motions for you to follow him deeper into the shop. You tread carefully, the air thick with anticipation. He leads you to a small, dimly lit alcove filled with an array of hidden treasures, each covered with a soft cloth.

“Here,” he says, pulling back a cloth to reveal a small, intricately carved box. “This is what you need. It holds something powerful, something that can guide you through the uncertainties you’ve been facing. But remember, with great power comes great responsibility.”

You look at the box, your heart racing with a mix of excitement and caution.

You take a deep breath, driven by curiosity, and reach for the small carved box. As you lift the lid, a soft glow emanates from within, illuminating your face. Inside, you find a delicate amulet resting on a bed of velvet. Its design is intricate, featuring swirling patterns that seem to shift subtly as you gaze at them.
You lean in, captivated by the amulet. “What do I need to do with it?”

The shopkeeper watches you closely, a look of approval in his eyes. “This amulet is said to grant insight into the unseen. It can help you navigate the challenges you face, especially those shrouded in mystery. But be cautious; it will reveal truths you may not be ready to confront.”

You feel the weight of the amulet in your hand, its energy pulsing gently as if it resonates with your own heartbeat. This could be the key to understanding the strange events surrounding you, but it also carries the potential for unforeseen consequences.

The shopkeeper’s gaze sharpens. “You must treat it with respect. It requires your intent and focus to activate its potential. Take it with you as you explore, and pay attention to how it reacts to your surroundings. It may lead you to hidden paths or warn you of dangers.”

He pauses, looking serious. “But be careful. Some energies are not friendly, and there are stories of those who have sought the truth and never returned.”

With this new information, you weigh your options.
“Will you take it?” the shopkeeper asks, his tone both encouraging and warning.

[[Take the Amulet]] — You decide to accept the amulet, feeling that it may help you uncover the truths you seek.
[[Close the Box and Leave]] — You feel a wave of uncertainty and decide it’s best not to take the amulet after all.</tw-passagedata><tw-passagedata pid="182" name="Continue Home" tags="" position="6000,225" size="100,100">You decide to head home, the weight of unanswered questions lingering in your mind. As you walk through the familiar streets, you can’t shake the feeling that there’s so much left undiscovered—mysteries hidden just out of reach.

Once you’re inside your apartment, you take a moment to breathe. The day has been filled with strange encounters, from the glitch on your phone to the curious shop you chose not to enter. You wonder what you might have found if you had pushed further.

The thought of the coordinates tugs at you, echoing the phrase “The Clock is Ticking.” You know that the allure of the unknown will likely call to you again, but for now, you decide to rest and gather your thoughts.

You make yourself a cup of tea and sit by the window, staring out at the city below. As night falls, you feel the pull of adventure still simmering within you, waiting for the right moment to explore what lies ahead.

The mysteries of the city and the stories waiting to be uncovered are far from over. You know you’ll have to return to those coordinates eventually and face whatever secrets they hold. But for tonight, you allow yourself a moment of peace, pondering the possibilities of tomorrow.

[[Start]] </tw-passagedata><tw-passagedata pid="183" name="Investigate the Coordinates" tags="" position="6125,225" size="100,100">Driven by a mix of curiosity and determination, you decide to investigate the coordinates. As you make your way toward the old part of the city, the familiar sounds of bustling life fade into the background, replaced by an eerie silence that seems to blanket the area.

After a few twists and turns, you find yourself standing before the factory. Its towering structure looms over you, rusted metal and cracked concrete telling stories of a bygone era. The windows are dark, and the entrance is shrouded in shadows, but a flicker of light from within catches your eye.

You hesitate for a moment, the weight of the unknown pressing down on you. What secrets does this place hold? What might you find inside?

[[Enter the Factory]] — You muster your courage and decide to step inside, eager to uncover what lies within.

[[Search the Surroundings]] — Before entering, you take a moment to explore the outside of the factory, looking for clues or anything unusual.</tw-passagedata><tw-passagedata pid="184" name="Search the Surroundings" tags="" position="6125,350" size="100,100">You carefully scan the surroundings, your eyes drawn to the numerous odd sigils etched into the factory’s walls and the ground around it. Some are faded, barely visible, while others stand out with an unsettling clarity, their designs twisting and curling in intricate patterns.

You kneel to get a closer look at one of the more prominent sigils. It resembles a spiral intertwined with angular shapes, radiating an eerie energy. As you trace it with your finger, a faint hum seems to resonate in the air, making the hairs on your arms stand on end.

You stand up and step back, feeling a mix of intrigue and apprehension. These symbols feel significant, like warnings or perhaps markers of something powerful hidden within.

With a deep breath, you consider your next move.

[[Enter the Factory]] — You decide that despite the symbols, you need to know what lies inside.

[[Document the Symbols]] — You pull out your phone to take pictures of the sigils, wanting to remember them for later investigation.</tw-passagedata><tw-passagedata pid="185" name="Document the Symbols" tags="" position="6100,500" size="100,100">You take out your phone and begin documenting the sigils, capturing their intricate designs in close-up photos. Each one seems to pulse with its own energy, and you feel a strange connection to them as you snap images.

As you photograph the symbols, you notice a recurring theme among them—some resemble ancient runes, while others look like alchemical symbols. A sense of urgency washes over you; these could be clues to understanding what the factory is hiding.

You step back, reviewing the photos. Something about the sigils feels like a puzzle waiting to be solved. With a sense of determination, you realize you need to explore further, but you&#39;re still drawn to the strange energy emanating from the factory itself.

You think ~~//about him and how much he loved these things, always talking to you about the intricacies of each symbol and their potential meanings//~~. But that thought shatters your train of focus, and you quickly refocus on the moment at hand. The weight of the factory’s mysteries pulls you back, and you shake off the distraction.

[[Enter the Factory]] — You feel compelled to find out what secrets lie within the building.
</tw-passagedata><tw-passagedata pid="186" name="Change your Mind" tags="Ending" position="800,3900" size="100,100">Suddenly, the weight of his words sinks in. You realize that the bond you’ve formed is stronger than you thought, and the urgency of the situation becomes clear. “Okay,” you say, a new determination igniting within you. “I’ll stay. I want to help.”

Relief washes over his face, a flicker of hope igniting in his eyes. “Thank you. I promise, we’ll find a way to make this work.”

With renewed purpose, you take a step closer, the chaos of the realm now a shared burden between you. “What’s our next move?” you ask, your mind racing with possibilities.

The scientist’s excitement returns, his eyes sparkling with fervor. “We need to analyze the data we collected from the portal and strengthen our defenses. The sigils we’ve activated are just the beginning; there’s so much more we can do together.”

You feel a surge of enthusiasm at his words. “Let’s get started then! What do you need from me?”

He begins pacing, his thoughts flowing rapidly. “We should set up a framework for studying the sigils’ energy patterns. If we can understand how they interact with the chaotic forces, we can develop more effective strategies for containment. And we’ll need to gather more resources to reinforce our defenses.”

As he speaks, you notice a brief flicker of something in his eyes—an echo of a memory that he quickly masks with focus. It’s as if he’s recalling a moment or a detail about your connection that you’re not privy to, a shadow of something significant that lingers just out of reach.

You nod, eager to dive into the work ahead. “I’ll help however I can. What should we focus on first?”

“Let’s begin by cataloging the sigils we’ve already activated,” he suggests, motioning toward the control panel. “If we can find out how they respond to different energies, we can start mapping out a more comprehensive plan.”

As you both work together, the atmosphere shifts from one of uncertainty to collaboration. With every piece of information you uncover, you feel a deeper connection to the scientist—and to the cause you’re now part of. Yet, the hint of his memory hangs in the air, an unspoken thread that you can’t quite grasp.

Hours pass in a whirlwind of research and discovery, your minds buzzing with ideas and strategies. The bond between you strengthens, forged in the fires of shared purpose and urgency. And as you glance at him, determination etched in his features, you realize that you’ve found not just a partner in this fight, but a friend.

The challenges ahead may be daunting, but together, you believe you can face whatever chaos this realm throws your way. And maybe, just maybe, the truth of your past will come to light when the time is right.
[[Start]] </tw-passagedata><tw-passagedata pid="187" name=" Leave" tags="Ending" position="1000,3900" size="100,100">You cross the threshold, leaving the chaos behind, but the weight of his gaze lingers in your mind, a reminder that your journey is far from over. Just as you begin to feel the distance between you grow, you hear a choked sob escape his lips, the sound breaking through the hum of machinery and the whispers of the shadows.

“But this was supposed to fix everything!” he cries, his voice cracking in despair. The sorrow in his words resonates within you, tugging at your heart. You pause for a moment, torn between your desire to help and the knowledge that you must forge your own path. The thought of leaving him behind, vulnerable and broken, stings deeper than you expected. He looks so small in that vast space, shoulders hunched and hands trembling, a shadow of the confident scientist you once knew.

With a heavy breath, you step forward, feeling the threshold solidify behind you, sealing away both the chaos and the scientist&#39;s pain. You glance back, and your heart aches as you see him sink to his knees, his body wracked with quiet sobs, as if the weight of his failures is too much to bear. “I thought I could make it right,” he whispers, desperation lacing his words. It’s a stark contrast to the man who once believed he could change the world. Now, he seems lost, his ambition reduced to nothing more than regret and sorrow.

Despite the pull of his emotions, you remind yourself that you can’t get more involved, regardless of the consequences. The echoes of his grief follow you, a haunting reminder of the bond you’ve forged and the sacrifices made in the name of survival. You press on, determined to find your own way in a world that feels both familiar and alien, the weight of your choices heavy on your shoulders.

As you leave him behind, you can’t shake the image of him there, alone in the darkness, tears streaking his dirt-smudged face, his once-brilliant mind now clouded by despair. It’s a painful reminder of what can happen when curiosity goes unchecked, and as you step away, you can’t help but wonder if this is the last time you’ll ever see him.
[[Start]] </tw-passagedata><tw-passagedata pid="188" name="“What if we do both?" tags="" position="1800,3800" size="100,100">You look around at the remnants of the factory, a place that feels both familiar and foreign. “What if we combined both approaches? We could set up a base here to study the dimensions while developing protective measures—a way to safeguard our home while pushing the boundaries of knowledge.”

His expression shifts to one of intrigue. “That could work. A dual strategy. We need to understand the risks before venturing out too far.”

A sense of purpose solidifies as you lay out the plan. “We could start with a small exploration mission, just to gather data. That way, we can gauge the situation without fully committing.”

He nods, a smile breaking through the earlier tension. “I like it. We’ll create a framework for safety protocols, then use that knowledge to venture into the unknown.”

His enthusiasm is infectious as he dives into the details, outlining potential research methods and safety measures with fervor. “We’ll need equipment—scanners, energy shields, maybe even a way to create temporary anchor points to keep us tethered to our own dimension,” he explains, his hands animatedly sketching ideas in the air.

You listen intently, picking up on his energy as you contribute your own thoughts. “What about communication devices? We need to stay in contact, especially if we’re exploring unfamiliar territory.”

“Excellent point! We could modify existing technology to suit our needs,” he replies, his eyes sparkling with excitement. “And we should document everything—every encounter, every anomaly we find.”

As he continues to brainstorm, you find your own ideas flowing more freely. You suggest integrating sensory feedback systems into the equipment, allowing you to respond to environmental changes in real time. He looks impressed, nodding enthusiastically.

Before long, you both have a rough outline of your mission—clear goals, safety protocols, and a timeline. The factory, once a place of remnants and decay, now buzzes with potential and purpose.

“Let’s start gathering the necessary materials,” he says, his voice brimming with determination. “If we work efficiently, we could be ready for our first exploration in just a few days.”

You smile, feeling the thrill of the adventure ahead. “Let’s get to work, then. There’s no time to waste.”
[[Next-&gt;next_4]]</tw-passagedata><tw-passagedata pid="189" name="next_2" tags="" position="1500,4100" size="100,100">He quickly grasps your shoulders, his grip firm but gentle. “Are you okay?” he asks, concern etched across his face. His eyes search yours for any sign of clarity.

You nod slowly, trying to shake off the disorientation. “I think so… just a bit of a headache,” you manage to say, though the ache still lingers, a heavy fog in your mind.

He takes a step back, still watching you closely. “We should probably find a place to sit down, let you rest. This has been a lot to handle.” There’s a hint of urgency in his tone, as if he’s both worried about you and anxious to understand what’s happening.
As you’re guided to a nearby bench, you take a moment to catch your breath. The cool air feels refreshing, but the headache persists, lingering in the back of your mind. After a moment of silence, you turn to him and ask, “What were we talking about again?”

He looks even more concerned now, as if weighing his words carefully. “It’s… it’s not important,” he finally replies, attempting to downplay it, but the hesitation in his voice suggests otherwise.

You sense that there’s more to it, but with your head throbbing, you decide to let it go for the moment. Instead, you focus on the surroundings, taking in the fading fog and the remnants of the adventure you’ve just escaped.
As you step out into the cool air, the weight of the encounter hangs over you. The fog swirls around your legs, making the world feel eerily quiet. You glance back one last time, the scientist’s figure now just a silhouette against the dim light. His trembling shoulders tug at something deep inside you—a memory you can’t fully grasp yet.

You shake off the chill creeping into your bones and head home, thoughts racing. What had he meant about remembering? The entity’s impact lingers in your mind, a haunting question. You resolve to think it through, to piece together the fragments of your own past that feel so distant and yet so close.

Once inside your home, you lean against the door, letting out a breath you didn’t realize you were holding. You know you’ll need to talk to him again, to uncover what lies beneath the surface of this chaotic reality. There’s more to this story—yours and his—and you’re determined to find a way to untangle it all.

The night stretches before you, a canvas waiting for your thoughts to fill it.
[[Next-&gt;next_3]]</tw-passagedata><tw-passagedata pid="190" name="next_3" tags="Ending" position="1200,4100" size="100,100">The morning sun filters through your curtains, illuminating the remnants of last night’s thoughts scattered around your desk. You blink at the papers, the scribbled question staring back at you, but the reason behind it feels like a fading dream—just out of reach.

As you brew a cup of coffee, your phone buzzes, breaking the stillness. It’s a message from the scientist. Your heart quickens as you open it:

“I hope you’re well. I was thinking about our conversation last night. can I get you to reconsider working with me?”
Your heart skips a beat at the unexpected request. The weight of his words hangs in the air as you consider the implications. He wants you to ~~//reconsider //~~ working with him. You had already made the decision to help, but now it feels more //significant//, layered with the mystery of your shared past and the entity’s influence.

You take a moment to collect your thoughts before typing a response.

“I’ve been thinking about it. What do you need me to do?”

As you hit send, a sense of purpose washes over you. The coffee brews quietly in the background, filling the space with its rich aroma. A few moments pass, and your phone buzzes again.

“Thank you. I believe there’s more we need to uncover about the entity and how it ties to both of us. Meet me at the factory. I’ll explain everything there.”

The factory—where it all began. Excitement mingles with trepidation as you remember the chaos of that place. You finish your coffee, feeling a rush of determination.

You grab your jacket, your mind racing with questions. What had he discovered? What was your connection to the entity? The answers feel tantalizingly close, and you’re ready to face whatever awaits you at the factory.

As you step outside, the cool air hits your face, invigorating you. The fog begins to lift, revealing a clearer path ahead. You’re ready to dive back into the mystery.
[[Start]] </tw-passagedata><tw-passagedata pid="191" name="next_4" tags="Ending" position="1900,3900" size="100,100">You smile, feeling the thrill of the adventure ahead. “Let’s get to work, then. There’s no time to waste.”

He replies, “Of course! Did the grant get renewed with all that happened? I forgot to fill out the paperwork.”

You roll your eyes at his oversight, the familiarity of his enthusiasm making you smile. “Of course, that’s why I did it for you,” you reply, trying to keep the mood light despite the sudden fog settling in your mind.

But the moment hangs heavy as you feel a flicker of confusion. ~~//Why would you be involved?//~~ You shake your head, pushing the thought aside. The scientist catches the shift in your demeanor but doesn’t linger on it. Instead, he dives back into his plans, eager to keep the momentum going.

“Let’s focus on what we need to gather. The equipment here is essential for our exploration,” he says, gesturing toward the various items scattered around the factory. “We’ll start with the scanners and any energy sources we can find. I’ll check the lab for anything we might have overlooked.”

You nod, grateful for his eagerness. “I’ll start sorting through the tools and materials here. If we can compile a list of what we have, we can figure out what else we need.”

As you both work, excitement begins to drown out the fog. You sift through old equipment, each piece igniting your curiosity about the adventures ahead. But the feeling that something important is just beyond your grasp lingers, a gentle reminder that there’s more to uncover in both the research and your connection to the scientist.

The day unfolds with a flurry of activity, both of you lost in the tasks at hand. With each discovery, you feel the thrill of the unknown drawing closer, the promise of new dimensions and revelations just waiting to be explored.
[[Start]] </tw-passagedata><tw-passagedata pid="192" name="Try to Find his name" tags="" position="6775,1675" size="100,100">The lack of a name frustrates you, a missing piece in the puzzle that feels crucial to understanding the whole story. Determined to uncover the truth, you keep digging, sifting through articles, forum posts, and any other digital breadcrumbs you can find.

You start searching for any mentions of the scientist in relation to other projects, hoping to uncover a lead. Each click feels like a step deeper into a labyrinth of secrecy. Some posts mention strange experiments, bizarre theories, and even rumors of ethical violations, but none provide a concrete name or any clear answers.
Then, you come across a few scattered references to a partner. The posts hint at a collaborative relationship, discussing joint projects and shared ambitions, but just as quickly as they appear, they fade into obscurity. It’s as if they were never there at all, and no one seems to notice that they are missing.

You find yourself puzzled by this oversight. How could something so seemingly significant be so easily overlooked? The silence surrounding the partner only deepens the mystery. Why were they not included in any discussions about the lab, and why is their identity just as elusive as the scientist’s?

Determined to press on, you decide to focus on the partner’s role. If you can uncover their contributions, perhaps it will lead you to the answers you seek about the scientist and the secrets of the abandoned lab. You start searching for any mention of projects or papers that might involve both of them, hoping this could be the breakthrough you need.
As you delve deeper, more references emerge about them working together—collaborative experiments, joint research papers, and project outlines. Each mention strengthens the sense of a significant partnership, yet each one conspicuously lacks names.

The absence of identifiers feels almost deliberate, like a calculated effort to erase any trace of their identities. You sift through the content, hoping to find even a single name or clue, but it’s all generic terms: “the scientist,” “the partner,” and vague descriptions of their work without specifics.

This pattern only fuels your frustration and curiosity. What happened to the records of their identities? Why was this partnership so thoroughly obscured? The more you dig, the more it seems that the truth is buried beneath layers of secrecy.

With renewed determination, you realize you need to pivot your approach. Perhaps a different source of information—interviews, old news articles, or even local lore—might shed light on the elusive partnership. You take a deep breath, ready to continue the search for answers.
[[Next-&gt;next-5]]
</tw-passagedata><tw-passagedata pid="193" name="next-5" tags="" position="6875,1675" size="100,100">As you continue your search, it gets even stranger. In spaces that clearly should accommodate more detailed identifiers, the terms “the scientist” and “the partner” persist, even in newspaper articles. It feels almost surreal—like a narrative deliberately crafted to erase individual identities.

You scroll through headlines that would typically include names of prominent figures in scientific circles, yet they’re all replaced with those vague identifiers. It’s as if there’s an unspoken agreement to keep their identities hidden. Your mind races with questions: Was this a protective measure, or was there something more sinister at play?

You can’t help but feel that these missing names are key to unlocking the entire story. You decide to shift your strategy, looking for any public records or local legends that might mention the lab or its projects. If the traditional sources are hiding the truth, perhaps the community has whispers of what really happened, and you’re determined to uncover them.

Then you notice it getting weirder. The articles appear to be using different names, but you can’t see them—it&#39;s as if the text is deliberately obscured. You squint at the screen, trying to decipher the letters, but they blur together, slipping away from your comprehension like shadows in the dark.

It’s unnerving. Why would there be different names, yet they remain hidden from view? You can’t shake the feeling that this is intentional, a way to conceal the truth from anyone who might stumble upon it. The idea sends chills down your spine.

Determined to unravel this mystery, you begin taking screenshots of the articles, hoping that examining them later might reveal something. You try refreshing the page, clearing your cache, even adjusting the brightness and contrast of your screen, but nothing changes. The names remain stubbornly out of reach.
With a sense of urgency growing within you, you decide that you need to seek out physical archives or libraries. If the online records are deliberately obscured, perhaps there are old documents, newspapers, or firsthand accounts that could shed light on this baffling situation. The hunt for the truth is far from over; in fact, it feels like it’s just beginning.
[[Next-&gt;next-6]]</tw-passagedata><tw-passagedata pid="194" name="next-6" tags="" position="6775,1775" size="100,100">You make your way to the library, anticipation coursing through you. As you sift through the physical editions of the newspapers and articles, you feel a mix of hope and apprehension. However, the moment you start reading, your heart sinks. The same problem exists here: the articles clearly use different names, but you can’t see them.

You examine the pages closely, running your fingers along the text, looking for any signs of tampering or alteration, but everything appears intact. There are no visible edits, no signs that anyone has attempted to erase or obscure the information. It’s as if the names have been deliberately hidden from your view.

Frustration wells up inside you, but you refuse to give in. You scan the library for any librarians or staff who might have deeper knowledge about the history of the lab. Maybe someone there can provide context or insight into why these records are so strange.

You approach the information desk, determined to find someone who can help you uncover the truth behind the obscured identities.
You approach the information desk, your mind racing with the need for answers. As you explain your findings to the librarian, you expect a glimmer of understanding or curiosity. Instead, the librarian looks at you quizzically.

“I don’t see anything wrong with these articles,” they say, flipping through a few pages. “These are all standard references. The names used are perfectly valid within the context of the stories.”

You try to explain your perspective, but they treat the names as if they are real and valid, completely dismissing your concerns. This only deepens your confusion. Why can’t anyone else see what you see?

Feeling a mix of frustration and determination, you decide to delve into other sections of the library. Maybe historical records or local archives might provide insight into the scientist and the partner, or even into the unusual circumstances surrounding the lab. You won’t let this bizarre situation deter you; the truth is out there, and you’re committed to finding it.
[[Next-&gt;next1]]</tw-passagedata><tw-passagedata pid="195" name="next1" tags="" position="6875,1775" size="100,100">As you continue your search, you stumble upon a small article tucked away in a corner of a local newspaper. The headline reads, “Accident Occurs at Research Lab,” and beneath it, there’s a grainy picture of the scientist standing outside the facility, looking solemn.

The article describes an incident that took place years ago, mentioning an “unfortunate accident” but providing few details. It notes that there were reports of strange occurrences leading up to the event, and it hints at the lab’s secretive nature.

Your heart races as you read through the sparse text, searching for anything more substantial. The scientist’s face is partially obscured by shadow, but you can see the intensity in his expression, a mix of concern and determination.

This revelation feels significant, and you wonder if this incident is tied to the mysterious disappearances and the strange obfuscation of names. You take a photo of the article, determined to analyze it later, and keep searching for any additional leads that might provide context or connections to the elusive partner.
[[Next-&gt;next2]]
</tw-passagedata><tw-passagedata pid="196" name="next2" tags="" position="6775,1875" size="100,100">The next thing you find is an old video interview with the scientist, tucked away in a dusty archive. The headline reads, “Scientist Addresses Recent Accident and Future Plans.” Your heart races as you click play, eager to see and hear him speak.

The video begins with a shaky camera, showing the scientist sitting in a dimly lit room, a serious expression etched on his face. He looks weary but determined. He starts by acknowledging the recent accident at the lab, his voice steady but tinged with emotion. “What happened was a tragedy, and I take full responsibility for the events that unfolded,” he says, his gaze intense.

He goes on to discuss the challenges the lab faced leading up to the incident, mentioning the pressures of groundbreaking research and the inherent risks of exploring the unknown. “We were pushing boundaries, and sometimes, in the pursuit of knowledge, we overlook the dangers,” he admits, a flicker of regret crossing his features.

As he speaks, you notice a subtle shift in his demeanor when he mentions the future. “We must learn from this experience,” he says, his voice firm. “I’m committed to ensuring that such mistakes never happen again. My work will continue, and I will find a way to make it safe.”
He goes on to discuss the challenges the lab faced leading up to the incident, mentioning the pressures of groundbreaking research and the inherent risks of exploring the unknown. “We were pushing boundaries, and sometimes, in the pursuit of knowledge, we overlook the dangers,” he admits, a flicker of regret crossing his features.

Then the news reporter interjects, looking confused. “But if it was such a serious incident, why was no one hurt in the accident?”

The scientist’s expression shifts abruptly, a look of horror dawning on his face. He stammers for a moment, clearly caught off guard. 

“That’s… that’s not right.” The next part of the video becomes oddly distorted, the audio warping and flickering like a bad signal. You strain to hear, your heart racing with anticipation.

Then, just as suddenly, the audio clears up, and you hear the scientist’s voice again, but it’s shaky. “My partner. They fell through it… I… I…” His words trail off, laden with a mix of dread and sorrow.

The weight of his admission hangs heavy in the air, and you can sense the turmoil beneath his calm facade. “I didn’t know… I didn’t think it would happen,” he continues, his voice barely above a whisper. “They were there to help me, to ensure everything went smoothly, but I lost control.”

You can see the pain etched on his face, the regret flooding his expression as he stares into the camera, as if seeking redemption or understanding. “I thought I could bring them back, but… it’s been too long.”

The screen flickers again, and you catch a glimpse of raw emotion—fear, guilt, and an unshakeable sense of loss. Just then, the reporter interjects, confusion evident on their face. “What? You don’t have a partner. You work alone.”

The scientist&#39;s expression shifts abruptly, a mix of anger and desperation flashing across his features. “No! That’s not true!” he insists, his voice rising. “I had a partner! They were vital to everything I was doing! Without them… I can’t control it!”

The reporter tries to regain control, but the scientist seems to spiral deeper into his memories, wrestling with the truth of his past. The tension in the room is palpable.
[[Next-&gt;next-3]]</tw-passagedata><tw-passagedata pid="197" name="next-3" tags="" position="6875,1875" size="100,100">The video cuts off again, leaving you breathless with questions. Who was this partner? Why was the reporter claiming they didn’t exist? And what really happened during that fateful incident? Each unanswered question feels like a thread tugging at the fabric of the mystery.

You realize that the obscured identity of the partner might be tied to the strange absence of names in the articles and records you&#39;ve encountered. It seems as if someone has deliberately erased traces of this person from history. Could it be a way to protect the scientist or to hide something far more sinister?

You take a moment to gather your thoughts. This investigation has led you down a dark path, and it feels as though you&#39;re on the brink of uncovering something significant—something that could explain the scientist’s turmoil.

With renewed determination, you decide to dig deeper into the archives and seek out any further information about the partner. Maybe there are hidden documents or undisclosed interviews that could shed light on their identity and the events surrounding the accident. You know that understanding the dynamics of their relationship might be the key to unraveling the enigma surrounding the lab and the scientist’s troubled past.

You dive back into your research, sifting through the archives with fervor. As you search, you begin to find a series of articles, all published in close succession, each one featuring the scientist. In these pieces, he adamantly claims that he did have a partner, but with each article, there’s a growing sense of desperation in his tone.

The first few pieces describe their collaborative work, detailing ambitious projects and groundbreaking research. But as the articles progress, the language shifts. The scientist appears more frantic, almost pleading as he insists on the existence of his partner. “They were essential to my work,” he states in one article. “Without them, I’m nothing.”

Yet, each time he asserts their existence, the articles refute it. Phrases like “no evidence of a partner has ever been found” or “the scientist worked alone on all documented projects” pepper the texts. It’s as if a concerted effort is being made to erase any trace of this individual from the narrative, despite the scientist&#39;s emotional appeals.

You can sense the underlying anxiety in his words, a stark contrast to the confident tone of earlier writings. In the final articles, he speaks of feeling lost without them, as if their absence has left a void he can’t fill. “I can’t move forward without acknowledging their role. I need to find a way to bring them back,” he expresses, his vulnerability laid bare.

This blatant contradiction intensifies the mystery. Why are these articles so determined to deny his partner’s existence? What could they possibly be trying to hide? You bookmark these articles, knowing they’re crucial to understanding the dynamics between the scientist and his partner. 

With every revelation, the urgency of your investigation heightens. You feel a growing responsibility to uncover the truth behind this obscured relationship, knowing that it could hold the key to understanding the chaos surrounding the portal and the scientist’s current state. Each discovery pulls you deeper into the scientist’s world, and you’re determined to find out what really happened.
[[Next-&gt;next-4]]</tw-passagedata><tw-passagedata pid="198" name="next-4" tags="" position="6775,1975" size="100,100">Suddenly, all mention of the scientist vanishes. It’s as if he has been erased from existence—not like the partner, but more insidiously. His name, his work, any acknowledgment of him in the articles and records you’ve been pouring over has disappeared.

You scroll through the archives in disbelief, reloading pages and searching under different terms, but nothing appears. The articles that once detailed his ambitious projects now seem to have been scrubbed clean, leaving only vague references to “a leading researcher” without any indication of who that might be.

Panic sets in as you realize that this isn’t just a simple oversight. It feels intentional, as if someone is actively working to erase him from history. The absence leaves a chilling void, and you can’t shake the feeling that you’re being watched—like someone doesn’t want you uncovering the truth.

You step back from your screen, trying to collect your thoughts. This sudden erasure raises even more questions: Why would someone want to erase him? What was he involved in that warranted such drastic measures?

You feel a rush of urgency; you had to find him. He was always a rushing fool, driven by ambition and an unyielding curiosity. Those traits might have led him to make choices that put him in danger. The thought of him, lost and possibly in trouble, spurs you into action—even though you had //n-e-v-e-r // | //m-e-t// |//  h-i-m//. Of course, you had to help the fool; he would lose his own head //w-i-t-h-o-u-t |  y-o-u//.

In your rush to get up, you trip over the desk, barely catching yourself just in time. The jolt of movement brings you back to the present, and you shake off the momentary embarrassment. What had you had been thinking about?—the urgency of finding him, the nagging feeling that he was in trouble, and the strange circumstances surrounding his disappearance.
[[Next-&gt;next_5]]
</tw-passagedata><tw-passagedata pid="199" name="next_5" tags="" position="6875,1975" size="100,100">You hurry to the exit of the library, your heart pounding with urgency. As soon as you burst through the doors, you break into a run, the cool air rushing against your skin. The world around you blurs as your mind races with thoughts of the scientist and the mystery that seems to envelop him.

You navigate through the bustling streets, weaving past pedestrians and dodging traffic, your focus unwavering. 

The energy from the amulet guides you, and with each step, you sense that you’re getting closer to uncovering something important. As you approach the university, its towering buildings loom ahead, promising the possibility of answers. You quicken your pace, eager to reach the archives and delve deeper.

With your heart racing and the amulet’s warmth in your pocket, you’re ready to confront whatever secrets await you inside.
[[Next-&gt;next_6]]</tw-passagedata><tw-passagedata pid="200" name="next_6" tags="" position="6775,2075" size="100,100">Instead of the archives, you find yourself heading toward the private labs at the university. The amulet’s warmth intensifies, almost pulling you forward as if guiding you toward something significant. You push through a set of double doors and step into a hallway lined with glass windows, where you can see researchers busy at work inside their labs.

You rush past, your heart racing, as you make your way toward the back of the building where the more secure labs are located. The atmosphere here feels different—charged with a sense of secrecy and urgency. The amulet seems to pulse in your pocket, urging you onward.

You rush past, your heart racing, as you make your way toward the back of the building where the more secure labs are located. The atmosphere here feels different—charged with a sense of secrecy and urgency. The amulet seems to pulse in your pocket, urging you onward.

To your surprise, the corridor is empty, and a sense of both unease and determination washes over you. Without thinking, you approach a door with a keypad. Instinctively, your fingers move to enter a code you didn’t remember knowing until now.

As the numbers click into place, you feel a strange sense of //familiarity//. The door unlocks with a soft beep, and you push it open, stepping inside.

The room is dimly lit and filled with high-tech equipment. Papers and documents are scattered across the tables, many marked with the scientist&#39;s name. Your pulse quickens as you scan the space, searching for any clue that might shed light on his disappearance. //Where did he go.//
[[Next-&gt;next-7]]</tw-passagedata><tw-passagedata pid="201" name="next-7" tags="" position="6875,2075" size="100,100">You look around frantically, your heart pounding in your chest. It had to be here—some clue, some piece of evidence that would explain everything. Your eyes dart from one machine to another, taking in the intricate setup of the lab.

You rush to a table cluttered with papers, scanning the documents for anything relevant. Some are research notes, filled with complex equations and diagrams, while others seem to detail experiments that were never completed. Nothing feels right; you sense a void where the answers should be.

As you sift through the papers, something catches your eye—a notebook, partially hidden under a stack of folders. You pull it out and flip it open. The handwriting is frantic, filled with sketches and notes that reveal a chaotic mind at work.

Words like “failure,” “disappearance,” and “urgent” leap out at you, but one phrase resonates deeply: “No one remembers them but me. I have to find them. It lied to me. What have I done?”

A chill runs down your spine as you realize the implications. The scientist was not just desperate; he felt utterly alone, burdened by the weight of a reality where those he cared for were forgotten. Your heart aches for him, for the loss and confusion that must have consumed him.

You flip through more pages, searching for anything that might lead you to him or shed light on what happened. Each entry reveals more of his torment, his struggle to grasp the truth while being surrounded by a world that seemed to conspire against him. You feel an urgent need to act, to uncover the mystery before it consumes you too.

Your eyes settle on a device nestled among the clutter, its design sleek and unfamiliar.. and yet. There it was—a potential key to unraveling the mystery surrounding the scientist and his lost partner.
Beside the device, a scattering of notes catches your attention. Hastily written, the pages are filled with scrawled diagrams and desperate scribbles. One note in particular stands out:

&quot;Failure. It can&#39;t find them. Only me. Why just me? They exist. I know they do.&quot;

The words are underlined, almost torn into the paper, the frustration palpable. The more you read, the more it becomes clear—the scientist has been searching for someone. Someone important. And he’s convinced they’re out there, somewhere. But for some reason, the device only reacts to him, leaving him stranded in his isolation, unable to reach whoever—or whatever—he’s been chasing.

The device hums softly, its surface adorned with buttons and a small screen that flickers to life as you approach. You can feel a pull toward it, a sense of connection that heightens your urgency.

You pick it up carefully, studying its features. It appears to be some kind of communication or tracking device, possibly linked to the experiments the scientist conducted. As you examine it more closely, you notice a series of symbols etched into the casing, echoing the strange sigils you’ve seen mentioned in your research.
[[Next-&gt;next-8]]</tw-passagedata><tw-passagedata pid="202" name="next-8" tags="" position="6775,2175" size="100,100">You shake off the absurd thought that briefly flits through your mind—//Why would you need to find yourself? //The idea is absurd, fleeting, and irrelevant right now. Instead, your focus sharpens on the task at hand as you activate the device again, fingers moving swiftly over the unfamiliar buttons. Each press triggers a series of rapid beeps, growing more intense with each second. The screen flickers, displaying a cascade of shifting coordinates, blinking in and out like a distant, fading beacon.

Your pulse quickens as you concentrate on the display. This has to be it. This is how you’ll find him. //That idiot.You told him. You warned him this experiment was a terrible idea//

As you watch, the device stabilizes on a particular location, a blinking dot indicating a specific point not too far from where you are.

With renewed determination, you tuck the device securely under your arm and grab the notebook. The urgency of the moment propels you forward; you need to get to that location quickly. Glancing back at the cluttered lab, you make a mental note of anything you might have missed, but there’s no time to waste.

You race out of the lab, the beeping from the device in your hand guiding you through the winding hallways. The amulet in your pocket grows warmer against your skin, an oddly comforting presence that feels more vital than ever, as though it knows just how much you need it right now. Your breath comes in quick bursts, and the world outside blurs as you rush toward the coordinates, your mind fixed on one thing: finding that absolute idiot.

//You told him. You knew it was a terrible idea to trust that thing.//

Each step only amplifies your frustration. How could he have let things spiral this far out of control? He wasn’t reckless, not usually, but this—this was beyond reckless. Now you might be the one left to pick up the pieces. The device beeps again, faster now, urging you on. Every step feels like a race against time, as if the very ground beneath you could collapse if you don’t act fast enough.

How long had it been since the experiment? Days? Weeks? The details blur in the haze of your head—//how had you forgotten?// It nags at you, the strange gaps in your memory, but there’s no time to dwell on it now. The thought spurs you forward, determination hardening in your chest, a potent mix of exasperation and concern fueling every step.

You’re angry—angry at him for pushing things too far, for not listening when you told him it was a terrible idea. But underneath that frustration, a deeper, nagging question lingers: Will you get there in time? Will he even be there?

You shake it off. Doubt is the last thing you need right now. You have to believe there’s still time, that you can still fix this before it spirals any further out of control.


All that matters now is finding him.

The device’s beeping grows steadier, guiding you toward the coordinates as you weave through the streets. You can’t shake the feeling that you’re running against the clock, and each second counts. You finally reach a secluded alley, the blinking light on the device indicating you’re close.

The air feels charged, almost electric, as you scan the area for any signs of what might be ahead. Is he really here? Or has he vanished, just like everything else? You grip the device tighter, steeling yourself for whatever you might find.
[[Next-&gt;next-9]].

</tw-passagedata><tw-passagedata pid="203" name="next-9" tags="" position="6875,2175" size="100,100">The device beeps rapidly, its light pulsing as you step deeper into the alley. Shadows loom around you, creating an eerie atmosphere that sends a chill down your spine. You take a deep breath, reminding yourself that you need to be brave for both of you.

As you move further in, you spot something on the ground—a faint glimmer amidst the debris. You approach cautiously, kneeling to inspect it. It’s a small piece of metal, intricately carved with the same symbols you’ve seen before. Your heart races; could this be a clue to his whereabouts?

You carefully pocket the metal piece and look around, feeling the device pulse with urgency in your hand. The beeping intensifies, drawing you toward a hidden door at the end of the alley, partially obscured by a tangle of vines. You push open the hidden door in to a small room, the dimly lit room reveals a stunning mural covering one wall. The artwork depicts swirling galaxies, intertwining forms, and ethereal landscapes, all punctuated by the same symbols you’ve seen before. The moment you step inside, the amulet in your pocket begins to hum with connection, its warmth intensifying.

The mural seems to pulse with energy, and you feel an inexplicable pull toward it. It’s as if the images are alive, whispering secrets. You can almost hear the faint echo of voices, urging you to look closer.

In the center of the mural, a figure stands, surrounded by vibrant light and shadows. You squint, recognizing the features of the scientist. The urgency of your quest surges within you—he’s somehow tied to this place, and you need to get to him.

You approach the mural, letting your fingers trace the contours of the imagery. As you do, the device in your hand begins to beep in a steady rhythm your here. Suddenly, a section of the mural glows brighter, revealing a hidden passageway behind it.

The beeping accelerates, and you realize this could be a way to reach him. With your heart racing, you step toward the glowing passage, ready to uncover the secrets that lie beyond.
[[Next-&gt;next+1]]</tw-passagedata><tw-passagedata pid="204" name="next+1" tags="" position="6775,2275" size="100,100">As you step through the glowing passage, the first thing that strikes you is the cave—cold and damp, the rough stone walls gleaming under the faint light of bioluminescent fungi. Their soft, eerie glow reflects in small pools of water collecting in the uneven ground, casting shifting shadows around the space. The air smells of earth and moss, thick with moisture, and your footsteps echo faintly as you move deeper inside.

The second thing you register is the chaos. Papers, yellowed and worn, are strewn across the cave floor like fallen leaves. Hand-drawn diagrams, equations, and notes scrawled in the scientist’s unmistakable handwriting litter the space, some pinned haphazardly to the walls. Makeshift tables are cluttered with strange devices—wires hanging loose, blinking lights, mechanical components half-assembled as if they were abandoned in the middle of some frantic work. There’s a tension in the air, an urgency that clings to every object, as if everything here was touched by desperation.

Then, your heart skips a beat as your eyes land on him.

The scientist is hunched over a table, completely absorbed in whatever intricate machine he’s tinkering with. His hair, usually somewhat wild, is now a tangled mess, as though he hasn’t had the luxury of rest in days. His clothes are wrinkled and stained with grease, dirt, and ink, giving him a disheveled, worn-down look. His hands move with a practiced but shaky precision, the telltale signs of exhaustion visible in his every movement. You can almost hear the hum of the device he’s working on, its parts glowing faintly in rhythm with the bioluminescence around you.

Relief washes over you as you see him, alive, but the moment is short-lived. As soon as he notices your presence, he freezes, eyes wide with shock as if he’s seeing a ghost. His face, gaunt and pale, shifts quickly from surprise to something much darker—anguish.

Without warning, he bursts into tears, the sound raw, unfiltered, and desperate. His hands, once so steady, are trembling uncontrollably now as they fall away from the device. &quot;I’m so sorry!&quot; he chokes out, his voice cracking under the weight of guilt. &quot;I didn’t mean for any of this to happen!&quot;

His words spill from him like a flood he can no longer hold back. &quot;I thought I could fix it, I thought I had fixed it, but—&quot; He sobs, his shoulders shaking. &quot;I thought I could make it right. I’m such a fool!&quot;

His knees buckle slightly, and he grips the edge of the table for support, his entire body wracked with sobs. Every apology feels like it’s tearing him apart, each word soaked in regret. You stand there, frozen for a moment, watching as the man you once knew—the man whose brilliant mind had always been his defining feature—crumbles under the weight of his own mistakes.

You //remember// him differently. Not like this.

There was a time when his passion for discovery was infectious, when his eyes would light up at the mere mention of a new idea, a new frontier to explore. You //recall// long nights spent by his side, watching him work through equations with meticulous precision, his mind always ten steps ahead of everyone else. He had always been so sure of himself, so confident, believing that no problem was too great for him to solve.

But now, that confidence is gone, shattered by the very disaster he thought he could prevent. The person standing before you seems like a shadow of the man you remember—the man who had convinced you, against your better judgment, to trust in his vision. You had argued with him, told him he was going too far, that the risks outweighed the potential, but he had just smiled in that infuriating way of his, assuring you he knew what he was doing. You remember his voice, calm yet determined, saying, *&quot;I’ve accounted for everything. Trust me.&quot;*

But you did trust him, didn’t you? You trusted him because you believed in his brilliance, because you had seen him do the impossible before. And now, as you watch him fall apart in front of you, you wonder if that was your mistake all along.

“I’m such a fool,” he whispers again, his voice barely audible now. His hands, once so steady and sure, tremble uncontrollably as they clutch the table, as if it’s the only thing keeping him from collapsing entirely. “But I had to keep trying. I could not lose you, and you kept just—” He cuts himself off, shaking the weight of his emotions spilling over.

You can’t help but recall a time when his hands were sure and confident, sketching out complex designs, building machines that seemed to defy logic. You remember how he used to look at you after solving some impossible equation, that brief, almost smug smile playing on his lips. He had always been on the verge of something great—always so close to pushing past the limits of what anyone thought was possible.

But now, that brilliance seems consumed by the very disaster he created. The man who once inspired awe in you is now reduced to a broken shell, weighed down by guilt, haunted by the consequences of his ambition.
[[Comfort him]]
[[You start yelling]]</tw-passagedata><tw-passagedata pid="205" name="Comfort him" tags="" position="6675,2375" size="100,100">You rush forward, wrapping your arms around him, pulling him into a firm, comforting embrace. His body feels fragile, trembling under the weight of everything that’s happened. You can feel his breath against your shoulder, uneven and shallow, but your mind races with questions, your frustration bubbling beneath the surface.

“Though I do want to know how you deleted me and then yourself, you fool.” The words come out sharper than intended, but they need to be said. “It was that thing, wasn’t it?”

He lets out a muffled, shaky sound—half laugh, half sob—as he clings to you, his whole frame trembling. “I didn’t mean to!” His voice cracks, strained with exhaustion. “I wanted to experiment, to push the boundaries. But the device... it was unstable. It took control of everything, and I couldn’t stop it.”

You pull back slightly, enough to see his face—his eyes, red from tears, are filled with guilt and regret. &quot;You need to explain. What did it do? How can we fix it?&quot;

He wipes his eyes, still shaking as he tries to compose himself. The raw anguish in his expression begins to harden into determination. “The device created a feedback loop I didn’t anticipate. It started erasing connections—people, memories... even you. I thought I could contain it, but it spiraled out of control. By the time I realized what was happening, it was already too late.”

Your hand tightens on his arm, urgency biting at your voice. “And that thing?” You almost don’t want to say its name, but you press on. “What about it? How does that fit in?”

His face darkens with frustration. “That was the first thing I figured out how to deal with,” he mutters bitterly. “It manipulated me. It used the chaos to feed, to grow stronger, and I was just a pawn in its game. I thought I could control it, but it outsmarted me.”

He pauses, his voice dropping as the weight of his failure settles over him again. “I managed to destroy it, but... that didn’t undo the damage. You were still gone. Everything else was still... lost. So I kept looking. Kept trying. I thought if I just found the right combination, the right equation, I could reverse it. But I failed.”

His eyes meet yours, full of a raw, pleading need for understanding. “I’ve been so consumed by trying to be the best, and listening to that thing, that I forgot what really mattered. You—my partner. My friend. I need your help to make this right, to bring back what was lost.”

The weight of his admission hangs in the air, a palpable tension that echoes with the struggles you both faced. You can see the shame etched on his features, the way he wrestles with the consequences of his actions. But beneath that, there’s a flicker of hope, a belief that together you can still change things.

You remember all the times he had chased after success, driven by the need to prove himself. The late-night conversations where he poured his dreams into the air, his eyes alight with ambition. But now, that same ambition feels like a heavy burden he’s struggling to bear.

You can feel the sincerity in his words, and despite your lingering frustration, you can’t help but soften. He’s broken, but he’s still here, still fighting to fix everything, to bring things back.

“Good,” you reply firmly, meeting his eyes with unwavering resolve. “Because we’re partners, and that means facing this mess together. Just tell me what we need to do.”

The determination in his expression begins to solidify, and for the first time, you can see a plan taking shape behind his eyes. “There’s still a way to reverse the damage,” he says, his voice gaining strength. “But we’ll need to gather the right materials and recalibrate the device. If we can disrupt the feedback loop, we might be able to restore what was lost.”

You nod, feeling a renewed sense of purpose. “Then let’s get started. We’ll fix this, Together.”

[[Help Him]]</tw-passagedata><tw-passagedata pid="206" name="Help Him" tags="" position="6550,2375" size="100,100">He flashes a watery smile, a glimmer of hope breaking through the turmoil, before letting go of you and turning back to the chaotic array of devices and notes scattered across the table.

“Alright,” he begins, his voice steadier now but still tinged with an undercurrent of anxiety. “I’ve been working on a plan to counteract the device’s effects. It involves recalibrating this machine”—he gestures to the complex device in front of him, his hands shaking slightly as he brushes aside a pile of disheveled papers—“to emit a frequency that can reverse the feedback loop. But for that, I need components I don’t have here.”

As he speaks, the urgency in his tone returns, a stark reminder of how critical this moment is. His brow is furrowed in concentration, and despite the flicker of determination in his eyes, you can see the weight of guilt still pressing down on him. “We need to gather those components. If we can amplify the signal correctly, it could help reestablish the connections that were lost.”

He rummages through a nearby box, his movements frantic, and pulls out a crumpled list he’d started compiling. “Here’s what we need: specific crystals that resonate at certain frequencies, a stabilizing core, and some wiring to connect it all.” His voice wavers slightly as he adds, “I believe I know where we can find them, but we’ll have to move quickly.”

Watching him, you can’t help but feel a pang of sympathy. This is not the confident figure of science you once knew; he’s become a shadow of himself, frazzled and desperate. The disheveled state of his clothes and the haunted look in his eyes tell a story of stress and regret.

You step closer, placing a hand on his shoulder, feeling the tension in his muscles. “We’ll get through this. I know it’s overwhelming, but we can do this together.”

He looks up at you, vulnerability flickering across his features. “I just… I didn’t want to put you in danger. This was my mistake. I should have known better.”

You shake your head, squeezing his shoulder gently. “You’re not alone in this. We’re partners, remember? We’ll face the consequences together.”

The determination in his eyes ignites a fire in you, and you nod, ready to tackle this challenge. “Let’s go then. Time is not on our side.”
[[Get to Work]]
</tw-passagedata><tw-passagedata pid="207" name="Get to Work" tags="" position="6550,2500" size="100,100">You both quickly get to work, gathering supplies and preparing for the task ahead. He busily scribbles down a more detailed list, his focus sharpening as he sorts through the clutter around him. You can sense the urgency in his movements, fueling your own determination.

Everything you need is scattered around the cave—tools, materials, and fragments of equipment that can be pieced together. He glances at you occasionally, relief washing over his features each time you make eye contact. It’s clear he’s grateful to have you by his side, a steady presence amid the chaos.

“Honestly, I don’t know what I would have done without you,” he admits, his voice laced with sincerity. “Having you here gives me hope that we can fix this.”

His words warm your heart, creating a shared purpose that binds you together as you prepare for the challenges ahead. You can see the tension in his shoulders begin to ease slightly, and he leans against the table for support, gathering his thoughts. 

With renewed determination, you dive into the tasks, working in sync. As you pass him a crucial component, your hands brush against each other, and he lingers for a moment, as if drawing strength from your presence. The connection feels palpable, a silent agreement that you’re in this together.

The chaotic energy in the cave shifts as you harness the materials. Each component clicks into place, and you can feel the tension in the air transforming into something more hopeful. He leans closer to you as he works, his shoulder grazing yours, and you can sense the weight of his worries, the way he relies on you to ground him.

Finally, with a last turn of a screw and a flick of a switch, everything powers up. The scientist’s eyes widen as the device glows with vibrant light, pulsing in rhythm with the amulet.

“It’s working!” he exclaims, a mix of disbelief and joy flooding his voice. “We might actually have a chance!”

The energy in the room intensifies, swirling around you like a storm of potential. He leans closer, almost as if he needs to lean on you for support, the gravity of the moment weighing heavily on him. You can feel a shift, a pull toward something larger—toward all the connections that had been severed.

You share a glance, the spark of determination igniting anew. “Let’s see this through,” you say, and he nods, his expression resolute yet still tinged with vulnerability.

As the device hums and vibrates, he leans in slightly, seeking your reassurance, waiting for the moment when everything you’ve worked for comes to fruition. The air is thick with anticipation, and for the first time, you truly believe you might be able to reclaim what was lost.
[[NEXT?]]</tw-passagedata><tw-passagedata pid="208" name="NEXT?" tags="" position="6425,2625" size="100,100">Everything flashes brightly for a moment, a kaleidoscope of colors and sensations overwhelming your senses. You feel a rush of energy coursing through you, and for a brief instant, it’s as if you can see glimpses of the connections that had been lost—faces, places, and memories flashing before your eyes.

Then, just as suddenly as it began, the energy settles into a calm, steady hum. The device stabilizes, and the glow dims to a gentle light, revealing a series of images on its screen. The scientist leans in, his eyes wide with amazement.

“Look! It’s registering connections! It’s showing us where we need to go to restore what was lost!” His voice is filled with wonder and urgency.

You scan the screen, your heart racing as you see familiar symbols and coordinates appear, linked to places that resonate with you. “This is it! We can fix everything!”

With a newfound sense of purpose, you turn to the scientist. “What’s our next step?”

He nods, his determination matching yours. “We need to follow these signals. If we can reach each location, we might be able to restore the connections and counteract the damage that’s been done.”

You both make it in time, racing to the first location indicated by the device. As you arrive, the air crackles with energy, the atmosphere thick with anticipation. The symbols from the device pulse softly, guiding you to the center of the area.

Together, you set up the equipment, your movements synchronized as if you’ve been doing this for years. The scientist&#39;s hands are steady, his focus unwavering as he activates the device. The moment everything clicks into place, a surge of energy courses through the air, illuminating the space around you.

The device hums, and the symbols glow brighter. You can feel the connections beginning to reestablish themselves, a ripple of energy flowing outward. Images flash before your eyes—faces, places, memories—filling the void left by the chaos. Each connection restored strengthens your resolve, and you know you’re on the right path.

With each successful restoration, a sense of relief washes over both of you. The weight of the past seems to lift, and hope begins to flourish. “We’re doing it!” you exclaim, a grin breaking across your face.

The scientist nods, his own smile reflecting the joy and determination within him. “Just a few more, and we’ll get everything back.”

In a spontaneous burst of gratitude and relief, he steps forward and pulls you into a tight hug. The warmth of his embrace envelops you, and for a moment, all the chaos fades away. It’s a brief respite from the whirlwind around you, a reminder of the bond you share.

“Thank you,” he whispers, his voice muffled against your shoulder. “I couldn’t have done this without you.”

You return the hug, feeling the weight of his gratitude and the shared sense of purpose between you. But just as quickly, he pulls back, his expression shifting to one of determination. “Let’s keep moving—we have more connections to restore!”

[[IT&#39;s OVER?]]</tw-passagedata><tw-passagedata pid="209" name="IT&#39;s OVER?" tags="True-ending" position="6525,2775" size="100,100">As the last connection settles, a wave of calm washes over the room. The device emits a soft chime, its lights stabilizing as the final remnants of energy coalesce into a brilliant glow. You both stand there, breathless, as the air hums with the resonance of restored connections.

For a moment, everything is still. Then, gradually, you begin to notice changes around you. The chaos in the lab seems to dissipate, the clutter rearranging itself into a more orderly state. The shadows recede, and the cave feels less foreboding, illuminated by a newfound light that radiates from the very essence of restored memories.

Elias looks at you, eyes wide with a mix of disbelief and joy. “It worked! We actually did it!” His voice is filled with emotion, and you can see the relief flooding his expression.

You laugh, the sound echoing in the cave as you shake your head in disbelief. “I still can’t believe you managed to erase yourself too, Elias!”

He rubs the back of his neck, a mix of embarrassment and amusement coloring his cheeks. “I suppose I do have a knack for making things more complicated than they need to be,” he admits, his earlier distress fading into a sheepish smile.

“But we’re back now, and that’s what matters,” you say, feeling a surge of warmth. “Let’s make sure this never happens again.”

Elias nods, determination returning to his eyes, but you notice a flicker of vulnerability behind his resolve. “Agreed. I won’t let my curiosity lead me down such a dangerous path again. No more trusting random entities from beyond this dimension for plans and ideas. It’s too risky.”

His voice trails off, and you sense the weight of what he’s been through. “You’ve been through so much,” you say gently, stepping closer. “It’s okay to feel scared or overwhelmed. I know it’s been tough.”

He looks down for a moment, the shadows of doubt flickering across his features. “I thought I could handle it, but I lost control. I didn’t just put myself in danger; I dragged you into it too. I can’t shake the feeling that I failed.”

You place a reassuring hand on his shoulder, grounding him. “You didn’t fail. You made a mistake, but we fixed it together. It’s okay to lean on someone sometimes, especially when things get tough.”

Elias meets your gaze, the sincerity in your words cutting through his self-doubt. “I appreciate that. I guess I’ve always felt like I had to carry the weight of my decisions alone.”

“Not anymore,” you reply firmly. “You have me, and we’ll face whatever comes next as partners. That means sharing the burden, not just the victories.”

A glimmer of hope flickers in his eyes, and he smiles, gratitude pouring from him. “Thank you. I don’t deserve it, but it means a lot to know I’m not alone in this.”

You chuckle lightly, the tension easing as you share a knowing look. “Of course you deserve it. We both do. Let’s focus on what we can control and make sure we’re prepared for whatever comes next.”

With a renewed sense of camaraderie, you grin. “Back to it, partner!”

Together, you start organizing the lab, making sure everything is in order and that the device is stable. The glow of restored connections lingers in the air, a reminder of your shared triumph.

As you sort through the scattered papers, Elias leans against the table, a thoughtful look crossing his face. “So, what should we tackle next? There’s so much potential out there.”

You pause, considering the possibilities. “Maybe we should focus on dimensional travel more systematically? Now that we’ve seen the consequences, we could explore safer ways to navigate those realms.”

Elias nods enthusiastically. “That sounds promising! We could develop a method to stabilize portals and ensure they don’t become unstable like the last one. Maybe even a guide for what to expect in different dimensions.”

“Exactly!” you reply, excitement bubbling up. “And we could compile a list of known entities and their behaviors, so we’re better prepared if we encounter something unexpected.”

His eyes light up at the idea. “I love that! We could even create simulations to test our theories before we try them out in real situations. That way, we can explore without putting ourselves at risk.”

“Right! And we could share our findings with the scientific community to help others avoid the mistakes we made,” you add, feeling the weight of responsibility settling in a good way.

Elias’s gaze drifts around the lab, filled with hope and determination. “It’s a fresh start for us. We’ll make this a place of discovery and safety.”

You both share a smile, but then a comfortable silence settles in, the excitement trailing off as you continue to organize and tidy up. The weight of the past lingers in the air, yet there’s a lightness that comes from knowing you’re in this together.

As the last papers are stacked neatly, Elias glances at you. “Whatever we choose, I know we’ll face it head-on. Together.”

“Together,” you echo, feeling a sense of purpose solidify between you as you look toward the future.

With that shared understanding, you both dive back into the tasks at hand, the promise of new adventures waiting just beyond the horizon.

[[THE END-&gt;The Echoes of the Unknown]]
</tw-passagedata><tw-passagedata pid="210" name="You start yelling" tags="" position="6925,2300" size="100,100">You can feel the anger boiling inside you, a mixture of frustration and fear. “You’re a genius, but you’ve put us in this mess! How could you think this was a good idea?” Your voice rises, echoing in the cave, and you see him flinch at your words.

“I know! I know!” he pleads, his voice trembling. “I thought I could control it. I thought I could help!”

“Help? By dragging me into this nightmare? You need to take responsibility for this, not just apologize! We have to fix it now—no more mistakes!”

His expression shifts, a flicker of determination breaking through the despair, but it quickly dims as he bows his head. “You’re right. I messed up. I just wanted to do something important, something that would change the world. But all I did was create chaos.”

You cross your arms, frustration bubbling over. “You think this is just about fixing your mistake? I told you the entity was bad news! You didn’t listen then, did you? And look where we are now!”

He winces, shame washing over his features. “I know,” he replies, his voice low and strained. “I should have listened. I thought I could control it—thought I could find a way to harness its power without consequences. But I was wrong.”

You point toward the darkness beyond the cave’s flickering light. “That thing is out there, and it’s angry. You thought you could handle it, but now look at you! You look worse than ever. How can I trust you to fix this?”

He takes a deep breath, his hands trembling slightly. “I’ve already faced the entity. It’s not a problem anymore; now I&#39;m just trying to fix what I broke.”

His voice shakes as he continues, and you see the tremor in his hands. “I’m not just looking to patch things up; I want to set everything right. If I can stabilize the device, I can fix all the broken connections. I just need your help to gather the last components.”

His gaze drops to the ground, and you can see the weight of his failure pressing down on him like a physical burden. “I thought I was doing something groundbreaking. I thought I could control it. But now… now I see how foolish I was. I never wanted to hurt anyone, especially not you.”

Tears spill down his cheeks, and he wipes at them angrily, as if embarrassed by his vulnerability. “I feel so lost, and I don’t know if I can make this right. I’ve failed you, and I’m terrified that it’s too late.” 

The sight of him—defeated, vulnerable, and shaking—pierces through your anger. He stands there, shoulders slumped, looking smaller and more fragile than ever, like a child who’s made a terrible mistake and is now faced with the consequences. It’s a stark reminder that, despite his brilliance, he’s still human, still grappling with the fallout of his actions.

“Please,” he whispers, his voice barely audible, “just give me this chance to make it right. I can’t do it alone. I don’t want to lose you, too.” 

His vulnerability hangs in the air, and for a moment, the tension between you softens. You can see the fear of failure in his eyes, and despite everything, a part of you aches for him.
[[Hug him]]
[[Keep your distance]]</tw-passagedata><tw-passagedata pid="211" name="Hug him" tags="" position="6775,2475" size="100,100">As the weight of his words settles in, your heart softens despite the anger still simmering beneath the surface. You see the genuine regret in his eyes, the fear of what he’s unleashed, and it strikes a chord within you. Without fully understanding why, you step forward and wrap your arms around him in a tight hug.

He tenses for a moment, surprised, but then relaxes into the embrace, his body shaking with quiet sobs. You hold him there, feeling the warmth of his presence mingling with the tension in the air. “We’ll fix this,” you whisper, your voice steady despite your own conflicted emotions. “But we need to work together. You can’t do it alone.”

He nods against you, his breath hitching. “I promise. I won’t let you down again.” His voice is muffled, thick with emotion, and you can feel the weight of his remorse pressing against you. He leans into you more, almost as if seeking strength from your embrace, and it stirs something deep within you—a mixture of compassion and determination.

When you finally pull away, there’s a vulnerability in his eyes that makes your heart ache. He wipes at his cheeks, but the tears keep coming, betraying his struggle to hold himself together. “I didn’t mean for any of this to happen,” he murmurs, his voice cracking. “I thought I could be brilliant, but I ended up being reckless instead. And then you were gone.”

His words hang in the air, heavy with the weight of his grief. “I thought I lost everything,” he adds, a shudder running through him. “I thought I had erased you for good, and it crushed me.”

Seeing him like this—so raw and broken—pierces through your anger. Despite everything, you can feel the depth of his pain, and it softens your resolve. “You didn’t lose me, not completely. I’m here now, and we can make this right.”

His eyes shimmer with a mix of relief and guilt. “But what if I mess up again? I can’t keep dragging you into my mistakes.”

“You’re not dragging me anywhere,” you insist gently. “We’re partners, remember? We face these challenges together. I trust you, even when you doubt yourself.”

He looks at you, searching for reassurance, and for a moment, the anger fades, replaced by a flicker of hope. “I never wanted to hurt you. I just… got caught up in my own ambition. I thought I could control it all.”

You place a hand on his shoulder, grounding him. “And now you see the consequences. That’s a start. Let’s channel that into something positive. We need to gather the components to fix this mess, together.”

He takes a deep breath, and though he still looks fragile, there’s a spark of determination in his eyes. “You’re right. I can’t let fear hold me back anymore.”
[[Get to Work]]</tw-passagedata><tw-passagedata pid="212" name="Keep your distance" tags="" position="7125,2375" size="100,100">You need to pull yourself together,” you say, your tone softer but firm. “Crying won’t fix this. We have to focus on what’s next.”

He wipes his face with his sleeve, struggling to regain his composure. “You’re right. I can’t afford to break down now. I have to be strong for both of us.” His voice wavers, and you can see the remnants of fear etched across his features, like a shadow that refuses to leave.

“Exactly. So tell me what we need to do. What’s the plan to find those components and fix what you broke?”

He takes a shaky breath, trying to steady himself. “There are specific areas in the cave where the energy signatures are strongest. If we split up, we can cover more ground. I’ll focus on the device, and you can help look for the power source. But stay alert; the entity could still be lurking nearby.”

You nod, adrenaline surging. “Fine. Let’s move quickly, then. We can’t let this situation get any worse.”

As you prepare to head deeper into the cave, you can see the guilt weighing heavily on him. “I never wanted this to happen,” he murmurs, almost to himself. “I thought I could control everything. I just… I wanted to prove I could make a difference.”

You feel a pang of sympathy despite your anger. “Well, you did make a difference. Just not the one you intended,” you say, your voice softening. “But now we need to focus on fixing it. We can’t afford any more mistakes.”

He nods, determination flickering back to life in his eyes, but the guilt still lingers. “You’re right. Let’s do this together. I won’t let you down again.”

With a shared glance, you both prepare to move deeper into the cave, the weight of your mission hanging heavily in the air. His eyes meet yours, filled with a mix of fear and regret. “Thank you for sticking by me. I know I’ve put you in danger, and I hate myself for it.” 

You swallow hard, trying to push your frustration aside. “Just stay close, and we’ll figure this out.” The shadows of the cave seem to close in around you as you venture forth, ready to face whatever lies ahead.
[[There it is]]</tw-passagedata><tw-passagedata pid="213" name="There it is" tags="" position="6925,2550" size="100,100">You both move the device to the center of the cave, the atmosphere charged with a mix of hope and apprehension. The scientist glances at you, but his eyes are filled with uncertainty, a reflection of the mistakes he’s made.

“Are you ready?” he asks, his voice steady but a slight tremor betrays his nerves. He fidgets with the wires, adjusting them repeatedly, almost as if he’s trying to convince himself it’ll be okay.

“Yeah, let’s do this,” you reply, trying to keep your own nerves in check.

As he prepares to activate the device, you notice him hesitating, biting his lip. “I… I just want to make sure everything’s perfect,” he murmurs, glancing at you with an almost pleading expression. “I can’t afford to mess this up again.”

You can see the shadows of doubt clouding his features, the way he keeps glancing at the device as if he’s expecting it to fail. “Elias, focus. We’ve come too far to second-guess ourselves now,” you urge, trying to push him out of his spiral of anxiety.

“Right. Right, of course,” he stammers, but you can see him struggling to mask his fear. “It’s just… what if the energy is too strong? What if I can’t control it again?” 

He brushes his hands over the device, his fingers trembling. “I never wanted to put you in danger… I thought I was being careful, but now…”

“Enough with the ‘what ifs.’ We have the tools we need. We can handle this together,” you insist, your voice firm yet encouraging.

He takes a deep breath, nodding slowly, but you can see the internal battle raging within him. “You’re right. I just… I can’t shake this feeling that I’ve already lost too much.” 

You reach out, placing a reassuring hand on his shoulder. “We’re not going to lose anything else. This time, we’re doing it right.”

He looks at you, gratitude mingling with his lingering guilt. “Thank you for believing in me,” he murmurs, but the heaviness in his gaze tells you he still feels unworthy of that trust. “I promise I’ll make this right.”

With a final nod, he takes his place at the control panel, fingers hovering above the activation switch. You can see him steeling himself, the tension in the air palpable. “On three, okay?” he says, his voice shaking slightly.

“Let’s do it,” you reply, determination filling you both. As he counts down, you can’t help but feel a surge of hope, tempered with the awareness of everything that’s at stake.
[[It works?]]</tw-passagedata><tw-passagedata pid="214" name="It works?" tags="" position="6775,2675" size="100,100">Everything flashes brightly for a moment, a kaleidoscope of colors and sensations overwhelming your senses. You feel a rush of energy coursing through you, and for a brief instant, it’s as if you can see glimpses of the connections that had been lost—faces, places, and memories flashing before your eyes.

Then, just as suddenly as it began, the energy settles into a calm, steady hum. The device stabilizes, and the glow dims to a gentle light, revealing a series of images on its screen. The scientist leans in, his eyes wide with amazement.

“Look! It’s registering connections! It’s showing us where we need to go to restore what was lost!” His voice is filled with wonder and urgency.

You scan the screen, your heart racing as you see familiar symbols and coordinates appear, linked to places that resonate with you. “This is it! We can fix everything!”

With a newfound sense of purpose, you turn to the scientist. “What’s our next step?”

He nods, his determination matching yours. “We need to follow these signals. If we can reach each location, we might be able to restore the connections and counteract the damage that’s been done.”
You both make it in time, racing to the first location indicated by the device. As you arrive, the air crackles with energy, the atmosphere thick with anticipation. The symbols from the device pulse softly, guiding you to the center of the area.

Together, you set up the equipment, your movements synchronized as if you’ve been doing this for years. The scientist&#39;s hands are steady, his focus unwavering as he activates the device. The moment everything clicks into place, a surge of energy courses through the air, illuminating the space around you.

The device hums, and the symbols glow brighter. You can feel the connections beginning to reestablish themselves, a ripple of energy flowing outward. Images flash before your eyes—faces, places, memories—filling the void left by the chaos. Each connection restored strengthens your resolve, and you know you’re on the right path.

With each successful restoration, a sense of relief washes over both of you. The weight of the past seems to lift, and hope begins to flourish. “We’re doing it!” you exclaim, a grin breaking across your face.

The scientist nods, his own smile reflecting the joy and determination within him. “Just a few more, and we’ll get everything back.”

Everything flashes brightly for a moment, a kaleidoscope of colors and sensations overwhelming your senses. You feel a rush of energy coursing through you, and for a brief instant, it’s as if you can see glimpses of the connections that had been lost—faces, places, and memories flashing before your eyes.

Then, just as suddenly as it began, the energy settles into a calm, steady hum. The device stabilizes, and the glow dims to a gentle light, revealing a series of images on its screen. The scientist leans in, his eyes wide with amazement.

“Look! It’s registering connections! It’s showing us where we need to go to restore what was lost!” His voice is filled with wonder and urgency.

You scan the screen, your heart racing as you see familiar symbols and coordinates appear, linked to places that resonate with you. “This is it! We can fix everything!”

With a newfound sense of purpose, you turn to the scientist. “What’s our next step?”

He nods, his determination matching yours. “We need to follow these signals. If we can reach each location, we might be able to restore the connections and counteract the damage that’s been done.”
You both make it in time, racing to the first location indicated by the device. As you arrive, the air crackles with energy, the atmosphere thick with anticipation. The symbols from the device pulse softly, guiding you to the center of the area.

Together, you set up the equipment, your movements synchronized as if you’ve been doing this for years. The scientist&#39;s hands are steady, his focus unwavering as he activates the device. The moment everything clicks into place, a surge of energy courses through the air, illuminating the space around you.

The device hums, and the symbols glow brighter. You can feel the connections beginning to reestablish themselves, a ripple of energy flowing outward. Images flash before your eyes—faces, places, memories—filling the void left by the chaos. Each connection restored strengthens your resolve, and you know you’re on the right path.

With each successful restoration, a sense of relief washes over both of you. The weight of the past seems to lift, and hope begins to flourish. “We’re doing it!” you exclaim, a grin breaking across your face.

The scientist nods, his own smile reflecting the joy and determination within him. “Just a few more, and we’ll get everything back.”

[[IT&#39;s OVER?]]
[[Still mad]]</tw-passagedata><tw-passagedata pid="215" name="Still mad" tags="True-ending" position="7000,2800" size="100,100">As you walk alongside Elias, the remnants of your anger still simmer beneath the surface. You can’t shake the frustration that led you here, the feeling that his reckless ambition nearly cost you everything. But as you glance at the restored connections and the glowing symbols of hope, a flicker of understanding begins to emerge.

You’re not ready to fully forgive him, not yet. The scars of the past linger, and the hurt is still fresh. But seeing him work so diligently, so passionately to fix what he broke, sparks a thought: maybe one day you could find it in yourself to forgive him.

For now, though, you keep your guard up, maintaining a healthy distance while also acknowledging the progress you’ve made together. “You know,” you say, your tone measured, “it’s not enough to just fix the device. We need to learn from this experience. You have to be more careful in the future.”

Elias meets your gaze, sincerity etched on his face. “I understand. I won’t take unnecessary risks again. I promise to listen this time.” His voice trembles slightly, and you see the weight of guilt pressing down on him.

“Honestly, I can’t even begin to express how sorry I am,” he continues, running a hand through his hair, frustration evident in the gesture. “I thought I could control everything, but I was so caught up in my ambitions that I didn’t see the danger. I was reckless, and it almost cost us everything.”

You feel a mix of sympathy and skepticism. “You can’t just say you’re sorry and expect it to change anything. Actions speak louder than words, Elias.”

He nods vigorously, his eyes pleading. “I know, and I’ll prove it to you. I’ll do everything I can to make this right. I’ll be more cautious, and I promise to consider your perspective. You deserve that much after what I’ve put you through.”

“It&#39;s hard to trust someone who acts without thinking,” you reply, your tone still firm. “You need to understand the impact of your choices.”

“I do. I really do,” he insists, his voice cracking with emotion. “I’ve been reflecting on everything, and I can’t shake the feeling that I’ve let you down. I never wanted to drag you into this, to put you in harm&#39;s way. If I could take it all back, I would.”

Seeing him like this—raw and vulnerable—pulls at your heartstrings. You want to believe that he means it, that he truly understands the weight of his actions. “Words are easy, Elias. What matters is that you learn from this.”

“I promise I will,” he replies, desperation in his eyes. “I’ll be better. You have my word. Please, just give me a chance to show you I can change.” 

His sincerity makes you pause, and you can sense the depth of his remorse. For now, the road to forgiveness feels long, but you appreciate his efforts to atone for his mistakes. “I’ll hold you to that,” you say, trying to keep your tone steady. 

As you both continue your journey, the weight of the past is still there, but the potential for growth and healing looms larger. Maybe, just maybe, there’s a path toward forgiveness waiting on the horizon. For now, you’re willing to walk alongside him, ready to face whatever challenges come next, one step at a time.

[[THE END-&gt;The Echoes of the Unknown]]</tw-passagedata><tw-passagedata pid="216" name="The Echoes of the Unknown" tags="Tital-card" position="2400,100" size="100,100">Welcome to//&#39;&#39; The Echoes of the Unknown&#39;&#39;//—a journey where the familiar and the mysterious intertwine, pulling you deeper into a world of secrets, strange coordinates, and unsettling truths. The clock is ticking, and each step you take may bring you closer to an answer—or to something far more dangerous. Are you ready to uncover what lies beyond the ordinary?
														=&gt;&lt;=





[[START-&gt;Start]] </tw-passagedata></tw-storydata>
<script title="Twine engine code" data-main="harlowe">(function(){"use strict";
var require,define;!function(){var e={},r={};require=function(i){var n=e[i];return n&&(r[i]=n[1].apply(void 0,n[0].map(require)),e[i]=void 0),r[i]},(define=function(r,i,n){if("function"==typeof r)return r();e[r]=[i,n]}).amd=!0}();/*!
 * https://github.com/paulmillr/es6-shim
 * @license es6-shim Copyright 2013-2016 by Paul Miller (http://paulmillr.com)
 *   and contributors,  MIT License
 * es6-shim: v0.35.4
 * see https://github.com/paulmillr/es6-shim/blob/0.35.3/LICENSE
 * Details and documentation:
 * https://github.com/paulmillr/es6-shim/
 */
(function(e,t){if(typeof define==="function"&&define.amd){define(t)}else if(typeof exports==="object"){module.exports=t()}else{e.returnExports=t()}})(this,function(){"use strict";var e=Function.call.bind(Function.apply);var t=Function.call.bind(Function.call);var r=Array.isArray;var n=Object.keys;var o=function notThunker(t){return function notThunk(){return!e(t,this,arguments)}};var i=function(e){try{e();return false}catch(t){return true}};var a=function valueOrFalseIfThrows(e){try{return e()}catch(t){return false}};var u=o(i);var f=function(){return!i(function(){return Object.defineProperty({},"x",{get:function(){}})})};var s=!!Object.defineProperty&&f();var c=function foo(){}.name==="foo";var l=Function.call.bind(Array.prototype.forEach);var p=Function.call.bind(Array.prototype.reduce);var v=Function.call.bind(Array.prototype.filter);var y=Function.call.bind(Array.prototype.some);var h=function(e,t,r,n){if(!n&&t in e){return}if(s){Object.defineProperty(e,t,{configurable:true,enumerable:false,writable:true,value:r})}else{e[t]=r}};var b=function(e,t,r){l(n(t),function(n){var o=t[n];h(e,n,o,!!r)})};var g=Function.call.bind(Object.prototype.toString);var d=typeof/abc/==="function"?function IsCallableSlow(e){return typeof e==="function"&&g(e)==="[object Function]"}:function IsCallableFast(e){return typeof e==="function"};var m={getter:function(e,t,r){if(!s){throw new TypeError("getters require true ES5 support")}Object.defineProperty(e,t,{configurable:true,enumerable:false,get:r})},proxy:function(e,t,r){if(!s){throw new TypeError("getters require true ES5 support")}var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,{configurable:n.configurable,enumerable:n.enumerable,get:function getKey(){return e[t]},set:function setKey(r){e[t]=r}})},redefine:function(e,t,r){if(s){var n=Object.getOwnPropertyDescriptor(e,t);n.value=r;Object.defineProperty(e,t,n)}else{e[t]=r}},defineByDescriptor:function(e,t,r){if(s){Object.defineProperty(e,t,r)}else if("value"in r){e[t]=r.value}},preserveToString:function(e,t){if(t&&d(t.toString)){h(e,"toString",t.toString.bind(t),true)}}};var O=Object.create||function(e,t){var r=function Prototype(){};r.prototype=e;var o=new r;if(typeof t!=="undefined"){n(t).forEach(function(e){m.defineByDescriptor(o,e,t[e])})}return o};var w=function(e,t){if(!Object.setPrototypeOf){return false}return a(function(){var r=function Subclass(t){var r=new e(t);Object.setPrototypeOf(r,Subclass.prototype);return r};Object.setPrototypeOf(r,e);r.prototype=O(e.prototype,{constructor:{value:r}});return t(r)})};var j=function(){if(typeof self!=="undefined"){return self}if(typeof window!=="undefined"){return window}if(typeof global!=="undefined"){return global}throw new Error("unable to locate global object")};var S=j();var T=S.isFinite;var I=Function.call.bind(String.prototype.indexOf);var E=Function.apply.bind(Array.prototype.indexOf);var P=Function.call.bind(Array.prototype.concat);var C=Function.call.bind(String.prototype.slice);var M=Function.call.bind(Array.prototype.push);var x=Function.apply.bind(Array.prototype.push);var N=Function.call.bind(Array.prototype.join);var A=Function.call.bind(Array.prototype.shift);var _=Math.max;var R=Math.min;var k=Math.floor;var L=Math.abs;var F=Math.exp;var D=Math.log;var z=Math.sqrt;var q=Function.call.bind(Object.prototype.hasOwnProperty);var W;var G=function(){};var H=S.Map;var V=H&&H.prototype["delete"];var B=H&&H.prototype.get;var U=H&&H.prototype.has;var $=H&&H.prototype.set;var J=S.Symbol||{};var X=J.species||"@@species";var K=Number.isNaN||function isNaN(e){return e!==e};var Z=Number.isFinite||function isFinite(e){return typeof e==="number"&&T(e)};var Y=d(Math.sign)?Math.sign:function sign(e){var t=Number(e);if(t===0){return t}if(K(t)){return t}return t<0?-1:1};var Q=function log1p(e){var t=Number(e);if(t<-1||K(t)){return NaN}if(t===0||t===Infinity){return t}if(t===-1){return-Infinity}return 1+t-1===0?t:t*(D(1+t)/(1+t-1))};var ee=function isArguments(e){return g(e)==="[object Arguments]"};var te=function isArguments(e){return e!==null&&typeof e==="object"&&typeof e.length==="number"&&e.length>=0&&g(e)!=="[object Array]"&&g(e.callee)==="[object Function]"};var re=ee(arguments)?ee:te;var ne={primitive:function(e){return e===null||typeof e!=="function"&&typeof e!=="object"},string:function(e){return g(e)==="[object String]"},regex:function(e){return g(e)==="[object RegExp]"},symbol:function(e){return typeof S.Symbol==="function"&&typeof e==="symbol"}};var oe=function overrideNative(e,t,r){var n=e[t];h(e,t,r,true);m.preserveToString(e[t],n)};var ie=typeof J==="function"&&typeof J["for"]==="function"&&ne.symbol(J());var ae=ne.symbol(J.iterator)?J.iterator:"_es6-shim iterator_";if(S.Set&&typeof(new S.Set)["@@iterator"]==="function"){ae="@@iterator"}if(!S.Reflect){h(S,"Reflect",{},true)}var ue=S.Reflect;var fe=String;var se=typeof document==="undefined"||!document?null:document.all;var ce=se==null?function isNullOrUndefined(e){return e==null}:function isNullOrUndefinedAndNotDocumentAll(e){return e==null&&e!==se};var le={Call:function Call(t,r){var n=arguments.length>2?arguments[2]:[];if(!le.IsCallable(t)){throw new TypeError(t+" is not a function")}return e(t,r,n)},RequireObjectCoercible:function(e,t){if(ce(e)){throw new TypeError(t||"Cannot call method on "+e)}return e},TypeIsObject:function(e){if(e===void 0||e===null||e===true||e===false){return false}return typeof e==="function"||typeof e==="object"||e===se},ToObject:function(e,t){return Object(le.RequireObjectCoercible(e,t))},IsCallable:d,IsConstructor:function(e){return le.IsCallable(e)},ToInt32:function(e){return le.ToNumber(e)>>0},ToUint32:function(e){return le.ToNumber(e)>>>0},ToNumber:function(e){if(ie&&g(e)==="[object Symbol]"){throw new TypeError("Cannot convert a Symbol value to a number")}return+e},ToInteger:function(e){var t=le.ToNumber(e);if(K(t)){return 0}if(t===0||!Z(t)){return t}return(t>0?1:-1)*k(L(t))},ToLength:function(e){var t=le.ToInteger(e);if(t<=0){return 0}if(t>Number.MAX_SAFE_INTEGER){return Number.MAX_SAFE_INTEGER}return t},SameValue:function(e,t){if(e===t){if(e===0){return 1/e===1/t}return true}return K(e)&&K(t)},SameValueZero:function(e,t){return e===t||K(e)&&K(t)},GetIterator:function(e){if(re(e)){return new W(e,"value")}var t=le.GetMethod(e,ae);if(!le.IsCallable(t)){throw new TypeError("value is not an iterable")}var r=le.Call(t,e);if(!le.TypeIsObject(r)){throw new TypeError("bad iterator")}return r},GetMethod:function(e,t){var r=le.ToObject(e)[t];if(ce(r)){return void 0}if(!le.IsCallable(r)){throw new TypeError("Method not callable: "+t)}return r},IteratorComplete:function(e){return!!e.done},IteratorClose:function(e,t){var r=le.GetMethod(e,"return");if(r===void 0){return}var n,o;try{n=le.Call(r,e)}catch(i){o=i}if(t){return}if(o){throw o}if(!le.TypeIsObject(n)){throw new TypeError("Iterator's return method returned a non-object.")}},IteratorNext:function(e){var t=arguments.length>1?e.next(arguments[1]):e.next();if(!le.TypeIsObject(t)){throw new TypeError("bad iterator")}return t},IteratorStep:function(e){var t=le.IteratorNext(e);var r=le.IteratorComplete(t);return r?false:t},Construct:function(e,t,r,n){var o=typeof r==="undefined"?e:r;if(!n&&ue.construct){return ue.construct(e,t,o)}var i=o.prototype;if(!le.TypeIsObject(i)){i=Object.prototype}var a=O(i);var u=le.Call(e,a,t);return le.TypeIsObject(u)?u:a},SpeciesConstructor:function(e,t){var r=e.constructor;if(r===void 0){return t}if(!le.TypeIsObject(r)){throw new TypeError("Bad constructor")}var n=r[X];if(ce(n)){return t}if(!le.IsConstructor(n)){throw new TypeError("Bad @@species")}return n},CreateHTML:function(e,t,r,n){var o=le.ToString(e);var i="<"+t;if(r!==""){var a=le.ToString(n);var u=a.replace(/"/g,"&quot;");i+=" "+r+'="'+u+'"'}var f=i+">";var s=f+o;return s+"</"+t+">"},IsRegExp:function IsRegExp(e){if(!le.TypeIsObject(e)){return false}var t=e[J.match];if(typeof t!=="undefined"){return!!t}return ne.regex(e)},ToString:function ToString(e){if(ie&&g(e)==="[object Symbol]"){throw new TypeError("Cannot convert a Symbol value to a number")}return fe(e)}};if(s&&ie){var pe=function defineWellKnownSymbol(e){if(ne.symbol(J[e])){return J[e]}var t=J["for"]("Symbol."+e);Object.defineProperty(J,e,{configurable:false,enumerable:false,writable:false,value:t});return t};if(!ne.symbol(J.search)){var ve=pe("search");var ye=String.prototype.search;h(RegExp.prototype,ve,function search(e){return le.Call(ye,e,[this])});var he=function search(e){var t=le.RequireObjectCoercible(this);if(!ce(e)){var r=le.GetMethod(e,ve);if(typeof r!=="undefined"){return le.Call(r,e,[t])}}return le.Call(ye,t,[le.ToString(e)])};oe(String.prototype,"search",he)}if(!ne.symbol(J.replace)){var be=pe("replace");var ge=String.prototype.replace;h(RegExp.prototype,be,function replace(e,t){return le.Call(ge,e,[this,t])});var de=function replace(e,t){var r=le.RequireObjectCoercible(this);if(!ce(e)){var n=le.GetMethod(e,be);if(typeof n!=="undefined"){return le.Call(n,e,[r,t])}}return le.Call(ge,r,[le.ToString(e),t])};oe(String.prototype,"replace",de)}if(!ne.symbol(J.split)){var me=pe("split");var Oe=String.prototype.split;h(RegExp.prototype,me,function split(e,t){return le.Call(Oe,e,[this,t])});var we=function split(e,t){var r=le.RequireObjectCoercible(this);if(!ce(e)){var n=le.GetMethod(e,me);if(typeof n!=="undefined"){return le.Call(n,e,[r,t])}}return le.Call(Oe,r,[le.ToString(e),t])};oe(String.prototype,"split",we)}var je=ne.symbol(J.match);var Se=je&&function(){var e={};e[J.match]=function(){return 42};return"a".match(e)!==42}();if(!je||Se){var Te=pe("match");var Ie=String.prototype.match;h(RegExp.prototype,Te,function match(e){return le.Call(Ie,e,[this])});var Ee=function match(e){var t=le.RequireObjectCoercible(this);if(!ce(e)){var r=le.GetMethod(e,Te);if(typeof r!=="undefined"){return le.Call(r,e,[t])}}return le.Call(Ie,t,[le.ToString(e)])};oe(String.prototype,"match",Ee)}}var Pe=function wrapConstructor(e,t,r){m.preserveToString(t,e);if(Object.setPrototypeOf){Object.setPrototypeOf(e,t)}if(s){l(Object.getOwnPropertyNames(e),function(n){if(n in G||r[n]){return}m.proxy(e,n,t)})}else{l(Object.keys(e),function(n){if(n in G||r[n]){return}t[n]=e[n]})}t.prototype=e.prototype;m.redefine(e.prototype,"constructor",t)};var Ce=function(){return this};var Me=function(e){if(s&&!q(e,X)){m.getter(e,X,Ce)}};var xe=function(e,t){var r=t||function iterator(){return this};h(e,ae,r);if(!e[ae]&&ne.symbol(ae)){e[ae]=r}};var Ne=function createDataProperty(e,t,r){if(s){Object.defineProperty(e,t,{configurable:true,enumerable:true,writable:true,value:r})}else{e[t]=r}};var Ae=function createDataPropertyOrThrow(e,t,r){Ne(e,t,r);if(!le.SameValue(e[t],r)){throw new TypeError("property is nonconfigurable")}};var _e=function(e,t,r,n){if(!le.TypeIsObject(e)){throw new TypeError("Constructor requires `new`: "+t.name)}var o=t.prototype;if(!le.TypeIsObject(o)){o=r}var i=O(o);for(var a in n){if(q(n,a)){var u=n[a];h(i,a,u,true)}}return i};if(String.fromCodePoint&&String.fromCodePoint.length!==1){var Re=String.fromCodePoint;oe(String,"fromCodePoint",function fromCodePoint(e){return le.Call(Re,this,arguments)})}var ke={fromCodePoint:function fromCodePoint(e){var t=[];var r;for(var n=0,o=arguments.length;n<o;n++){r=Number(arguments[n]);if(!le.SameValue(r,le.ToInteger(r))||r<0||r>1114111){throw new RangeError("Invalid code point "+r)}if(r<65536){M(t,String.fromCharCode(r))}else{r-=65536;M(t,String.fromCharCode((r>>10)+55296));M(t,String.fromCharCode(r%1024+56320))}}return N(t,"")},raw:function raw(e){var t=arguments.length-1;var r=le.ToObject(e,"bad template");var raw=le.ToObject(r.raw,"bad raw value");var n=raw.length;var o=le.ToLength(n);if(o<=0){return""}var i=[];var a=0;var u,f,s,c;while(a<o){u=le.ToString(a);s=le.ToString(raw[u]);M(i,s);if(a+1>=o){break}f=a+1<arguments.length?arguments[a+1]:"";c=le.ToString(f);M(i,c);a+=1}return N(i,"")}};if(String.raw&&String.raw({raw:{0:"x",1:"y",length:2}})!=="xy"){oe(String,"raw",ke.raw)}b(String,ke);var Le=function repeat(e,t){if(t<1){return""}if(t%2){return repeat(e,t-1)+e}var r=repeat(e,t/2);return r+r};var Fe=Infinity;var De={repeat:function repeat(e){var t=le.ToString(le.RequireObjectCoercible(this));var r=le.ToInteger(e);if(r<0||r>=Fe){throw new RangeError("repeat count must be less than infinity and not overflow maximum string size")}return Le(t,r)},startsWith:function startsWith(e){var t=le.ToString(le.RequireObjectCoercible(this));if(le.IsRegExp(e)){throw new TypeError('Cannot call method "startsWith" with a regex')}var r=le.ToString(e);var n;if(arguments.length>1){n=arguments[1]}var o=_(le.ToInteger(n),0);return C(t,o,o+r.length)===r},endsWith:function endsWith(e){var t=le.ToString(le.RequireObjectCoercible(this));if(le.IsRegExp(e)){throw new TypeError('Cannot call method "endsWith" with a regex')}var r=le.ToString(e);var n=t.length;var o;if(arguments.length>1){o=arguments[1]}var i=typeof o==="undefined"?n:le.ToInteger(o);var a=R(_(i,0),n);return C(t,a-r.length,a)===r},includes:function includes(e){if(le.IsRegExp(e)){throw new TypeError('"includes" does not accept a RegExp')}var t=le.ToString(e);var r;if(arguments.length>1){r=arguments[1]}return I(this,t,r)!==-1},codePointAt:function codePointAt(e){var t=le.ToString(le.RequireObjectCoercible(this));var r=le.ToInteger(e);var n=t.length;if(r>=0&&r<n){var o=t.charCodeAt(r);var i=r+1===n;if(o<55296||o>56319||i){return o}var a=t.charCodeAt(r+1);if(a<56320||a>57343){return o}return(o-55296)*1024+(a-56320)+65536}}};if(String.prototype.includes&&"a".includes("a",Infinity)!==false){oe(String.prototype,"includes",De.includes)}if(String.prototype.startsWith&&String.prototype.endsWith){var ze=i(function(){return"/a/".startsWith(/a/)});var qe=a(function(){return"abc".startsWith("a",Infinity)===false});if(!ze||!qe){oe(String.prototype,"startsWith",De.startsWith);oe(String.prototype,"endsWith",De.endsWith)}}if(ie){var We=a(function(){var e=/a/;e[J.match]=false;return"/a/".startsWith(e)});if(!We){oe(String.prototype,"startsWith",De.startsWith)}var Ge=a(function(){var e=/a/;e[J.match]=false;return"/a/".endsWith(e)});if(!Ge){oe(String.prototype,"endsWith",De.endsWith)}var He=a(function(){var e=/a/;e[J.match]=false;return"/a/".includes(e)});if(!He){oe(String.prototype,"includes",De.includes)}}b(String.prototype,De);var Ve=["\t\n\x0B\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003","\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028","\u2029\ufeff"].join("");var Be=new RegExp("(^["+Ve+"]+)|(["+Ve+"]+$)","g");var Ue=function trim(){return le.ToString(le.RequireObjectCoercible(this)).replace(Be,"")};var $e=["\x85","\u200b","\ufffe"].join("");var Je=new RegExp("["+$e+"]","g");var Xe=/^[-+]0x[0-9a-f]+$/i;var Ke=$e.trim().length!==$e.length;h(String.prototype,"trim",Ue,Ke);var Ze=function(e){return{value:e,done:arguments.length===0}};var Ye=function(e){le.RequireObjectCoercible(e);h(this,"_s",le.ToString(e));h(this,"_i",0)};Ye.prototype.next=function(){var e=this._s;var t=this._i;if(typeof e==="undefined"||t>=e.length){this._s=void 0;return Ze()}var r=e.charCodeAt(t);var n,o;if(r<55296||r>56319||t+1===e.length){o=1}else{n=e.charCodeAt(t+1);o=n<56320||n>57343?1:2}this._i=t+o;return Ze(e.substr(t,o))};xe(Ye.prototype);xe(String.prototype,function(){return new Ye(this)});var Qe={from:function from(e){var r=this;var n;if(arguments.length>1){n=arguments[1]}var o,i;if(typeof n==="undefined"){o=false}else{if(!le.IsCallable(n)){throw new TypeError("Array.from: when provided, the second argument must be a function")}if(arguments.length>2){i=arguments[2]}o=true}var a=typeof(re(e)||le.GetMethod(e,ae))!=="undefined";var u,f,s;if(a){f=le.IsConstructor(r)?Object(new r):[];var c=le.GetIterator(e);var l,p;s=0;while(true){l=le.IteratorStep(c);if(l===false){break}p=l.value;try{if(o){p=typeof i==="undefined"?n(p,s):t(n,i,p,s)}f[s]=p}catch(v){le.IteratorClose(c,true);throw v}s+=1}u=s}else{var y=le.ToObject(e);u=le.ToLength(y.length);f=le.IsConstructor(r)?Object(new r(u)):new Array(u);var h;for(s=0;s<u;++s){h=y[s];if(o){h=typeof i==="undefined"?n(h,s):t(n,i,h,s)}Ae(f,s,h)}}f.length=u;return f},of:function of(){var e=arguments.length;var t=this;var n=r(t)||!le.IsCallable(t)?new Array(e):le.Construct(t,[e]);for(var o=0;o<e;++o){Ae(n,o,arguments[o])}n.length=e;return n}};b(Array,Qe);Me(Array);W=function(e,t){h(this,"i",0);h(this,"array",e);h(this,"kind",t)};b(W.prototype,{next:function(){var e=this.i;var t=this.array;if(!(this instanceof W)){throw new TypeError("Not an ArrayIterator")}if(typeof t!=="undefined"){var r=le.ToLength(t.length);if(e<r){var n=this.kind;var o;if(n==="key"){o=e}else if(n==="value"){o=t[e]}else if(n==="entry"){o=[e,t[e]]}this.i=e+1;return Ze(o)}}this.array=void 0;return Ze()}});xe(W.prototype);var et=Array.of===Qe.of||function(){var e=function Foo(e){this.length=e};e.prototype=[];var t=Array.of.apply(e,[1,2]);return t instanceof e&&t.length===2}();if(!et){oe(Array,"of",Qe.of)}var tt={copyWithin:function copyWithin(e,t){var r=le.ToObject(this);var n=le.ToLength(r.length);var o=le.ToInteger(e);var i=le.ToInteger(t);var a=o<0?_(n+o,0):R(o,n);var u=i<0?_(n+i,0):R(i,n);var f;if(arguments.length>2){f=arguments[2]}var s=typeof f==="undefined"?n:le.ToInteger(f);var c=s<0?_(n+s,0):R(s,n);var l=R(c-u,n-a);var p=1;if(u<a&&a<u+l){p=-1;u+=l-1;a+=l-1}while(l>0){if(u in r){r[a]=r[u]}else{delete r[a]}u+=p;a+=p;l-=1}return r},fill:function fill(e){var t;if(arguments.length>1){t=arguments[1]}var r;if(arguments.length>2){r=arguments[2]}var n=le.ToObject(this);var o=le.ToLength(n.length);t=le.ToInteger(typeof t==="undefined"?0:t);r=le.ToInteger(typeof r==="undefined"?o:r);var i=t<0?_(o+t,0):R(t,o);var a=r<0?o+r:r;for(var u=i;u<o&&u<a;++u){n[u]=e}return n},find:function find(e){var r=le.ToObject(this);var n=le.ToLength(r.length);if(!le.IsCallable(e)){throw new TypeError("Array#find: predicate must be a function")}var o=arguments.length>1?arguments[1]:null;for(var i=0,a;i<n;i++){a=r[i];if(o){if(t(e,o,a,i,r)){return a}}else if(e(a,i,r)){return a}}},findIndex:function findIndex(e){var r=le.ToObject(this);var n=le.ToLength(r.length);if(!le.IsCallable(e)){throw new TypeError("Array#findIndex: predicate must be a function")}var o=arguments.length>1?arguments[1]:null;for(var i=0;i<n;i++){if(o){if(t(e,o,r[i],i,r)){return i}}else if(e(r[i],i,r)){return i}}return-1},keys:function keys(){return new W(this,"key")},values:function values(){return new W(this,"value")},entries:function entries(){return new W(this,"entry")}};if(Array.prototype.keys&&!le.IsCallable([1].keys().next)){delete Array.prototype.keys}if(Array.prototype.entries&&!le.IsCallable([1].entries().next)){delete Array.prototype.entries}if(Array.prototype.keys&&Array.prototype.entries&&!Array.prototype.values&&Array.prototype[ae]){b(Array.prototype,{values:Array.prototype[ae]});if(ne.symbol(J.unscopables)){Array.prototype[J.unscopables].values=true}}if(c&&Array.prototype.values&&Array.prototype.values.name!=="values"){var rt=Array.prototype.values;oe(Array.prototype,"values",function values(){return le.Call(rt,this,arguments)});h(Array.prototype,ae,Array.prototype.values,true)}b(Array.prototype,tt);if(1/[true].indexOf(true,-0)<0){h(Array.prototype,"indexOf",function indexOf(e){var t=E(this,arguments);if(t===0&&1/t<0){return 0}return t},true)}xe(Array.prototype,function(){return this.values()});if(Object.getPrototypeOf){var nt=Object.getPrototypeOf([].values());if(nt){xe(nt)}}var ot=function(){return a(function(){return Array.from({length:-1}).length===0})}();var it=function(){var e=Array.from([0].entries());return e.length===1&&r(e[0])&&e[0][0]===0&&e[0][1]===0}();if(!ot||!it){oe(Array,"from",Qe.from)}var at=function(){return a(function(){return Array.from([0],void 0)})}();if(!at){var ut=Array.from;oe(Array,"from",function from(e){if(arguments.length>1&&typeof arguments[1]!=="undefined"){return le.Call(ut,this,arguments)}return t(ut,this,e)})}var ft=-(Math.pow(2,32)-1);var st=function(e,r){var n={length:ft};n[r?(n.length>>>0)-1:0]=true;return a(function(){t(e,n,function(){throw new RangeError("should not reach here")},[]);return true})};if(!st(Array.prototype.forEach)){var ct=Array.prototype.forEach;oe(Array.prototype,"forEach",function forEach(e){return le.Call(ct,this.length>=0?this:[],arguments)})}if(!st(Array.prototype.map)){var lt=Array.prototype.map;oe(Array.prototype,"map",function map(e){return le.Call(lt,this.length>=0?this:[],arguments)})}if(!st(Array.prototype.filter)){var pt=Array.prototype.filter;oe(Array.prototype,"filter",function filter(e){return le.Call(pt,this.length>=0?this:[],arguments)})}if(!st(Array.prototype.some)){var vt=Array.prototype.some;oe(Array.prototype,"some",function some(e){return le.Call(vt,this.length>=0?this:[],arguments)})}if(!st(Array.prototype.every)){var yt=Array.prototype.every;oe(Array.prototype,"every",function every(e){return le.Call(yt,this.length>=0?this:[],arguments)})}if(!st(Array.prototype.reduce)){var ht=Array.prototype.reduce;oe(Array.prototype,"reduce",function reduce(e){return le.Call(ht,this.length>=0?this:[],arguments)})}if(!st(Array.prototype.reduceRight,true)){var bt=Array.prototype.reduceRight;oe(Array.prototype,"reduceRight",function reduceRight(e){return le.Call(bt,this.length>=0?this:[],arguments)})}var gt=Number("0o10")!==8;var dt=Number("0b10")!==2;var mt=y($e,function(e){return Number(e+0+e)===0});if(gt||dt||mt){var Ot=Number;var wt=/^0b[01]+$/i;var jt=/^0o[0-7]+$/i;var St=wt.test.bind(wt);var Tt=jt.test.bind(jt);var It=function(e,t){var r;if(typeof e.valueOf==="function"){r=e.valueOf();if(ne.primitive(r)){return r}}if(typeof e.toString==="function"){r=e.toString();if(ne.primitive(r)){return r}}throw new TypeError("No default value")};var Et=Je.test.bind(Je);var Pt=Xe.test.bind(Xe);var Ct=function(){var e=function Number(t){var r;if(arguments.length>0){r=ne.primitive(t)?t:It(t,"number")}else{r=0}if(typeof r==="string"){r=le.Call(Ue,r);if(St(r)){r=parseInt(C(r,2),2)}else if(Tt(r)){r=parseInt(C(r,2),8)}else if(Et(r)||Pt(r)){r=NaN}}var n=this;var o=a(function(){Ot.prototype.valueOf.call(n);return true});if(n instanceof e&&!o){return new Ot(r)}return Ot(r)};return e}();Pe(Ot,Ct,{});b(Ct,{NaN:Ot.NaN,MAX_VALUE:Ot.MAX_VALUE,MIN_VALUE:Ot.MIN_VALUE,NEGATIVE_INFINITY:Ot.NEGATIVE_INFINITY,POSITIVE_INFINITY:Ot.POSITIVE_INFINITY});Number=Ct;m.redefine(S,"Number",Ct)}var Mt=Math.pow(2,53)-1;b(Number,{MAX_SAFE_INTEGER:Mt,MIN_SAFE_INTEGER:-Mt,EPSILON:2.220446049250313e-16,parseInt:S.parseInt,parseFloat:S.parseFloat,isFinite:Z,isInteger:function isInteger(e){return Z(e)&&le.ToInteger(e)===e},isSafeInteger:function isSafeInteger(e){return Number.isInteger(e)&&L(e)<=Number.MAX_SAFE_INTEGER},isNaN:K});h(Number,"parseInt",S.parseInt,Number.parseInt!==S.parseInt);if([,1].find(function(){return true})===1){oe(Array.prototype,"find",tt.find)}if([,1].findIndex(function(){return true})!==0){oe(Array.prototype,"findIndex",tt.findIndex)}var xt=Function.bind.call(Function.bind,Object.prototype.propertyIsEnumerable);var Nt=function ensureEnumerable(e,t){if(s&&xt(e,t)){Object.defineProperty(e,t,{enumerable:false})}};var At=function sliceArgs(){var e=Number(this);var t=arguments.length;var r=t-e;var n=new Array(r<0?0:r);for(var o=e;o<t;++o){n[o-e]=arguments[o]}return n};var _t=function assignTo(e){return function assignToSource(t,r){t[r]=e[r];return t}};var Rt=function(e,t){var r=n(Object(t));var o;if(le.IsCallable(Object.getOwnPropertySymbols)){o=v(Object.getOwnPropertySymbols(Object(t)),xt(t))}return p(P(r,o||[]),_t(t),e)};var kt={assign:function(e,t){var r=le.ToObject(e,"Cannot convert undefined or null to object");return p(le.Call(At,1,arguments),Rt,r)},is:function is(e,t){return le.SameValue(e,t)}};var Lt=Object.assign&&Object.preventExtensions&&function(){var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(t){return e[1]==="y"}}();if(Lt){oe(Object,"assign",kt.assign)}b(Object,kt);if(s){var Ft={setPrototypeOf:function(e){var r;var n=function(e,t){if(!le.TypeIsObject(e)){throw new TypeError("cannot set prototype on a non-object")}if(!(t===null||le.TypeIsObject(t))){throw new TypeError("can only set prototype to an object or null"+t)}};var o=function(e,o){n(e,o);t(r,e,o);return e};try{r=e.getOwnPropertyDescriptor(e.prototype,"__proto__").set;t(r,{},null)}catch(i){if(e.prototype!=={}.__proto__){return}r=function(e){this.__proto__=e};o.polyfill=o(o({},null),e.prototype)instanceof e}return o}(Object)};b(Object,Ft)}if(Object.setPrototypeOf&&Object.getPrototypeOf&&Object.getPrototypeOf(Object.setPrototypeOf({},null))!==null&&Object.getPrototypeOf(Object.create(null))===null){(function(){var e=Object.create(null);var t=Object.getPrototypeOf;var r=Object.setPrototypeOf;Object.getPrototypeOf=function(r){var n=t(r);return n===e?null:n};Object.setPrototypeOf=function(t,n){var o=n===null?e:n;return r(t,o)};Object.setPrototypeOf.polyfill=false})()}var Dt=!i(function(){return Object.keys("foo")});if(!Dt){var zt=Object.keys;oe(Object,"keys",function keys(e){return zt(le.ToObject(e))});n=Object.keys}var qt=i(function(){return Object.keys(/a/g)});if(qt){var Wt=Object.keys;oe(Object,"keys",function keys(e){if(ne.regex(e)){var t=[];for(var r in e){if(q(e,r)){M(t,r)}}return t}return Wt(e)});n=Object.keys}if(Object.getOwnPropertyNames){var Gt=!i(function(){return Object.getOwnPropertyNames("foo")});if(!Gt){var Ht=typeof window==="object"?Object.getOwnPropertyNames(window):[];var Vt=Object.getOwnPropertyNames;oe(Object,"getOwnPropertyNames",function getOwnPropertyNames(e){var t=le.ToObject(e);if(g(t)==="[object Window]"){try{return Vt(t)}catch(r){return P([],Ht)}}return Vt(t)})}}if(Object.getOwnPropertyDescriptor){var Bt=!i(function(){return Object.getOwnPropertyDescriptor("foo","bar")});if(!Bt){var Ut=Object.getOwnPropertyDescriptor;oe(Object,"getOwnPropertyDescriptor",function getOwnPropertyDescriptor(e,t){return Ut(le.ToObject(e),t)})}}if(Object.seal){var $t=!i(function(){return Object.seal("foo")});if(!$t){var Jt=Object.seal;oe(Object,"seal",function seal(e){if(!le.TypeIsObject(e)){return e}return Jt(e)})}}if(Object.isSealed){var Xt=!i(function(){return Object.isSealed("foo")});if(!Xt){var Kt=Object.isSealed;oe(Object,"isSealed",function isSealed(e){if(!le.TypeIsObject(e)){return true}return Kt(e)})}}if(Object.freeze){var Zt=!i(function(){return Object.freeze("foo")});if(!Zt){var Yt=Object.freeze;oe(Object,"freeze",function freeze(e){if(!le.TypeIsObject(e)){return e}return Yt(e)})}}if(Object.isFrozen){var Qt=!i(function(){return Object.isFrozen("foo")});if(!Qt){var er=Object.isFrozen;oe(Object,"isFrozen",function isFrozen(e){if(!le.TypeIsObject(e)){return true}return er(e)})}}if(Object.preventExtensions){var tr=!i(function(){return Object.preventExtensions("foo")});if(!tr){var rr=Object.preventExtensions;oe(Object,"preventExtensions",function preventExtensions(e){if(!le.TypeIsObject(e)){return e}return rr(e)})}}if(Object.isExtensible){var nr=!i(function(){return Object.isExtensible("foo")});if(!nr){var or=Object.isExtensible;oe(Object,"isExtensible",function isExtensible(e){if(!le.TypeIsObject(e)){return false}return or(e)})}}if(Object.getPrototypeOf){var ir=!i(function(){return Object.getPrototypeOf("foo")});if(!ir){var ar=Object.getPrototypeOf;oe(Object,"getPrototypeOf",function getPrototypeOf(e){return ar(le.ToObject(e))})}}var ur=s&&function(){var e=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags");return e&&le.IsCallable(e.get)}();if(s&&!ur){var fr=function flags(){if(!le.TypeIsObject(this)){throw new TypeError("Method called on incompatible type: must be an object.")}var e="";if(this.global){e+="g"}if(this.ignoreCase){e+="i"}if(this.multiline){e+="m"}if(this.unicode){e+="u"}if(this.sticky){e+="y"}return e};m.getter(RegExp.prototype,"flags",fr)}var sr=s&&a(function(){return String(new RegExp(/a/g,"i"))==="/a/i"});var cr=ie&&s&&function(){var e=/./;e[J.match]=false;return RegExp(e)===e}();var lr=a(function(){return RegExp.prototype.toString.call({source:"abc"})==="/abc/"});var pr=lr&&a(function(){return RegExp.prototype.toString.call({source:"a",flags:"b"})==="/a/b"});if(!lr||!pr){var vr=RegExp.prototype.toString;h(RegExp.prototype,"toString",function toString(){var e=le.RequireObjectCoercible(this);if(ne.regex(e)){return t(vr,e)}var r=fe(e.source);var n=fe(e.flags);return"/"+r+"/"+n},true);m.preserveToString(RegExp.prototype.toString,vr);RegExp.prototype.toString.prototype=void 0}if(s&&(!sr||cr)){var yr=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get;var hr=Object.getOwnPropertyDescriptor(RegExp.prototype,"source")||{};var br=function(){return this.source};var gr=le.IsCallable(hr.get)?hr.get:br;var dr=RegExp;var mr=function(){return function RegExp(e,t){var r=le.IsRegExp(e);var n=this instanceof RegExp;if(!n&&r&&typeof t==="undefined"&&e.constructor===RegExp){return e}var o=e;var i=t;if(ne.regex(e)){o=le.Call(gr,e);i=typeof t==="undefined"?le.Call(yr,e):t;return new RegExp(o,i)}else if(r){o=e.source;i=typeof t==="undefined"?e.flags:t}return new dr(e,t)}}();Pe(dr,mr,{$input:true});RegExp=mr;m.redefine(S,"RegExp",mr)}if(s){var Or={input:"$_",lastMatch:"$&",lastParen:"$+",leftContext:"$`",rightContext:"$'"};l(n(Or),function(e){if(e in RegExp&&!(Or[e]in RegExp)){m.getter(RegExp,Or[e],function get(){return RegExp[e]})}})}Me(RegExp);var wr=1/Number.EPSILON;var jr=function roundTiesToEven(e){return e+wr-wr};var Sr=Math.pow(2,-23);var Tr=Math.pow(2,127)*(2-Sr);var Ir=Math.pow(2,-126);var Er=Math.E;var Pr=Math.LOG2E;var Cr=Math.LOG10E;var Mr=Number.prototype.clz;delete Number.prototype.clz;var xr={acosh:function acosh(e){var t=Number(e);if(K(t)||e<1){return NaN}if(t===1){return 0}if(t===Infinity){return t}var r=1/(t*t);if(t<2){return Q(t-1+z(1-r)*t)}var n=t/2;return Q(n+z(1-r)*n-1)+1/Pr},asinh:function asinh(e){var t=Number(e);if(t===0||!T(t)){return t}var r=L(t);var n=r*r;var o=Y(t);if(r<1){return o*Q(r+n/(z(n+1)+1))}return o*(Q(r/2+z(1+1/n)*r/2-1)+1/Pr)},atanh:function atanh(e){var t=Number(e);if(t===0){return t}if(t===-1){return-Infinity}if(t===1){return Infinity}if(K(t)||t<-1||t>1){return NaN}var r=L(t);return Y(t)*Q(2*r/(1-r))/2},cbrt:function cbrt(e){var t=Number(e);if(t===0){return t}var r=t<0;var n;if(r){t=-t}if(t===Infinity){n=Infinity}else{n=F(D(t)/3);n=(t/(n*n)+2*n)/3}return r?-n:n},clz32:function clz32(e){var t=Number(e);var r=le.ToUint32(t);if(r===0){return 32}return Mr?le.Call(Mr,r):31-k(D(r+.5)*Pr)},cosh:function cosh(e){var t=Number(e);if(t===0){return 1}if(K(t)){return NaN}if(!T(t)){return Infinity}var r=F(L(t)-1);return(r+1/(r*Er*Er))*(Er/2)},expm1:function expm1(e){var t=Number(e);if(t===-Infinity){return-1}if(!T(t)||t===0){return t}if(L(t)>.5){return F(t)-1}var r=t;var n=0;var o=1;while(n+r!==n){n+=r;o+=1;r*=t/o}return n},hypot:function hypot(e,t){var r=0;var n=0;for(var o=0;o<arguments.length;++o){var i=L(Number(arguments[o]));if(n<i){r*=n/i*(n/i);r+=1;n=i}else{r+=i>0?i/n*(i/n):i}}return n===Infinity?Infinity:n*z(r)},log2:function log2(e){return D(e)*Pr},log10:function log10(e){return D(e)*Cr},log1p:Q,sign:Y,sinh:function sinh(e){var t=Number(e);if(!T(t)||t===0){return t}var r=L(t);if(r<1){var n=Math.expm1(r);return Y(t)*n*(1+1/(n+1))/2}var o=F(r-1);return Y(t)*(o-1/(o*Er*Er))*(Er/2)},tanh:function tanh(e){var t=Number(e);if(K(t)||t===0){return t}if(t>=20){return 1}if(t<=-20){return-1}return(Math.expm1(t)-Math.expm1(-t))/(F(t)+F(-t))},trunc:function trunc(e){var t=Number(e);return t<0?-k(-t):k(t)},imul:function imul(e,t){var r=le.ToUint32(e);var n=le.ToUint32(t);var o=r>>>16&65535;var i=r&65535;var a=n>>>16&65535;var u=n&65535;return i*u+(o*u+i*a<<16>>>0)|0},fround:function fround(e){var t=Number(e);if(t===0||t===Infinity||t===-Infinity||K(t)){return t}var r=Y(t);var n=L(t);if(n<Ir){return r*jr(n/Ir/Sr)*Ir*Sr}var o=(1+Sr/Number.EPSILON)*n;var i=o-(o-n);if(i>Tr||K(i)){return r*Infinity}return r*i}};var Nr=function withinULPDistance(e,t,r){return L(1-e/t)/Number.EPSILON<(r||8)};b(Math,xr);h(Math,"sinh",xr.sinh,Math.sinh(710)===Infinity);h(Math,"cosh",xr.cosh,Math.cosh(710)===Infinity);h(Math,"log1p",xr.log1p,Math.log1p(-1e-17)!==-1e-17);h(Math,"asinh",xr.asinh,Math.asinh(-1e7)!==-Math.asinh(1e7));
h(Math,"asinh",xr.asinh,Math.asinh(1e300)===Infinity);h(Math,"atanh",xr.atanh,Math.atanh(1e-300)===0);h(Math,"tanh",xr.tanh,Math.tanh(-2e-17)!==-2e-17);h(Math,"acosh",xr.acosh,Math.acosh(Number.MAX_VALUE)===Infinity);h(Math,"acosh",xr.acosh,!Nr(Math.acosh(1+Number.EPSILON),Math.sqrt(2*Number.EPSILON)));h(Math,"cbrt",xr.cbrt,!Nr(Math.cbrt(1e-300),1e-100));h(Math,"sinh",xr.sinh,Math.sinh(-2e-17)!==-2e-17);var Ar=Math.expm1(10);h(Math,"expm1",xr.expm1,Ar>22025.465794806718||Ar<22025.465794806718);h(Math,"hypot",xr.hypot,Math.hypot(Infinity,NaN)!==Infinity);var _r=Math.round;var Rr=Math.round(.5-Number.EPSILON/4)===0&&Math.round(-.5+Number.EPSILON/3.99)===1;var kr=wr+1;var Lr=2*wr-1;var Fr=[kr,Lr].every(function(e){return Math.round(e)===e});h(Math,"round",function round(e){var t=k(e);var r=t===-1?-0:t+1;return e-t<.5?t:r},!Rr||!Fr);m.preserveToString(Math.round,_r);var Dr=Math.imul;if(Math.imul(4294967295,5)!==-5){Math.imul=xr.imul;m.preserveToString(Math.imul,Dr)}if(Math.imul.length!==2){oe(Math,"imul",function imul(e,t){return le.Call(Dr,Math,arguments)})}var zr=function(){var e=S.setTimeout;if(typeof e!=="function"&&typeof e!=="object"){return}le.IsPromise=function(e){if(!le.TypeIsObject(e)){return false}if(typeof e._promise==="undefined"){return false}return true};var r=function(e){if(!le.IsConstructor(e)){throw new TypeError("Bad promise constructor")}var t=this;var r=function(e,r){if(t.resolve!==void 0||t.reject!==void 0){throw new TypeError("Bad Promise implementation!")}t.resolve=e;t.reject=r};t.resolve=void 0;t.reject=void 0;t.promise=new e(r);if(!(le.IsCallable(t.resolve)&&le.IsCallable(t.reject))){throw new TypeError("Bad promise constructor")}};var n;if(typeof window!=="undefined"&&le.IsCallable(window.postMessage)){n=function(){var e=[];var t="zero-timeout-message";var r=function(r){M(e,r);window.postMessage(t,"*")};var n=function(r){if(r.source===window&&r.data===t){r.stopPropagation();if(e.length===0){return}var n=A(e);n()}};window.addEventListener("message",n,true);return r}}var o=function(){var e=S.Promise;var t=e&&e.resolve&&e.resolve();return t&&function(e){return t.then(e)}};var i=le.IsCallable(S.setImmediate)?S.setImmediate:typeof process==="object"&&process.nextTick?process.nextTick:o()||(le.IsCallable(n)?n():function(t){e(t,0)});var a=function(e){return e};var u=function(e){throw e};var f=0;var s=1;var c=2;var l=0;var p=1;var v=2;var y={};var h=function(e,t,r){i(function(){g(e,t,r)})};var g=function(e,t,r){var n,o;if(t===y){return e(r)}try{n=e(r);o=t.resolve}catch(i){n=i;o=t.reject}o(n)};var d=function(e,t){var r=e._promise;var n=r.reactionLength;if(n>0){h(r.fulfillReactionHandler0,r.reactionCapability0,t);r.fulfillReactionHandler0=void 0;r.rejectReactions0=void 0;r.reactionCapability0=void 0;if(n>1){for(var o=1,i=0;o<n;o++,i+=3){h(r[i+l],r[i+v],t);e[i+l]=void 0;e[i+p]=void 0;e[i+v]=void 0}}}r.result=t;r.state=s;r.reactionLength=0};var m=function(e,t){var r=e._promise;var n=r.reactionLength;if(n>0){h(r.rejectReactionHandler0,r.reactionCapability0,t);r.fulfillReactionHandler0=void 0;r.rejectReactions0=void 0;r.reactionCapability0=void 0;if(n>1){for(var o=1,i=0;o<n;o++,i+=3){h(r[i+p],r[i+v],t);e[i+l]=void 0;e[i+p]=void 0;e[i+v]=void 0}}}r.result=t;r.state=c;r.reactionLength=0};var O=function(e){var t=false;var r=function(r){var n;if(t){return}t=true;if(r===e){return m(e,new TypeError("Self resolution"))}if(!le.TypeIsObject(r)){return d(e,r)}try{n=r.then}catch(o){return m(e,o)}if(!le.IsCallable(n)){return d(e,r)}i(function(){j(e,r,n)})};var n=function(r){if(t){return}t=true;return m(e,r)};return{resolve:r,reject:n}};var w=function(e,r,n,o){if(e===I){t(e,r,n,o,y)}else{t(e,r,n,o)}};var j=function(e,t,r){var n=O(e);var o=n.resolve;var i=n.reject;try{w(r,t,o,i)}catch(a){i(a)}};var T,I;var E=function(){var e=function Promise(t){if(!(this instanceof e)){throw new TypeError('Constructor Promise requires "new"')}if(this&&this._promise){throw new TypeError("Bad construction")}if(!le.IsCallable(t)){throw new TypeError("not a valid resolver")}var r=_e(this,e,T,{_promise:{result:void 0,state:f,reactionLength:0,fulfillReactionHandler0:void 0,rejectReactionHandler0:void 0,reactionCapability0:void 0}});var n=O(r);var o=n.reject;try{t(n.resolve,o)}catch(i){o(i)}return r};return e}();T=E.prototype;var P=function(e,t,r,n){var o=false;return function(i){if(o){return}o=true;t[e]=i;if(--n.count===0){var a=r.resolve;a(t)}}};var C=function(e,t,r){var n=e.iterator;var o=[];var i={count:1};var a,u;var f=0;while(true){try{a=le.IteratorStep(n);if(a===false){e.done=true;break}u=a.value}catch(s){e.done=true;throw s}o[f]=void 0;var c=t.resolve(u);var l=P(f,o,r,i);i.count+=1;w(c.then,c,l,r.reject);f+=1}if(--i.count===0){var p=r.resolve;p(o)}return r.promise};var x=function(e,t,r){var n=e.iterator;var o,i,a;while(true){try{o=le.IteratorStep(n);if(o===false){e.done=true;break}i=o.value}catch(u){e.done=true;throw u}a=t.resolve(i);w(a.then,a,r.resolve,r.reject)}return r.promise};b(E,{all:function all(e){var t=this;if(!le.TypeIsObject(t)){throw new TypeError("Promise is not object")}var n=new r(t);var o,i;try{o=le.GetIterator(e);i={iterator:o,done:false};return C(i,t,n)}catch(a){var u=a;if(i&&!i.done){try{le.IteratorClose(o,true)}catch(f){u=f}}var s=n.reject;s(u);return n.promise}},race:function race(e){var t=this;if(!le.TypeIsObject(t)){throw new TypeError("Promise is not object")}var n=new r(t);var o,i;try{o=le.GetIterator(e);i={iterator:o,done:false};return x(i,t,n)}catch(a){var u=a;if(i&&!i.done){try{le.IteratorClose(o,true)}catch(f){u=f}}var s=n.reject;s(u);return n.promise}},reject:function reject(e){var t=this;if(!le.TypeIsObject(t)){throw new TypeError("Bad promise constructor")}var n=new r(t);var o=n.reject;o(e);return n.promise},resolve:function resolve(e){var t=this;if(!le.TypeIsObject(t)){throw new TypeError("Bad promise constructor")}if(le.IsPromise(e)){var n=e.constructor;if(n===t){return e}}var o=new r(t);var i=o.resolve;i(e);return o.promise}});b(T,{"catch":function(e){return this.then(null,e)},then:function then(e,t){var n=this;if(!le.IsPromise(n)){throw new TypeError("not a promise")}var o=le.SpeciesConstructor(n,E);var i;var b=arguments.length>2&&arguments[2]===y;if(b&&o===E){i=y}else{i=new r(o)}var g=le.IsCallable(e)?e:a;var d=le.IsCallable(t)?t:u;var m=n._promise;var O;if(m.state===f){if(m.reactionLength===0){m.fulfillReactionHandler0=g;m.rejectReactionHandler0=d;m.reactionCapability0=i}else{var w=3*(m.reactionLength-1);m[w+l]=g;m[w+p]=d;m[w+v]=i}m.reactionLength+=1}else if(m.state===s){O=m.result;h(g,i,O)}else if(m.state===c){O=m.result;h(d,i,O)}else{throw new TypeError("unexpected Promise state")}return i.promise}});y=new r(E);I=T.then;return E}();if(S.Promise){delete S.Promise.accept;delete S.Promise.defer;delete S.Promise.prototype.chain}if(typeof zr==="function"){b(S,{Promise:zr});var qr=w(S.Promise,function(e){return e.resolve(42).then(function(){})instanceof e});var Wr=!i(function(){return S.Promise.reject(42).then(null,5).then(null,G)});var Gr=i(function(){return S.Promise.call(3,G)});var Hr=function(e){var t=e.resolve(5);t.constructor={};var r=e.resolve(t);try{r.then(null,G).then(null,G)}catch(n){return true}return t===r}(S.Promise);var Vr=s&&function(){var e=0;var t=Object.defineProperty({},"then",{get:function(){e+=1}});Promise.resolve(t);return e===1}();var Br=function BadResolverPromise(e){var t=new Promise(e);e(3,function(){});this.then=t.then;this.constructor=BadResolverPromise};Br.prototype=Promise.prototype;Br.all=Promise.all;var Ur=a(function(){return!!Br.all([1,2])});if(!qr||!Wr||!Gr||Hr||!Vr||Ur){Promise=zr;oe(S,"Promise",zr)}if(Promise.all.length!==1){var $r=Promise.all;oe(Promise,"all",function all(e){return le.Call($r,this,arguments)})}if(Promise.race.length!==1){var Jr=Promise.race;oe(Promise,"race",function race(e){return le.Call(Jr,this,arguments)})}if(Promise.resolve.length!==1){var Xr=Promise.resolve;oe(Promise,"resolve",function resolve(e){return le.Call(Xr,this,arguments)})}if(Promise.reject.length!==1){var Kr=Promise.reject;oe(Promise,"reject",function reject(e){return le.Call(Kr,this,arguments)})}Nt(Promise,"all");Nt(Promise,"race");Nt(Promise,"resolve");Nt(Promise,"reject");Me(Promise)}var Zr=function(e){var t=n(p(e,function(e,t){e[t]=true;return e},{}));return e.join(":")===t.join(":")};var Yr=Zr(["z","a","bb"]);var Qr=Zr(["z",1,"a","3",2]);if(s){var en=function fastkey(e,t){if(!t&&!Yr){return null}if(ce(e)){return"^"+le.ToString(e)}else if(typeof e==="string"){return"$"+e}else if(typeof e==="number"){if(!Qr){return"n"+e}return e}else if(typeof e==="boolean"){return"b"+e}return null};var tn=function emptyObject(){return Object.create?Object.create(null):{}};var rn=function addIterableToMap(e,n,o){if(r(o)||ne.string(o)){l(o,function(e){if(!le.TypeIsObject(e)){throw new TypeError("Iterator value "+e+" is not an entry object")}n.set(e[0],e[1])})}else if(o instanceof e){t(e.prototype.forEach,o,function(e,t){n.set(t,e)})}else{var i,a;if(!ce(o)){a=n.set;if(!le.IsCallable(a)){throw new TypeError("bad map")}i=le.GetIterator(o)}if(typeof i!=="undefined"){while(true){var u=le.IteratorStep(i);if(u===false){break}var f=u.value;try{if(!le.TypeIsObject(f)){throw new TypeError("Iterator value "+f+" is not an entry object")}t(a,n,f[0],f[1])}catch(s){le.IteratorClose(i,true);throw s}}}}};var nn=function addIterableToSet(e,n,o){if(r(o)||ne.string(o)){l(o,function(e){n.add(e)})}else if(o instanceof e){t(e.prototype.forEach,o,function(e){n.add(e)})}else{var i,a;if(!ce(o)){a=n.add;if(!le.IsCallable(a)){throw new TypeError("bad set")}i=le.GetIterator(o)}if(typeof i!=="undefined"){while(true){var u=le.IteratorStep(i);if(u===false){break}var f=u.value;try{t(a,n,f)}catch(s){le.IteratorClose(i,true);throw s}}}}};var on={Map:function(){var e={};var r=function MapEntry(e,t){this.key=e;this.value=t;this.next=null;this.prev=null};r.prototype.isRemoved=function isRemoved(){return this.key===e};var n=function isMap(e){return!!e._es6map};var o=function requireMapSlot(e,t){if(!le.TypeIsObject(e)||!n(e)){throw new TypeError("Method Map.prototype."+t+" called on incompatible receiver "+le.ToString(e))}};var i=function MapIterator(e,t){o(e,"[[MapIterator]]");h(this,"head",e._head);h(this,"i",this.head);h(this,"kind",t)};i.prototype={isMapIterator:true,next:function next(){if(!this.isMapIterator){throw new TypeError("Not a MapIterator")}var e=this.i;var t=this.kind;var r=this.head;if(typeof this.i==="undefined"){return Ze()}while(e.isRemoved()&&e!==r){e=e.prev}var n;while(e.next!==r){e=e.next;if(!e.isRemoved()){if(t==="key"){n=e.key}else if(t==="value"){n=e.value}else{n=[e.key,e.value]}this.i=e;return Ze(n)}}this.i=void 0;return Ze()}};xe(i.prototype);var a;var u=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}if(this&&this._es6map){throw new TypeError("Bad construction")}var e=_e(this,Map,a,{_es6map:true,_head:null,_map:H?new H:null,_size:0,_storage:tn()});var t=new r(null,null);t.next=t.prev=t;e._head=t;if(arguments.length>0){rn(Map,e,arguments[0])}return e};a=u.prototype;m.getter(a,"size",function(){if(typeof this._size==="undefined"){throw new TypeError("size method called on incompatible Map")}return this._size});b(a,{get:function get(e){o(this,"get");var t;var r=en(e,true);if(r!==null){t=this._storage[r];if(t){return t.value}return}if(this._map){t=B.call(this._map,e);if(t){return t.value}return}var n=this._head;var i=n;while((i=i.next)!==n){if(le.SameValueZero(i.key,e)){return i.value}}},has:function has(e){o(this,"has");var t=en(e,true);if(t!==null){return typeof this._storage[t]!=="undefined"}if(this._map){return U.call(this._map,e)}var r=this._head;var n=r;while((n=n.next)!==r){if(le.SameValueZero(n.key,e)){return true}}return false},set:function set(e,t){o(this,"set");var n=this._head;var i=n;var a;var u=en(e,true);if(u!==null){if(typeof this._storage[u]!=="undefined"){this._storage[u].value=t;return this}a=this._storage[u]=new r(e,t);i=n.prev}else if(this._map){if(U.call(this._map,e)){B.call(this._map,e).value=t}else{a=new r(e,t);$.call(this._map,e,a);i=n.prev}}while((i=i.next)!==n){if(le.SameValueZero(i.key,e)){i.value=t;return this}}a=a||new r(e,t);if(le.SameValue(-0,e)){a.key=+0}a.next=this._head;a.prev=this._head.prev;a.prev.next=a;a.next.prev=a;this._size+=1;return this},"delete":function(t){o(this,"delete");var r=this._head;var n=r;var i=en(t,true);if(i!==null){if(typeof this._storage[i]==="undefined"){return false}n=this._storage[i].prev;delete this._storage[i]}else if(this._map){if(!U.call(this._map,t)){return false}n=B.call(this._map,t).prev;V.call(this._map,t)}while((n=n.next)!==r){if(le.SameValueZero(n.key,t)){n.key=e;n.value=e;n.prev.next=n.next;n.next.prev=n.prev;this._size-=1;return true}}return false},clear:function clear(){o(this,"clear");this._map=H?new H:null;this._size=0;this._storage=tn();var t=this._head;var r=t;var n=r.next;while((r=n)!==t){r.key=e;r.value=e;n=r.next;r.next=r.prev=t}t.next=t.prev=t},keys:function keys(){o(this,"keys");return new i(this,"key")},values:function values(){o(this,"values");return new i(this,"value")},entries:function entries(){o(this,"entries");return new i(this,"key+value")},forEach:function forEach(e){o(this,"forEach");var r=arguments.length>1?arguments[1]:null;var n=this.entries();for(var i=n.next();!i.done;i=n.next()){if(r){t(e,r,i.value[1],i.value[0],this)}else{e(i.value[1],i.value[0],this)}}}});xe(a,a.entries);return u}(),Set:function(){var e=function isSet(e){return e._es6set&&typeof e._storage!=="undefined"};var r=function requireSetSlot(t,r){if(!le.TypeIsObject(t)||!e(t)){throw new TypeError("Set.prototype."+r+" called on incompatible receiver "+le.ToString(t))}};var o;var i=function Set(){if(!(this instanceof Set)){throw new TypeError('Constructor Set requires "new"')}if(this&&this._es6set){throw new TypeError("Bad construction")}var e=_e(this,Set,o,{_es6set:true,"[[SetData]]":null,_storage:tn()});if(!e._es6set){throw new TypeError("bad set")}if(arguments.length>0){nn(Set,e,arguments[0])}return e};o=i.prototype;var a=function(e){var t=e;if(t==="^null"){return null}else if(t==="^undefined"){return void 0}var r=t.charAt(0);if(r==="$"){return C(t,1)}else if(r==="n"){return+C(t,1)}else if(r==="b"){return t==="btrue"}return+t};var u=function ensureMap(e){if(!e["[[SetData]]"]){var t=new on.Map;e["[[SetData]]"]=t;l(n(e._storage),function(e){var r=a(e);t.set(r,r)});e["[[SetData]]"]=t}e._storage=null};m.getter(i.prototype,"size",function(){r(this,"size");if(this._storage){return n(this._storage).length}u(this);return this["[[SetData]]"].size});b(i.prototype,{has:function has(e){r(this,"has");var t;if(this._storage&&(t=en(e))!==null){return!!this._storage[t]}u(this);return this["[[SetData]]"].has(e)},add:function add(e){r(this,"add");var t;if(this._storage&&(t=en(e))!==null){this._storage[t]=true;return this}u(this);this["[[SetData]]"].set(e,e);return this},"delete":function(e){r(this,"delete");var t;if(this._storage&&(t=en(e))!==null){var n=q(this._storage,t);return delete this._storage[t]&&n}u(this);return this["[[SetData]]"]["delete"](e)},clear:function clear(){r(this,"clear");if(this._storage){this._storage=tn()}if(this["[[SetData]]"]){this["[[SetData]]"].clear()}},values:function values(){r(this,"values");u(this);return new f(this["[[SetData]]"].values())},entries:function entries(){r(this,"entries");u(this);return new f(this["[[SetData]]"].entries())},forEach:function forEach(e){r(this,"forEach");var n=arguments.length>1?arguments[1]:null;var o=this;u(o);this["[[SetData]]"].forEach(function(r,i){if(n){t(e,n,i,i,o)}else{e(i,i,o)}})}});h(i.prototype,"keys",i.prototype.values,true);xe(i.prototype,i.prototype.values);var f=function SetIterator(e){h(this,"it",e)};f.prototype={isSetIterator:true,next:function next(){if(!this.isSetIterator){throw new TypeError("Not a SetIterator")}return this.it.next()}};xe(f.prototype);return i}()};var an=S.Set&&!Set.prototype["delete"]&&Set.prototype.remove&&Set.prototype.items&&Set.prototype.map&&Array.isArray((new Set).keys);if(an){S.Set=on.Set}if(S.Map||S.Set){var un=a(function(){return new Map([[1,2]]).get(1)===2});if(!un){S.Map=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}var e=new H;if(arguments.length>0){rn(Map,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,S.Map.prototype);return e};S.Map.prototype=O(H.prototype);h(S.Map.prototype,"constructor",S.Map,true);m.preserveToString(S.Map,H)}var fn=new Map;var sn=function(){var e=new Map([[1,0],[2,0],[3,0],[4,0]]);e.set(-0,e);return e.get(0)===e&&e.get(-0)===e&&e.has(0)&&e.has(-0)}();var cn=fn.set(1,2)===fn;if(!sn||!cn){oe(Map.prototype,"set",function set(e,r){t($,this,e===0?0:e,r);return this})}if(!sn){b(Map.prototype,{get:function get(e){return t(B,this,e===0?0:e)},has:function has(e){return t(U,this,e===0?0:e)}},true);m.preserveToString(Map.prototype.get,B);m.preserveToString(Map.prototype.has,U)}var ln=new Set;var pn=Set.prototype["delete"]&&Set.prototype.add&&Set.prototype.has&&function(e){e["delete"](0);e.add(-0);return!e.has(0)}(ln);var vn=ln.add(1)===ln;if(!pn||!vn){var yn=Set.prototype.add;Set.prototype.add=function add(e){t(yn,this,e===0?0:e);return this};m.preserveToString(Set.prototype.add,yn)}if(!pn){var hn=Set.prototype.has;Set.prototype.has=function has(e){return t(hn,this,e===0?0:e)};m.preserveToString(Set.prototype.has,hn);var bn=Set.prototype["delete"];Set.prototype["delete"]=function SetDelete(e){return t(bn,this,e===0?0:e)};m.preserveToString(Set.prototype["delete"],bn)}var gn=w(S.Map,function(e){var t=new e([]);t.set(42,42);return t instanceof e});var dn=Object.setPrototypeOf&&!gn;var mn=function(){try{return!(S.Map()instanceof S.Map)}catch(e){return e instanceof TypeError}}();if(S.Map.length!==0||dn||!mn){S.Map=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}var e=new H;if(arguments.length>0){rn(Map,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,Map.prototype);return e};S.Map.prototype=H.prototype;h(S.Map.prototype,"constructor",S.Map,true);m.preserveToString(S.Map,H)}var On=w(S.Set,function(e){var t=new e([]);t.add(42,42);return t instanceof e});var wn=Object.setPrototypeOf&&!On;var jn=function(){try{return!(S.Set()instanceof S.Set)}catch(e){return e instanceof TypeError}}();if(S.Set.length!==0||wn||!jn){var Sn=S.Set;S.Set=function Set(){if(!(this instanceof Set)){throw new TypeError('Constructor Set requires "new"')}var e=new Sn;if(arguments.length>0){nn(Set,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,Set.prototype);return e};S.Set.prototype=Sn.prototype;h(S.Set.prototype,"constructor",S.Set,true);m.preserveToString(S.Set,Sn)}var Tn=new S.Map;var In=!a(function(){return Tn.keys().next().done});if(typeof S.Map.prototype.clear!=="function"||(new S.Set).size!==0||Tn.size!==0||typeof S.Map.prototype.keys!=="function"||typeof S.Set.prototype.keys!=="function"||typeof S.Map.prototype.forEach!=="function"||typeof S.Set.prototype.forEach!=="function"||u(S.Map)||u(S.Set)||typeof Tn.keys().next!=="function"||In||!gn){b(S,{Map:on.Map,Set:on.Set},true)}if(S.Set.prototype.keys!==S.Set.prototype.values){h(S.Set.prototype,"keys",S.Set.prototype.values,true)}xe(Object.getPrototypeOf((new S.Map).keys()));xe(Object.getPrototypeOf((new S.Set).keys()));if(c&&S.Set.prototype.has.name!=="has"){var En=S.Set.prototype.has;oe(S.Set.prototype,"has",function has(e){return t(En,this,e)})}}b(S,on);Me(S.Map);Me(S.Set)}var Pn=function throwUnlessTargetIsObject(e){if(!le.TypeIsObject(e)){throw new TypeError("target must be an object")}};var Cn={apply:function apply(){return le.Call(le.Call,null,arguments)},construct:function construct(e,t){if(!le.IsConstructor(e)){throw new TypeError("First argument must be a constructor.")}var r=arguments.length>2?arguments[2]:e;if(!le.IsConstructor(r)){throw new TypeError("new.target must be a constructor.")}return le.Construct(e,t,r,"internal")},deleteProperty:function deleteProperty(e,t){Pn(e);if(s){var r=Object.getOwnPropertyDescriptor(e,t);if(r&&!r.configurable){return false}}return delete e[t]},has:function has(e,t){Pn(e);return t in e}};if(Object.getOwnPropertyNames){Object.assign(Cn,{ownKeys:function ownKeys(e){Pn(e);var t=Object.getOwnPropertyNames(e);if(le.IsCallable(Object.getOwnPropertySymbols)){x(t,Object.getOwnPropertySymbols(e))}return t}})}var Mn=function ConvertExceptionToBoolean(e){return!i(e)};if(Object.preventExtensions){Object.assign(Cn,{isExtensible:function isExtensible(e){Pn(e);return Object.isExtensible(e)},preventExtensions:function preventExtensions(e){Pn(e);return Mn(function(){return Object.preventExtensions(e)})}})}if(s){var xn=function get(e,t,r){var n=Object.getOwnPropertyDescriptor(e,t);if(!n){var o=Object.getPrototypeOf(e);if(o===null){return void 0}return xn(o,t,r)}if("value"in n){return n.value}if(n.get){return le.Call(n.get,r)}return void 0};var Nn=function set(e,r,n,o){var i=Object.getOwnPropertyDescriptor(e,r);if(!i){var a=Object.getPrototypeOf(e);if(a!==null){return Nn(a,r,n,o)}i={value:void 0,writable:true,enumerable:true,configurable:true}}if("value"in i){if(!i.writable){return false}if(!le.TypeIsObject(o)){return false}var u=Object.getOwnPropertyDescriptor(o,r);if(u){return ue.defineProperty(o,r,{value:n})}return ue.defineProperty(o,r,{value:n,writable:true,enumerable:true,configurable:true})}if(i.set){t(i.set,o,n);return true}return false};Object.assign(Cn,{defineProperty:function defineProperty(e,t,r){Pn(e);return Mn(function(){return Object.defineProperty(e,t,r)})},getOwnPropertyDescriptor:function getOwnPropertyDescriptor(e,t){Pn(e);return Object.getOwnPropertyDescriptor(e,t)},get:function get(e,t){Pn(e);var r=arguments.length>2?arguments[2]:e;return xn(e,t,r)},set:function set(e,t,r){Pn(e);var n=arguments.length>3?arguments[3]:e;return Nn(e,t,r,n)}})}if(Object.getPrototypeOf){var An=Object.getPrototypeOf;Cn.getPrototypeOf=function getPrototypeOf(e){Pn(e);return An(e)}}if(Object.setPrototypeOf&&Cn.getPrototypeOf){var _n=function(e,t){var r=t;while(r){if(e===r){return true}r=Cn.getPrototypeOf(r)}return false};Object.assign(Cn,{setPrototypeOf:function setPrototypeOf(e,t){Pn(e);if(t!==null&&!le.TypeIsObject(t)){throw new TypeError("proto must be an object or null")}if(t===ue.getPrototypeOf(e)){return true}if(ue.isExtensible&&!ue.isExtensible(e)){return false}if(_n(e,t)){return false}Object.setPrototypeOf(e,t);return true}})}var Rn=function(e,t){if(!le.IsCallable(S.Reflect[e])){h(S.Reflect,e,t)}else{var r=a(function(){S.Reflect[e](1);S.Reflect[e](NaN);S.Reflect[e](true);return true});if(r){oe(S.Reflect,e,t)}}};Object.keys(Cn).forEach(function(e){Rn(e,Cn[e])});var kn=S.Reflect.getPrototypeOf;if(c&&kn&&kn.name!=="getPrototypeOf"){oe(S.Reflect,"getPrototypeOf",function getPrototypeOf(e){return t(kn,S.Reflect,e)})}if(S.Reflect.setPrototypeOf){if(a(function(){S.Reflect.setPrototypeOf(1,{});return true})){oe(S.Reflect,"setPrototypeOf",Cn.setPrototypeOf)}}if(S.Reflect.defineProperty){if(!a(function(){var e=!S.Reflect.defineProperty(1,"test",{value:1});var t=typeof Object.preventExtensions!=="function"||!S.Reflect.defineProperty(Object.preventExtensions({}),"test",{});return e&&t})){oe(S.Reflect,"defineProperty",Cn.defineProperty)}}if(S.Reflect.construct){if(!a(function(){var e=function F(){};return S.Reflect.construct(function(){},[],e)instanceof e})){oe(S.Reflect,"construct",Cn.construct)}}if(String(new Date(NaN))!=="Invalid Date"){var Ln=Date.prototype.toString;var Fn=function toString(){var e=+this;if(e!==e){return"Invalid Date"}return le.Call(Ln,this)};oe(Date.prototype,"toString",Fn)}var Dn={anchor:function anchor(e){return le.CreateHTML(this,"a","name",e)},big:function big(){return le.CreateHTML(this,"big","","")},blink:function blink(){return le.CreateHTML(this,"blink","","")},bold:function bold(){return le.CreateHTML(this,"b","","")},fixed:function fixed(){return le.CreateHTML(this,"tt","","")},fontcolor:function fontcolor(e){return le.CreateHTML(this,"font","color",e)},fontsize:function fontsize(e){return le.CreateHTML(this,"font","size",e)},italics:function italics(){return le.CreateHTML(this,"i","","")},link:function link(e){return le.CreateHTML(this,"a","href",e)},small:function small(){return le.CreateHTML(this,"small","","")},strike:function strike(){return le.CreateHTML(this,"strike","","")},sub:function sub(){return le.CreateHTML(this,"sub","","")},sup:function sub(){return le.CreateHTML(this,"sup","","")}};l(Object.keys(Dn),function(e){var r=String.prototype[e];var n=false;if(le.IsCallable(r)){var o=t(r,"",' " ');var i=P([],o.match(/"/g)).length;n=o!==o.toLowerCase()||i>2}else{n=true}if(n){oe(String.prototype,e,Dn[e])}});var zn=function(){if(!ie){return false}var e=typeof JSON==="object"&&typeof JSON.stringify==="function"?JSON.stringify:null;if(!e){return false}if(typeof e(J())!=="undefined"){return true}if(e([J()])!=="[null]"){return true}var t={a:J()};t[J()]=true;if(e(t)!=="{}"){return true}return false}();var qn=a(function(){if(!ie){return true}return JSON.stringify(Object(J()))==="{}"&&JSON.stringify([Object(J())])==="[{}]"});if(zn||!qn){var Wn=JSON.stringify;oe(JSON,"stringify",function stringify(e){if(typeof e==="symbol"){return}var n;if(arguments.length>1){n=arguments[1]}var o=[e];if(!r(n)){var i=le.IsCallable(n)?n:null;var a=function(e,r){var n=i?t(i,this,e,r):r;if(typeof n!=="symbol"){if(ne.symbol(n)){return _t({})(n)}return n}};o.push(a)}else{o.push(n)}if(arguments.length>2){o.push(arguments[2])}return Wn.apply(this,o)})}return S});
//# sourceMappingURL=es6-shim.map
/*! jQuery v3.7.1 | (c) OpenJS Foundation and other contributors | jquery.org/license */
!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(ie,e){"use strict";var oe=[],r=Object.getPrototypeOf,ae=oe.slice,g=oe.flat?function(e){return oe.flat.call(e)}:function(e){return oe.concat.apply([],e)},s=oe.push,se=oe.indexOf,n={},i=n.toString,ue=n.hasOwnProperty,o=ue.toString,a=o.call(Object),le={},v=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},y=function(e){return null!=e&&e===e.window},C=ie.document,u={type:!0,src:!0,nonce:!0,noModule:!0};function m(e,t,n){var r,i,o=(n=n||C).createElement("script");if(o.text=e,t)for(r in u)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function x(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?n[i.call(e)]||"object":typeof e}var t="3.7.1",l=/HTML$/i,ce=function(e,t){return new ce.fn.init(e,t)};function c(e){var t=!!e&&"length"in e&&e.length,n=x(e);return!v(e)&&!y(e)&&("array"===n||0===t||"number"==typeof t&&0<t&&t-1 in e)}function fe(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}ce.fn=ce.prototype={jquery:t,constructor:ce,length:0,toArray:function(){return ae.call(this)},get:function(e){return null==e?ae.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=ce.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return ce.each(this,e)},map:function(n){return this.pushStack(ce.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(ae.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(ce.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(ce.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(0<=n&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:oe.sort,splice:oe.splice},ce.extend=ce.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||v(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(e=arguments[s]))for(t in e)r=e[t],"__proto__"!==t&&a!==r&&(l&&r&&(ce.isPlainObject(r)||(i=Array.isArray(r)))?(n=a[t],o=i&&!Array.isArray(n)?[]:i||ce.isPlainObject(n)?n:{},i=!1,a[t]=ce.extend(l,o,r)):void 0!==r&&(a[t]=r));return a},ce.extend({expando:"jQuery"+(t+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==i.call(e))&&(!(t=r(e))||"function"==typeof(n=ue.call(t,"constructor")&&t.constructor)&&o.call(n)===a)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){m(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(c(e)){for(n=e.length;r<n;r++)if(!1===t.call(e[r],r,e[r]))break}else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},text:function(e){var t,n="",r=0,i=e.nodeType;if(!i)while(t=e[r++])n+=ce.text(t);return 1===i||11===i?e.textContent:9===i?e.documentElement.textContent:3===i||4===i?e.nodeValue:n},makeArray:function(e,t){var n=t||[];return null!=e&&(c(Object(e))?ce.merge(n,"string"==typeof e?[e]:e):s.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:se.call(t,e,n)},isXMLDoc:function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!l.test(t||n&&n.nodeName||"HTML")},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,a=!n;i<o;i++)!t(e[i],i)!==a&&r.push(e[i]);return r},map:function(e,t,n){var r,i,o=0,a=[];if(c(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&a.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&a.push(i);return g(a)},guid:1,support:le}),"function"==typeof Symbol&&(ce.fn[Symbol.iterator]=oe[Symbol.iterator]),ce.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){n["[object "+t+"]"]=t.toLowerCase()});var pe=oe.pop,de=oe.sort,he=oe.splice,ge="[\\x20\\t\\r\\n\\f]",ve=new RegExp("^"+ge+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ge+"+$","g");ce.contains=function(e,t){var n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(e.contains?e.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))};var f=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function p(e,t){return t?"\0"===e?"\ufffd":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e}ce.escapeSelector=function(e){return(e+"").replace(f,p)};var ye=C,me=s;!function(){var e,b,w,o,a,T,r,C,d,i,k=me,S=ce.expando,E=0,n=0,s=W(),c=W(),u=W(),h=W(),l=function(e,t){return e===t&&(a=!0),0},f="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",t="(?:\\\\[\\da-fA-F]{1,6}"+ge+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",p="\\["+ge+"*("+t+")(?:"+ge+"*([*^$|!~]?=)"+ge+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+t+"))|)"+ge+"*\\]",g=":("+t+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+p+")*)|.*)\\)|)",v=new RegExp(ge+"+","g"),y=new RegExp("^"+ge+"*,"+ge+"*"),m=new RegExp("^"+ge+"*([>+~]|"+ge+")"+ge+"*"),x=new RegExp(ge+"|>"),j=new RegExp(g),A=new RegExp("^"+t+"$"),D={ID:new RegExp("^#("+t+")"),CLASS:new RegExp("^\\.("+t+")"),TAG:new RegExp("^("+t+"|[*])"),ATTR:new RegExp("^"+p),PSEUDO:new RegExp("^"+g),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ge+"*(even|odd|(([+-]|)(\\d*)n|)"+ge+"*(?:([+-]|)"+ge+"*(\\d+)|))"+ge+"*\\)|)","i"),bool:new RegExp("^(?:"+f+")$","i"),needsContext:new RegExp("^"+ge+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ge+"*((?:-\\d)?\\d*)"+ge+"*\\)|)(?=[^-]|$)","i")},N=/^(?:input|select|textarea|button)$/i,q=/^h\d$/i,L=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,H=/[+~]/,O=new RegExp("\\\\[\\da-fA-F]{1,6}"+ge+"?|\\\\([^\\r\\n\\f])","g"),P=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},M=function(){V()},R=J(function(e){return!0===e.disabled&&fe(e,"fieldset")},{dir:"parentNode",next:"legend"});try{k.apply(oe=ae.call(ye.childNodes),ye.childNodes),oe[ye.childNodes.length].nodeType}catch(e){k={apply:function(e,t){me.apply(e,ae.call(t))},call:function(e){me.apply(e,ae.call(arguments,1))}}}function I(t,e,n,r){var i,o,a,s,u,l,c,f=e&&e.ownerDocument,p=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==p&&9!==p&&11!==p)return n;if(!r&&(V(e),e=e||T,C)){if(11!==p&&(u=L.exec(t)))if(i=u[1]){if(9===p){if(!(a=e.getElementById(i)))return n;if(a.id===i)return k.call(n,a),n}else if(f&&(a=f.getElementById(i))&&I.contains(e,a)&&a.id===i)return k.call(n,a),n}else{if(u[2])return k.apply(n,e.getElementsByTagName(t)),n;if((i=u[3])&&e.getElementsByClassName)return k.apply(n,e.getElementsByClassName(i)),n}if(!(h[t+" "]||d&&d.test(t))){if(c=t,f=e,1===p&&(x.test(t)||m.test(t))){(f=H.test(t)&&U(e.parentNode)||e)==e&&le.scope||((s=e.getAttribute("id"))?s=ce.escapeSelector(s):e.setAttribute("id",s=S)),o=(l=Y(t)).length;while(o--)l[o]=(s?"#"+s:":scope")+" "+Q(l[o]);c=l.join(",")}try{return k.apply(n,f.querySelectorAll(c)),n}catch(e){h(t,!0)}finally{s===S&&e.removeAttribute("id")}}}return re(t.replace(ve,"$1"),e,n,r)}function W(){var r=[];return function e(t,n){return r.push(t+" ")>b.cacheLength&&delete e[r.shift()],e[t+" "]=n}}function F(e){return e[S]=!0,e}function $(e){var t=T.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function B(t){return function(e){return fe(e,"input")&&e.type===t}}function _(t){return function(e){return(fe(e,"input")||fe(e,"button"))&&e.type===t}}function z(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&R(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function X(a){return F(function(o){return o=+o,F(function(e,t){var n,r=a([],e.length,o),i=r.length;while(i--)e[n=r[i]]&&(e[n]=!(t[n]=e[n]))})})}function U(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function V(e){var t,n=e?e.ownerDocument||e:ye;return n!=T&&9===n.nodeType&&n.documentElement&&(r=(T=n).documentElement,C=!ce.isXMLDoc(T),i=r.matches||r.webkitMatchesSelector||r.msMatchesSelector,r.msMatchesSelector&&ye!=T&&(t=T.defaultView)&&t.top!==t&&t.addEventListener("unload",M),le.getById=$(function(e){return r.appendChild(e).id=ce.expando,!T.getElementsByName||!T.getElementsByName(ce.expando).length}),le.disconnectedMatch=$(function(e){return i.call(e,"*")}),le.scope=$(function(){return T.querySelectorAll(":scope")}),le.cssHas=$(function(){try{return T.querySelector(":has(*,:jqfake)"),!1}catch(e){return!0}}),le.getById?(b.filter.ID=function(e){var t=e.replace(O,P);return function(e){return e.getAttribute("id")===t}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&C){var n=t.getElementById(e);return n?[n]:[]}}):(b.filter.ID=function(e){var n=e.replace(O,P);return function(e){var t="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return t&&t.value===n}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&C){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];i=t.getElementsByName(e),r=0;while(o=i[r++])if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),b.find.TAG=function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):t.querySelectorAll(e)},b.find.CLASS=function(e,t){if("undefined"!=typeof t.getElementsByClassName&&C)return t.getElementsByClassName(e)},d=[],$(function(e){var t;r.appendChild(e).innerHTML="<a id='"+S+"' href='' disabled='disabled'></a><select id='"+S+"-\r\\' disabled='disabled'><option selected=''></option></select>",e.querySelectorAll("[selected]").length||d.push("\\["+ge+"*(?:value|"+f+")"),e.querySelectorAll("[id~="+S+"-]").length||d.push("~="),e.querySelectorAll("a#"+S+"+*").length||d.push(".#.+[+~]"),e.querySelectorAll(":checked").length||d.push(":checked"),(t=T.createElement("input")).setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),r.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&d.push(":enabled",":disabled"),(t=T.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||d.push("\\["+ge+"*name"+ge+"*="+ge+"*(?:''|\"\")")}),le.cssHas||d.push(":has"),d=d.length&&new RegExp(d.join("|")),l=function(e,t){if(e===t)return a=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!le.sortDetached&&t.compareDocumentPosition(e)===n?e===T||e.ownerDocument==ye&&I.contains(ye,e)?-1:t===T||t.ownerDocument==ye&&I.contains(ye,t)?1:o?se.call(o,e)-se.call(o,t):0:4&n?-1:1)}),T}for(e in I.matches=function(e,t){return I(e,null,null,t)},I.matchesSelector=function(e,t){if(V(e),C&&!h[t+" "]&&(!d||!d.test(t)))try{var n=i.call(e,t);if(n||le.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){h(t,!0)}return 0<I(t,T,null,[e]).length},I.contains=function(e,t){return(e.ownerDocument||e)!=T&&V(e),ce.contains(e,t)},I.attr=function(e,t){(e.ownerDocument||e)!=T&&V(e);var n=b.attrHandle[t.toLowerCase()],r=n&&ue.call(b.attrHandle,t.toLowerCase())?n(e,t,!C):void 0;return void 0!==r?r:e.getAttribute(t)},I.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ce.uniqueSort=function(e){var t,n=[],r=0,i=0;if(a=!le.sortStable,o=!le.sortStable&&ae.call(e,0),de.call(e,l),a){while(t=e[i++])t===e[i]&&(r=n.push(i));while(r--)he.call(e,n[r],1)}return o=null,e},ce.fn.uniqueSort=function(){return this.pushStack(ce.uniqueSort(ae.apply(this)))},(b=ce.expr={cacheLength:50,createPseudo:F,match:D,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(O,P),e[3]=(e[3]||e[4]||e[5]||"").replace(O,P),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||I.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&I.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return D.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&j.test(n)&&(t=Y(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(O,P).toLowerCase();return"*"===e?function(){return!0}:function(e){return fe(e,t)}},CLASS:function(e){var t=s[e+" "];return t||(t=new RegExp("(^|"+ge+")"+e+"("+ge+"|$)"))&&s(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(n,r,i){return function(e){var t=I.attr(e,n);return null==t?"!="===r:!r||(t+="","="===r?t===i:"!="===r?t!==i:"^="===r?i&&0===t.indexOf(i):"*="===r?i&&-1<t.indexOf(i):"$="===r?i&&t.slice(-i.length)===i:"~="===r?-1<(" "+t.replace(v," ")+" ").indexOf(i):"|="===r&&(t===i||t.slice(0,i.length+1)===i+"-"))}},CHILD:function(d,e,t,h,g){var v="nth"!==d.slice(0,3),y="last"!==d.slice(-4),m="of-type"===e;return 1===h&&0===g?function(e){return!!e.parentNode}:function(e,t,n){var r,i,o,a,s,u=v!==y?"nextSibling":"previousSibling",l=e.parentNode,c=m&&e.nodeName.toLowerCase(),f=!n&&!m,p=!1;if(l){if(v){while(u){o=e;while(o=o[u])if(m?fe(o,c):1===o.nodeType)return!1;s=u="only"===d&&!s&&"nextSibling"}return!0}if(s=[y?l.firstChild:l.lastChild],y&&f){p=(a=(r=(i=l[S]||(l[S]={}))[d]||[])[0]===E&&r[1])&&r[2],o=a&&l.childNodes[a];while(o=++a&&o&&o[u]||(p=a=0)||s.pop())if(1===o.nodeType&&++p&&o===e){i[d]=[E,a,p];break}}else if(f&&(p=a=(r=(i=e[S]||(e[S]={}))[d]||[])[0]===E&&r[1]),!1===p)while(o=++a&&o&&o[u]||(p=a=0)||s.pop())if((m?fe(o,c):1===o.nodeType)&&++p&&(f&&((i=o[S]||(o[S]={}))[d]=[E,p]),o===e))break;return(p-=g)===h||p%h==0&&0<=p/h}}},PSEUDO:function(e,o){var t,a=b.pseudos[e]||b.setFilters[e.toLowerCase()]||I.error("unsupported pseudo: "+e);return a[S]?a(o):1<a.length?(t=[e,e,"",o],b.setFilters.hasOwnProperty(e.toLowerCase())?F(function(e,t){var n,r=a(e,o),i=r.length;while(i--)e[n=se.call(e,r[i])]=!(t[n]=r[i])}):function(e){return a(e,0,t)}):a}},pseudos:{not:F(function(e){var r=[],i=[],s=ne(e.replace(ve,"$1"));return s[S]?F(function(e,t,n,r){var i,o=s(e,null,r,[]),a=e.length;while(a--)(i=o[a])&&(e[a]=!(t[a]=i))}):function(e,t,n){return r[0]=e,s(r,null,n,i),r[0]=null,!i.pop()}}),has:F(function(t){return function(e){return 0<I(t,e).length}}),contains:F(function(t){return t=t.replace(O,P),function(e){return-1<(e.textContent||ce.text(e)).indexOf(t)}}),lang:F(function(n){return A.test(n||"")||I.error("unsupported lang: "+n),n=n.replace(O,P).toLowerCase(),function(e){var t;do{if(t=C?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===n||0===t.indexOf(n+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=ie.location&&ie.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===r},focus:function(e){return e===function(){try{return T.activeElement}catch(e){}}()&&T.hasFocus()&&!!(e.type||e.href||~e.tabIndex)},enabled:z(!1),disabled:z(!0),checked:function(e){return fe(e,"input")&&!!e.checked||fe(e,"option")&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!b.pseudos.empty(e)},header:function(e){return q.test(e.nodeName)},input:function(e){return N.test(e.nodeName)},button:function(e){return fe(e,"input")&&"button"===e.type||fe(e,"button")},text:function(e){var t;return fe(e,"input")&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:X(function(){return[0]}),last:X(function(e,t){return[t-1]}),eq:X(function(e,t,n){return[n<0?n+t:n]}),even:X(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:X(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:X(function(e,t,n){var r;for(r=n<0?n+t:t<n?t:n;0<=--r;)e.push(r);return e}),gt:X(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=b.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[e]=B(e);for(e in{submit:!0,reset:!0})b.pseudos[e]=_(e);function G(){}function Y(e,t){var n,r,i,o,a,s,u,l=c[e+" "];if(l)return t?0:l.slice(0);a=e,s=[],u=b.preFilter;while(a){for(o in n&&!(r=y.exec(a))||(r&&(a=a.slice(r[0].length)||a),s.push(i=[])),n=!1,(r=m.exec(a))&&(n=r.shift(),i.push({value:n,type:r[0].replace(ve," ")}),a=a.slice(n.length)),b.filter)!(r=D[o].exec(a))||u[o]&&!(r=u[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?I.error(e):c(e,s).slice(0)}function Q(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function J(a,e,t){var s=e.dir,u=e.next,l=u||s,c=t&&"parentNode"===l,f=n++;return e.first?function(e,t,n){while(e=e[s])if(1===e.nodeType||c)return a(e,t,n);return!1}:function(e,t,n){var r,i,o=[E,f];if(n){while(e=e[s])if((1===e.nodeType||c)&&a(e,t,n))return!0}else while(e=e[s])if(1===e.nodeType||c)if(i=e[S]||(e[S]={}),u&&fe(e,u))e=e[s]||e;else{if((r=i[l])&&r[0]===E&&r[1]===f)return o[2]=r[2];if((i[l]=o)[2]=a(e,t,n))return!0}return!1}}function K(i){return 1<i.length?function(e,t,n){var r=i.length;while(r--)if(!i[r](e,t,n))return!1;return!0}:i[0]}function Z(e,t,n,r,i){for(var o,a=[],s=0,u=e.length,l=null!=t;s<u;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),l&&t.push(s)));return a}function ee(d,h,g,v,y,e){return v&&!v[S]&&(v=ee(v)),y&&!y[S]&&(y=ee(y,e)),F(function(e,t,n,r){var i,o,a,s,u=[],l=[],c=t.length,f=e||function(e,t,n){for(var r=0,i=t.length;r<i;r++)I(e,t[r],n);return n}(h||"*",n.nodeType?[n]:n,[]),p=!d||!e&&h?f:Z(f,u,d,n,r);if(g?g(p,s=y||(e?d:c||v)?[]:t,n,r):s=p,v){i=Z(s,l),v(i,[],n,r),o=i.length;while(o--)(a=i[o])&&(s[l[o]]=!(p[l[o]]=a))}if(e){if(y||d){if(y){i=[],o=s.length;while(o--)(a=s[o])&&i.push(p[o]=a);y(null,s=[],i,r)}o=s.length;while(o--)(a=s[o])&&-1<(i=y?se.call(e,a):u[o])&&(e[i]=!(t[i]=a))}}else s=Z(s===t?s.splice(c,s.length):s),y?y(null,t,s,r):k.apply(t,s)})}function te(e){for(var i,t,n,r=e.length,o=b.relative[e[0].type],a=o||b.relative[" "],s=o?1:0,u=J(function(e){return e===i},a,!0),l=J(function(e){return-1<se.call(i,e)},a,!0),c=[function(e,t,n){var r=!o&&(n||t!=w)||((i=t).nodeType?u(e,t,n):l(e,t,n));return i=null,r}];s<r;s++)if(t=b.relative[e[s].type])c=[J(K(c),t)];else{if((t=b.filter[e[s].type].apply(null,e[s].matches))[S]){for(n=++s;n<r;n++)if(b.relative[e[n].type])break;return ee(1<s&&K(c),1<s&&Q(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(ve,"$1"),t,s<n&&te(e.slice(s,n)),n<r&&te(e=e.slice(n)),n<r&&Q(e))}c.push(t)}return K(c)}function ne(e,t){var n,v,y,m,x,r,i=[],o=[],a=u[e+" "];if(!a){t||(t=Y(e)),n=t.length;while(n--)(a=te(t[n]))[S]?i.push(a):o.push(a);(a=u(e,(v=o,m=0<(y=i).length,x=0<v.length,r=function(e,t,n,r,i){var o,a,s,u=0,l="0",c=e&&[],f=[],p=w,d=e||x&&b.find.TAG("*",i),h=E+=null==p?1:Math.random()||.1,g=d.length;for(i&&(w=t==T||t||i);l!==g&&null!=(o=d[l]);l++){if(x&&o){a=0,t||o.ownerDocument==T||(V(o),n=!C);while(s=v[a++])if(s(o,t||T,n)){k.call(r,o);break}i&&(E=h)}m&&((o=!s&&o)&&u--,e&&c.push(o))}if(u+=l,m&&l!==u){a=0;while(s=y[a++])s(c,f,t,n);if(e){if(0<u)while(l--)c[l]||f[l]||(f[l]=pe.call(r));f=Z(f)}k.apply(r,f),i&&!e&&0<f.length&&1<u+y.length&&ce.uniqueSort(r)}return i&&(E=h,w=p),c},m?F(r):r))).selector=e}return a}function re(e,t,n,r){var i,o,a,s,u,l="function"==typeof e&&e,c=!r&&Y(e=l.selector||e);if(n=n||[],1===c.length){if(2<(o=c[0]=c[0].slice(0)).length&&"ID"===(a=o[0]).type&&9===t.nodeType&&C&&b.relative[o[1].type]){if(!(t=(b.find.ID(a.matches[0].replace(O,P),t)||[])[0]))return n;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}i=D.needsContext.test(e)?0:o.length;while(i--){if(a=o[i],b.relative[s=a.type])break;if((u=b.find[s])&&(r=u(a.matches[0].replace(O,P),H.test(o[0].type)&&U(t.parentNode)||t))){if(o.splice(i,1),!(e=r.length&&Q(o)))return k.apply(n,r),n;break}}}return(l||ne(e,c))(r,t,!C,n,!t||H.test(e)&&U(t.parentNode)||t),n}G.prototype=b.filters=b.pseudos,b.setFilters=new G,le.sortStable=S.split("").sort(l).join("")===S,V(),le.sortDetached=$(function(e){return 1&e.compareDocumentPosition(T.createElement("fieldset"))}),ce.find=I,ce.expr[":"]=ce.expr.pseudos,ce.unique=ce.uniqueSort,I.compile=ne,I.select=re,I.setDocument=V,I.tokenize=Y,I.escape=ce.escapeSelector,I.getText=ce.text,I.isXML=ce.isXMLDoc,I.selectors=ce.expr,I.support=ce.support,I.uniqueSort=ce.uniqueSort}();var d=function(e,t,n){var r=[],i=void 0!==n;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&ce(e).is(n))break;r.push(e)}return r},h=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},b=ce.expr.match.needsContext,w=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function T(e,n,r){return v(n)?ce.grep(e,function(e,t){return!!n.call(e,t,e)!==r}):n.nodeType?ce.grep(e,function(e){return e===n!==r}):"string"!=typeof n?ce.grep(e,function(e){return-1<se.call(n,e)!==r}):ce.filter(n,e,r)}ce.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?ce.find.matchesSelector(r,e)?[r]:[]:ce.find.matches(e,ce.grep(t,function(e){return 1===e.nodeType}))},ce.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(ce(e).filter(function(){for(t=0;t<r;t++)if(ce.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)ce.find(e,i[t],n);return 1<r?ce.uniqueSort(n):n},filter:function(e){return this.pushStack(T(this,e||[],!1))},not:function(e){return this.pushStack(T(this,e||[],!0))},is:function(e){return!!T(this,"string"==typeof e&&b.test(e)?ce(e):e||[],!1).length}});var k,S=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(ce.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||k,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&3<=e.length?[null,e,null]:S.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof ce?t[0]:t,ce.merge(this,ce.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:C,!0)),w.test(r[1])&&ce.isPlainObject(t))for(r in t)v(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=C.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):v(e)?void 0!==n.ready?n.ready(e):e(ce):ce.makeArray(e,this)}).prototype=ce.fn,k=ce(C);var E=/^(?:parents|prev(?:Until|All))/,j={children:!0,contents:!0,next:!0,prev:!0};function A(e,t){while((e=e[t])&&1!==e.nodeType);return e}ce.fn.extend({has:function(e){var t=ce(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(ce.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&ce(e);if(!b.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?-1<a.index(n):1===n.nodeType&&ce.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(1<o.length?ce.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?se.call(ce(e),this[0]):se.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(ce.uniqueSort(ce.merge(this.get(),ce(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),ce.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return d(e,"parentNode")},parentsUntil:function(e,t,n){return d(e,"parentNode",n)},next:function(e){return A(e,"nextSibling")},prev:function(e){return A(e,"previousSibling")},nextAll:function(e){return d(e,"nextSibling")},prevAll:function(e){return d(e,"previousSibling")},nextUntil:function(e,t,n){return d(e,"nextSibling",n)},prevUntil:function(e,t,n){return d(e,"previousSibling",n)},siblings:function(e){return h((e.parentNode||{}).firstChild,e)},children:function(e){return h(e.firstChild)},contents:function(e){return null!=e.contentDocument&&r(e.contentDocument)?e.contentDocument:(fe(e,"template")&&(e=e.content||e),ce.merge([],e.childNodes))}},function(r,i){ce.fn[r]=function(e,t){var n=ce.map(this,i,e);return"Until"!==r.slice(-5)&&(t=e),t&&"string"==typeof t&&(n=ce.filter(t,n)),1<this.length&&(j[r]||ce.uniqueSort(n),E.test(r)&&n.reverse()),this.pushStack(n)}});var D=/[^\x20\t\r\n\f]+/g;function N(e){return e}function q(e){throw e}function L(e,t,n,r){var i;try{e&&v(i=e.promise)?i.call(e).done(t).fail(n):e&&v(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}ce.Callbacks=function(r){var e,n;r="string"==typeof r?(e=r,n={},ce.each(e.match(D)||[],function(e,t){n[t]=!0}),n):ce.extend({},r);var i,t,o,a,s=[],u=[],l=-1,c=function(){for(a=a||r.once,o=i=!0;u.length;l=-1){t=u.shift();while(++l<s.length)!1===s[l].apply(t[0],t[1])&&r.stopOnFalse&&(l=s.length,t=!1)}r.memory||(t=!1),i=!1,a&&(s=t?[]:"")},f={add:function(){return s&&(t&&!i&&(l=s.length-1,u.push(t)),function n(e){ce.each(e,function(e,t){v(t)?r.unique&&f.has(t)||s.push(t):t&&t.length&&"string"!==x(t)&&n(t)})}(arguments),t&&!i&&c()),this},remove:function(){return ce.each(arguments,function(e,t){var n;while(-1<(n=ce.inArray(t,s,n)))s.splice(n,1),n<=l&&l--}),this},has:function(e){return e?-1<ce.inArray(e,s):0<s.length},empty:function(){return s&&(s=[]),this},disable:function(){return a=u=[],s=t="",this},disabled:function(){return!s},lock:function(){return a=u=[],t||i||(s=t=""),this},locked:function(){return!!a},fireWith:function(e,t){return a||(t=[e,(t=t||[]).slice?t.slice():t],u.push(t),i||c()),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!o}};return f},ce.extend({Deferred:function(e){var o=[["notify","progress",ce.Callbacks("memory"),ce.Callbacks("memory"),2],["resolve","done",ce.Callbacks("once memory"),ce.Callbacks("once memory"),0,"resolved"],["reject","fail",ce.Callbacks("once memory"),ce.Callbacks("once memory"),1,"rejected"]],i="pending",a={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},"catch":function(e){return a.then(null,e)},pipe:function(){var i=arguments;return ce.Deferred(function(r){ce.each(o,function(e,t){var n=v(i[t[4]])&&i[t[4]];s[t[1]](function(){var e=n&&n.apply(this,arguments);e&&v(e.promise)?e.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[t[0]+"With"](this,n?[e]:arguments)})}),i=null}).promise()},then:function(t,n,r){var u=0;function l(i,o,a,s){return function(){var n=this,r=arguments,e=function(){var e,t;if(!(i<u)){if((e=a.apply(n,r))===o.promise())throw new TypeError("Thenable self-resolution");t=e&&("object"==typeof e||"function"==typeof e)&&e.then,v(t)?s?t.call(e,l(u,o,N,s),l(u,o,q,s)):(u++,t.call(e,l(u,o,N,s),l(u,o,q,s),l(u,o,N,o.notifyWith))):(a!==N&&(n=void 0,r=[e]),(s||o.resolveWith)(n,r))}},t=s?e:function(){try{e()}catch(e){ce.Deferred.exceptionHook&&ce.Deferred.exceptionHook(e,t.error),u<=i+1&&(a!==q&&(n=void 0,r=[e]),o.rejectWith(n,r))}};i?t():(ce.Deferred.getErrorHook?t.error=ce.Deferred.getErrorHook():ce.Deferred.getStackHook&&(t.error=ce.Deferred.getStackHook()),ie.setTimeout(t))}}return ce.Deferred(function(e){o[0][3].add(l(0,e,v(r)?r:N,e.notifyWith)),o[1][3].add(l(0,e,v(t)?t:N)),o[2][3].add(l(0,e,v(n)?n:q))}).promise()},promise:function(e){return null!=e?ce.extend(e,a):a}},s={};return ce.each(o,function(e,t){var n=t[2],r=t[5];a[t[1]]=n.add,r&&n.add(function(){i=r},o[3-e][2].disable,o[3-e][3].disable,o[0][2].lock,o[0][3].lock),n.add(t[3].fire),s[t[0]]=function(){return s[t[0]+"With"](this===s?void 0:this,arguments),this},s[t[0]+"With"]=n.fireWith}),a.promise(s),e&&e.call(s,s),s},when:function(e){var n=arguments.length,t=n,r=Array(t),i=ae.call(arguments),o=ce.Deferred(),a=function(t){return function(e){r[t]=this,i[t]=1<arguments.length?ae.call(arguments):e,--n||o.resolveWith(r,i)}};if(n<=1&&(L(e,o.done(a(t)).resolve,o.reject,!n),"pending"===o.state()||v(i[t]&&i[t].then)))return o.then();while(t--)L(i[t],a(t),o.reject);return o.promise()}});var H=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;ce.Deferred.exceptionHook=function(e,t){ie.console&&ie.console.warn&&e&&H.test(e.name)&&ie.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},ce.readyException=function(e){ie.setTimeout(function(){throw e})};var O=ce.Deferred();function P(){C.removeEventListener("DOMContentLoaded",P),ie.removeEventListener("load",P),ce.ready()}ce.fn.ready=function(e){return O.then(e)["catch"](function(e){ce.readyException(e)}),this},ce.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--ce.readyWait:ce.isReady)||(ce.isReady=!0)!==e&&0<--ce.readyWait||O.resolveWith(C,[ce])}}),ce.ready.then=O.then,"complete"===C.readyState||"loading"!==C.readyState&&!C.documentElement.doScroll?ie.setTimeout(ce.ready):(C.addEventListener("DOMContentLoaded",P),ie.addEventListener("load",P));var M=function(e,t,n,r,i,o,a){var s=0,u=e.length,l=null==n;if("object"===x(n))for(s in i=!0,n)M(e,t,s,n[s],!0,o,a);else if(void 0!==r&&(i=!0,v(r)||(a=!0),l&&(a?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(ce(e),n)})),t))for(;s<u;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:l?t.call(e):u?t(e[0],n):o},R=/^-ms-/,I=/-([a-z])/g;function W(e,t){return t.toUpperCase()}function F(e){return e.replace(R,"ms-").replace(I,W)}var $=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function B(){this.expando=ce.expando+B.uid++}B.uid=1,B.prototype={cache:function(e){var t=e[this.expando];return t||(t={},$(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[F(t)]=n;else for(r in t)i[F(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][F(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(F):(t=F(t))in r?[t]:t.match(D)||[]).length;while(n--)delete r[t[n]]}(void 0===t||ce.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!ce.isEmptyObject(t)}};var _=new B,z=new B,X=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,U=/[A-Z]/g;function V(e,t,n){var r,i;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(U,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n="true"===(i=n)||"false"!==i&&("null"===i?null:i===+i+""?+i:X.test(i)?JSON.parse(i):i)}catch(e){}z.set(e,t,n)}else n=void 0;return n}ce.extend({hasData:function(e){return z.hasData(e)||_.hasData(e)},data:function(e,t,n){return z.access(e,t,n)},removeData:function(e,t){z.remove(e,t)},_data:function(e,t,n){return _.access(e,t,n)},_removeData:function(e,t){_.remove(e,t)}}),ce.fn.extend({data:function(n,e){var t,r,i,o=this[0],a=o&&o.attributes;if(void 0===n){if(this.length&&(i=z.get(o),1===o.nodeType&&!_.get(o,"hasDataAttrs"))){t=a.length;while(t--)a[t]&&0===(r=a[t].name).indexOf("data-")&&(r=F(r.slice(5)),V(o,r,i[r]));_.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof n?this.each(function(){z.set(this,n)}):M(this,function(e){var t;if(o&&void 0===e)return void 0!==(t=z.get(o,n))?t:void 0!==(t=V(o,n))?t:void 0;this.each(function(){z.set(this,n,e)})},null,e,1<arguments.length,null,!0)},removeData:function(e){return this.each(function(){z.remove(this,e)})}}),ce.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=_.get(e,t),n&&(!r||Array.isArray(n)?r=_.access(e,t,ce.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=ce.queue(e,t),r=n.length,i=n.shift(),o=ce._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,function(){ce.dequeue(e,t)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return _.get(e,n)||_.access(e,n,{empty:ce.Callbacks("once memory").add(function(){_.remove(e,[t+"queue",n])})})}}),ce.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?ce.queue(this[0],t):void 0===n?this:this.each(function(){var e=ce.queue(this,t,n);ce._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&ce.dequeue(this,t)})},dequeue:function(e){return this.each(function(){ce.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=ce.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};"string"!=typeof e&&(t=e,e=void 0),e=e||"fx";while(a--)(n=_.get(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var G=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Y=new RegExp("^(?:([+-])=|)("+G+")([a-z%]*)$","i"),Q=["Top","Right","Bottom","Left"],J=C.documentElement,K=function(e){return ce.contains(e.ownerDocument,e)},Z={composed:!0};J.getRootNode&&(K=function(e){return ce.contains(e.ownerDocument,e)||e.getRootNode(Z)===e.ownerDocument});var ee=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&K(e)&&"none"===ce.css(e,"display")};function te(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return ce.css(e,t,"")},u=s(),l=n&&n[3]||(ce.cssNumber[t]?"":"px"),c=e.nodeType&&(ce.cssNumber[t]||"px"!==l&&+u)&&Y.exec(ce.css(e,t));if(c&&c[3]!==l){u/=2,l=l||c[3],c=+u||1;while(a--)ce.style(e,t,c+l),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),c/=o;c*=2,ce.style(e,t,c+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}var ne={};function re(e,t){for(var n,r,i,o,a,s,u,l=[],c=0,f=e.length;c<f;c++)(r=e[c]).style&&(n=r.style.display,t?("none"===n&&(l[c]=_.get(r,"display")||null,l[c]||(r.style.display="")),""===r.style.display&&ee(r)&&(l[c]=(u=a=o=void 0,a=(i=r).ownerDocument,s=i.nodeName,(u=ne[s])||(o=a.body.appendChild(a.createElement(s)),u=ce.css(o,"display"),o.parentNode.removeChild(o),"none"===u&&(u="block"),ne[s]=u)))):"none"!==n&&(l[c]="none",_.set(r,"display",n)));for(c=0;c<f;c++)null!=l[c]&&(e[c].style.display=l[c]);return e}ce.fn.extend({show:function(){return re(this,!0)},hide:function(){return re(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ee(this)?ce(this).show():ce(this).hide()})}});var xe,be,we=/^(?:checkbox|radio)$/i,Te=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Ce=/^$|^module$|\/(?:java|ecma)script/i;xe=C.createDocumentFragment().appendChild(C.createElement("div")),(be=C.createElement("input")).setAttribute("type","radio"),be.setAttribute("checked","checked"),be.setAttribute("name","t"),xe.appendChild(be),le.checkClone=xe.cloneNode(!0).cloneNode(!0).lastChild.checked,xe.innerHTML="<textarea>x</textarea>",le.noCloneChecked=!!xe.cloneNode(!0).lastChild.defaultValue,xe.innerHTML="<option></option>",le.option=!!xe.lastChild;var ke={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function Se(e,t){var n;return n="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&fe(e,t)?ce.merge([e],n):n}function Ee(e,t){for(var n=0,r=e.length;n<r;n++)_.set(e[n],"globalEval",!t||_.get(t[n],"globalEval"))}ke.tbody=ke.tfoot=ke.colgroup=ke.caption=ke.thead,ke.th=ke.td,le.option||(ke.optgroup=ke.option=[1,"<select multiple='multiple'>","</select>"]);var je=/<|&#?\w+;/;function Ae(e,t,n,r,i){for(var o,a,s,u,l,c,f=t.createDocumentFragment(),p=[],d=0,h=e.length;d<h;d++)if((o=e[d])||0===o)if("object"===x(o))ce.merge(p,o.nodeType?[o]:o);else if(je.test(o)){a=a||f.appendChild(t.createElement("div")),s=(Te.exec(o)||["",""])[1].toLowerCase(),u=ke[s]||ke._default,a.innerHTML=u[1]+ce.htmlPrefilter(o)+u[2],c=u[0];while(c--)a=a.lastChild;ce.merge(p,a.childNodes),(a=f.firstChild).textContent=""}else p.push(t.createTextNode(o));f.textContent="",d=0;while(o=p[d++])if(r&&-1<ce.inArray(o,r))i&&i.push(o);else if(l=K(o),a=Se(f.appendChild(o),"script"),l&&Ee(a),n){c=0;while(o=a[c++])Ce.test(o.type||"")&&n.push(o)}return f}var De=/^([^.]*)(?:\.(.+)|)/;function Ne(){return!0}function qe(){return!1}function Le(e,t,n,r,i,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(r=r||n,n=void 0),t)Le(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=qe;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return ce().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=ce.guid++)),e.each(function(){ce.event.add(this,t,i,r,n)})}function He(e,r,t){t?(_.set(e,r,!1),ce.event.add(e,r,{namespace:!1,handler:function(e){var t,n=_.get(this,r);if(1&e.isTrigger&&this[r]){if(n)(ce.event.special[r]||{}).delegateType&&e.stopPropagation();else if(n=ae.call(arguments),_.set(this,r,n),this[r](),t=_.get(this,r),_.set(this,r,!1),n!==t)return e.stopImmediatePropagation(),e.preventDefault(),t}else n&&(_.set(this,r,ce.event.trigger(n[0],n.slice(1),this)),e.stopPropagation(),e.isImmediatePropagationStopped=Ne)}})):void 0===_.get(e,r)&&ce.event.add(e,r,Ne)}ce.event={global:{},add:function(t,e,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=_.get(t);if($(t)){n.handler&&(n=(o=n).handler,i=o.selector),i&&ce.find.matchesSelector(J,i),n.guid||(n.guid=ce.guid++),(u=v.events)||(u=v.events=Object.create(null)),(a=v.handle)||(a=v.handle=function(e){return"undefined"!=typeof ce&&ce.event.triggered!==e.type?ce.event.dispatch.apply(t,arguments):void 0}),l=(e=(e||"").match(D)||[""]).length;while(l--)d=g=(s=De.exec(e[l])||[])[1],h=(s[2]||"").split(".").sort(),d&&(f=ce.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=ce.event.special[d]||{},c=ce.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&ce.expr.match.needsContext.test(i),namespace:h.join(".")},o),(p=u[d])||((p=u[d]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(t,r,h,a)||t.addEventListener&&t.addEventListener(d,a)),f.add&&(f.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),ce.event.global[d]=!0)}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=_.hasData(e)&&_.get(e);if(v&&(u=v.events)){l=(t=(t||"").match(D)||[""]).length;while(l--)if(d=g=(s=De.exec(t[l])||[])[1],h=(s[2]||"").split(".").sort(),d){f=ce.event.special[d]||{},p=u[d=(r?f.delegateType:f.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=p.length;while(o--)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));a&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,h,v.handle)||ce.removeEvent(e,d,v.handle),delete u[d])}else for(d in u)ce.event.remove(e,d+t[l],n,r,!0);ce.isEmptyObject(u)&&_.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,a,s=new Array(arguments.length),u=ce.event.fix(e),l=(_.get(this,"events")||Object.create(null))[u.type]||[],c=ce.event.special[u.type]||{};for(s[0]=u,t=1;t<arguments.length;t++)s[t]=arguments[t];if(u.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,u)){a=ce.event.handlers.call(this,u,l),t=0;while((i=a[t++])&&!u.isPropagationStopped()){u.currentTarget=i.elem,n=0;while((o=i.handlers[n++])&&!u.isImmediatePropagationStopped())u.rnamespace&&!1!==o.namespace&&!u.rnamespace.test(o.namespace)||(u.handleObj=o,u.data=o.data,void 0!==(r=((ce.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,s))&&!1===(u.result=r)&&(u.preventDefault(),u.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,u),u.result}},handlers:function(e,t){var n,r,i,o,a,s=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&1<=e.button))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[i=(r=t[n]).selector+" "]&&(a[i]=r.needsContext?-1<ce(i,this).index(l):ce.find(i,this,null,[l]).length),a[i]&&o.push(r);o.length&&s.push({elem:l,handlers:o})}return l=this,u<t.length&&s.push({elem:l,handlers:t.slice(u)}),s},addProp:function(t,e){Object.defineProperty(ce.Event.prototype,t,{enumerable:!0,configurable:!0,get:v(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(e){return e[ce.expando]?e:new ce.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return we.test(t.type)&&t.click&&fe(t,"input")&&He(t,"click",!0),!1},trigger:function(e){var t=this||e;return we.test(t.type)&&t.click&&fe(t,"input")&&He(t,"click"),!0},_default:function(e){var t=e.target;return we.test(t.type)&&t.click&&fe(t,"input")&&_.get(t,"click")||fe(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},ce.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},ce.Event=function(e,t){if(!(this instanceof ce.Event))return new ce.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Ne:qe,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&ce.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[ce.expando]=!0},ce.Event.prototype={constructor:ce.Event,isDefaultPrevented:qe,isPropagationStopped:qe,isImmediatePropagationStopped:qe,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Ne,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Ne,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Ne,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},ce.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},ce.event.addProp),ce.each({focus:"focusin",blur:"focusout"},function(r,i){function o(e){if(C.documentMode){var t=_.get(this,"handle"),n=ce.event.fix(e);n.type="focusin"===e.type?"focus":"blur",n.isSimulated=!0,t(e),n.target===n.currentTarget&&t(n)}else ce.event.simulate(i,e.target,ce.event.fix(e))}ce.event.special[r]={setup:function(){var e;if(He(this,r,!0),!C.documentMode)return!1;(e=_.get(this,i))||this.addEventListener(i,o),_.set(this,i,(e||0)+1)},trigger:function(){return He(this,r),!0},teardown:function(){var e;if(!C.documentMode)return!1;(e=_.get(this,i)-1)?_.set(this,i,e):(this.removeEventListener(i,o),_.remove(this,i))},_default:function(e){return _.get(e.target,r)},delegateType:i},ce.event.special[i]={setup:function(){var e=this.ownerDocument||this.document||this,t=C.documentMode?this:e,n=_.get(t,i);n||(C.documentMode?this.addEventListener(i,o):e.addEventListener(r,o,!0)),_.set(t,i,(n||0)+1)},teardown:function(){var e=this.ownerDocument||this.document||this,t=C.documentMode?this:e,n=_.get(t,i)-1;n?_.set(t,i,n):(C.documentMode?this.removeEventListener(i,o):e.removeEventListener(r,o,!0),_.remove(t,i))}}}),ce.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,i){ce.event.special[e]={delegateType:i,bindType:i,handle:function(e){var t,n=e.relatedTarget,r=e.handleObj;return n&&(n===this||ce.contains(this,n))||(e.type=r.origType,t=r.handler.apply(this,arguments),e.type=i),t}}}),ce.fn.extend({on:function(e,t,n,r){return Le(this,e,t,n,r)},one:function(e,t,n,r){return Le(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,ce(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=qe),this.each(function(){ce.event.remove(this,e,n,t)})}});var Oe=/<script|<style|<link/i,Pe=/checked\s*(?:[^=]|=\s*.checked.)/i,Me=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function Re(e,t){return fe(e,"table")&&fe(11!==t.nodeType?t:t.firstChild,"tr")&&ce(e).children("tbody")[0]||e}function Ie(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function We(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Fe(e,t){var n,r,i,o,a,s;if(1===t.nodeType){if(_.hasData(e)&&(s=_.get(e).events))for(i in _.remove(t,"handle events"),s)for(n=0,r=s[i].length;n<r;n++)ce.event.add(t,i,s[i][n]);z.hasData(e)&&(o=z.access(e),a=ce.extend({},o),z.set(t,a))}}function $e(n,r,i,o){r=g(r);var e,t,a,s,u,l,c=0,f=n.length,p=f-1,d=r[0],h=v(d);if(h||1<f&&"string"==typeof d&&!le.checkClone&&Pe.test(d))return n.each(function(e){var t=n.eq(e);h&&(r[0]=d.call(this,e,t.html())),$e(t,r,i,o)});if(f&&(t=(e=Ae(r,n[0].ownerDocument,!1,n,o)).firstChild,1===e.childNodes.length&&(e=t),t||o)){for(s=(a=ce.map(Se(e,"script"),Ie)).length;c<f;c++)u=e,c!==p&&(u=ce.clone(u,!0,!0),s&&ce.merge(a,Se(u,"script"))),i.call(n[c],u,c);if(s)for(l=a[a.length-1].ownerDocument,ce.map(a,We),c=0;c<s;c++)u=a[c],Ce.test(u.type||"")&&!_.access(u,"globalEval")&&ce.contains(l,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?ce._evalUrl&&!u.noModule&&ce._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},l):m(u.textContent.replace(Me,""),u,l))}return n}function Be(e,t,n){for(var r,i=t?ce.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||ce.cleanData(Se(r)),r.parentNode&&(n&&K(r)&&Ee(Se(r,"script")),r.parentNode.removeChild(r));return e}ce.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,o,a,s,u,l,c=e.cloneNode(!0),f=K(e);if(!(le.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||ce.isXMLDoc(e)))for(a=Se(c),r=0,i=(o=Se(e)).length;r<i;r++)s=o[r],u=a[r],void 0,"input"===(l=u.nodeName.toLowerCase())&&we.test(s.type)?u.checked=s.checked:"input"!==l&&"textarea"!==l||(u.defaultValue=s.defaultValue);if(t)if(n)for(o=o||Se(e),a=a||Se(c),r=0,i=o.length;r<i;r++)Fe(o[r],a[r]);else Fe(e,c);return 0<(a=Se(c,"script")).length&&Ee(a,!f&&Se(e,"script")),c},cleanData:function(e){for(var t,n,r,i=ce.event.special,o=0;void 0!==(n=e[o]);o++)if($(n)){if(t=n[_.expando]){if(t.events)for(r in t.events)i[r]?ce.event.remove(n,r):ce.removeEvent(n,r,t.handle);n[_.expando]=void 0}n[z.expando]&&(n[z.expando]=void 0)}}}),ce.fn.extend({detach:function(e){return Be(this,e,!0)},remove:function(e){return Be(this,e)},text:function(e){return M(this,function(e){return void 0===e?ce.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return $e(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Re(this,e).appendChild(e)})},prepend:function(){return $e(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Re(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return $e(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return $e(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(ce.cleanData(Se(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return ce.clone(this,e,t)})},html:function(e){return M(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Oe.test(e)&&!ke[(Te.exec(e)||["",""])[1].toLowerCase()]){e=ce.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(ce.cleanData(Se(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var n=[];return $e(this,arguments,function(e){var t=this.parentNode;ce.inArray(this,n)<0&&(ce.cleanData(Se(this)),t&&t.replaceChild(e,this))},n)}}),ce.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,a){ce.fn[e]=function(e){for(var t,n=[],r=ce(e),i=r.length-1,o=0;o<=i;o++)t=o===i?this:this.clone(!0),ce(r[o])[a](t),s.apply(n,t.get());return this.pushStack(n)}});var _e=new RegExp("^("+G+")(?!px)[a-z%]+$","i"),ze=/^--/,Xe=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=ie),t.getComputedStyle(e)},Ue=function(e,t,n){var r,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];for(i in r=n.call(e),t)e.style[i]=o[i];return r},Ve=new RegExp(Q.join("|"),"i");function Ge(e,t,n){var r,i,o,a,s=ze.test(t),u=e.style;return(n=n||Xe(e))&&(a=n.getPropertyValue(t)||n[t],s&&a&&(a=a.replace(ve,"$1")||void 0),""!==a||K(e)||(a=ce.style(e,t)),!le.pixelBoxStyles()&&_e.test(a)&&Ve.test(t)&&(r=u.width,i=u.minWidth,o=u.maxWidth,u.minWidth=u.maxWidth=u.width=a,a=n.width,u.width=r,u.minWidth=i,u.maxWidth=o)),void 0!==a?a+"":a}function Ye(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(l){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",J.appendChild(u).appendChild(l);var e=ie.getComputedStyle(l);n="1%"!==e.top,s=12===t(e.marginLeft),l.style.right="60%",o=36===t(e.right),r=36===t(e.width),l.style.position="absolute",i=12===t(l.offsetWidth/3),J.removeChild(u),l=null}}function t(e){return Math.round(parseFloat(e))}var n,r,i,o,a,s,u=C.createElement("div"),l=C.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",le.clearCloneStyle="content-box"===l.style.backgroundClip,ce.extend(le,{boxSizingReliable:function(){return e(),r},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),s},scrollboxSize:function(){return e(),i},reliableTrDimensions:function(){var e,t,n,r;return null==a&&(e=C.createElement("table"),t=C.createElement("tr"),n=C.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="box-sizing:content-box;border:1px solid",t.style.height="1px",n.style.height="9px",n.style.display="block",J.appendChild(e).appendChild(t).appendChild(n),r=ie.getComputedStyle(t),a=parseInt(r.height,10)+parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)===t.offsetHeight,J.removeChild(e)),a}}))}();var Qe=["Webkit","Moz","ms"],Je=C.createElement("div").style,Ke={};function Ze(e){var t=ce.cssProps[e]||Ke[e];return t||(e in Je?e:Ke[e]=function(e){var t=e[0].toUpperCase()+e.slice(1),n=Qe.length;while(n--)if((e=Qe[n]+t)in Je)return e}(e)||e)}var et=/^(none|table(?!-c[ea]).+)/,tt={position:"absolute",visibility:"hidden",display:"block"},nt={letterSpacing:"0",fontWeight:"400"};function rt(e,t,n){var r=Y.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function it(e,t,n,r,i,o){var a="width"===t?1:0,s=0,u=0,l=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(l+=ce.css(e,n+Q[a],!0,i)),r?("content"===n&&(u-=ce.css(e,"padding"+Q[a],!0,i)),"margin"!==n&&(u-=ce.css(e,"border"+Q[a]+"Width",!0,i))):(u+=ce.css(e,"padding"+Q[a],!0,i),"padding"!==n?u+=ce.css(e,"border"+Q[a]+"Width",!0,i):s+=ce.css(e,"border"+Q[a]+"Width",!0,i));return!r&&0<=o&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-u-s-.5))||0),u+l}function ot(e,t,n){var r=Xe(e),i=(!le.boxSizingReliable()||n)&&"border-box"===ce.css(e,"boxSizing",!1,r),o=i,a=Ge(e,t,r),s="offset"+t[0].toUpperCase()+t.slice(1);if(_e.test(a)){if(!n)return a;a="auto"}return(!le.boxSizingReliable()&&i||!le.reliableTrDimensions()&&fe(e,"tr")||"auto"===a||!parseFloat(a)&&"inline"===ce.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===ce.css(e,"boxSizing",!1,r),(o=s in e)&&(a=e[s])),(a=parseFloat(a)||0)+it(e,t,n||(i?"border":"content"),o,r,a)+"px"}function at(e,t,n,r,i){return new at.prototype.init(e,t,n,r,i)}ce.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Ge(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=F(t),u=ze.test(t),l=e.style;if(u||(t=Ze(s)),a=ce.cssHooks[t]||ce.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:l[t];"string"===(o=typeof n)&&(i=Y.exec(n))&&i[1]&&(n=te(e,t,i),o="number"),null!=n&&n==n&&("number"!==o||u||(n+=i&&i[3]||(ce.cssNumber[s]?"":"px")),le.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(u?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,r){var i,o,a,s=F(t);return ze.test(t)||(t=Ze(s)),(a=ce.cssHooks[t]||ce.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,n)),void 0===i&&(i=Ge(e,t,r)),"normal"===i&&t in nt&&(i=nt[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),ce.each(["height","width"],function(e,u){ce.cssHooks[u]={get:function(e,t,n){if(t)return!et.test(ce.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?ot(e,u,n):Ue(e,tt,function(){return ot(e,u,n)})},set:function(e,t,n){var r,i=Xe(e),o=!le.scrollboxSize()&&"absolute"===i.position,a=(o||n)&&"border-box"===ce.css(e,"boxSizing",!1,i),s=n?it(e,u,n,a,i):0;return a&&o&&(s-=Math.ceil(e["offset"+u[0].toUpperCase()+u.slice(1)]-parseFloat(i[u])-it(e,u,"border",!1,i)-.5)),s&&(r=Y.exec(t))&&"px"!==(r[3]||"px")&&(e.style[u]=t,t=ce.css(e,u)),rt(0,t,s)}}}),ce.cssHooks.marginLeft=Ye(le.reliableMarginLeft,function(e,t){if(t)return(parseFloat(Ge(e,"marginLeft"))||e.getBoundingClientRect().left-Ue(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),ce.each({margin:"",padding:"",border:"Width"},function(i,o){ce.cssHooks[i+o]={expand:function(e){for(var t=0,n={},r="string"==typeof e?e.split(" "):[e];t<4;t++)n[i+Q[t]+o]=r[t]||r[t-2]||r[0];return n}},"margin"!==i&&(ce.cssHooks[i+o].set=rt)}),ce.fn.extend({css:function(e,t){return M(this,function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=Xe(e),i=t.length;a<i;a++)o[t[a]]=ce.css(e,t[a],!1,r);return o}return void 0!==n?ce.style(e,t,n):ce.css(e,t)},e,t,1<arguments.length)}}),((ce.Tween=at).prototype={constructor:at,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||ce.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(ce.cssNumber[n]?"":"px")},cur:function(){var e=at.propHooks[this.prop];return e&&e.get?e.get(this):at.propHooks._default.get(this)},run:function(e){var t,n=at.propHooks[this.prop];return this.options.duration?this.pos=t=ce.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):at.propHooks._default.set(this),this}}).init.prototype=at.prototype,(at.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=ce.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){ce.fx.step[e.prop]?ce.fx.step[e.prop](e):1!==e.elem.nodeType||!ce.cssHooks[e.prop]&&null==e.elem.style[Ze(e.prop)]?e.elem[e.prop]=e.now:ce.style(e.elem,e.prop,e.now+e.unit)}}}).scrollTop=at.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ce.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},ce.fx=at.prototype.init,ce.fx.step={};var st,ut,lt,ct,ft=/^(?:toggle|show|hide)$/,pt=/queueHooks$/;function dt(){ut&&(!1===C.hidden&&ie.requestAnimationFrame?ie.requestAnimationFrame(dt):ie.setTimeout(dt,ce.fx.interval),ce.fx.tick())}function ht(){return ie.setTimeout(function(){st=void 0}),st=Date.now()}function gt(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=Q[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function vt(e,t,n){for(var r,i=(yt.tweeners[t]||[]).concat(yt.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function yt(o,e,t){var n,a,r=0,i=yt.prefilters.length,s=ce.Deferred().always(function(){delete u.elem}),u=function(){if(a)return!1;for(var e=st||ht(),t=Math.max(0,l.startTime+l.duration-e),n=1-(t/l.duration||0),r=0,i=l.tweens.length;r<i;r++)l.tweens[r].run(n);return s.notifyWith(o,[l,n,t]),n<1&&i?t:(i||s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l]),!1)},l=s.promise({elem:o,props:ce.extend({},e),opts:ce.extend(!0,{specialEasing:{},easing:ce.easing._default},t),originalProperties:e,originalOptions:t,startTime:st||ht(),duration:t.duration,tweens:[],createTween:function(e,t){var n=ce.Tween(o,l.opts,e,t,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(n),n},stop:function(e){var t=0,n=e?l.tweens.length:0;if(a)return this;for(a=!0;t<n;t++)l.tweens[t].run(1);return e?(s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l,e])):s.rejectWith(o,[l,e]),this}}),c=l.props;for(!function(e,t){var n,r,i,o,a;for(n in e)if(i=t[r=F(n)],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=ce.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(c,l.opts.specialEasing);r<i;r++)if(n=yt.prefilters[r].call(l,o,c,l.opts))return v(n.stop)&&(ce._queueHooks(l.elem,l.opts.queue).stop=n.stop.bind(n)),n;return ce.map(c,vt,l),v(l.opts.start)&&l.opts.start.call(o,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),ce.fx.timer(ce.extend(u,{elem:o,anim:l,queue:l.opts.queue})),l}ce.Animation=ce.extend(yt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return te(n.elem,e,Y.exec(t),n),n}]},tweener:function(e,t){v(e)?(t=e,e=["*"]):e=e.match(D);for(var n,r=0,i=e.length;r<i;r++)n=e[r],yt.tweeners[n]=yt.tweeners[n]||[],yt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,o,a,s,u,l,c,f="width"in t||"height"in t,p=this,d={},h=e.style,g=e.nodeType&&ee(e),v=_.get(e,"fxshow");for(r in n.queue||(null==(a=ce._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,p.always(function(){p.always(function(){a.unqueued--,ce.queue(e,"fx").length||a.empty.fire()})})),t)if(i=t[r],ft.test(i)){if(delete t[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!v||void 0===v[r])continue;g=!0}d[r]=v&&v[r]||ce.style(e,r)}if((u=!ce.isEmptyObject(t))||!ce.isEmptyObject(d))for(r in f&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],null==(l=v&&v.display)&&(l=_.get(e,"display")),"none"===(c=ce.css(e,"display"))&&(l?c=l:(re([e],!0),l=e.style.display||l,c=ce.css(e,"display"),re([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===ce.css(e,"float")&&(u||(p.done(function(){h.display=l}),null==l&&(c=h.display,l="none"===c?"":c)),h.display="inline-block")),n.overflow&&(h.overflow="hidden",p.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),u=!1,d)u||(v?"hidden"in v&&(g=v.hidden):v=_.access(e,"fxshow",{display:l}),o&&(v.hidden=!g),g&&re([e],!0),p.done(function(){for(r in g||re([e]),_.remove(e,"fxshow"),d)ce.style(e,r,d[r])})),u=vt(g?v[r]:0,r,p),r in v||(v[r]=u.start,g&&(u.end=u.start,u.start=0))}],prefilter:function(e,t){t?yt.prefilters.unshift(e):yt.prefilters.push(e)}}),ce.speed=function(e,t,n){var r=e&&"object"==typeof e?ce.extend({},e):{complete:n||!n&&t||v(e)&&e,duration:e,easing:n&&t||t&&!v(t)&&t};return ce.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in ce.fx.speeds?r.duration=ce.fx.speeds[r.duration]:r.duration=ce.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){v(r.old)&&r.old.call(this),r.queue&&ce.dequeue(this,r.queue)},r},ce.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ee).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(t,e,n,r){var i=ce.isEmptyObject(t),o=ce.speed(e,n,r),a=function(){var e=yt(this,ce.extend({},t),o);(i||_.get(this,"finish"))&&e.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(i,e,o){var a=function(e){var t=e.stop;delete e.stop,t(o)};return"string"!=typeof i&&(o=e,e=i,i=void 0),e&&this.queue(i||"fx",[]),this.each(function(){var e=!0,t=null!=i&&i+"queueHooks",n=ce.timers,r=_.get(this);if(t)r[t]&&r[t].stop&&a(r[t]);else for(t in r)r[t]&&r[t].stop&&pt.test(t)&&a(r[t]);for(t=n.length;t--;)n[t].elem!==this||null!=i&&n[t].queue!==i||(n[t].anim.stop(o),e=!1,n.splice(t,1));!e&&o||ce.dequeue(this,i)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var e,t=_.get(this),n=t[a+"queue"],r=t[a+"queueHooks"],i=ce.timers,o=n?n.length:0;for(t.finish=!0,ce.queue(this,a,[]),r&&r.stop&&r.stop.call(this,!0),e=i.length;e--;)i[e].elem===this&&i[e].queue===a&&(i[e].anim.stop(!0),i.splice(e,1));for(e=0;e<o;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete t.finish})}}),ce.each(["toggle","show","hide"],function(e,r){var i=ce.fn[r];ce.fn[r]=function(e,t,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(gt(r,!0),e,t,n)}}),ce.each({slideDown:gt("show"),slideUp:gt("hide"),slideToggle:gt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,r){ce.fn[e]=function(e,t,n){return this.animate(r,e,t,n)}}),ce.timers=[],ce.fx.tick=function(){var e,t=0,n=ce.timers;for(st=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||ce.fx.stop(),st=void 0},ce.fx.timer=function(e){ce.timers.push(e),ce.fx.start()},ce.fx.interval=13,ce.fx.start=function(){ut||(ut=!0,dt())},ce.fx.stop=function(){ut=null},ce.fx.speeds={slow:600,fast:200,_default:400},ce.fn.delay=function(r,e){return r=ce.fx&&ce.fx.speeds[r]||r,e=e||"fx",this.queue(e,function(e,t){var n=ie.setTimeout(e,r);t.stop=function(){ie.clearTimeout(n)}})},lt=C.createElement("input"),ct=C.createElement("select").appendChild(C.createElement("option")),lt.type="checkbox",le.checkOn=""!==lt.value,le.optSelected=ct.selected,(lt=C.createElement("input")).value="t",lt.type="radio",le.radioValue="t"===lt.value;var mt,xt=ce.expr.attrHandle;ce.fn.extend({attr:function(e,t){return M(this,ce.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){ce.removeAttr(this,e)})}}),ce.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?ce.prop(e,t,n):(1===o&&ce.isXMLDoc(e)||(i=ce.attrHooks[t.toLowerCase()]||(ce.expr.match.bool.test(t)?mt:void 0)),void 0!==n?null===n?void ce.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=ce.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!le.radioValue&&"radio"===t&&fe(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(D);if(i&&1===e.nodeType)while(n=i[r++])e.removeAttribute(n)}}),mt={set:function(e,t,n){return!1===t?ce.removeAttr(e,n):e.setAttribute(n,n),n}},ce.each(ce.expr.match.bool.source.match(/\w+/g),function(e,t){var a=xt[t]||ce.find.attr;xt[t]=function(e,t,n){var r,i,o=t.toLowerCase();return n||(i=xt[o],xt[o]=r,r=null!=a(e,t,n)?o:null,xt[o]=i),r}});var bt=/^(?:input|select|textarea|button)$/i,wt=/^(?:a|area)$/i;function Tt(e){return(e.match(D)||[]).join(" ")}function Ct(e){return e.getAttribute&&e.getAttribute("class")||""}function kt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(D)||[]}ce.fn.extend({prop:function(e,t){return M(this,ce.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each(function(){delete this[ce.propFix[e]||e]})}}),ce.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&ce.isXMLDoc(e)||(t=ce.propFix[t]||t,i=ce.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=ce.find.attr(e,"tabindex");return t?parseInt(t,10):bt.test(e.nodeName)||wt.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),le.optSelected||(ce.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),ce.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ce.propFix[this.toLowerCase()]=this}),ce.fn.extend({addClass:function(t){var e,n,r,i,o,a;return v(t)?this.each(function(e){ce(this).addClass(t.call(this,e,Ct(this)))}):(e=kt(t)).length?this.each(function(){if(r=Ct(this),n=1===this.nodeType&&" "+Tt(r)+" "){for(o=0;o<e.length;o++)i=e[o],n.indexOf(" "+i+" ")<0&&(n+=i+" ");a=Tt(n),r!==a&&this.setAttribute("class",a)}}):this},removeClass:function(t){var e,n,r,i,o,a;return v(t)?this.each(function(e){ce(this).removeClass(t.call(this,e,Ct(this)))}):arguments.length?(e=kt(t)).length?this.each(function(){if(r=Ct(this),n=1===this.nodeType&&" "+Tt(r)+" "){for(o=0;o<e.length;o++){i=e[o];while(-1<n.indexOf(" "+i+" "))n=n.replace(" "+i+" "," ")}a=Tt(n),r!==a&&this.setAttribute("class",a)}}):this:this.attr("class","")},toggleClass:function(t,n){var e,r,i,o,a=typeof t,s="string"===a||Array.isArray(t);return v(t)?this.each(function(e){ce(this).toggleClass(t.call(this,e,Ct(this),n),n)}):"boolean"==typeof n&&s?n?this.addClass(t):this.removeClass(t):(e=kt(t),this.each(function(){if(s)for(o=ce(this),i=0;i<e.length;i++)r=e[i],o.hasClass(r)?o.removeClass(r):o.addClass(r);else void 0!==t&&"boolean"!==a||((r=Ct(this))&&_.set(this,"__className__",r),this.setAttribute&&this.setAttribute("class",r||!1===t?"":_.get(this,"__className__")||""))}))},hasClass:function(e){var t,n,r=0;t=" "+e+" ";while(n=this[r++])if(1===n.nodeType&&-1<(" "+Tt(Ct(n))+" ").indexOf(t))return!0;return!1}});var St=/\r/g;ce.fn.extend({val:function(n){var r,e,i,t=this[0];return arguments.length?(i=v(n),this.each(function(e){var t;1===this.nodeType&&(null==(t=i?n.call(this,e,ce(this).val()):n)?t="":"number"==typeof t?t+="":Array.isArray(t)&&(t=ce.map(t,function(e){return null==e?"":e+""})),(r=ce.valHooks[this.type]||ce.valHooks[this.nodeName.toLowerCase()])&&"set"in r&&void 0!==r.set(this,t,"value")||(this.value=t))})):t?(r=ce.valHooks[t.type]||ce.valHooks[t.nodeName.toLowerCase()])&&"get"in r&&void 0!==(e=r.get(t,"value"))?e:"string"==typeof(e=t.value)?e.replace(St,""):null==e?"":e:void 0}}),ce.extend({valHooks:{option:{get:function(e){var t=ce.find.attr(e,"value");return null!=t?t:Tt(ce.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],u=a?o+1:i.length;for(r=o<0?u:a?o:0;r<u;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!fe(n.parentNode,"optgroup"))){if(t=ce(n).val(),a)return t;s.push(t)}return s},set:function(e,t){var n,r,i=e.options,o=ce.makeArray(t),a=i.length;while(a--)((r=i[a]).selected=-1<ce.inArray(ce.valHooks.option.get(r),o))&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),ce.each(["radio","checkbox"],function(){ce.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=-1<ce.inArray(ce(e).val(),t)}},le.checkOn||(ce.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Et=ie.location,jt={guid:Date.now()},At=/\?/;ce.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{t=(new ie.DOMParser).parseFromString(e,"text/xml")}catch(e){}return n=t&&t.getElementsByTagName("parsererror")[0],t&&!n||ce.error("Invalid XML: "+(n?ce.map(n.childNodes,function(e){return e.textContent}).join("\n"):e)),t};var Dt=/^(?:focusinfocus|focusoutblur)$/,Nt=function(e){e.stopPropagation()};ce.extend(ce.event,{trigger:function(e,t,n,r){var i,o,a,s,u,l,c,f,p=[n||C],d=ue.call(e,"type")?e.type:e,h=ue.call(e,"namespace")?e.namespace.split("."):[];if(o=f=a=n=n||C,3!==n.nodeType&&8!==n.nodeType&&!Dt.test(d+ce.event.triggered)&&(-1<d.indexOf(".")&&(d=(h=d.split(".")).shift(),h.sort()),u=d.indexOf(":")<0&&"on"+d,(e=e[ce.expando]?e:new ce.Event(d,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=h.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:ce.makeArray(t,[e]),c=ce.event.special[d]||{},r||!c.trigger||!1!==c.trigger.apply(n,t))){if(!r&&!c.noBubble&&!y(n)){for(s=c.delegateType||d,Dt.test(s+d)||(o=o.parentNode);o;o=o.parentNode)p.push(o),a=o;a===(n.ownerDocument||C)&&p.push(a.defaultView||a.parentWindow||ie)}i=0;while((o=p[i++])&&!e.isPropagationStopped())f=o,e.type=1<i?s:c.bindType||d,(l=(_.get(o,"events")||Object.create(null))[e.type]&&_.get(o,"handle"))&&l.apply(o,t),(l=u&&o[u])&&l.apply&&$(o)&&(e.result=l.apply(o,t),!1===e.result&&e.preventDefault());return e.type=d,r||e.isDefaultPrevented()||c._default&&!1!==c._default.apply(p.pop(),t)||!$(n)||u&&v(n[d])&&!y(n)&&((a=n[u])&&(n[u]=null),ce.event.triggered=d,e.isPropagationStopped()&&f.addEventListener(d,Nt),n[d](),e.isPropagationStopped()&&f.removeEventListener(d,Nt),ce.event.triggered=void 0,a&&(n[u]=a)),e.result}},simulate:function(e,t,n){var r=ce.extend(new ce.Event,n,{type:e,isSimulated:!0});ce.event.trigger(r,null,t)}}),ce.fn.extend({trigger:function(e,t){return this.each(function(){ce.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return ce.event.trigger(e,t,n,!0)}});var qt=/\[\]$/,Lt=/\r?\n/g,Ht=/^(?:submit|button|image|reset|file)$/i,Ot=/^(?:input|select|textarea|keygen)/i;function Pt(n,e,r,i){var t;if(Array.isArray(e))ce.each(e,function(e,t){r||qt.test(n)?i(n,t):Pt(n+"["+("object"==typeof t&&null!=t?e:"")+"]",t,r,i)});else if(r||"object"!==x(e))i(n,e);else for(t in e)Pt(n+"["+t+"]",e[t],r,i)}ce.param=function(e,t){var n,r=[],i=function(e,t){var n=v(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!ce.isPlainObject(e))ce.each(e,function(){i(this.name,this.value)});else for(n in e)Pt(n,e[n],t,i);return r.join("&")},ce.fn.extend({serialize:function(){return ce.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=ce.prop(this,"elements");return e?ce.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!ce(this).is(":disabled")&&Ot.test(this.nodeName)&&!Ht.test(e)&&(this.checked||!we.test(e))}).map(function(e,t){var n=ce(this).val();return null==n?null:Array.isArray(n)?ce.map(n,function(e){return{name:t.name,value:e.replace(Lt,"\r\n")}}):{name:t.name,value:n.replace(Lt,"\r\n")}}).get()}});var Mt=/%20/g,Rt=/#.*$/,It=/([?&])_=[^&]*/,Wt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ft=/^(?:GET|HEAD)$/,$t=/^\/\//,Bt={},_t={},zt="*/".concat("*"),Xt=C.createElement("a");function Ut(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,r=0,i=e.toLowerCase().match(D)||[];if(v(t))while(n=i[r++])"+"===n[0]?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(t)):(o[n]=o[n]||[]).push(t)}}function Vt(t,i,o,a){var s={},u=t===_t;function l(e){var r;return s[e]=!0,ce.each(t[e]||[],function(e,t){var n=t(i,o,a);return"string"!=typeof n||u||s[n]?u?!(r=n):void 0:(i.dataTypes.unshift(n),l(n),!1)}),r}return l(i.dataTypes[0])||!s["*"]&&l("*")}function Gt(e,t){var n,r,i=ce.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&ce.extend(!0,e,r),e}Xt.href=Et.href,ce.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Et.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Et.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":zt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":ce.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Gt(Gt(e,ce.ajaxSettings),t):Gt(ce.ajaxSettings,e)},ajaxPrefilter:Ut(Bt),ajaxTransport:Ut(_t),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var c,f,p,n,d,r,h,g,i,o,v=ce.ajaxSetup({},t),y=v.context||v,m=v.context&&(y.nodeType||y.jquery)?ce(y):ce.event,x=ce.Deferred(),b=ce.Callbacks("once memory"),w=v.statusCode||{},a={},s={},u="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(h){if(!n){n={};while(t=Wt.exec(p))n[t[1].toLowerCase()+" "]=(n[t[1].toLowerCase()+" "]||[]).concat(t[2])}t=n[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return h?p:null},setRequestHeader:function(e,t){return null==h&&(e=s[e.toLowerCase()]=s[e.toLowerCase()]||e,a[e]=t),this},overrideMimeType:function(e){return null==h&&(v.mimeType=e),this},statusCode:function(e){var t;if(e)if(h)T.always(e[T.status]);else for(t in e)w[t]=[w[t],e[t]];return this},abort:function(e){var t=e||u;return c&&c.abort(t),l(0,t),this}};if(x.promise(T),v.url=((e||v.url||Et.href)+"").replace($t,Et.protocol+"//"),v.type=t.method||t.type||v.method||v.type,v.dataTypes=(v.dataType||"*").toLowerCase().match(D)||[""],null==v.crossDomain){r=C.createElement("a");try{r.href=v.url,r.href=r.href,v.crossDomain=Xt.protocol+"//"+Xt.host!=r.protocol+"//"+r.host}catch(e){v.crossDomain=!0}}if(v.data&&v.processData&&"string"!=typeof v.data&&(v.data=ce.param(v.data,v.traditional)),Vt(Bt,v,t,T),h)return T;for(i in(g=ce.event&&v.global)&&0==ce.active++&&ce.event.trigger("ajaxStart"),v.type=v.type.toUpperCase(),v.hasContent=!Ft.test(v.type),f=v.url.replace(Rt,""),v.hasContent?v.data&&v.processData&&0===(v.contentType||"").indexOf("application/x-www-form-urlencoded")&&(v.data=v.data.replace(Mt,"+")):(o=v.url.slice(f.length),v.data&&(v.processData||"string"==typeof v.data)&&(f+=(At.test(f)?"&":"?")+v.data,delete v.data),!1===v.cache&&(f=f.replace(It,"$1"),o=(At.test(f)?"&":"?")+"_="+jt.guid+++o),v.url=f+o),v.ifModified&&(ce.lastModified[f]&&T.setRequestHeader("If-Modified-Since",ce.lastModified[f]),ce.etag[f]&&T.setRequestHeader("If-None-Match",ce.etag[f])),(v.data&&v.hasContent&&!1!==v.contentType||t.contentType)&&T.setRequestHeader("Content-Type",v.contentType),T.setRequestHeader("Accept",v.dataTypes[0]&&v.accepts[v.dataTypes[0]]?v.accepts[v.dataTypes[0]]+("*"!==v.dataTypes[0]?", "+zt+"; q=0.01":""):v.accepts["*"]),v.headers)T.setRequestHeader(i,v.headers[i]);if(v.beforeSend&&(!1===v.beforeSend.call(y,T,v)||h))return T.abort();if(u="abort",b.add(v.complete),T.done(v.success),T.fail(v.error),c=Vt(_t,v,t,T)){if(T.readyState=1,g&&m.trigger("ajaxSend",[T,v]),h)return T;v.async&&0<v.timeout&&(d=ie.setTimeout(function(){T.abort("timeout")},v.timeout));try{h=!1,c.send(a,l)}catch(e){if(h)throw e;l(-1,e)}}else l(-1,"No Transport");function l(e,t,n,r){var i,o,a,s,u,l=t;h||(h=!0,d&&ie.clearTimeout(d),c=void 0,p=r||"",T.readyState=0<e?4:0,i=200<=e&&e<300||304===e,n&&(s=function(e,t,n){var r,i,o,a,s=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}(v,T,n)),!i&&-1<ce.inArray("script",v.dataTypes)&&ce.inArray("json",v.dataTypes)<0&&(v.converters["text script"]=function(){}),s=function(e,t,n,r){var i,o,a,s,u,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=l[u+" "+o]||l["* "+o]))for(i in l)if((s=i.split(" "))[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[i]:!0!==l[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}(v,s,T,i),i?(v.ifModified&&((u=T.getResponseHeader("Last-Modified"))&&(ce.lastModified[f]=u),(u=T.getResponseHeader("etag"))&&(ce.etag[f]=u)),204===e||"HEAD"===v.type?l="nocontent":304===e?l="notmodified":(l=s.state,o=s.data,i=!(a=s.error))):(a=l,!e&&l||(l="error",e<0&&(e=0))),T.status=e,T.statusText=(t||l)+"",i?x.resolveWith(y,[o,l,T]):x.rejectWith(y,[T,l,a]),T.statusCode(w),w=void 0,g&&m.trigger(i?"ajaxSuccess":"ajaxError",[T,v,i?o:a]),b.fireWith(y,[T,l]),g&&(m.trigger("ajaxComplete",[T,v]),--ce.active||ce.event.trigger("ajaxStop")))}return T},getJSON:function(e,t,n){return ce.get(e,t,n,"json")},getScript:function(e,t){return ce.get(e,void 0,t,"script")}}),ce.each(["get","post"],function(e,i){ce[i]=function(e,t,n,r){return v(t)&&(r=r||n,n=t,t=void 0),ce.ajax(ce.extend({url:e,type:i,dataType:r,data:t,success:n},ce.isPlainObject(e)&&e))}}),ce.ajaxPrefilter(function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")}),ce._evalUrl=function(e,t,n){return ce.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){ce.globalEval(e,t,n)}})},ce.fn.extend({wrapAll:function(e){var t;return this[0]&&(v(e)&&(e=e.call(this[0])),t=ce(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(n){return v(n)?this.each(function(e){ce(this).wrapInner(n.call(this,e))}):this.each(function(){var e=ce(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=v(t);return this.each(function(e){ce(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(e){return this.parent(e).not("body").each(function(){ce(this).replaceWith(this.childNodes)}),this}}),ce.expr.pseudos.hidden=function(e){return!ce.expr.pseudos.visible(e)},ce.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},ce.ajaxSettings.xhr=function(){try{return new ie.XMLHttpRequest}catch(e){}};var Yt={0:200,1223:204},Qt=ce.ajaxSettings.xhr();le.cors=!!Qt&&"withCredentials"in Qt,le.ajax=Qt=!!Qt,ce.ajaxTransport(function(i){var o,a;if(le.cors||Qt&&!i.crossDomain)return{send:function(e,t){var n,r=i.xhr();if(r.open(i.type,i.url,i.async,i.username,i.password),i.xhrFields)for(n in i.xhrFields)r[n]=i.xhrFields[n];for(n in i.mimeType&&r.overrideMimeType&&r.overrideMimeType(i.mimeType),i.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)r.setRequestHeader(n,e[n]);o=function(e){return function(){o&&(o=a=r.onload=r.onerror=r.onabort=r.ontimeout=r.onreadystatechange=null,"abort"===e?r.abort():"error"===e?"number"!=typeof r.status?t(0,"error"):t(r.status,r.statusText):t(Yt[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=o(),a=r.onerror=r.ontimeout=o("error"),void 0!==r.onabort?r.onabort=a:r.onreadystatechange=function(){4===r.readyState&&ie.setTimeout(function(){o&&a()})},o=o("abort");try{r.send(i.hasContent&&i.data||null)}catch(e){if(o)throw e}},abort:function(){o&&o()}}}),ce.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),ce.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return ce.globalEval(e),e}}}),ce.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),ce.ajaxTransport("script",function(n){var r,i;if(n.crossDomain||n.scriptAttrs)return{send:function(e,t){r=ce("<script>").attr(n.scriptAttrs||{}).prop({charset:n.scriptCharset,src:n.url}).on("load error",i=function(e){r.remove(),i=null,e&&t("error"===e.type?404:200,e.type)}),C.head.appendChild(r[0])},abort:function(){i&&i()}}});var Jt,Kt=[],Zt=/(=)\?(?=&|$)|\?\?/;ce.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Kt.pop()||ce.expando+"_"+jt.guid++;return this[e]=!0,e}}),ce.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,o,a=!1!==e.jsonp&&(Zt.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Zt.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=v(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Zt,"$1"+r):!1!==e.jsonp&&(e.url+=(At.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||ce.error(r+" was not called"),o[0]},e.dataTypes[0]="json",i=ie[r],ie[r]=function(){o=arguments},n.always(function(){void 0===i?ce(ie).removeProp(r):ie[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,Kt.push(r)),o&&v(i)&&i(o[0]),o=i=void 0}),"script"}),le.createHTMLDocument=((Jt=C.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Jt.childNodes.length),ce.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(le.createHTMLDocument?((r=(t=C.implementation.createHTMLDocument("")).createElement("base")).href=C.location.href,t.head.appendChild(r)):t=C),o=!n&&[],(i=w.exec(e))?[t.createElement(i[1])]:(i=Ae([e],t,o),o&&o.length&&ce(o).remove(),ce.merge([],i.childNodes)));var r,i,o},ce.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return-1<s&&(r=Tt(e.slice(s)),e=e.slice(0,s)),v(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),0<a.length&&ce.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(r?ce("<div>").append(ce.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},ce.expr.pseudos.animated=function(t){return ce.grep(ce.timers,function(e){return t===e.elem}).length},ce.offset={setOffset:function(e,t,n){var r,i,o,a,s,u,l=ce.css(e,"position"),c=ce(e),f={};"static"===l&&(e.style.position="relative"),s=c.offset(),o=ce.css(e,"top"),u=ce.css(e,"left"),("absolute"===l||"fixed"===l)&&-1<(o+u).indexOf("auto")?(a=(r=c.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),v(t)&&(t=t.call(e,n,ce.extend({},s))),null!=t.top&&(f.top=t.top-s.top+a),null!=t.left&&(f.left=t.left-s.left+i),"using"in t?t.using.call(e,f):c.css(f)}},ce.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){ce.offset.setOffset(this,t,e)});var e,n,r=this[0];return r?r.getClientRects().length?(e=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===ce.css(r,"position"))t=r.getBoundingClientRect();else{t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;while(e&&(e===n.body||e===n.documentElement)&&"static"===ce.css(e,"position"))e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=ce(e).offset()).top+=ce.css(e,"borderTopWidth",!0),i.left+=ce.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-ce.css(r,"marginTop",!0),left:t.left-i.left-ce.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent;while(e&&"static"===ce.css(e,"position"))e=e.offsetParent;return e||J})}}),ce.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var o="pageYOffset"===i;ce.fn[t]=function(e){return M(this,function(e,t,n){var r;if(y(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===n)return r?r[i]:e[t];r?r.scrollTo(o?r.pageXOffset:n,o?n:r.pageYOffset):e[t]=n},t,e,arguments.length)}}),ce.each(["top","left"],function(e,n){ce.cssHooks[n]=Ye(le.pixelPosition,function(e,t){if(t)return t=Ge(e,n),_e.test(t)?ce(e).position()[n]+"px":t})}),ce.each({Height:"height",Width:"width"},function(a,s){ce.each({padding:"inner"+a,content:s,"":"outer"+a},function(r,o){ce.fn[o]=function(e,t){var n=arguments.length&&(r||"boolean"!=typeof e),i=r||(!0===e||!0===t?"margin":"border");return M(this,function(e,t,n){var r;return y(e)?0===o.indexOf("outer")?e["inner"+a]:e.document.documentElement["client"+a]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+a],r["scroll"+a],e.body["offset"+a],r["offset"+a],r["client"+a])):void 0===n?ce.css(e,t,i):ce.style(e,t,n,i)},s,n?e:void 0,n)}})}),ce.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){ce.fn[t]=function(e){return this.on(t,e)}}),ce.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.on("mouseenter",e).on("mouseleave",t||e)}}),ce.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,n){ce.fn[n]=function(e,t){return 0<arguments.length?this.on(n,null,e,t):this.trigger(n)}});var en=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;ce.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),v(e))return r=ae.call(arguments,2),(i=function(){return e.apply(t||this,r.concat(ae.call(arguments)))}).guid=e.guid=e.guid||ce.guid++,i},ce.holdReady=function(e){e?ce.readyWait++:ce.ready(!0)},ce.isArray=Array.isArray,ce.parseJSON=JSON.parse,ce.nodeName=fe,ce.isFunction=v,ce.isWindow=y,ce.camelCase=F,ce.type=x,ce.now=Date.now,ce.isNumeric=function(e){var t=ce.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},ce.trim=function(e){return null==e?"":(e+"").replace(en,"$1")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return ce});var tn=ie.jQuery,nn=ie.$;return ce.noConflict=function(e){return ie.$===ce&&(ie.$=nn),e&&ie.jQuery===ce&&(ie.jQuery=tn),ce},"undefined"==typeof e&&(ie.jQuery=ie.$=ce),ce});
"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,a=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function ownKeys(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"==_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _createForOfIteratorHelper(e,t){var n,r,a,o,i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(i)return r=!(n=!0),{s:function(){i=i.call(e)},n:function(){var e=i.next();return n=e.done,e},e:function(e){r=!0,a=e},f:function(){try{n||null==i.return||i.return()}finally{if(r)throw a}}};if(Array.isArray(e)||(i=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return i&&(e=i),o=0,{s:t=function(){},n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var n;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}define("engine",["jquery","utils","state","section","passages"],function(N,j,P,R,I){var t,V=j.impossible,M=j.passageSelector,D=j.transitionOut,F=j.options;function L(e,t,n){var r,a,o;if(n?(n=n.get("name"),(a=I.getTree(n)).children.length&&(r={type:"include",tag:t,name:n,children:a.children,text:a.text})):r=I.getTree(t),r){for(;(o=e[e.length-1])&&("root"===o.type||"include"===o.type)&&o.children.some(function(e){return e.type.startsWith("unclosed")});)e[e.length-1]=Object.create(o),e=e[e.length-1].children=o.children.slice();e.push(r)}}function n(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=n.loadedGame,a=I.get(e),o=j.storyElement,i=o.parent(),s=n.stretch,n=n.transition,n=void 0===n?{}:n,c=n.depart,c=void 0===c?"instant":c,l=n.arrive,l=void 0===l?"dissolve":l,u=n.departOrigin,p=n.arriveOrigin,n=n.time,d=(i.findAndFilter("tw-enchantment").each(function(e,t){var n=(t=N(t)).data("enchantedProperties");n&&o.css(n.reduce(function(e,t){return e[t]="",e},{})),t[0]===i[0]&&(i=o.unwrap().parent())}),I.hasValid(e)||V("Engine.showPassage","There's no passage with the name \""+e+'"!'),o.children(M).not(".transition-out, .transition-out *")),a=(a.get("tags")||[]).join(" "),f=(t=N("<tw-passage><tw-sidebar>"),f=t.children("tw-sidebar"),h=N('<tw-icon tabindex=0 alt="Undo" title="Undo">&#8630;</tw-icon>'),g=N('<tw-icon tabindex=0 alt="Redo" title="Redo">&#8631;</tw-icon>'),P.pastLength<=0&&h.css("visibility","hidden"),P.futureLength<=0&&g.css("visibility","hidden"),f.append(h,g),t),h=("function"==typeof u&&(u=u.call(d)),"function"==typeof p&&(p=p.call(f)),!s&&c),m=h&&d.css("width"),g=(j.detachStoryElement(),f.appendTo(o).attr({tags:a}),h&&(D(d,c,n,0,0,0,u),d.css({position:"absolute",width:function(){return"0px"!==m?m:"100%"}})),o.attr({tags:a}),R.create(f)),y=(r&&(g.loadedGame=!0),[]);if(P.pastLength<=0&&1===P.turns){var b,v=_createForOfIteratorHelper(I.getTagged("startup"));try{for(v.s();!(b=v.n()).done;)L(y,"startup",b.value)}catch(e){v.e(e)}finally{v.f()}if(F.debug){var w,k=_createForOfIteratorHelper(I.getTagged("debug-startup"));try{for(k.s();!(w=k.n()).done;)L(y,"debug-startup",w.value)}catch(e){k.e(e)}finally{k.f()}}}var S,T=_createForOfIteratorHelper(I.getTagged("header"));try{for(T.s();!(S=T.n()).done;)L(y,"header",S.value)}catch(e){T.e(e)}finally{T.f()}if(F.debug){var _,x=_createForOfIteratorHelper(I.getTagged("debug-header"));try{for(x.s();!(_=x.n()).done;)L(y,"debug-header",_.value)}catch(e){x.e(e)}finally{x.f()}}L(y,e);var O,A=_createForOfIteratorHelper(I.getTagged("footer"));try{for(A.s();!(O=A.n()).done;)L(y,"footer",O.value)}catch(e){A.e(e)}finally{A.f()}if(F.debug){var C,E=_createForOfIteratorHelper(I.getTagged("debug-footer"));try{for(E.s();!(C=E.n()).done;)L(y,"debug-footer",C.value)}catch(e){E.e(e)}finally{E.f()}}g.renderInto(y,f,{transition:l,transitionTime:n,transitionOrigin:p}),g.loadedGame=!1,j.reattachStoryElement(),scroll(0,s?f.offset().top-.05*N(window).height():o[0].getBoundingClientRect().top+document.body.scrollTop)}return Object.freeze({goBack:function(e){P.rewind()&&n(P.passage,e)},goForward:function(e){P.fastForward()&&n(P.passage,e)},goToPassage:function(e,t){P.play(e),n(e,t)},redirect:function(e,t){P.redirect(e),n(e,t)},toggleFullscreen:function(){var e=document.documentElement;document.fullscreenElement?document.exitFullscreen():document.msFullscreenElement?document.msExitFullscreen():(e.msRequestFullscreen||e.requestFullscreen).call(e)},showPassage:n,enableDebugMode:function(){t&&t()},registerDebugMode:function(e){t=t||e}})}),define("harlowe",["jquery","debugmode/mode","renderer","state","section","engine","passages","utils","utils/renderutils","internaltypes/varscope","internaltypes/twineerror","macros","macrolib/values","macrolib/commands","macrolib/datastructures","macrolib/stylechangers","macrolib/enchantments","macrolib/metadata","macrolib/patterns","macrolib/links","macrolib/custommacros","utils/jqueryplugins","repl"],function($,DebugMode,Renderer,State,Section,Engine,Passages,Utils,_ref,VarScope){var dialog=_ref.dialog;function __HarloweEval(text){eval(text+"")}function printJSError(e){var t,n="".concat(e.name,": ").concat(e.message);return e.stack&&(t=(e=e.stack.split("\n")).findIndex(function(e){return e.includes("__HarloweEval")}),n+="\n".concat(e.slice(0,t).join("\n").replace(/\([^)]+\)/g,""))),"<div style='font-family:monospace;overflow-y:scroll;max-height:30vh'>```"+n+"```</div>"}!function(o){window.onerror=function(e,t,n,r,a){window.onerror=o,Utils.storyElement.parent().append(dialog({message:"Sorry to interrupt, but this page's code has got itself in a mess.\n\n".concat(printJSError(a),"\n(This is probably due to a bug in the Harlowe game engine.)")}).addClass("harlowe-crash")),"function"==typeof o&&o.apply(void 0,arguments)}}(window.onerror),Utils.onStartup(function(){var n,e,t,r,a=$("tw-storydata");0!==a.length&&(Utils.options.ifid=a.attr("ifid"),(a.attr("tags")||"").split(/\s/).forEach(function(e){"uncompressed-pure-values"!==e&&"uncompressed-saves"!==e||(Utils.options.uncompressedPureValues=!0),"uncompressed-structures"!==e&&"uncompressed-saves"!==e||(Utils.options.uncompressedStructures=!0)}),(a.attr("options")||"").split(/\s/).forEach(function(e){e&&(Utils.options[e]=!0),"debug"===e&&DebugMode()}),a=(a=a.attr("startnode"))||[].reduce.call($("tw-passagedata"),function(e,t){t=t.getAttribute("pid");return t<e?t:e},1/0),a=$("tw-passagedata[pid='"+a+"']").attr("name"),$(document.documentElement).on("keydown",function(e){13===e.which&&"0"===e.target.getAttribute("tabindex")&&$(e.target).trigger("click")}),n=!1,$("[role=script]").each(function(t){try{__HarloweEval($(this).html())}catch(e){n||(n=!0,dialog({parent:Utils.storyElement.parent(),message:"There is a problem with this story's "+Utils.nth(t+1)+" script:\n\n"+printJSError(e)}))}}),$("[role=stylesheet]").each(function(e,t){$(document.head).append("<style data-title=\"Story stylesheet '".concat(e+1,"'\">").concat($(t).html()))}),(e=Section.create()).stack=[{tempVariables:Object.create(VarScope)}],(r=Passages.loadMetadata(e)).length&&(t=dialog({parent:Utils.storyElement.parent(),message:"These errors occurred when running the `(metadata:)` macro calls in this story's passages:<p></p>"}),r.forEach(function(e){return t.find("p").append(e.render())})),(r=!Utils.options.debug&&State.hasSessionStorage&&sessionStorage.getItem("Saved Session"))&&!0===State.deserialise(e,r)?Engine.showPassage(State.passage):Engine.goToPassage(a))})}),define("macros",["utils/naturalsort","utils","utils/operationutils","datatypes/changercommand","datatypes/custommacro","datatypes/lambda","datatypes/codehook","internaltypes/changedescriptor","internaltypes/twineerror"],function(g,e,t,o,r,y,b,p,v){var w=e.insensitiveName,k=e.nth,S=e.andList,T=t.objectName,_=t.typeName,d=t.toSource,x=Array.isArray,i={};function O(e){return e===s.TypeSignature.Any||(x(e.innerType)?e.innerType.some(O):!!e.innerType&&O(e.innerType))}function a(e,t,n,r){var a,o,i,s,c,l,u,p,d=t.fn,f=t.typeSignature,h=t.returnType,m=(r=function(e){for(var t,n,r,a=[],o=0;o<e.length;o+=1)o in e&&(!0===(null==(t=e[o])?void 0:t.spreader)?(n=t.value,(r=v.containsError(n))?a.push(r):x(n)||"string"==typeof n?a.push.apply(a,_toConsumableArray(n)):n instanceof Set?a.push.apply(a,_toConsumableArray(Array.from(n).sort(g("en")))):a.push(v.create("operation","I can't spread out "+T(n)+", because it is not a string, dataset, or array."))):a.push(t));return a}(r),"string"!=typeof e&&(a=e,e=""),a?"":"("+(x(e)&&1<e.length?e[0]:e)+":)");for(e=a?a.TwineScript_KnownName?"the custom macro, ".concat(a.TwineScript_KnownName):"an unnamed custom macro":"the ".concat(m," macro"),o=0<f.length?1===f.length&&O(f[0])?1===r.length?"That value can't be given to macros as-is.":"Give only a single value to this macro.":e+" must only be given "+S(f.map(_))+(1<f.length?", in that order":"."):e+" must not be given any data."+(a?"":" Just write "+m),s=0,c=Math.max(r.length,f.length);s<c;s+=1){if(p=f[s],l=r[s],v.containsError(l))return l;if(s>=f.length&&!i)return v.create("datatype",r.length-f.length+" too many values were given to "+e+".",o);if(!(p=p||i).innerType||"rest"!==p.pattern&&"zero or more"!==p.pattern||(i=p.innerType,"rest"===p.pattern&&(p=p.innerType)),!function e(t,n){if(null===n)return void 0===t;var r=_typeof(t);if("function"!=typeof n&&n.pattern){if("optional"===n.pattern||"zero or more"===n.pattern)return void 0===t||e(t,n.innerType);if("either"===n.pattern){for(var a=0;a<n.innerType.length;a+=1)if(e(t,n.innerType[a]))return!0;return!1}if("lambda"===n.pattern&&e(t,n.innerType))return n.clauses.includes("where")===("where"in t||"each"in t)&&n.clauses.includes("making")==="making"in t&&n.clauses.includes("via")==="via"in t&&n.clauses.includes("with")==="with"in t;if("insensitive set"===n.pattern)return n.innerType.includes(w(t));if("range"===n.pattern)return n.range(t);if("wrapped"===n.pattern)return e(t,n.innerType)}return(void 0===n||void 0!==t)&&("anything"===n.TwineScript_TypeName&&void 0!==t&&!t.TwineScript_Unstorable||"everything"===n.TwineScript_TypeName&&void 0!==t||(n===String?"string"===r:n===Boolean?"boolean"===r:n===parseInt?"number"===r&&!Number.isNaN(t)&&!(t+"").includes("."):n===Number?"number"===r&&!Number.isNaN(t):n===Array?x(t):n===Map||n===Set?t instanceof n:Object.isPrototypeOf.call(n,t)))}(l,p))return void 0===l?(u=f.filter(function(e){return!("optional"===e.pattern||"zero or more"===e.pattern)}).length,v.create("datatype","".concat(e," was given ").concat(r.length?S(r.map(T)):"nothing",", but needs ").concat(u-s," more value").concat(1<u-s?"s":"","."),o)):null!=(u=l)&&u.TwineScript_Unstorable&&O(p)?v.create("datatype",e+"'s "+k(s+1)+" value, "+T(l)+", is not valid data for this macro.",o):b.isPrototypeOf(l)&&"Changer"===h?v.create("syntax","Please put this hook outside the parentheses of "+e+", not inside it.","Hooks should appear after a macro"+(a?".":": "+m+"[Some text]")):l&&y.isPrototypeOf(l)&&"lambda"===p.pattern?v.create("datatype",e+"'s "+k(s+1)+" value (a lambda) should have "+S(["where","when","making","via","with"].filter(function(e){return p.clauses.includes(e)}).map(function(e){return"a '"+e+"' clause"}))+", not "+S(["where","when","making","via","with"].filter(function(e){return e in l}).map(function(e){return"a '"+e+"' clause"}))+"."):"insensitive set"===p.pattern?v.create("datatype",T(l)+" is not a valid name string for "+e+".","Only the following names are recognised (capitalisation and hyphens ignored): "+S(p.innerType)+"."):v.create("datatype","".concat(e,"'s ").concat(k(s+1)," value is ").concat(T(l),", but should be ").concat(_(p),"."),p.message||o)}return d.apply(null,[n].concat(r))}function f(e,t,n,r){var a={fn:n,typeSignature:r=[].concat(r||[]),returnType:t};Object.freeze(a),[].concat(e).forEach(function(e){return Object.defineProperty(i,w(e),{value:a})})}var s={has:function(e){return e=w(e),hasOwnProperty.call(i,e)},get:function(e){return e=w(e),hasOwnProperty.call(i,e)&&i[e]},add:function e(t,n,r,a){return f(t,n,r,a),e},addChanger:function e(t,n,r,a){return f(t,"Changer",n,a),o.register(x(t)?t[0]:t,r),e},addCommand:function e(t,n,r,a){var s,c,l,u,o=!(4<arguments.length&&void 0!==arguments[4])||arguments[4],i=[].concat(t)[0];return f(t,"Command",(s=i,c=n,l=r,u=o,function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a,o,i=c.apply(void 0,n);return i||(a=p.create(),o=_objectSpread({TwineScript_TypeID:"command",TwineScript_ObjectName:"a (".concat(s,":) command"),TwineScript_TypeName:"a (".concat(s,":) command"),TwineScript_Print:function(){return"`[A (".concat(s,":) command]`")},TwineScript_ToSource:function(){return"(".concat(s,":").concat(n.map(d),")")},TwineScript_is:function(e){return d(this)===d(e)}},u?{TwineScript_Attach:function(e,t){return a.section=e,t.run(a),o},TwineScript_Run:function(e){e=l.apply(void 0,[a,e].concat(n));return a=p.create(),e}}:{TwineScript_Run:function(e){return l.apply(void 0,[e].concat(n))}}))}),a),e},TypeSignature:{optional:function(e){return{pattern:"optional",innerType:e}},zeroOrMore:function(e){return{pattern:"zero or more",innerType:e}},either:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{pattern:"either",innerType:t}},rest:function(e){return{pattern:"rest",innerType:e}},insensitiveSet:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{pattern:"insensitive set",innerType:t}},numberRange:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1/0;return{pattern:"range",min:t,max:n,range:function(e){return"number"==typeof e&&!Number.isNaN(e)&&t<=e&&e<=n}}},nonNegativeInteger:{pattern:"range",integer:!0,min:0,max:1/0,range:function(e){return"number"==typeof e&&!Number.isNaN(e)&&0<=e&&!(e+"").includes(".")}},positiveInteger:{pattern:"range",integer:!0,min:1,max:1/0,range:function(e){return"number"==typeof e&&!Number.isNaN(e)&&1<=e&&!(e+"").includes(".")}},wrapped:function(e,t){return{pattern:"wrapped",innerType:e,message:t}},Any:{TwineScript_TypeName:"anything"},Everything:{TwineScript_TypeName:"everything"}},run:function(e,t,n){return s.has(e)?a(e,s.get(e),t,n):v.create("macrocall","I can't run the macro '"+e+"' because it doesn't exist.","Did you mean to run a macro? If you have a word written like (this:), it is regarded as a macro name.")},runCustom:function(e,t,n){return r.isPrototypeOf(e)?a(e,e,t,n):v.containsError(e)?e:v.create("macrocall","I can't call ".concat(T(e)," because it isn't a custom macro."))}};return Object.assign(s.TypeSignature,{positiveNumber:s.TypeSignature.numberRange(Math.pow(2,-52),1/0),nonNegativeNumber:s.TypeSignature.numberRange(0,1/0),percent:s.TypeSignature.numberRange(0,1)}),Object.freeze(s)}),define("passages",["jquery","utils/naturalsort","utils","markup","internaltypes/twineerror"],function(t,s,e,c,l){var u=e.insensitiveName,p=e.unescape,n=e.onStartup,o=e.impossible,d=Object.assign,f=RegExp(c.Patterns.macroFront+c.Patterns.macroName,"ig");function r(e){var t,r,a,o,n=e.attr("name"),i=p(e.html()),s=(t=n,o=["metadata","storylet","exclusivity","urgency"],((s=i).match(f)||[]).some(function(t){return o.some(function(e){return u(t.slice(1,-1))===e})})?(r=!1,a={},c.lex(s,t).children.forEach(function e(t){if("macro"===t.type){var n=u(t.name);if(o.some(function(e){return n===e})){if(l.isPrototypeOf(a[n]))return;if(r)return void(a[n]=l.create("syntax","The (".concat(t.name,":) macro can't appear after non-metadata macros.")));if(a[n])return void(a[n]=l.create("syntax","There is more than one (".concat(t.name,":) macro.")));a[n]=t}else r=!0;t.children.forEach(function e(t){var n=u(t.name);"macro"===t.type&&o.some(function(e){return n===e})?a[n]=l.create("syntax","The (".concat(t.name,":) macro can't be inside another macro.")):t.children.forEach(e)})}else t.children.forEach(e)}),a):{});return d(new Map([["source",i],["tags",(e.attr("tags")||"").split(/\s/)||[]],["name",n]]),{TwineScript_TypeName:"a passage datamap",TwineScript_ObjectName:"a passage datamap",metadata:s,tree:null})}var a=Object.create(null),i=[],h=null,m=d(new Map,{TwineScript_ObjectName:"the Passages datamap",getTagged:function(n){var e,r;return a[n]||(e=s("en",function(e){return e.get("name")}),r=[],this.forEach(function(e){var t=e instanceof Map&&e.get("tags");Array.isArray(t)&&t.includes(n)&&r.push(e)}),r.sort(e),a[n]=r)},clearTagCache:function(){a=Object.create(null)},clear:function(){Map.prototype.clear.call(this),this.clearTagCache(),this.clearTreeCache(),this.clearStoryletCache()},delete:function(){var e;(e=Map.prototype.delete).call.apply(e,[this].concat(Array.prototype.slice.call(arguments))),this.clearTagCache(),this.clearTreeCache(),this.clearStoryletCache()},getTree:function(e){if(!this.has(e))return o("Passages.getTree","No passage name?"),[];var t=this.get(e),n=t.get("tags");if(n.includes("header")||n.includes("footer")||n.includes("debug-header")||n.includes("debug-footer"))return t.tree||(t.tree=c.lex(t.get("source"),e)),t.tree;for(var r,a=0;a<i.length;a+=1)if(i[a]&&i[a].place===e)return r=i.splice(a,1)[0],i.unshift(r),r;n=c.lex(t.get("source"),e);return i.unshift(n),16<i.length&&i.pop(),n},clearTreeCache:function(){i=[]},getStorylets:function(r,e){var a,o,i,e=e?e.filter(r,_toConsumableArray(m.values())):_toConsumableArray(m.values());return l.containsError(e)?e:(a=[],o=-1/0,e.reduce(function(e,t){if(e)return e;e=t.get("storylet");if(e){var n=r.speculate(e,t.get("name"),"a (storylet:) macro");if(l.containsError(n))return n.message="There's an error in the storylet passage \""+t.get("name")+'":\n'+n.message,n.source=e.TwineScript_ToSource(),n;n&&(e=t.get("exclusivity"),o=Math.max(o,"number"==typeof e?e:0),a.push(t))}},void 0)||(i=s("en"),a.filter(function(e){e=e.get("exclusivity");return("number"==typeof e?e:0)===o}).sort(function(e,t){var n=e.get("urgency"),r=t.get("urgency");return(n="number"==typeof n?n:0)!==(r="number"==typeof r?r:0)?r-n:i(e.get("name"),t.get("name"))})))},allStorylets:function(){return h=h||_toConsumableArray(m.values()).filter(function(e){return e.get("storylet")})},clearStoryletCache:function(){h=null},loadMetadata:function(i){var s=[];return m.forEach(function(o){o.metadata&&Object.keys(o.metadata).forEach(function(e){var t,n,r;function a(e,t){o.has(e)?s.push(l.create("syntax","This passage's datamap already has a '"+JSON.stringify(e)+"' data name.")):o.set(e,t)}l.containsError(o.metadata[e])?s.push(o.metadata[e]):(t=o.metadata[e],n=i.speculate(t,o.get("name"),"a ("+e+":) macro"),r='In "'+o.get("name")+'":\n',l.containsError(n)?(n.message=r+n.message,n.source=t.text,s.push(n)):n instanceof Map?n.forEach(function(e,t){return a(t,e)}):a(e,n))}),o.metadata=void 0}),s},hasValid:function(e){e=this.get(e);return e&&e instanceof Map&&e.has("source")},create:r});return n(function(){t("tw-storydata > tw-passagedata").get().forEach(function(e){e=t(e),m.set(e.attr("name"),new r(e))})}),m}),define("renderer",["jquery","utils","markup","internaltypes/twineerror"],function(a,e,S,T){var _=e.escape,x=e.insensitiveName,O=e.options;function A(e,t,n){n=2<arguments.length&&void 0!==n?n:"";return"<"+t+(n?" "+n:"")+">"+e+"</"+t+">"}var C="text-align: center; max-width:50%; ";function E(m,g){function y(e,t,n){e=E(e.children,g);return e&&A(e,t,n)}var b="",v=[];if(m)for(var e,w=(m=Array.isArray(m)?m:[m]).length,k=0;k<w;k+=1)if(e=function(e){var n=m[e];switch(n.type){case"include":b+=y(n,"tw-"+n.type,'type="'.concat(n.tag,'" name="').concat(n.name,'"'));break;case"error":b+=T.create("syntax",n.message,n.explanation).render(_(n.text))[0].outerHTML;break;case"numbered":case"bulleted":for(var t="numbered"===n.type?"ol":"ul",r=(b+="<"+t+">",1);e<w&&m[e];){if("br"===m[e].type){if(b+="</li>",!m[e+1]||m[e+1].type!==n.type)break}else m[e].type===n.type?(b=(b+=("<"+t+">").repeat(Math.max(0,m[e].depth-r)))+("</"+t+">").repeat(Math.max(0,r-m[e].depth))+"<li>",r=m[e].depth):b+=E([m[e]],g);e+=1}b+=("</"+t+">").repeat(r+1);break;case"align":for(;n&&"align"===n.type;){var a=n.align,o=e+=1;if("left"===a){--e;break}for(;e<w&&m[e]&&"align"!==m[e].type;)e+=1;var o=E(m.slice(o,e),g),i="";switch(a){case"center":i+=C+"margin-left: auto; margin-right: auto;";break;case"justify":case"right":i+="text-align: "+a+";";break;default:+a&&(i+=C+"margin-left: "+a+"%;")}b+="<tw-align "+(i?'style="'+i+'"':"")+">"+o+"</tw-align>\n",n=m[e]}break;case"column":for(var s,c=[];n&&"column"===n.type;){var l=n.column,u=e+=1;if("none"===l){--e;break}for(;e<w&&m[e]&&"column"!==m[e].type;)e+=1;c.push({text:n.text,type:l,body:E(m.slice(u,e),g),width:n.width,marginLeft:n.marginLeft,marginRight:n.marginRight}),n=m[e]}c.length&&(s=c.reduce(function(e,t){return e+t.width},0),b+="<tw-columns>"+c.map(function(e){return"<tw-column type=".concat(e.type," ",' style="width:').concat(e.width/s*100,"%; margin-left: ").concat(e.marginLeft,"em; margin-right: ").concat(e.marginRight,'em;">').concat(e.body,"</tw-column>\n")}).join("")+"</tw-columns>");break;case"heading":for(b+="<h"+n.depth+">";++e<w&&m[e];){if("br"===m[e].type){b+="</h"+n.depth+">";break}b+=E([m[e]],g)}break;case"br":if(!v.length||/td|th/.test(v[0])){b+="<br>";for(var p=m[e+1];p&&("br"===p.type||"tag"===p.type&&/^<br\b/i.test(p.text));)b+="<tw-consecutive-br"+("tag"===p.type?" data-raw":"")+"></tw-consecutive-br>",p=m[(e+=1)+1]}break;case"hr":b+="<hr>";break;case"escapedLine":case"comment":break;case"inlineUrl":b+='<a class="link" href="'+_(n.text)+'">'+n.text+"</a>";break;case"scriptStyleTag":case"tag":var d=n.text.toLowerCase();/^<\/?(?:table|thead|tbody|tr|tfoot|td|th|svg)\b/.test(d)&&!n.text.endsWith("/>")&&v[n.text.startsWith("</")?"shift":"unshift"](d),b+=n.text.startsWith("</")?n.text:n.text.replace(/(\/)?>$/,function(e,t){return" data-raw".concat(t?"></".concat(n.text.match(/[\w-]+/)):"",">")});break;case"sub":case"sup":case"strong":case"em":b+=y(n,n.type);break;case"strike":b+=y(n,"s");break;case"bold":b+=y(n,"b");break;case"italic":b+=y(n,"i");break;case"twineLink":d=_slicedToArray(S.lex("(link-goto:"+JSON.stringify(n.innerText)+","+JSON.stringify(n.passage)+")").children,1)[0];b+='<tw-expression type="macro" name="link-goto"'+(O.debug?' title="'+_(n.text)+'"':"")+' code="'+g.code.length+'"></tw-expression>',g.code.push(d);break;case"hook":b+="<tw-hook "+(n.hidden?"hidden ":"")+(n.name?'name="'+x(n.name)+'"':"")+(O.debug&&n.name?' title="Hook: ?'+n.name+'"':"")+' source="'+g.source.length+'"></tw-hook>',g.source.push(n.children);break;case"unclosedHook":return b+="<tw-hook "+(n.hidden?"hidden ":"")+(n.name?'name="'+x(n.name)+'"':"")+'source="'+g.source.length+'"></tw-hook>',g.source.push(m.slice(e+1,w)),{v:b};case"verbatim":b+=A(_(n.innerText).replace(/\n/g,"<br>"),"tw-verbatim");break;case"collapsed":b+=y(n,"tw-collapsed");break;case"unclosedCollapsed":return{v:b+="<tw-collapsed>"+E(m.slice(e+1,w),g)+"</tw-collapsed>"};case"variable":case"tempVariable":case"macro":var f=[],h=[];if("macro"===n.type&&!function e(t){"string"!==t.type&&"hook"!==t.type&&t.children.every(e);var n=x(t.name);if("macro"!==t.type||"prompt"!==n&&"confirm"!==n){if("hook"===t.type&&!t.everyLeaf(function(e){return"error"!==e.type||(h.push(e),!1)}))return!1}else f.push(t);return!0}(n),h.length)return{v:T.create("syntax","This code hook's markup contained "+h.length+" error"+(h.length?"s":"")+":<br>\u2014"+h.map(function(e){return e.message}).join("<br>\u2014")).render(_(n.text))[0].outerHTML};d=f.map(function(e){return e.blockerTree=g.blockers.length,g.blockers.push(e),e.blockerTree});b+='<tw-expression type="'+n.type+'" name="'+_(n.name||n.text)+'"'+(O.debug?' title="'+_(n.text)+'"':"")+(d.length?' blockers="'+d+'"':"")+' code="'+g.code.length+'"></tw-expression>',g.code.push(n);break;default:b+=n.children&&n.children.length?E(n.children,g):n.text}k=e}(k))return e.v;return b}return Object.freeze({exec:function(e){var r={code:[],blockers:[],source:[]},e=E(e="string"==typeof e?S.lex(e).children:e,r),e=a(a.parseHTML(e,document,!0));return e.findAndFilter("script:not([src])").each(function(e,t){var n=t.getAttribute("type");n&&"text/javascript"!==n.toLowerCase()||t.setAttribute("type","application/x-harlowe")}),r.blockers=r.blockers.map(function(e){e.blockedValue=!0;e=Object.create(e);return e.blockedValue=!1,e}),e.findAndFilter("tw-expression[code]:not([data-raw]), tw-expression[blockers]:not([data-raw]), tw-hook[source]:not([data-raw])").each(function(e,t){var n;(t=a(t)).attr("blockers")&&(n=t.popAttr("blockers").split(",").map(function(e){return r.blockers[e]}),t.data("blockers",n)),t.attr("source")&&t.data("source",r.source[t.popAttr("source")]),t.attr("code")&&t.data("code",r.code[t.popAttr("code")])}),e}})}),define("repl",["utils","markup","section"],function(e,t,n){e.onStartup(function(){return setTimeout(function(){e.options.debug&&(window.REPL=function(e){e=n.create().eval(t.lex("(print:"+e+")"));return e.TwineScript_Run?e.TwineScript_Run().source:e},window.LEX=function(e){e=t.lex(e);return 1===e.length?e[0]:e})})})}),define("section",["jquery","utils","twinescript/runner","twinescript/operations","state","utils/operationutils","utils/renderutils","utils/scripttag","datatypes/changercommand","datatypes/colour","datatypes/lambda","datatypes/codehook","internaltypes/changedescriptor","internaltypes/varscope","internaltypes/twineerror","internaltypes/twinenotifier"],function(p,f,a,u,r,e,t,i,d,h,o,m,g,y,b,v){var w=e.printBuiltinValue,k=e.objectName,S=e.typeID,T=e.isObject,s=t.collapse,_=Object.assign,x=Object.create,O=Object.keys;function A(e,t,n){if(t&&"object"===_typeof(t)&&d.isPrototypeOf(t)){var r=n.popData("source")||(null==(r=n[0].cachedData)?void 0:r.source),a=(null!=(a=n[0])&&a.cachedData&&(n[0].cachedData.source=void 0),n.data("originalSource",r),g.create({target:n,source:r,section:this,append:"append"})),o=t.run(a);if(b.containsError(o)&&e.replaceWith(o.render(e.attr("title"))),!this.renderInto(r,null,a))return o=f.insensitiveName(e.attr("name")),["if","elseif","unless","else","testfalse"].includes(o)&&(e.addClass("false"),"elseif"!==o)&&(this.stackTop.lastHookShown=!1),n.data("live")&&function(t,n,r){function a(e){p&&(d-=(e-p)*(f.options.debug&&void 0!==f.options.speedMultiplier?f.options.speedMultiplier:1)),p=e,0<d?requestAnimationFrame(a):(d=s,o())}var o,i=this,e=r.data("live"),s=e.delay,c=e.event,l=((n=_objectSpread(_objectSpread({},n),{},{append:"replace",transitionDeferred:!1,enabled:!0})).data=_objectSpread(_objectSpread({},n.data),{},{live:void 0}),r.data("originalSource")||""),u=this.stackTop.tempVariables,p=null,d=s;o=this.whenUnblocked.bind(this,function(){var e;i.inDOM()&&(e=null==c?void 0:c.filter(i,[!0],u),b.containsError(e)?e.render(i,t.attr("title")).replaceAll(t):c&&!e[0]?requestAnimationFrame(a):(i.renderInto(l,r,n,u),e||r.find("tw-expression[name='stop']").length||i.inDOM()&&requestAnimationFrame(a)))}),requestAnimationFrame(a)}.call(this,e,a,n),!0}else{if(!1===t)return o=n.popData("source")||(null==(r=n[0].cachedData)?void 0:r.source),null!=(a=n[0])&&a.cachedData&&(n[0].cachedData.source=void 0),o&&(n.cachedData&&(n.cachedData.source=void 0),n.data("originalSource",o),n.data("hidden",!0)),e.addClass("false"),!(this.stackTop.lastHookShown=!1);if(!0!==t)return!1}return this.stackTop.lastHookShown=!0}function C(e){var t,n,e=(e instanceof p?e[0]:e).nextSibling;return e&&(e instanceof Text&&!e.textContent.trim()||["br","tw-consecutive-br"].includes((e.tagName||"").toLowerCase()))?(t=(n=C(e)).whitespace,n=n.nextElem,{whitespace:p(e).add(t),nextElem:n}):{whitespace:p(),nextElem:p(e)}}function E(e){if(null!=e&&e.length)return p("<tw-open-button replay label='\ud83d\udd0d'>").data("evalReplay",e)}function c(e,t){var n=this.eval(t);e.append(E(this.evalReplay)),e.append(function(e,t){if(/a \((go-to|undo|redirect|restart):\) command/.exec(null==t?void 0:t.TwineScript_TypeName))return p("<tw-open-button goto label='GO'>").data("goto",{section:e,command:t})}(this,n)),this.stackTop.evaluateOnly&&n&&(d.isPrototypeOf(n)||"function"==typeof n.TwineScript_Run)&&(n=b.create("syntax","I can't work out what ".concat(this.stackTop.evaluateOnly," should evaluate to, because it contains a ").concat(d.isPrototypeOf(n)?"changer.":"command."),"Please rewrite this without putting changers or commands here."));var r=p();for(i=e;d.isPrototypeOf(n);){var a=C(i),o=a.whitespace;if((i=a.nextElem)[0]&&i[0].nodeType===Node.TEXT_NODE&&"+"===i[0].textContent.trim()){var i,a=i,s=C(a),c=s.whitespace;if((i=s.nextElem).is("tw-expression")){var s=i.popData("code")||(null==(s=i[0])||null==(s=s.cachedData)?void 0:s.code),l=(null!=(l=i[0])&&l.cachedData&&(i[0].cachedData.code=void 0),this.eval(s));if(b.containsError(l)){n=l;break}s=u["+"](n,l);p(o).add(a).add(c).remove(),n=b.containsError(s)?b.create("operation","I can't combine "+k(n)+" with "+k(l)+".","function"==typeof l.TwineScript_Run?"If you want to attach this changer to ".concat(k(l),", remove the + between them."):"Changers can only be added to other changers."):s;continue}}if(i.is("tw-expression")){c=i.popData("code")||(null==(a=i[0])||null==(a=a.cachedData)?void 0:a.code),s=(null!=(l=i[0])&&l.cachedData&&(i[0].cachedData.code=void 0),this.eval(c));if(i.append(E(this.evalReplay)),b.containsError(s)){n=s;break}if(s&&"object"===_typeof(s)&&"function"==typeof s.TwineScript_Attach){n=s.TwineScript_Attach(this,n);break}return d.isPrototypeOf(s)?void e.replaceWith(b.create("operation","Changers like (".concat(n.macroName,":) need to be combined using + between them."),"Place the + between the changer macros, or the variables holding them. The + is absent only between a changer and its attached hook or command.").render(e.attr("title"))):void e.replaceWith(b.create("operation","".concat(k(s)," can't have changers like (").concat(n.macroName,":) attached."),"Changers placed just before hooks, links and commands will attempt to attach, but in this case it didn't work.").render(e.attr("title")))}if(i.is("tw-hook")){o.remove(),r=i;break}n.macroName||f.impossible("Section.runExpression","changer has no macroName");a=e.attr("title")||"("+n.macroName+": ...)";return void e.replaceWith(b.create("syntax","The (".concat(n.macroName,":) changer should be stored in a variable or attached to a hook."),"Macros like this should appear before a hook: ".concat(a,"[Some text]")).render(e.attr("title")))}e.attr("return",S(n)),r=r.length?r:C(e).nextElem.filter("tw-hook"),(t=b.containsError(n))?e.replaceWith(t.render(e.attr("title")).append(E(this.evalReplay))):v.isPrototypeOf(n)?e.append(n.render()):n&&"function"==typeof n.TwineScript_Run?(n=n.TwineScript_Run(this),b.containsError(n)?e.replaceWith(n.render(e.attr("title"))):g.isPrototypeOf(n)?null!=(t=n.data)&&t.live?e.replaceWith(b.create("unimplemented","I currently can't attach (live:) or (event:) macros to commands - only hooks.").render(e.attr("title"))):(n.section=this,n.target=i,this.renderInto("",i,n)):T(n)&&n.blocked?(this.stackTop.blocked=n.blocked,e.data("code",{type:"macro",blockedValue:!0,text:e.attr("title")||"",start:0,end:(e.attr("title")||"").length})):n&&f.impossible("Section.runExpression","TwineScript_Run() returned a non-ChangeDescriptor ".concat(_typeof(n),': "').concat(n,'"'))):r.length&&A.call(this,e,n,r)||("string"==typeof n||"number"==typeof n||n instanceof Map||n instanceof Set||Array.isArray(n)||h.isPrototypeOf(n)||m.isPrototypeOf(n)||n&&"function"==typeof n.TwineScript_Print&&!d.isPrototypeOf(n)?(n=w(n),b.containsError(n)?e.replaceWith(n.render(e.attr("title"))):"string"==typeof n||Array.isArray(n)?this.renderInto(n,e):f.impossible("printBuiltinValue() produced a non-string non-array ".concat(_typeof(n)))):d.isPrototypeOf(n)||"boolean"==typeof n||f.impossible("Section.runExpression","The expression evaluated to an unknown value: ".concat(n)))}var l={add:[],remove:[]};return Object.preventExtensions({create:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:f.storyElement,n=_(x(this),{timestamp:Date.now(),dom:e,stack:[],enchantments:[],unblockCallbacks:[],freeVariables:null,evalReplay:null,loadedGame:!1,Identifiers:{TwineScript_Identifiers:!0,it:0,get time(){var e;return null!=(e=n.stackTop)&&e.evaluateOnly?b.create("operation","'time' can't be used in ".concat(n.stackTop.evaluateOnly,".")):(Date.now()-n.timestamp)*(f.options.debug&&void 0!==f.options.speedMultiplier?f.options.speedMultiplier:1)},get turns(){return r.turns},get turn(){return r.turns},get visits(){var t=n.stackTop.speculativePassage;return r.history().filter(function(e){return e===(t||r.passage)}).length+(!t||t===r.passage)},get visit(){return n.Identifiers.visits},get exits(){var e;return null!=(e=n.stackTop)&&e.evaluateOnly?b.create("operation","'exit' and 'exits' can't be used in ".concat(n.stackTop.evaluateOnly,".")):n.dom.find("tw-enchantment, tw-link").filter(function(e,t){return(t=p(t)).data("enchantmentEvent")||t.parent().data("linkPassageName")||t.parent().data("clickEvent")}).length},get exit(){return n.Identifiers.exits},get pos(){return n.stackTop&&!n.stackTop.evaluateOnly&&n.stackTop.lambdaPos?+n.stackTop.lambdaPos||1:b.create("operation","'pos' can only be used in lambdas that aren't 'when' lambdas.")}}});return n},eval:function(t){var e,n;f.options.debug&&f.options.evalReplay&&(n=Array.isArray(t)?t.reduce(function(e,t){return e+t.text},""):t.text||"",this.evalReplay=[{code:n,fromCode:n,basis:(Array.isArray(t)?t[0]:t).start,start:0,end:n.length,diff:0}]);try{e=a(this,t)}catch(e){return null!=(n=window.console)&&n.error(e),this.evalReplay=null,b.create("","An internal error occurred while trying to run ".concat([].concat(t).map(function(e){return e.text}).join(""),"."),'The error was "'.concat(e.message,'".\nIf this is the latest version of Harlowe, please consider reporting a bug (see the documentation).'))}return this.evalReplay&&2===this.evalReplay.length&&this.evalReplay.shift(),e},get stackTop(){return this.stack[0]},inDOM:function(){return 0<f.storyElement.find(this.dom).length},evaluateTwineMarkup:function(e,t){var n=p("<p>");return this.stack.unshift({desc:g.create({target:n,source:e,section:this,append:"append"}),tempVariables:this.stackTop.tempVariables,evaluateOnly:t,finalIter:!0}),this.execute(),0<(e=n.find("tw-error")).length?e:n},speculate:function(e,t,n){this.stack.unshift({evaluateOnly:n,finalIter:!0,tempVariables:_(x(y),{TwineScript_VariableStore:{type:"temp",name:n}}),speculativePassage:t});var r,n=this.evalReplay;return this.evalReplay=null,o.isPrototypeOf(e)?r=e.apply(this,{fail:!1,pass:!0}):e&&(r=a(this,e)),this.stack.shift(),this.evalReplay=n,r},renderInto:function(e,a,t){var o=this,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,i=g.create({target:a,source:e,section:this,append:"append"});if(t)if(d.isPrototypeOf(t)){var e=t.run(i);if(b.containsError(e))return e.render(a.attr("title")).replaceAll(a),!1}else _(i,t);if((a=i.target,50<=this.stack.length)&&50<=this.stack.reduce(function(e,t){return e+!!t.finalIter},0))return b.create("infinite","Printing this expression may have trapped me in an infinite loop.").render(a.attr("title")).replaceAll(a),!1;var s=function(e,t,n){var r=a instanceof p&&a.is("tw-hook")&&0<a.parents("tw-collapsed,[collapsing=true]").length;o.stack.unshift({desc:e,finalIter:n,tempVariables:t,collapses:r,evaluateOnly:o.stackTop&&o.stackTop.evaluateOnly})},r=r||x(this.stack.length?this.stackTop.tempVariables:y),t=(hasOwnProperty.call(r,"TwineScript_VariableStore")||(t=null==(e=a)?void 0:e.tag(),r.TwineScript_VariableStore={type:"temp",name:"tw-hook"===t?a.attr("name")?"?"+a.attr("name"):"an unnamed hook":"tw-expression"===t?"a "+a.attr("type")+" expression":"tw-passage"===t?"this passage":"an unknown scope"}),null==(e=this.stackTop)?void 0:e.blocked);if(O(i.loopVars).length){var c=_objectSpread({},i.loopVars),l=Math.min.apply(Math,_toConsumableArray(O(c).map(function(e){return c[e].length})));if(v.create(l+" loop"+(1!==l?"s":"")).render().prependTo(a),l){for(var n=l-1;0<=n;--n)!function(n){s(i,O(c).reduce(function(e,t){return e[t]=c[t][n],e},x(r),n===l-1))}(n);for(var u=l-1;0<=u&&!this.stackTop.blocked;--u)this.execute()}}else s(i,r,!0),this.execute();return(0===this.stack.length||!t&&null!=(e=this.stackTop)&&e.blocked)&&this.updateEnchantments(),i.enabled},execute:function(){var a=this,e=this.stackTop,t=e.desc,n=e.dom,r=e.collapses,o=e.evaluateOnly;t&&!n&&(n=t.render(),this.stackTop.dom=n,this.stackTop.desc=void 0),n.findAndFilter('tw-hook,tw-expression,script[type="application/x-harlowe"]').each(function(e,t){var n=p(t).data();t.cachedData={blockers:n.blockers,code:n.code,source:n.source}}).each(function(e,t){if(a.stackTop.blocked)return!1;var n=t.cachedData;switch(n&&(t.cachedData=void 0),(t=p(t)).tag()){case"tw-hook":var r=t.popData("source")||(null==n?void 0:n.source);(r&&t.data("originalSource",r),t.data("tempVariables",a.stackTop.tempVariables),t.popAttr("hidden"))?t.data("hidden",!0):r&&a.renderInto(r,t);break;case"tw-expression":var r=t.data("blockers")||(null==n?void 0:n.blockers);if(r){if(o)return void t.removeData("blockers").removeData("code").replaceWith(b.create("syntax","I can't use a macro like (prompt:) or (confirm:) in ".concat(o,"."),"Please rewrite this without putting such macros here.").render(t.attr("title"),t));if(r.length)return a.stackTop.blocked=!0,r=a.eval(r.shift()),b.containsError(r)&&(a.stackTop.blocked=!1,t.removeData("blockers").replaceWith(r.render(t.attr("title"),t))),!1;t.removeData("blockers")}r=t.popData("code")||(null==n?void 0:n.code);r&&c.call(a,t,r);break;case"script":if(f.reattachStoryElement(),t.text())try{i(t.text(),a.stackTop.tempVariables)}catch(e){b.isPrototypeOf(e)?t.replaceWith(e.render(t.text(),t)):(null!=(r=window.console)&&r.error(e),t.replaceWith(b.create("","A Javascript error occurred while running this <script> element.",'The error was "'.concat(e,'". Check the browser console for more details.')).render(t.text(),t)))}}}),this.stackTop.blocked||(n.length&&r&&s(n),n.findAndFilter("tw-collapsed,[collapsing=true]").each(function(){s(p(this))}),setTimeout(function(){return n.find("input, textarea").first().focus()},100),this.stack.shift())},updateEnchantments:function(){this.enchantments.forEach(function(e){e.disenchant(),e.enchantScope()})},on:function(e,t){return l[e].push(t),this},addEnchantment:function(t){var n=this;this.enchantments.push(t),l.add.forEach(function(e){return e(n,t)})},removeEnchantment:function(t){var n=this,e=this.enchantments.indexOf(t);this.enchantments.splice(e,1),t.disenchant(),l.remove.forEach(function(e){return e(n,t)})},unblock:function(e){for(this.stack.length||f.impossible("Section.unblock","stack is empty"),this.stackTop.blocked=!1,void 0!==e&&(this.stackTop.blockedValues=(this.stackTop.blockedValues||[]).concat(e));this.stack.length&&!this.stackTop.blocked;)this.execute();if(!this.stack.length)for(;0<this.unblockCallbacks.length;){var t;if(this.unblockCallbacks.shift()(),null!=(t=this.stackTop)&&t.blocked)return}},whenUnblocked:function(e,t){this.stack.length&&this.stackTop.blocked?this.unblockCallbacks=this.unblockCallbacks.concat(e):(t||e)()},blockedValue:function(){var e=this.stackTop;return e?e.blockedValues&&e.blockedValues.length?e.blockedValues.shift():(f.impossible("Section.blockedValue","blockedValues is missing or empty"),0):(f.impossible("Section.blockedValue","stack is empty"),0)}})}),define("state",["jquery","utils","passages","datatypes/customcommand","utils/operationutils","markup"],function(n,y,b,v,e,t){var i,w,C=e.toSource,E=e.is,k=t.lex,o=Object.assign,h=Object.create,e=Object.defineProperty,N=Array.isArray,s=Math.imul,t=(e(Map.prototype,"toJSON",{value:void 0}),e(Set.prototype,"toJSON",{value:void 0}),["localStorage","sessionStorage"].map(function(e){try{return!!window[e]&&(window[e].setItem("test","1"),window[e].removeItem("test"),!0)}catch(e){return!1}}));function S(e,t){var n=0<arguments.length&&void 0!==e?e:String.fromCodePoint(Date.now()%1114112),e=1<arguments.length&&void 0!==t?t:0;i.seedIter=e,i.seed=n;for(var r,a=0,o=2166136261;a<n.length;a+=1)r=s(n.charCodeAt(a),3432918353),o^=s(r<<15|r>>>17,461845907),o=s(o=o<<13|o>>>19,5)+3864292196|0;return o^=n.length,o=s(o^=o>>>16,2246822507),o=s(o^=o>>>13,3266489909),o=((o^=o>>>16)>>>0)+1831565813*e,function(){i.seedIter+=1;var e=o+=1831565813,e=s(e^e>>>15,1|e);return(((e^=e+s(e^e>>>7,61|e))^e>>>14)>>>0)/4294967296}}function r(e,t){for(var n,r=t.variables,a=h(null),o=e.length-1;0<=o;--o){for(var i,s,c=e[o],l=0,u=["mockVisits","mockTurns","seed","seedIter"];l<u.length;l++){var p=u[l];hasOwnProperty.call(c,p)&&!hasOwnProperty.call(t,p)&&(t[p]=c[p])}for(i in c.forgetVisits&&(t.forgetVisits=Math.max(t.forgetVisits||0,c.forgetVisits)),void 0!==c.turns&&(t.turns=(t.turns||0)+c.turns),t.pastVisits||(t.pastVisits=[]),o!==e.length-1&&(void 0!==e[o+1].visits&&Array.isArray(t.pastVisits[0])?t.pastVisits[0]:t.pastVisits).unshift(c.passage),void 0!==c.pastVisits&&t.pastVisits.unshift(c.pastVisits),void 0!==c.visits&&t.pastVisits.unshift(c.visits),c.variables)if("TwineScript_TypeDefs"===i)for(var d in r[i]||(r[i]=h(null)),c.variables[i])r[i][d]||(r[i][d]=c.variables[i][d]);else i.startsWith("TwineScript_")||i in r||(null===c.variables[i]&&(a[i]=!0),a[i])||(r[i]=c.variables[i],!(s=c.valueRefs[i]))||"via"in s||t.valueRefs[i]||(t.valueRefs[i]=s)}for(n in t.valueRefs){var f=t.valueRefs[n];f&&"via"in f&&delete t.valueRefs[n]}}var a,c={passage:"",variables:h(null),visits:void 0,turns:void 0,seed:void 0,seedIter:void 0,mockVisits:void 0,mockTurns:void 0,forgetVisits:void 0,create:function(e){var t=h(c);return t.passage=e||"",t.variables=h(null),t.valueRefs=h(null),t}},l={forward:[],back:[],load:[],beforeForward:[],beforeBack:[],beforeLoad:[],forgetUndos:[]},u=[],p=-1,d=c.create(),f="";function m(){i.history=i.pastVisits.slice(i.forgetVisits).reduce(function(e,t){return e.concat(t)},[]),i.mockVisits&&(i.history=i.mockVisits.concat(i.history))}function g(){var e=c.create();e.pastVisits=[],o(e.variables,{TwineScript_ObjectName:"this story's variables",TwineScript_TypeDefs:h(null),TwineScript_VariableStore:{type:"global",name:"this story's variables"},TwineScript_Delete:function(e){delete this[e],d.variables[e]=null,delete d.valueRefs[e]},TwineScript_Set:function(e,t,n){if(this[e]=t,d.variables[e]=t,n)d.valueRefs[e]=n;else if((N(t)||t instanceof Map||t instanceof Set||"string"==typeof t)&&!y.options.uncompressedStructures)for(var r=p;0<=r;--r){var a=u[r].variables[e];if(void 0!==a){a=function e(t,n,r){var a="it"===r?"its":r+"'s",o="";if(N(n)&&N(t)&&n.length){for(var i=n.length===t.length,o="(a:",s=0;s<n.length;s+=1){var c,l,u,p=n[s];E(p,t[s])?(c=C(p),l="".concat(a," ").concat(s+1,"th"),o+=(c.length<l.length?c:l)+","):(i=!1,-1<(c=t.indexOf(p))?(l=C(p),u="".concat(a," ").concat(c+1,"th"),o+=(l.length<u.length?l:u)+","):o+=e(t[s],p,"".concat(a," ").concat(s+1,"th"))+",")}o=i?r:o.slice(0,-1)+")"}else if(n instanceof Map&&t instanceof Map&&n.size){var d,f=n.size===t.size,h=(o="(dm:",_createForOfIteratorHelper(n.entries()));try{for(h.s();!(d=h.n()).done;){var m,g,y=_slicedToArray(d.value,2),b=y[0],v=y[1];o+="".concat(C(b),","),E(v,t.get(b))?(m=C(v),g="".concat(a," (").concat(C(b),")"),o+=(m.length<g.length?m:g)+","):(f=!1,o+=e(t.get(b),v,"".concat(a," (").concat(C(b),")"))+",")}}catch(e){h.e(e)}finally{h.f()}o=f?r:o.slice(0,-1)+")"}else if(n instanceof Set&&t instanceof Set&&n.size){var w,k=new Set,S=new Set,T=_createForOfIteratorHelper(t);try{for(T.s();!(w=T.n()).done;){var _=w.value;n.has(_)||k.add(_)}}catch(e){T.e(e)}finally{T.f()}var x,O=_createForOfIteratorHelper(n);try{for(O.s();!(x=O.n()).done;){var A=x.value;t.has(A)||S.add(A)}}catch(e){O.e(e)}finally{O.f()}k.size||S.size||(o=r),o=k.size+S.size>n.size?C(n):r+(S.size?"+"+C(S):"")+(k.size?"-"+C(k):"")}else"string"==typeof n&&"string"==typeof t&&n&&(n.startsWith(t)?o=r+"+"+C(n.slice(t.length)):n.endsWith(t)&&(o=C(n.slice(0,n.length-t.length))+"+"+r));return o?"it"===r?{via:o}:o:"it"===r?void 0:C(n)}(a,t,"it");a&&("it"===a.via?delete d.variables[e]:d.valueRefs[e]=a);break}}},TwineScript_GetProperty:function(e){return this[e]},TwineScript_DefineType:function(e,t){this.TwineScript_TypeDefs[e]=t,hasOwnProperty.call(d.variables,"TwineScript_TypeDefs")||(d.variables.TwineScript_TypeDefs=h(null)),d.variables.TwineScript_TypeDefs[e]=t}}),r(u.slice(0,p+1),e),i=e,m(),w=S(e.seed,e.seedIter)}function T(e){d=c.create(e);e=a.serialise(!0),f=e.past,e=e.pastAndPresent;if(a.hasSessionStorage&&"string"==typeof e)try{sessionStorage.setItem("Saved Session",e)}catch(e){}}function _(e,t,n,r){for(var a in r)if(hasOwnProperty.call(r,a)&&!a.startsWith("TwineScript_"))if("object"===_typeof(r[a]))if(hasOwnProperty.call(r[a],"at")){n.valueRefs[a]=r[a];var o=r[a],i=o.at,s=o.from,c=o.to,l=o.hash,u=o.seed,p=o.seedIter,o=o.blockedValues;if(!b.has(i))throw Error('The data refers to a passage named `"'.concat(n.passage,"\"`, but it isn't in this story."));var d=b.get(i).get("source"),f=d.slice(s,c);if(void 0!==l)for(var h=0,m=c-s;y.hash(f).toString(16)!==l;){if(h+m>=d.length)throw Error("The value (or type) of the variable `$".concat(a,"` couldn't be found in the passage `\"").concat(i,'"`.'));(h+=1)===s&&(h+=1),f=d.slice(h,h+m)}c=k(f,"","macro");void 0!==u&&void 0!==p&&(w=S(u,p)),void 0!==o&&(e.stackTop.blockedValues=o,c.forEach(function e(t){var n;"string"!==t.type&&"hook"!==t.type&&t.children.every(e),"macro"!==t.type||"prompt"!==(n=y.insensitiveName(t.name))&&"confirm"!==n||(t.blockedValue=!0)})),r[a]=e.eval(c)}else if(hasOwnProperty.call(r[a],"via")){for(var g=t.length-1;0<=g;--g)if(hasOwnProperty.call(t[g].variables,a)){e.Identifiers.it=t[g].variables[a];break}r[a]=e.eval(k(r[a].via,"","macro")),e.Identifiers.it=0}else hasOwnProperty.call(r[a],"changer")&&(r[a].changer=e.eval(k(r[a].changer,"","macro")),r[a].hook=e.eval(k(r[a].hook,"","macro")),_(e,t,n,r[a].variables),r[a]=v.create(r[a]));else r[a]=e.eval(k(r[a],"","macro"));else"TwineScript_MockVisits"===a&&(n.mockVisits=r[a])}return g(),d.seed=i.seed,d.seedIter=0,(a={get passage(){return d.passage},get variables(){return i.variables},get pastLength(){return p},get turns(){return p+1+(i.turns||0)+(i.mockTurns||0)},get futureLength(){return u.length-1-p},get mockVisits(){return i.mockVisits||[]},set mockVisits(e){i.mockVisits=e,d.mockVisits=e,m()},get mockTurns(){return i.mockTurns||0},set mockTurns(e){i.mockTurns=e,d.mockTurns=e},history:function(){return i.history},forgetUndos:function(e){e<0&&(e=u.length+e);var t,e=u.splice(0,Math.min(u.length-1,e));e.length&&(p=u.length-1,t=u[0],r(e,t),t.pastVisits.push(e[e.length-1].passage),t.turns=(t.turns||0)+e.length,i.turns=(i.turns||0)+e.length,t.forgetVisits&&(t.pastVisits=t.pastVisits.slice(t.forgetVisits-t.turns),t.forgetVisits-=t.turns),f="",0===p&&n("tw-link[undo], tw-icon[alt='Undo']",y.storyElement).each(function(e,t){(n(t).closest("tw-expression, tw-hook").data("forgetUndosEvent")||Object)(t)}),l.forgetUndos.forEach(function(e){return e()}))},forgetVisits:function(e){(e=e<0?u.length+e:e)>p+i.turns&&(e=p+i.turns),d.forgetVisits=i.forgetVisits=Math.max(i.forgetVisits||0,e),m()},passageNameVisited:function(e){var t=0;if(!b.get(e))return 0;for(var n=0;n<i.history.length;n++)t+=+(e===i.history[n]);return t},get timeline(){return u},play:function(t){var e;d||y.impossible("State.play","present is undefined!"),l.beforeForward.forEach(function(e){return e()}),d.passage&&((null!=(e=d.visits)&&e.length&&Array.isArray(i.pastVisits[i.pastVisits.length-1])?i.pastVisits[i.pastVisits.length-1]:i.pastVisits).push(d.passage),i.history.push(d.passage)),d.passage=t,u=u.slice(0,p+1).concat(d),p+=1,T(t),l.forward.forEach(function(e){return e(t)})},redirect:function(e){var t;d||y.impossible("State.redirect","present is undefined!"),d.passage&&(null!=(t=d.visits)&&t.length&&Array.isArray(i.pastVisits[i.pastVisits.length-1])?i.pastVisits[i.pastVisits.length-1].push(d.passage):i.pastVisits.push([d.passage]),i.history.push(d.passage)),d.visits=(d.visits||[]).concat(e),d.passage=e},rewind:function(e){for(var t=void 0!==e?e:1,n=!1;0<t&&0<p;t--)n=!0,--p;return n&&(l.beforeBack.forEach(function(e){return e()}),f="",T(u[p].passage),g(),l.back.forEach(function(e){return e()})),n},fastForward:function(e){var t=1,n=!1;for("number"==typeof e&&(t=e);0<t&&0<u.length;t--)n=!0,p+=1;return n&&(l.beforeForward.forEach(function(e){return e()}),T(u[p].passage),g(),l.forward.forEach(function(e){return e(u[p].passage,"fastForward")})),n},on:function(e,t){if(e in l)return"function"!=typeof t||l[e].includes(t)||l[e].push(t),a;y.impossible("State.on","invalid event name")},reset:function(){l.beforeLoad.forEach(function(e){return e()}),u=[],p=-1,g(),(d=c.create()).seed=i.seed,d.seedIter=0,f="",w=S(),l.load.forEach(function(e){return e(u)})},hasStorage:t[0],hasSessionStorage:t[1],setSeed:function(e){w=S(e),d.seed=i.seed,d.seedIter=0},get seed(){return i.seed},get seedIter(){return i.seedIter},random:function(){var e=w();return d.seedIter=i.seedIter,e},shuffled:function(){for(var a=this,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.reduce(function(e,t,n){var r=a.random()*(n+1)|0;return r===n?e.push(t):(e.push(e[r]),e[r]=t),e},[]);return d.seedIter=i.seedIter,r}}).serialise=function(e){function o(e,t){if("TwineScript_TypeDefs"===t){var n,r={};for(n in e[t])r[n]=C(e[t][n]);return r}var a;return null===e[t]?null:e[t]&&hasOwnProperty.call(e[t],"TwineScript_CustomCommand")?(a=e[t].TwineScript_CustomCommand(),{changer:C(a.changer),toSource:a.toSource,hook:C(a.hook),variables:Object.keys(a.variables).reduce(function(e,t){return e[t]=o(a.variables,t),e},{})}):C(e[t])}function t(e,t){if(c.isPrototypeOf(t)&&void 0===t.visits&&void 0===t.turns&&void 0===t.mockVisits&&void 0===t.forgetVisits&&void 0===t.pastVisits&&void 0===t.mockTurns&&void 0===t.seed&&void 0===t.seedIter&&Object.keys(t.variables).every(function(e){return e.startsWith("TwineScript_")}))return t.passage;if(!c.isPrototypeOf(this)||"valueRefs"!==e){if(c.isPrototypeOf(this)&&"variables"===e){var n,r={};for(n in this.variables)this.valueRefs[n]?r[n]=this.valueRefs[n]:r[n]=o(this.variables,n);return r}return t}}var e=u.slice(f?e?p-1:p:0,p+1),n=e.slice(0,-1),r=f;try{return{past:r=n.length?(r?r.slice(0,-1)+",":"[")+JSON.stringify(n,t).slice(1):r,pastAndPresent:r.slice(0,-1)+(r?",":"[")+JSON.stringify(e.slice(-1),t).slice(1)}}catch(e){return{past:!1,pastAndPresent:!1}}},a.deserialise=function(e,t){var n;try{n=JSON.parse(t)}catch(e){return Error("The save data is unintelligible.")}if(!N(n))return Error("The save data isn't a sequence of past turns.");for(var r=0;r<n.length;r+=1){var a=n[r];if("string"==typeof a)a={passage:a,variables:{}};else if("object"!==_typeof(a)||!hasOwnProperty.call(a,"variables")){n.splice(r--,1);continue}if(a.valueRefs=h(null),a.variables=o(h(null),a.variables),!b.hasValid(a.passage))return Error('The data refers to a passage named `"'.concat(a.passage,"\"`, but it isn't in this story."));if(hasOwnProperty.call(a.variables,"TwineScript_TypeDefs"))try{_(e,n.slice(0,r),a,a.variables.TwineScript_TypeDefs)}catch(e){return Error("The variable types on turn ".concat(r+1," couldn't be reconstructed.").concat(e.message?" (".concat(e.message,")"):""))}try{_(e,n.slice(0,r),a,a.variables)}catch(e){return Error("The variables on turn ".concat(r+1," couldn't be reconstructed.").concat(e.message?" (".concat(e.message,")"):""))}n[r]=o(h(c),a)}return p=(u=n).length-1,l.load.forEach(function(e){return e(u)}),f="",g(),T(u[p].passage),!0},Object.seal(c),Object.freeze(a)}),define("utils",["jquery","markup","utils/polyfills"],function(d){var r=String.fromCharCode,n="audio,blockquote,canvas,div,h1,h2,h3,h4,h5,hr,ol,p,pre,table,ul,video,tw-align,tw-story,tw-passage,tw-sidebar,tw-columns,tw-column,tw-meter".split(","),a="a,b,i,em,strong,sup,sub,abbr,acronym,s,strike,del,big,small,script,img,button,input,tw-link,tw-broken-link,tw-verbatim,tw-collapsed,tw-error,tw-colour,tw-icon".split(","),f=["audio"],e=_slicedToArray([function(e){return r(e)!==r(e).toLowerCase()},function(e){return r(e)!==r(e).toUpperCase()},function(e){return r(e).toLowerCase()!==r(e).toUpperCase()}].map(function(e){return"["+Array.from(Array(57343)).map(function(e,t){return t}).filter(e).map(function(e,t,n){return e===n[t-1]+1&&e===n[t+1]-1?"-":r(e)}).join("").replace(/-+/g,"-")+"]"}),3),t=e[0],o=e[1],e=e[2];function s(e){return"instant"===e?0:800}var i,c,l=[],u={},p=0,h={},m=0,g={};function y(n,r,e,a,o){var i=null,s=0,c=r+e;function l(e){var t;1&n[0].compareDocumentPosition(document)&&(c=0),i&&(c-=t=e-i),i=e,0<a&&0<p+m&&n.data("expediteAnim")(a),c<=r&&(s+=t||0,"paused"===n.css("animation-play-state"))&&n.css({visibility:"","animation-play-state":"running"}),c<=0?(n.removeData("expediteAnim"),o()):requestAnimationFrame(l)}n.data("expediteAnim",function(e){var t;c-=e=void 0===e?s:e,"running"===n.css("animation-play-state")&&n.css("animation-delay",(("ms"===(t=(t=n.css("animation-delay")).toLowerCase()).slice(-2)?+t.slice(0,-2)||0:"s"===t.slice(-1)&&1e3*+t.slice(0,-1)||0)||0)-e+"ms")}),c?requestAnimationFrame(l):l()}d(document.documentElement).on("keydown keyup mousedown mouseup",function(e){var t=e.key,n=e.button,e=e.type.includes("down"),r=t?u:h,n=t&&v.insensitiveName(t)||n;r[n]&&!e?t?p=Math.max(p-1,0):m=Math.max(m-1,0):!r[n]&&e&&(t?p+=1:m+=1),r[n]=e}).on("mousemove",function(e){var t=e.pageX,e=e.pageY;g.x=t,g.y=e});var b=/-|_/g,v={hash:function(e){for(var t=9,n=e.length;0<n;)--n,t=Math.imul(t^e.charCodeAt(n),Math.pow(9,9));return(t^t>>>9)>>>0},permutations:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r,a,o=t.length,i=[[].concat(t)],s=Array(o).fill(0),c=1;c<o;)s[c]<c?(r=c%2&&s[c],a=t[c],t[c]=t[r],t[r]=a,++s[c],c=1,i.push([].concat(t))):(s[c]=0,++c);return i},nth:function(e){var t=+e+"";return e+("1"!==t[t.length-1]||1!==t.length&&"1"===t[t.length-2]?"2"!==t[t.length-1]||1!==t.length&&"1"===t[t.length-2]?"3"!==t[t.length-1]||1!==t.length&&"1"===t[t.length-2]?"th":"rd":"nd":"st")},plural:function(e,t,n){return e+" "+(1!==Math.abs(e)?n||t+"s":t)},andList:function(e){return e.length<=1?e[0]:e.slice(0,-1).join(", ")+" and "+e[e.length-1]},realWhitespace:"[ \\n\\r\\f\\t\\v\\u00a0\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000]",anyRealLetter:"[\\dA-Za-z\\u00c0-\\u00de\\u00df-\\u00ff\\u0150\\u0170\\u0151\\u0171\\uD800-\\uDFFF]",anyUppercase:t,anyLowercase:o,anyCasedLetter:e,anyNewline:"(?:\\n|\\r|\\r\\n)",unescape:function(e){return e.replace(/&(?:amp|lt|gt|quot|nbsp|zwnj|#39|#96);/g,function(e){return{"&amp;":"&","&gt;":">","&lt;":"<","&quot;":'"',"&#39;":"'","&nbsp;":String.fromCharCode(160),"&zwnj;":String.fromCharCode(8204)}[e]})},escape:function(e){return e.replace(/[&><"']/g,function(e){return{"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"}[e]})},insensitiveName:function(e){return(e+"").toLowerCase().replace(b,"")},allKeysDown:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.every(function(e){return u[e]})},someKeysDown:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.some(function(e){return u[e]})},buttonsDown:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.every(function(e){return h[e]})},anyInputDown:function(){return 0<p+m},mouseCoords:g,parentColours:function(e){for(var t,n={colour:null,backgroundColour:null},r=/^\w+a\(.+?,\s*0\s*\)$|^transparent$/;e.length&&e[0]!==document;e=e.parent())if(n.backgroundColour||(t=e.css("background-color")).match(r)||(n.backgroundColour=t),n.colour||(t=e.css("color")).match(r)||(n.colour=t),n.colour&&n.backgroundColour)return n;return{colour:"#fff",backgroundColour:"#000"}},childrenProbablyInline:function(e){var t=[];return[].every.call(e.findAndFilter("*"),function(e){if(!(e.hidden||/none|inline/.test(e.style.display)||/display: (none|inline)/.test(e.getAttribute("style")))){if(n.includes(e.tagName.toLowerCase())||/display: (?!none|inline|inherit|unset)/.test(e.getAttribute("style")))return!1;a.includes(e.tagName.toLowerCase())||t.push(e)}return!0})&&t.every(function(e){return/inline|none/.test(window.getComputedStyle(e).display)})},transitionOut:function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,i=6<arguments.length&&void 0!==arguments[6]?arguments[6]:void 0;0!==e.length&&(n=n||s(t),!(1<e.length)&&v.childrenProbablyInline(e)&&["tw-hook","tw-passage","tw-sidebar","tw-expression"].includes(e.tag())||(e=e.wrapAll("<tw-transition-container>").parent()),i&&e.css("transform-origin",i),e.attr("data-t8n",t).addClass("transition-out").css({"animation-duration":"".concat(n,"ms"),"animation-delay":"".concat(-o,"ms"),"animation-play-state":"paused"}),requestAnimationFrame(function(){v.childrenProbablyInline(e)?e.css("display","inline"):e.parent().is("tw-backdrop,tw-story")||e[0].setAttribute("style",e[0].getAttribute("style")+"display:block !important;width:100%")}),y(e,n,r-o,a,function(){e.remove()}))},transitionIn:function(u,e,t){var p,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,o=6<arguments.length&&void 0!==arguments[6]?arguments[6]:void 0;0!==u.length&&(t=t||s(e),(p=1<u.length||!v.childrenProbablyInline(u)||!["tw-hook","tw-passage","tw-sidebar","tw-expression"].includes(u.tag()))&&(u=u.wrapAll("<tw-transition-container>").parent()),o&&u.css("transform-origin",o),u.attr("data-t8n",e).addClass("transition-in").css(_objectSpread({"animation-duration":"".concat(t,"ms"),"animation-delay":"".concat(-a,"ms")},n-a?{visibility:"hidden","animation-play-state":"paused"}:{})),requestAnimationFrame(function(){v.childrenProbablyInline(u)?u.css("display","inline"):u.parent().is("tw-backdrop,tw-story")||u[0].setAttribute("style",u[0].getAttribute("style")+"display:block !important;width:100%")}),y(u,t,n-a,r,function(){var e=0===u.filter(f.join(",")).length;if(p&&e){u.find("tw-transition-container, .transition-in, .transition-out").each(function(e,t){((t=d(t)).data("expediteAnim")||Object)()});for(var t=[],n=u.find("*"),r=0;r<n.length;r+=1){var a=n[r];0===a.scrollTop&&0===a.scrollLeft||t.push([a,a.scrollLeft,a.scrollTop])}e=u.find(document.activeElement);u.contents().unwrap();for(var o=0,i=t;o<i.length;o++){var s=_slicedToArray(i[o],3),c=s[0],l=s[1],s=s[2];c.scrollLeft=l,c.scrollTop=s}e.length&&e[0].focus()}else u.removeClass("transition-in").removeAttr("data-t8n")}))},debounce:function(e){function t(){300<Date.now()-l||s<=u?(u=n=0,p=!i,o?(e(c),c=[]):e.apply(void 0,_toConsumableArray(c)),p=!1):n=requestAnimationFrame(t)}var n,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=r.batch,o=void 0!==a&&a,a=r.recur,i=void 0!==a&&a,a=r.maxWait,s=void 0===a?1/0:a,c=[],l=0,u=0,p=!1;return function(){var e;p||(e=Date.now(),u+=e-l,l=e,o?c.push(arguments):c=arguments,n&&cancelAnimationFrame(n),n=requestAnimationFrame(t))}},impossible:function(e,t){window.console&&console.error(e+"(): "+t)},onStartup:function(e){l?l.push(e):e()},get storyElement(){return i},detachStoryElement:function(){document.documentElement.contains(i[0])&&(c=i.parent(),i.detach())},reattachStoryElement:function(){document.documentElement.contains(i[0])||(c||d(document.body)).append(i.parents().length?i.parents().last():i)},options:{speedMultiplier:1}};return d(function(){i=d("tw-story"),l.forEach(function(e){return e()}),l=null}),Object.freeze(v)}),define("datatypes/assignmentrequest",["utils/operationutils","datatypes/typedvar","datatypes/datatype","internaltypes/varref","internaltypes/twineerror"],function(e,y,b,v,w){var k=e.objectName,S=e.matches,t=e.toSource;return Object.freeze({assignmentRequest:!0,TwineScript_TypeName:"a VariableToValue (a 'to' or 'into' expression)",TwineScript_ObjectName:"a VariableToValue (a 'to' or 'into' expression)",TwineScript_ToSource:function(){return"into"===this.operator?"".concat(t(this.src)," ").concat(this.operator," ").concat(t(this.dest)):"".concat(t(this.dest)," ").concat(this.operator," ").concat(t(this.src))},TwineScript_Unstorable:!0,set:function(){var e,t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=[],r=function e(t,n,r){var a=!(2<arguments.length&&void 0!==r)||r,o=[],i=n&&v.isPrototypeOf(n)?n.get():n;if(w.containsError(i))return i;if(Array.isArray(i)&&Array.isArray(t)){for(var s=0,c=0;s<t.length&&c<i.length;){var l=t[s],u=i[c];if(y.isPrototypeOf(l)&&l.datatype.rest||b.isPrototypeOf(l)&&l.rest){for(var p=c;c<i.length&&S(l,u);)u=i[c+=1];y.isPrototypeOf(l)?l.datatype=[l.datatype]:b.isPrototypeOf(l)&&(l=b.create("array")),o=o.concat(e(l,v.isPrototypeOf(n)?v.create(n,{first:p+1,last:c+1}):i.slice(p,c)))}else o=o.concat(e(l,v.isPrototypeOf(n)?v.create(n,c+1):u)),c+=1;s+=1}return s<t.length?a&&w.create("operation","I can't unpack this array because it needs ".concat(t.length-s," more value").concat(0<t.length-s?"s":"",".")):o}if(t instanceof Map&&i instanceof Map){var d,f=_createForOfIteratorHelper(t.entries());try{for(f.s();!(d=f.n()).done;){var h=_slicedToArray(d.value,2),m=h[0],g=h[1];if(!i.has(m))return a&&w.create("operation","I can't unpack this datamap because it needs a '"+m+"' data name.");o=o.concat(e(g,v.isPrototypeOf(n)?v.create(n,m):i.get(m)))}}catch(e){f.e(e)}finally{f.f()}return o}if(y.isPrototypeOf(t)){if("function"==typeof t.datatype.destructure)return[{dest:t,value:i,src:n}].concat(t.datatype.destructure(i));if(!S(i,t.datatype))return a&&w.create("operation","I can't put ".concat(k(i)," into ").concat(t.varRef.TwineScript_ToSource()," because it doesn't match ").concat(t.varRef.TwineScript_ToSource(),"'s datatype, ").concat(k(t.datatype),"."));o=o.concat(e(t.datatype,i))}return v.isPrototypeOf(t)||y.isPrototypeOf(t)?o.concat({dest:t,value:i,src:n}):"function"==typeof t.destructure?o.concat(t.destructure(i)):S(i,t)?o:a&&w.create("operation","I tried to unpack, but "+k(t)+" in the pattern didn't match "+k(i)+".")}(this.dest,this.src);if(e=w.containsError(r))return e;if(!r.length)return w.create("operation","I can't store a new value inside "+k(this.dest)+" that isn't in a variable.","You need a variable, or a data structure containing variables at certain positions, to store the value.");var a,o=_createForOfIteratorHelper(r.reverse());try{for(o.s();!(a=o.n()).done;){var i=a.value,s=i.dest,c=i.value,l=i.src;if(y.isPrototypeOf(s)){if(e=w.containsError(s.defineType()))return e;s=s.varRef}if(e=s.set(c,this.srcRef),w.isPrototypeOf(e))return e;t&&l&&l.delete(),n.shift(k(s)+" is now "+k(c))}}catch(e){o.e(e)}finally{o.f()}return n.join("; ")},create:function(e,t,n,r){return w.containsError(e)?e:w.containsError(t)?t:Object.assign(Object.create(this),{dest:e,src:t,operator:n,srcRef:r})}})}),define("datatypes/changercommand",["utils","utils/operationutils","internaltypes/changedescriptor","internaltypes/twineerror"],function(e,t,n,r){var i=e.plural,a=e.impossible,o=t.is,s=t.toSource,c={},l={TwineScript_TypeID:"changer",TwineScript_TypeName:"a changer",TwineScript_Print:function(){return"`[A ("+this.macroName+":) changer]`"},TwineScript_ToSource:function(){return"("+this.macroName+":"+("else"===this.name?"":this.params.map(s))+")"+(this.next?"+"+this.next.TwineScript_ToSource():"")},get TwineScript_ObjectName(){1===this.params.length&&36<(e=s(this.params[0])).length&&(e=void 0);for(var e,t="a (".concat(this.macroName,":").concat(e||"",") changer"),n=this.next,r=(n&&(t+=" combined with "),0);n&&t.length<48;){var a="(".concat(n.macroName,":)");t+=(0<r&&!n.next?" and ":"")+a+(n.next?", ":""),n=n.next,r+=1}for(var o=0;n&&o<99;)n=n.next,o+=1;return 0<o&&(t+="".concat(0<r?" and ":"").concat(i(o,"other changer"))),t},summary:function(){var e=n.create();return this.run(e),e.summary()},create:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,r=!(3<arguments.length&&void 0!==arguments[3])||arguments[3];return Array.isArray(t)||a("ChangerCommand.create","params was not an array but "+t),Object.assign(Object.create(this),{macroName:e,params:t,next:n,canEnchant:r})},"TwineScript_+":function(e){for(var t=this.TwineScript_Clone(),n=t;n.next;)n=n.next;return n.next=e,t.canEnchant=this.canEnchant&&e.canEnchant,t},TwineScript_is:function(e){if(l.isPrototypeOf(e))return this.macroName===e.macroName&&o(this.params,e.params)&&o(this.next,e.next)},TwineScript_Clone:function(){for(var e=l.create(this.macroName,this.params,this.next),t=e;t.next;)t=t.next=t.next.TwineScript_Clone();return e.canEnchant=this.canEnchant,e},run:function(e,t){var n="output"===this.macroName?[t||this]:this.params,n=c[this.macroName].apply(c,[e].concat(_toConsumableArray(n)));if(r.containsError(n))return n;this.next&&this.next.run(e,t||this)},register:function(e,t){c[e]=t}};return Object.freeze(l)}),define("datatypes/codehook",[],function(){var t=Object.freeze({TwineScript_TypeName:"a code hook",TwineScript_ObjectName:"a code hook",TwineScript_ToSource:function(){return this.source},TwineScript_Print:function(){return this.code},TwineScript_toString:function(){return this.source},TwineScript_is:function(e){return t.isPrototypeOf(e)&&this.source===e.source},TwineScript_Clone:function(){return t.create(this.code,this.source)},create:function(e,t){return Object.assign(Object.create(this),{code:e,source:t})}});return t}),define("datatypes/colour",["jquery"],function(c){var l=Math.max,u=Math.min,a=Math.sin,o=Math.cos,i=Math.pow,p=Math.round,d=Math.floor,s=Math.atan2,f=Math.cbrt,h=Math.sqrt,m=Math.PI,g=Object.assign,y=Object.create,b=/^([\da-fA-F])([\da-fA-F])([\da-fA-F])$/,t=/^([\da-fA-F])([\da-fA-F])([\da-fA-F])([\da-fA-F])([\da-fA-F])([\da-fA-F])$/,v=y(null);function w(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(0<r.length)return w.apply(void 0,[w(e,t)].concat(r));if(!t)return e;for(var o=[],i=0;i<e.length;i++){o[i]=[];for(var s=0;s<t[0].length;s++){for(var c=0,l=0;l<e[0].length;l++)c+=e[i][l]*t[l][s];o[i][s]=c}}return o}function n(e){var t,n=e.r,r=e.g,a=e.b,e=e.a,o=l(n/=255,r/=255,a/=255),i=u(n,r,a),s=(o+i)/2,c=o-i;if(o===i)return{h:0,s:0,l:s};switch(o){case n:t=(r-a)/c+(r<a?6:0);break;case r:t=(a-n)/c+2;break;case a:t=(n-r)/c+4}return{h:t=p(60*t),s:.5<s?c/(2-o-i):c/(o+i),l:s,a:e}}var k=[.9642956764295677,1,.8251046025104602],S=24389/27,T=216/24389,_=function(e){return e.map(function(e){return[e]})},x=function(e){return e.map(function(e){return e[0]})};function O(e){var t=e.l,n=e.c,r=e.h,e=e.a,n=[t*=100,n*o(r*m/180),n*a(r*m/180)],r=[];r[1]=(n[0]+16)/116,r[0]=n[1]/500+r[1],r[2]=r[1]-n[2]/200;n=[i(r[0],3)>T?i(r[0],3):(116*r[0]-16)/S,S*T<t?i((16+t)/116,3):t/S,i(r[2],3)>T?i(r[2],3):(116*r[2]-16)/S].map(function(e,t){return e*k[t]}),t=_slicedToArray(x(w([[3.2409699419045226,-1.537383177570094,-.4986107602930034],[-.9692436362808796,1.8759675015077202,.04155505740717559],[.05563007969699366,-.20397695888897652,1.0569715142428786]],w([[.9554734527042182,-.023098536874261423,.0632593086610217],[-.028369706963208136,1.0099954580058226,.021041398966943008],[.012314001688319899,-.020507696433477912,1.3303659366080753]],_(n)))).map(function(e){return u(255,l(0,255*(.0031308<(e=e)?1.055*i(e,1/2.4)-.055:12.92*e)))}),3);return{r:t[0],g:t[1],b:t[2],a:e}}function e(e){function t(e){return 1e-5<=n[e]&&n[e]<=255-1e-5}var n=O(e);if(Object.keys(n).every(t))return n;var r=(e=_objectSpread({},e)).c,a=0;for(e.c/=2;1e-5<r-a;)n=O(e),Object.keys(n).every(t)?a=e.c:r=e.c,e.c=(r+a)/2;return O(e)}var A=Object.freeze({TwineScript_TypeID:"colour",TwineScript_TypeName:"a colour",TwineScript_ObjectName:"a colour",TwineScript_DebugName:function(){return"a colour "+this.TwineScript_Print()},"TwineScript_+":function(e){var t=this.toRGBA(),e=e.toRGBA();return A.create({r:u(p(.6*(t.r+e.r)),255),g:u(p(.6*(t.g+e.g)),255),b:u(p(.6*(t.b+e.b)),255),a:(t.a+e.a)/2})},TwineScript_Print:function(){var e=this.toRGBA();return"<tw-colour style='background-color:rgba("+[e.r,e.g,e.b,e.a]+");'></tw-colour>"},TwineScript_is:function(e){var t;return!!A.isPrototypeOf(e)&&(e.lcha&&this.lcha?e.lcha.l===this.lcha.l&&e.lcha.c===this.lcha.c&&e.lcha.h===this.lcha.h&&e.a===this.a:(t=this.toRGBA(),(e=e.toRGBA()).r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a))},TwineScript_Clone:function(){return A.create(this)},toRGBAString:function(){var e=this.toRGBA(),t=e.r,n=e.g,r=e.b,e=e.a;return"rgba(".concat(t,", ").concat(n,", ").concat(r,", ").concat(e,")")},toHSLA:function(){return n(this.toRGBA())},toRGBA:function(){return this.lch?e(_objectSpread({a:this.a},this.lch)):this},toLCHA:function(){return this.lch?_objectSpread({a:this.a},this.lch):(t=(e=this).r,n=e.g,r=e.b,e=e.a,n=[116*(t=x(w([[1.0479298208405488,.022946793341019088,-.05019222954313557],[.029627815688159344,.990434484573249,-.01707382502938514],[-.009243058152591178,.015055144896577895,.7518742899580008]],w([[.41239079926595934,.357584339383878,.1804807884018343],[.21263900587151027,.715168678767756,.07219231536073371],[.01933081871559182,.11919477979462598,.9505321522496607]],_([t/255,n/255,r/255].map(function(e){return e<.04045?e/12.92:i((e+.055)/1.055,2.4)}))))).map(function(e,t){return e/k[t]}).map(function(e){return T<e?f(e):(S*e+16)/116}))[1]-16,500*(t[0]-t[1]),200*(t[1]-t[2])],r=180*s(n[2],n[1])/m,{l:n[0]/100,c:h(i(n[1],2)+i(n[2],2)),h:0<=r?r:360+r,a:e});var e,t,n,r},LCHRotate:function(e){e<0&&(e=360+e);var t=this.toLCHA();return t.h=(t.h+e)%360,A.create(t)},TwineScript_GetProperty:function(e){var t;return"lch"===e?(t=this.toLCHA(),new Map([["l",t.l],["c",t.c],["h",t.h]])):(t=this.toRGBA(),"h"===e||"s"===e||"l"===e?n(t)[e]:"r"===e||"g"===e||"b"===e||"a"===e?t[e]:void 0)},TwineScript_Properties:["h","s","l","r","g","b","a","lch"],TwineScript_ToSource:function(){if(0===this.a)return"transparent";var e=!this.lch&&n(this);if(1===e.l&&!e.h&&!e.s)return"white";if(0===e.l&&!e.h&&!e.s)return"black";if(.5<=e.l&&e.l<.5334&&0===e.s)return"gray";if(.5===e.l&&.8<=e.s&&e.s<.804){var t={0:"red",30:"orange",60:"yellow",90:"lime",120:"green",180:"cyan",210:"blue",240:"navy",270:"purple",300:"magenta"}[e.h];if(t)return t}return"(".concat(this.lch?"lch":"hsl",":").concat(this.lch?[this.lch.l,this.lch.c,this.lch.h]:[e.h,e.s,e.l]).concat(1!==this.a?","+this.a:"",")")},create:function(e){var t,n,r,a,o,i;return"string"==typeof e?this.create((A.isHexString(e)?function(e){return"string"!=typeof e?e:(e=(e=e.replace("#","")).replace(b,"$1$1$2$2$3$3"),{r:parseInt(e.slice(0,2),16),g:parseInt(e.slice(2,4),16),b:parseInt(e.slice(4,6),16)})}:function(e){var t;return e in v?v[e]:(t="transparent"===(t=c("<p>").css("background-color",e).css("background-color"))?{r:0,g:0,b:0,a:0}:t.startsWith("rgb")?t.match(/\d+/g).reduce(function(e,t,n){return e["rgb"[n]]=+t,e},{}):{r:192,g:192,b:192},v[e]=t)})(e)):!("h"in e&&"s"in e&&"l"in e)||"r"in e||"g"in e||"b"in e?("a"in e&&"number"==typeof e.a||(e.a=1),"h"in e&&"c"in e&&!("s"in e)&&"l"in e?g(y(this),{a:e.a,lch:{l:e.l,c:e.c,h:e.h}}):g(y(this),e)):this.create((a=(t=e).h,o=e.s,i=e.l,t=e.a,0===o?{r:e=d(255*i),g:e,b:e}:(r=2*i-(n=i<.5?i*(1+o):i+o-i*o),{r:d(255*s((a/=360)+1/3)),g:d(255*s(a)),b:d(255*s(a-1/3)),a:t})));function s(e){return e<0&&(e+=1),1<e&&--e,e<1/6?r+6*(n-r)*e:e<.5?n:e<2/3?r+(n-r)*(2/3-e)*6:r}},isHexString:function(e){return"string"==typeof e&&"#"===e[0]&&(e.slice(1).match(b)||e.slice(1).match(t))},isCSS3Function:function(e){return"string"==typeof e&&/^(?:rgb|hsl)a?\(\s*\d+(?:\.\d+)?\s*,\s*\d+(?:\.\d+)?%?\s*,\s*\d+(?:\.\d+)?%?(?:,\s*\d+(?:\.\d+)?\s*)?\)$/.test(e)}});return A}),define("datatypes/customcommand",["internaltypes/changedescriptor","internaltypes/twineerror"],function(l,u){var p=Object.assign,d=Object.create;return Object.seal({TwineScript_TypeID:"command",TwineScript_ObjectName:"a custom command",TwineScript_TypeName:"a custom command",TwineScript_Print:function(){return"`[a custom command]`"},create:function(e){var t,n=e.toSource,r=e.changer,a=e.hook,o=e.variables,i={};for(t in o)i[t]=[o[t]];var s,c=l.create({source:a,loopVars:i},r);return u.containsError(c)?c:s=p(d(this),{TwineScript_Attach:function(e,t){c.section=e;e=t.run(c);return u.containsError(e)?e:s},TwineScript_Run:function(e){c.section=e;e=c;return c=l.create({source:a,loopVars:i},r),e},TwineScript_ToSource:function(){return n},TwineScript_CustomCommand:function(){return e}})}})}),define("datatypes/custommacro",["jquery","utils","renderer","utils/operationutils","datatypes/customcommand","internaltypes/varref","internaltypes/varscope","internaltypes/twineerror","internaltypes/twinenotifier"],function(w,e,k,t,S,T,_,x,O){function n(v){return function(e){v.called+=1;for(var t=v.varNames,n=v.params,r=v.body,a=E(N(_),{TwineScript_VariableStore:{type:"temp",name:v.TwineScript_ObjectName+" call #"+v.called},TwineScript_TypeDefs:N(null)}),o=[],i=0,s=!1,c=arguments.length,l=new Array(1<c?c-1:0),u=1;u<c;u++)l[u-1]=arguments[u];for(var p=0;p<l.length;p+=1){var d=l[p],f=t[i],h=(a.TwineScript_TypeDefs[f]=n[i].datatype.rest?n[i].datatype.create("array"):n[i].datatype,T.create(a,f));if(x.containsError(h))return h;if(n[i].datatype.rest){var s=!0,m=(a[f]||[]).concat([d]);if(p<l.length-1){a[f]=m;continue}h.set(m)}else h.set(d),i+=1;o.push(O.create(A(h)+" is now "+A(a[f])))}if(!s&&null!=(g=n[i])&&g.datatype.rest){var g=T.create(a,t[i]);if(x.containsError(g))return g;g.set([]),a.TwineScript_TypeDefs[name]=n[i].datatype.create("array")}var y,g=w("<p>").append(k.exec(r.code)),b=e.stack.length,r=(e.stack.unshift({tempVariables:a,dom:g,output:function(e){y=e}}),e.evalReplay);for(e.evalReplay=null,e.execute();e.stack.length>b;)e.stack.shift();e.evalReplay=r;r=g.find("tw-error");return r.length?(g.prepend(o.map(function(e){return e.render()}),"<br>"),x.create("propagated","".concat(r.length," error").concat(1<r.length?"s":""," occurred when running ").concat(v.TwineScript_ObjectName,"."),void 0,g)):void 0===y?x.create("custommacro","".concat(v.TwineScript_ObjectName," didn't output any data or hooks using (output:) or (output-data:).")):"object"===_typeof(y)&&"changer"in y?S.create(E(y,{toSource:"(".concat(v.TwineScript_KnownName||"unnamed",":").concat(l.map(C),")")})):y}}var r=e.andList,A=t.objectName,a=t.typeName,o=t.matches,C=t.toSource,E=Object.assign,N=Object.create,i=Object.seal({TwineScript_TypeID:"macro",TwineScript_TypeName:"a custom macro",TwineScript_GetProperty:function(e){if("params"===e)return _toConsumableArray(this.params)},TwineScript_Properties:["params"],TwineScript_Print:function(){return"`["+this.TwineScript_ObjectName+"]`"},TwineScript_Clone:function(){var e=E(N(i),this);return e.fn=n(e),e},TwineScript_ToSource:function(){return"(macro:"+this.params.map(function(e){return e.TwineScript_ToSource()}).concat("")+this.body.TwineScript_ToSource()+")"},createFromFn:function(e,t,n,r){return E(N(i),{params:[],fn:e,typeSignature:r,TwineScript_ObjectName:t,TwineScript_ToSource:n,TwineScript_KnownName:""})},create:function(e,t){t=E(N(i),{params:e,called:0,varNames:e.map(function(e){return e.varRef.propertyChain[0]}),typeSignature:e.map(function(t){var e=t.datatype.toTypeSignatureObject?t.datatype.toTypeSignatureObject({rest:t.rest}):{pattern:"range",range:function(e){return o(t.datatype,e)},name:a(t.datatype)};return t.rest?{pattern:"zero or more",innerType:e}:e}),body:t,TwineScript_KnownName:"",TwineScript_ObjectName:"a custom macro (with ".concat(e.length?r(e.map(C)):"no params",")")});return t.fn=n(t),t}});return i}),define("datatypes/datatype",["utils","utils/operationutils","datatypes/changercommand","datatypes/colour","datatypes/gradient","datatypes/lambda","datatypes/custommacro","datatypes/codehook","internaltypes/twineerror"],function(e,t,n,r,a,o,i,s,c){var l=e.realWhitespace,u=e.anyRealLetter,p=e.anyCasedLetter,d=e.anyNewline,f=t.objectName,e=Object.seal,h=Object.keys,m=Math.floor,g=Math.abs,y={TwineScript_TypeID:"datatype",TwineScript_TypeName:"a datatype",TwineScript_Print:function(){return"`["+this.TwineScript_ObjectName+"]`"},get TwineScript_ObjectName(){return"the "+(this.rest?"...":"")+this.name+" datatype"},TwineScript_is:function(e){return y.isPrototypeOf(e)&&e.name===this.name},TwineScript_Clone:function(){return this.rest?this:Object.create(this)},TwineScript_ToSource:function(){return(this.rest?"...":"")+this.name},TwineScript_IsTypeOf:function(e){var t=this.name,n=this.rest;return!!v[t]&&v[t](e,n)},toTypeSignatureObject:function(){var e=this.name,e={pattern:"range",range:v[e],name:"a "+("dm"===e?"datamap":"ds"===e?"dataset":"num"===e?e+"ber":"str"===e?e+"ing":"color"===e?"colour":"bool"===e?e+"ean":"alnum"===e?"alphanumeric character":"int"===e?e+"eger":"even"===e||"odd"===e?e+" number":e.endsWith("case")||"whitespace"===e?e+" character":"empty"===e?e+" value":e)};return this.rest?{pattern:"zero or more",innerType:e}:e},create:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=(e="datamap"===e?"dm":"dataset"===e?"ds":"number"===e?"num":"string"===e?"str":"color"===e?"colour":"boolean"===e?"bool":"alphanumeric"===e?"alnum":"integer"===e?"int":"newline"===e?"linebreak":e,Object.create(this));return n.name=e,n.rest=t,n},from:function(t){var e=h(b).find(function(e){return b[e](t)});return e?y.create(e):c.create("datatype",f(t)+" doesn't correspond to a datatype value.")}},b={array:Array.isArray,dm:function(e){return e instanceof Map},ds:function(e){return e instanceof Set},datatype:function(e){return y.isPrototypeOf(e)},changer:function(e){return n.isPrototypeOf(e)},colour:function(e){return r.isPrototypeOf(e)},gradient:function(e){return a.isPrototypeOf(e)},lambda:function(e){return o.isPrototypeOf(e)},macro:function(e){return i.isPrototypeOf(e)},codehook:function(e){return s.isPrototypeOf(e)},command:function(e){return e&&"command"===e.TwineScript_TypeID},str:function(e){return"string"==typeof e},num:function(e){return"number"==typeof e},bool:function(e){return"boolean"==typeof e}},v=_objectSpread(_objectSpread({},b),{},{even:function(e){return!isNaN(e)&&m(g(e))%2==0},odd:function(e){return!isNaN(e)&&m(g(e))%2==1},empty:function(e){return e instanceof Map||e instanceof Set?!e.size:!(!Array.isArray(e)&&"string"!=typeof e||e.length)},int:function(e){return"number"==typeof e&&e===(0|e)},uppercase:function(e){return"string"==typeof e&&1===_toConsumableArray(e).length&&_toConsumableArray(e).every(function(e){return e!==e.toLowerCase()})},lowercase:function(e){return"string"==typeof e&&1===_toConsumableArray(e).length&&_toConsumableArray(e).every(function(e){return e!==e.toUpperCase()})},whitespace:function(e){return"string"==typeof e&&!!e.match("^"+l+"$")},digit:function(e){return"string"==typeof e&&!!e.match("^\\d$")},alnum:function(e){return"string"==typeof e&&!!e.match("^"+u+"$")},anycase:function(e){return"string"==typeof e&&!!e.match("^"+p+"$")},linebreak:function(e){return"string"==typeof e&&!!e.match("^"+d+"$")},any:function(){return!0},const:function(){return!0}});return e(y)}),define("datatypes/gradient",["utils/operationutils"],function(e){var t=e.toSource,n=Object.freeze({TwineScript_TypeID:"gradient",TwineScript_TypeName:"a gradient",TwineScript_ObjectName:"a gradient",TwineScript_DebugName:function(){return"a gradient "+this.TwineScript_Print()},TwineScript_GetProperty:function(e){var t=this;return"angle"===e?this.angle:"stops"===e?this.stops.map(function(e){return new Map([[t.repeating?"pixels":"percent",e.stop],["colour",e.colour.TwineScript_Clone()]])}):void 0},TwineScript_Properties:["angle","stops"],TwineScript_ToSource:function(){return"(gradient:"+this.angle+","+this.stops.map(function(e){return t(e.stop)+","+t(e.colour)})+")"},TwineScript_is:function(e){var r=this;return e.angle===this.angle&&e.stops.length===this.stops.length&&e.stops.every(function(e,t){var n=e.colour,e=e.stop;return r.stops[t].stop===e&&r.stops[t].colour.TwineScript_is(n)})},TwineScript_Clone:function(){return n.create(this.angle,_toConsumableArray(this.stops))},TwineScript_Print:function(){return"<tw-colour style='background:"+this.toLinearGradientString()+"'></tw-colour>"},create:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];return Object.assign(Object.create(this),{angle:e,stops:t.sort(function(e,t){return e.stop-t.stop}),repeating:n})},multiply:function(t){return n.create(this.angle,this.stops.map(function(e){return{colour:e.colour,stop:e.stop*t}}))},toLinearGradientString:function(){var r=this;return(this.repeating?"repeating-":"")+"linear-gradient(".concat(this.angle,"deg, ").concat(this.stops.reduce(function(e,t){var n=t.colour,t=t.stop;return e+n.toRGBAString()+" "+t*(r.repeating?1:100)+(r.repeating?"px,":"%,")},"").slice(0,-1),")")}});return n}),define("datatypes/hookset",["jquery","utils","utils/renderutils","utils/operationutils"],function(g,s,e,t){var y=e.textNodeToChars,b=e.realWhitespace,c=e.findTextInNodes,r=t.toSource;function l(e){function t(n,e){if(Array.isArray(e))return e.reduce(function(e,t){return e.add(n.get(t))},g());if(e&&"object"===_typeof(e)&&"first"in e&&"last"in e){for(var t=e.first,r=e.last,a=n.length,o=(t<0&&(t+=a),r<0&&(r+=a),[n.get(t)]);t!==r;)t+=Math.sign(r-t),o.push(n.get(t));return g(o)}if("string"==typeof e){if("chars"===e){var i,s=[],c=_createForOfIteratorHelper(n.textNodes(m));try{for(c.s();!(i=c.n()).done;){var l,u=i.value,p=_createForOfIteratorHelper(y(u));try{for(p.s();!(l=p.n()).done;){var d=l.value;d.textContent.match(b)||s.push(d)}}catch(e){p.e(e)}finally{p.f()}}}catch(e){c.e(e)}finally{c.f()}return g(s)}if("links"===e)return n.findAndFilter("tw-link, .enchantment-link");if("visited"===e)return n.findAndFilter("tw-link.visited");var f,h;if("lines"===e)return f=n.findAndFilter("br:not(tw-sidebar *),tw-consecutive-br:not(tw-sidebar *)").get(),h=[[]],n.contents().each(function e(t,n){var r=(n.tagName||"").toLowerCase();if("tw-sidebar"!==r)if("tw-passage"===r||"tw-transition-container"===r)g(n).contents().each(e);else{if(f.length){if(n===f[0])return f.shift(),void h.push([]);if(16&n.compareDocumentPosition(f[0]))return h.push([]),g(n).contents().each(e),void h.push([])}h[h.length-1].push(n)}}),g(h.map(function(e){return!!e.length&&g(e).wrapAll("<tw-pseudo-hook>").parent()[0]}).filter(Boolean))}return g(n.get(e))}var n,r,a=e.dom,m=":not(tw-error, tw-error *)",o=g();this.next&&(o=o.add(l.call(this.next,e)));if(this.selector){if("string"===this.selector.type)i=this.selector.data,n=c((n=a).textNodes(),i),r=g(),n.forEach(function(e){r=r.add(g(e).wrapAll("<tw-pseudo-hook>").parent())}),i=r;else{if("base"===this.selector.type)return o.add(t(l.call(this.selector.data,e),this.property));n=this.selector.data,e='tw-hook[name="'+(n=s.insensitiveName(n).replace(/"/g,"&quot;"))+'"],tw-enchantment[name="'+n+'"]';var e=e+={page:", tw-story",passage:", tw-passage",sidebar:", tw-sidebar",link:", tw-link, .enchantment-link"}[n]||"",i=a.findAndFilter(e).add(a.parentsUntil(s.storyElement.parent())).filter(e)}o=this.property?o.add(t(i,this.property)):o.add(i)}return o=o.get().reduce(function(e,t){return t=g(t),e.add(t.is("tw-enchantment")&&t.contents().length<=1?t.contents():t)},g())}function a(e){var t,n;return e?(t=e.selector,n=e.property,e=e.next,[JSON.stringify(["base"===t.type?a(t.data):s.insensitiveName(t.data),n])].concat(_toConsumableArray(a(e))).sort()):[]}var o=Object.freeze({forEach:function(e,n){var t=l.call(this,e).each(function(e,t){return n(g(t),e)});return e.dom.findAndFilter("tw-pseudo-hook").contents().unwrap(),t},hooks:function(e){return l.call(this,e)},get TwineScript_ObjectName(){return"the hook name ".concat(this.TwineScript_ToSource())},TwineScript_TypeID:"hookName",TwineScript_TypeName:"a hook name (like ?this)",TwineScript_Unstorable:!0,TwineScript_ToSource:function(){var e="",t=this.selector,n=t.type,t=t.data;return"name"===n?t.match(RegExp("^"+s.anyRealLetter+"+$"))?e+="?"+t:e+="(hooks-named:"+JSON.stringify(t)+")":"string"===n?e+=JSON.stringify(t):"base"===n&&(e+=t.TwineScript_ToSource()+"'s "+r(this.property,"property")),this.next&&(e+=" + "+this.next.TwineScript_ToSource()),e},"TwineScript_+":function(e){for(var t=this.TwineScript_Clone(),n=t;n.next;)n=n.next;return n.next=e,t},TwineScript_is:function(e){return a(this)+""==a(e)+""},TwineScript_GetProperty:function(e){return o.create({type:"base",data:this},e,void 0)},TwineScript_Properties:["chars","links","lines","visited"],TwineScript_Clone:function(){return o.create(this.selector,this.property,this.next)},create:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:void 0;return Object.assign(Object.create(this||o),{selector:Object.freeze(e),property:t,next:n})},from:function(e){return o.isPrototypeOf(e)||"string"==typeof e||s.impossible("HookSet.from() was given a non-HookSet non-string."),o.isPrototypeOf(e)?e:o.create({type:"string",data:e})}});return o}),define("datatypes/lambda",["utils/operationutils","internaltypes/varscope","internaltypes/varref","internaltypes/twineerror"],function(e,h,s,m){var g=e.objectName;var c=Object.freeze({TwineScript_TypeID:"lambda",TwineScript_TypeName:"a lambda",get TwineScript_ObjectName(){return'a "'+("making"in this?"making ... ":"")+("each"in this?"each ... ":"")+("where"in this?"where ... ":"")+("when"in this?"when ... ":"")+("via"in this?"via ... ":"")+'" lambda'},TwineScript_Print:function(){return"`[A lambda]`"},TwineScript_is:function(e){return e===this},TwineScript_ToSource:function(){return this.source},TypeSignature:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{pattern:"lambda",innerType:c,clauses:t,typeName:'a "'+t.concat("").join(" ...")+'" lambda'}},TwineScript_Clone:function(){return Object.assign(Object.create(c),this)},create:function(e,t,n,r){var a,o="temp variable, or typed temp variable";function i(e){e=e&&e.varRef?e.varRef:e;return void 0===e||e&&s.isPrototypeOf(e)&&h.isPrototypeOf(e.object)&&1===e.propertyChain.length}if(m.containsError(n))return n;if("making"===t&&!i(n))return m.create("syntax","I need a "+o+", to the right of '"+t+"', not "+g(n)+".");if(m.containsError(e))return e;if(c.isPrototypeOf(e)){if("when"===t||"when"in e)return m.create("syntax","A 'when' lambda cannot have any other clauses, such as '"+t+"'.");if(t in e)return m.create("syntax","This lambda has two '"+t+"' clauses.");a=e}else{if("when"===t&&void 0!==e)return m.create("syntax","A 'when' lambda shouldn't begin with a temp variable (just use 'when' followed by the condition).");if(!i(e))return m.create("syntax","This lambda needs to start with a single "+o+", not "+g(e)+".");(a=Object.create(this)).loop=e||""}return a.source=r.trim(),a[t]=n,a.making&&a.making.getName()===(a.loop&&a.loop.getName())?m.create("syntax","This lambda has two variables named '"+a.loop.getName()+"'.","Lambdas should have all-unique parameter names."):a},apply:function(e,t){var n=t.loop,r=t.pos,a=t.making,o=t.ignoreVia;function i(e,t){if(e){var n,r;if("datatype"in e&&"varRef"in e)return n=e.varRef.create(s,e.varRef.propertyChain),m.containsError(n)?n:(r=n.defineType(e.datatype),m.containsError(r)||(r=n.set(t),m.containsError(r))?r:void 0);s[e.getName()]=t}}var s=(s=t.tempVariables)||Object.create(e.stack.length?e.stackTop.tempVariables:h),t=i(this.loop,n)||i(this.making,a);if(m.containsError(t))return t;e.stack.unshift(Object.assign(Object.create(e.stackTop||null),{tempVariables:s,lambdaPos:this.when?void 0:r})),!n||this.making||this.when?e.Identifiers.it=m.create("operation","I can't use 'it', or an implied 'it', in "+this.TwineScript_ObjectName):e.Identifiers.it=n;var c,l,u,p,d,t=!o&&this.via,o="where"in this||"when"in this,f=e.evalReplay;return e.evalReplay=f?[]:null,o?(c=e.eval(this.where||this.when),l=e.evalReplay,e.evalReplay=l&&t?[]:null,!n||this.making||this.when||(e.Identifiers.it=n),u=c,p=!t||e.eval(t),d=null,u=m.containsError(u)||("boolean"!=typeof u?m.create("operation","This lambda's 'where' clause must evaluate to true or false, not "+g(u)+"."):u?p:d)):c=u=!t||e.eval(t),p=t?e.evalReplay:null,e.stack.shift(),(e.evalReplay=f)&&(o||t)&&(((d=f[f.length-1])||{}).lambda&&d.lambda.obj===this||((d={lambda:{obj:this,loops:[]},code:(f[f.length-1]||{}).code||""}).fromCode=d.code,f.push(d)),d.lambda.loops.push(_objectSpread(_objectSpread(_objectSpread({it:n,pos:r},void 0!==a&&{making:a}),t&&{viaReplay:p,viaResult:u}),o&&{whereReplay:l,whereResult:null!==c&&c}))),u},filter:function(r,e){var a,o=this,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return e.reduce(function(e,t,n){return a||(n=o.apply(r,{loop:t,pos:n+1,ignoreVia:!0,tempVariables:i}),a=m.containsError(n))||e.concat(n?[t]:[])},[])}});return c}),define("datatypes/typedvar",["utils/operationutils","internaltypes/varref","internaltypes/twineerror"],function(e,a,o){var i=e.typeName,t=e.matches,n=e.toSource,s=e.unstorableValue,e=Object.freeze,c=Object.assign,l=Object.create,u=e({TwineScript_TypeName:"a TypedVar (typed variable name)",get TwineScript_ObjectName(){var e=n(this.datatype);return"the ".concat(e.length<24?e+"-":"","typed variable name, ").concat(this.varRef.TwineScript_ToSource())},TwineScript_Print:function(){return"`[A typed variable name]`"},TwineScript_Unstorable:!0,TwineScript_Clone:function(){return c(l(u),{datatype:this.datatype.TwineScript_Clone(),varRef:this.varRef})},TwineScript_ToSource:function(){return n(this.datatype)+"-type "+this.varRef.TwineScript_ToSource()},TwineScript_GetProperty:function(e){return"name"===e?this.getName():this[e]},TwineScript_Properties:["datatype","name"],TwineScript_IsTypeOf:function(e){return t(this.datatype,e)},get:function(){var e;return(e=this.varRef).get.apply(e,arguments)},getName:function(){return this.varRef.getName()},defineType:function(){if("any"!==this.datatype.name)return this.varRef.defineType(this.datatype)},create:function(e,t){var n,r;return(n=o.containsError(t)||o.containsError(e)||t.error)||(a.isPrototypeOf(t)?(n=t.object,r=t.compiledPropertyChain,n&&n.TwineScript_VariableStore&&1===r.length&&n.TwineScript_TypeDefs?(r=s(e))&&!u.isPrototypeOf(r)?o.create("syntax","The -type syntax can't have "+i(r)+" to its left."):c(l(this),{datatype:e,varRef:t}):o.create("unimplemented","I can only restrict the datatypes of variables, not data names or anything else.")):o.create("syntax","The -type syntax must have a variable to its right."))}});return u}),define("datatypes/varbind",["jquery","utils","utils/operationutils","internaltypes/varref","internaltypes/twineerror"],function(o,e,t,n,r){var a=t.objectName;return n.on("set",function(r,a){r.TwineScript_VariableStore&&e.storyElement.find("[data-2bind]").each(function(e,t){var n=(t=o(t)).data("twoWayBindEvent");"function"==typeof n&&n(t,r,a)})}),Object.freeze({TwineScript_TypeName:"a VarBind (bound variable name)",get TwineScript_ObjectName(){return"a ".concat(this.bind," bind to ").concat(this.varRef.TwineScript_ToSource())},TwineScript_Print:function(){return"`[A bound variable name]`"},TwineScript_Unstorable:!0,TwineScript_ToSource:function(){return("two way"===this.bind?"2":"")+"bind "+this.varRef.TwineScript_ToSource()},set:function(e){var e=this.varRef.set(e);if(e=r.containsError(e))return e},create:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"one way";return r.containsError(e)?e:n.isPrototypeOf(e)?e.error||Object.assign(Object.create(this),{varRef:e,bind:t}):r.create("operation","I can only 'bind' a variable, not "+a(e)+".")}})}),define("debugmode/highlight",["jquery","utils","utils/typecolours","macros","lexer"],function(u,e,t,p,n){var d=e.insensitiveName,f=t.versionClass,h=n.lex;return function(e,t,n,r){if(9999<e.length)return[u("<span>").text(e)];for(var a=h(e,"",t||"macro"),o=[],i="",s=a,c=a.start;c<a.end;c+=1){var l=a.pathAt(c);l[0]!==s[0]&&(o.length&&(o[o.length-1].textContent=i),i="",s=l,o.push(u("<".concat(r&&n<=c&&c<r?"mark":"span",' class="').concat(function(e){for(var t={},n="",r=0;r<e.length;r+=1){var a=e[r],o=a.type,i=a.text,s=("verbatim"!==o&&"comment"!==o||(n=""),f+o);switch(t[s]=(t[s]||0)+1,1<t[s]&&(s+="-"+t[s]),o){case"text":i.trim()&&e.slice(r+1).reduce(function(e,t){return void 0===e?"macro"===t.type||"hook"!==t.type&&e:e},void 0)&&(s+=" ".concat(f,"error"));break;case"macroName":var c,l=e[r].text[0];"_"!==l&&"$"!==l?(c=d(e[r].text.slice(0,-1)),p.has(c)?s+="-"+p.get(c).returnType.toLowerCase():s+=" ".concat(f,"error")):s+=" ".concat(f,"customMacro ").concat(f+("_"===l?"tempV":"v"),"ariable")}n+=s+" "}return n}(s),'">'))[0])),i+=a.text[c-a.start]}return o.length&&(o[o.length-1].textContent=i),o}}),define("debugmode/mode",["jquery","utils","utils/naturalsort","state","engine","internaltypes/varref","internaltypes/twineerror","utils/operationutils","utils/renderutils","passages","section","debugmode/panel","debugmode/highlight","utils/typecolours"],function(I,V,M,D,F,L,H,e,t,z,q,W,B,n){var U=e.objectName,$=e.isObject,G=e.toSource,Y=e.typeID,J=t.dialog,X=n.CSS,K=function(e,t){var f=V.escape,i=V.nth,n=V.debounce,r=I(document.documentElement),a=M(),o={darkMode:!0,fadePanel:!0,evalReplay:!0,width:null,maxHeight:400};if(D.hasStorage)try{var s=localStorage.getItem("(Debug Options "+V.options.ifid+")");s&&(o=JSON.parse(s))}catch(e){}function c(){if(D.hasStorage)try{localStorage.setItem("(Debug Options "+V.options.ifid+")",JSON.stringify(o))}catch(e){}}W.defaultMaxHeight=o.maxHeight;function l(e){return n(function(){if(V.options.debug)return e.apply(this,arguments)},{maxWait:2e3})}var h=I('<tw-debugger class="'.concat([o.darkMode?"theme-dark":"",o.fadePanel?"fade-panel":""].join(" "),'" style="').concat(o.width?"width:"+o.width+"px":"","\">\n<div class='panel panel-errors' hidden><table></table></div>\n<div class='tabs'></div>\n<label style='user-select:none'>Turns: </label><select class='turns' disabled></select>\n<button class='show-invisibles'>\ud83d\udd0d Debug View</button>\n<button class='show-dom'><span style=\"vertical-align:text-top\">&lt;</span><span style=\"vertical-align:text-bottom\">&gt;</span> DOM View</button>\n<button class='close'>\u2716</button>\n<div class='resizer-h'>\n</tw-debugger>")),s=h.find(".tabs"),u=h.find(".show-dom"),p=h.find(".show-invisibles"),d=h.find(".close"),m=h.find(".turns");I(document.documentElement).on("click","tw-expression, tw-error, tw-eval-explanation",n(function(e){var r,a,o,i,l,u,p,d,t=I(e.target).data("evalReplay");function n(){var e,s,c=r[a],t=o.find("tw-eval-explanation").empty(),n=o.find("tw-eval-code");c.toCode||c.toDesc||c.error||c.lambda?(o.find("tw-eval-code").empty().append(B(c.code,"macro",0<a&&c.start,0<a&&c.end+c.diff)),t.append(c.lambda?"":"<code class='".concat(56<c.fromCode.length?"from-block":"from-inline","'></code>"),c.error?"<span> caused an error: </span>":c.lambda?"<span>The lambda <code class='to-lambda'></code> was run, producing these results.</span>":"<span> became".concat(c.ToDesc?"\u2026":""," </span>").concat(c.toDesc?"<span class='to-desc'>".concat(f(c.toDesc),".</span>"):"<code class='to-code'></code>")),c.error?t.append(c.error):c.lambda?(s=function(e,t){return I("<".concat(e,"><code></").concat(e,">")).find("code").append(B(t,"macro")).end()},t.find(".to-lambda").append(B(c.lambda.obj.source,"macro")).end().append((e=I("<table>")).append.apply(e,[I("<tr>").append(s("th","pos"),c.lambda.obj.loop?s("th","_"+c.lambda.obj.loop.getName()).append(" / ",I("<code>").append(B("it","macro"))):s("th","it"),c.lambda.obj.making&&s("th","_"+c.lambda.obj.making.getName()),c.lambda.obj.where&&s("th","where").append(" result"),c.lambda.obj.via&&s("th","via").append(" result"))].concat(_toConsumableArray(c.lambda.loops.map(function(e){var t=e.it,n=e.pos,r=e.making,a=e.whereResult,o=e.whereReplay,i=e.viaResult,e=e.viaReplay;return I("<tr>").append(s("td",G(n)),s("td",G(t)),void 0!==r&&s("td",G(r)),null!=a&&(H.containsError(a)?I("<td>").append(a.render(c.lambda.obj.source,!0)):s("td",G(a))).append(o&&I("<tw-open-button replay label='\ud83d\udd0d'>").data("evalReplay",o)),null!=i&&(H.containsError(i)?I("<td>").append(i.render(c.lambda.obj.source,!0)):s("td",G(i))).append(e&&I("<tw-open-button replay label='\ud83d\udd0d'>").data("evalReplay",e)))})))))):c.toDesc||t.find(".to-code").append(B(c.toCode,"macro")),t.next().html(c.itIdentifier?'(The <code class="cm-harlowe-3-identifier">it</code> identifier now refers to '.concat(f(c.itIdentifier),".)"):"").next().text(c.reason||"")):(n.html(B(c.code,"macro")),t.html("<center>First, there was <code></code>.</center>").next().empty().next().empty()),c.lambda||t.find("code").first().append(B(c.fromCode,"macro")),o.find("mark").each(function(e,t){t.scrollIntoView()}),i.css("visibility",a<=9?"hidden":"visible"),l.css("visibility",a<=0?"hidden":"visible"),p.css("visibility",a>=r.length-1?"hidden":"visible"),d.css("visibility",a>=r.length-10?"hidden":"visible"),u.html("( ".concat(a+1,"/").concat(r.length," )"))}t&&(r=t,t=J({buttons:[{name:"Understood",confirm:!(a=0),callback:function(){return!h.find("tw-backdrop").length&&h.removeClass("show-dialog")}}]}).addClass("eval-replay"),o=I("<tw-eval-replay>".concat(1===r.length?"":"<tw-eval-code></tw-eval-code>","<tw-eval-explanation></tw-eval-explanation><tw-eval-it></tw-eval-it><tw-eval-reason></tw-eval-reason>").concat(1===r.length?"":"<tw-dialog-links><tw-link style='visibility:hidden'>\u2190 10</tw-link><tw-link style='visibility:hidden'>\u2190 \u2190</tw-link><b></b><tw-link>\u2192 \u2192</tw-link><tw-link>10 \u2192</tw-link></tw-dialog-links>","</tw-eval-replay>")),t.find("tw-dialog").css({width:"75vw","max-width":"75vw"}).prepend(o),i=o.find("tw-link:first-of-type"),l=i.next(),u=l.next(),p=u.next(),d=p.next(),n(),i.on("click",function(){a=Math.max(0,a-10),n()}),l.on("click",function(){a=Math.max(0,a-1),n()}),p.on("click",function(){a=Math.min(r.length-1,a+1),n()}),d.on("click",function(){a=Math.min(r.length-1,a+10),n()}),h.find("tw-backdrop").length?h.find("tw-backdrop").before(t):h.addClass("show-dialog").append(t));var s,t=I(e.target).data("goto");t&&(s=V.options.ignoreGotos,V.options.ignoreGotos=!1,t.command.TwineScript_Run(t.section),V.options.ignoreGotos=s),e.stopPropagation()})),h.find(".resizer-h").mousedown(function(e){if(1!==e.which)return!0;e.stopPropagation();var t=e.pageX,n=h.width();r.on("mousemove.debugger-resizer-h",function(e){e=e.pageX;h.width("".concat(n+t-e|0,"px"))}).on("mouseup.debugger-resizer-h",function(){r.off(".debugger-resizer-h"),o.width=h.width(),c()})}),h.on("mousedown",".resizer-v",function(e){if(1!==e.which)return!0;e.stopPropagation();var t=e.pageY,n=I(e.target.parentNode).height();r.on("mousemove.debugger-resizer-v",function(e){e=e.pageY;h.find(".panel").css("maxHeight","".concat(n+t-(0|e),"px"))}).on("mouseup.debugger-resizer-v",function(){r.off(".debugger-resizer-v"),o.maxHeight=h.find(".panel").css("maxHeight"),c()})}),p.click(function(){r.toggleClass("debug-mode").removeClass("dom-debug-mode"),p.toggleClass("enabled"),u.removeClass("enabled")}),u.click(function(){r.toggleClass("dom-debug-mode").removeClass("debug-mode"),u.toggleClass("enabled"),p.removeClass("enabled")}),d.click(function(){r.removeClass("debug-mode dom-debug-mode"),h.detach(),Object.assign(V.options,{debug:!1,speedMultiplier:1,ignoreClickEvents:!1,ignoreGotos:!1})});function g(e){(e=e.parents(".variable-row, .enchantment-row, .source-row")).next(".panel-row-source").find("td").empty().append(B(e.data("value")||G(e.data("enchantment").changer),e.is("source-row")?"markup":"macro"))}function y(){return k=new Set}function b(){I(document.body).append(h),V.options.debug=!0,V.options.evalReplay=o.evalReplay,V.options.speedMultiplier=1,V.options.ignoreClickEvents=!1,V.options.ignoreGotos=!1,R()}var v,w=l(function(){var r=m.children().get(),e=D.timeline,a=0;e.forEach(function(e,t){var n=e.turns,e=e.passage,n=(a+=1+(void 0===n?0:n))+": "+e;r[t]?r[t].textContent=n:m.append("<option value='".concat(t,"'>").concat(n,"</option>"))}),e.length<r.length&&I(r.slice(e.length)).remove(),m[1<=e.length?"removeAttr":"attr"]("disabled"),m.val(D.pastLength)}),k=(m.change(function(e){e=e.target.value-D.pastLength;0!=e&&(D[e<0?"rewind":"fastForward"](Math.abs(e)),F.showPassage(D.passage))}),w(),D.on("forward",w).on("load",w).on("forgetUndos",function(){return w}).on("back",function(){D.pastLength<=1&&m.attr("disabled"),m.find("[selected]").removeAttr("selected"),m.val(D.pastLength)}),new Set),S=W.create({className:"variables",tabName:"Variable",rowWrite:function(e,t){var n,r=e.name,a=e.dataset,o=e.path,i=e.value,s=e.tempScope,e=e.type,c=i&&48<i.length&&!i.TwineScript_DebugName,l=$(i)&&i.TwineScript_DebugName?i.TwineScript_DebugName():f(U(i)),u="",a=(o.length&&(u=o.reduce(function(e,t){return e+t+"'s "},"")),a&&(r="???"),e?G(e):""),e="object"===_typeof(i)||c;return t?(t[0].firstChild.innerHTML=a||"",u&&I(t[0].firstChild).children(".variable-path").html((s?"_":"$")+f(u)),t[0].childNodes[1].lastChild.textContent=(u?"":s?"_":"$")+f(r+""),t[0].childNodes[2].textContent=s||"",t[0].childNodes[3].innerHTML=l,n=(c=I(t[0].lastChild.firstChild)).is(".open"),c[e?"show":"hide"](),c=t.next(".panel-row-source"),n&&c.find("td").empty().append(B(G(i))),t.data("value",G(i)),t.add(c)):I('<div class="variable-row">').attr("data-name",r).attr("data-path",o+"").attr("data-scope",s||"").css("padding-left",Math.min(5,o.length)+"em").append("<td class='variable-type'>".concat(a||"","</td>"),"<td class='variable-name cm-harlowe-3-"+(s?"tempV":"v")+"ariable'><span class='variable-path'>"+(u?(s?"_":"$")+f(u):"")+"</span> "+(u?"":s?"_":"$")+f(r+"")+"</td>","<td class='temporary-variable-scope'>".concat(s||"","</td>"),"<td class='variable-value cm-harlowe-3-macroName-"+Y(i)+"'>"+l+"</td><td class='panel-row-buttons'><tw-folddown tabindex=0 style='display:"+(e?"visible":"none")+"'>(source:) </tw-folddown></td>").data("value",G(i)).find("tw-folddown").data("folddown",g).end().add("<tr class='variable-row panel-row-source' style='display:none'><td colspan='5'></td></tr>")},rowCheck:function(e,t){var n=e.name,r=e.path,e=e.tempScope;return t[0]&&t[0].getAttribute("data-name")===n&&t[0].getAttribute("data-path")===r+""&&t[0].getAttribute("data-scope")===e},columnHead:function(){return'<tr class="panel-head"><th data-col="variable-type">Type</th><th data-col="variable-name">Name</th><th data-col="temporary-variable-scope">Scope</th><th data-col="variable-value">Value</th></tr>'},rowSort:function(e,t,n){if("variable-value"===e)return a(t.attr("class"),n.attr("class"))||a(t.parent().data("value"),n.parent().data("value"))}}),T=l(function(){var e,t,o=[],n=D.variables,r=o.length;for(e in n)e.startsWith("TwineScript")||(r+=1,function n(e){var r,t,a;500<o.length||(o.push(e),r=e.path.concat(e.name),t=e.value,a=e.tempScope,r.length<=4&&(Array.isArray(t)?t.forEach(function(e,t){return n({name:i(t+1),path:r,value:e,tempScope:a})}):t instanceof Map?_toConsumableArray(t).forEach(function(e){var t=(e=_slicedToArray(e,2))[0],e=e[1];return n({name:t,path:r,value:e,tempScope:a})}):t instanceof Set&&_toConsumableArray(t).forEach(function(e,t){return n({name:t,dataset:!0,path:r,value:e,tempScope:a})})))}({name:e,path:[],value:n[e],tempScope:"",type:null==(t=n.TwineScript_TypeDefs)?void 0:t[e]}));o.push.apply(o,_toConsumableArray(k)),r+=k.size,S.update(o,r),0===r!==S.panel[0].classList.contains("panel-variables-empty")&&S.panel.toggleClass("panel-variables-empty")}),_=(L.on("set",function(e,t,n){var r,a;e===D.variables||"temp"!==(null==(a=e.TwineScript_VariableStore)?void 0:a.type)||null!=(a=e.TwineScript_VariableStore)&&a.name.match(/#\d+$/)||(r=null==(a=e.TwineScript_VariableStore)?void 0:a.name,e=null==(a=e.TwineScript_TypeDefs)?void 0:a[t],(a=_toConsumableArray(k).find(function(e){return e.name===t&&e.tempScope===r}))?a.value=n:k.add({name:t,path:[],value:n,tempScope:r,type:e})),T(),v()}).on("delete",function(){T(),v()}),S.panel.append("<div class='panel-variables-bottom'>\n\t\t\t<button class='panel-variables-copy'>Copy $ variables as (set:) call</button>\n\t\t\t<input class='clipboard' type=\"text\" style='opacity:0;pointer-events:none;position:absolute;'></input>\n\t\t</div>").removeAttr("hidden"),S.tab.addClass("enabled"),S.panel.find(".clipboard")),x=(r.on("click",".panel-variables-copy",function(){var e,t=[];for(e in D.variables)e.startsWith("TwineScript")||t.push("$"+e+" to "+G(D.variables[e]));_.val("(set:"+t+")")[0].select(),document.execCommand("copy")}),W.create({className:"enchantments",tabName:"Enchantment",rowWrite:function(e,t){var n=e.scope,r=e.changer,a=e.lambda,o=e.name,i=e.localHook,a=r?f(U(r)):a?f(G(a)):"<em>enchanted with ("+o+":)</em>";return t||I('<div class="enchantment-row">').data("enchantment",e).append("<td><span class='enchantment-name'>"+G(n)+(i?"</span><span class='enchantment-local cm-harlowe-3-hookName'>"+("function"==typeof i.TwineScript_ToSource?i.TwineScript_ToSource():i.attr("name")?"?"+i.attr("name"):"an unnamed hook"):"")+"</span></td><td class='enchantment-value cm-harlowe-3-macroName-"+(r?"changer":"command")+" '>"+a+"</td>"+(r?"<td class='panel-row-buttons'><tw-folddown tabindex=0>(source:)</tw-folddown></td>":"")).find("tw-folddown").data("folddown",g).end().add(r?I("<tr class='panel-row-source' style='display:none'><td colspan='3'></td></tr>"):"")},rowCheck:function(e,t){return t.data("enchantment")===e},columnHead:function(){return'<tr class="panel-head"><th data-col="enchantment-name">Scope</th><th data-col="enchantment-value">Value</th></div>'}})),d=l(function(e){x.update(e.enchantments,e.enchantments.length)}),O=(q.on("add",d).on("remove",d),q.create()),A=W.create({className:"storylets",tabName:"Storylet",rowWrite:function(e,t){var n=e.name,r=e.active,a=e.storyletSource,o=e.exclusive,e=e.urgent;return t?(t.toggleClass("storylet-closed",!r),t[0].firstChild.textContent=r?"\u2713":""):(t=I('<tr class="storylet-row '.concat(r?"":"storylet-closed",'">')).attr("data-name",n).append("<td class='storylet-open'>"+(r?"\u2713":"")+"</td><td class='storylet-name'>"+n+"</td><td class='storylet-lambda'></td><td class='storylet-exclusive'>"+o+"</td><td class='storylet-urgent'>"+e+"</td>")).find(".storylet-lambda").append(B(a.replace(/^when\s+/i,""))),t},rowCheck:function(e,t){e=e.name;return t[0].getAttribute("data-name")===f(e+"")},columnHead:function(){return'<tr class="panel-head"><th data-col="storylet-open" data-order="desc">Open</th><th data-col="storylet-name">Name</th><th data-col="storylet-lambda">Condition</th><th data-col="storylet-exclusive" class=\'storylet-exclusive\'>Exclusivity</th><th data-col="storylet-urgent" class=\'storylet-urgent\'>Urgency</th></tr>'}}),C=(A.tab.hide(),v=l(function(){var r,a,o=z.getStorylets(O),i=H.containsError(o),e=z.allStorylets();A.update(e.map(function(t){var e="number"==typeof t.get("exclusivity")?t.get("exclusivity"):0,n="number"==typeof t.get("urgency")?t.get("urgency"):0;return r=r||e,a=a||e,{name:t.get("name"),storyletSource:t.get("storylet").TwineScript_ToSource(),active:!i&&o.some(function(e){return e.get("name")===t.get("name")}),exclusive:e,urgent:n}}),i?0:o.length),A.panel.toggleClass("storylet-error",i),A.panel.toggleClass("panel-exclusive",r),A.panel.toggleClass("panel-urgent",a),e.length&&A.tab.show()}),W.create({className:"source",tabName:"Source",tabNameCounter:!1,rowWrite:function(e,t){var n=e.name,e=e.tag;return t?t.add(t.next(".panel-row-source")):(t=z.get(n).get("source"),I('<div class="source-row" data-tag="'.concat(e,'">')).data("value",t).append('<td class="source-name">'.concat(n,'</td><td class="source-tags">').concat(e,"</td><td class='panel-row-buttons'><tw-folddown class='").concat(e?"":"open","' tabindex=0></tw-folddown></td>")).find("tw-folddown").data("folddown",g).end().add(I("<tr class='panel-row-source' style='".concat(e?"display:none":"","'><td colspan='3'></td></tr>")).find("td").append(!e&&B(t,"markup")).end()))},rowCheck:function(e,t){e=e.name;return t[0].firstChild.textContent===f(e+"")},tabUpdate:I.noop,columnHead:I.noop})),E=["debug-startup","startup","header","debug-header","footer","debug-footer"].reduce(function(e,t){return e.concat(z.getTagged(t).map(function(e){return{name:e.get("name"),tag:t}}))},[]),N=W.create({className:"errors",tabName:"Error",rowWrite:I.noop,rowCheck:I.noop,columnHead:I.noop,tabUpdate:function(e){return N.tab.css({background:e?"rgba(230,101,204,0.3)":""}).text("".concat(e," Error").concat(1!==e?"s":""))}}),d=n(function(e){var t;V.options.debug&&(N.panelRows.append(e.reduce(function(e,t){var t=_slicedToArray(t,2),n=t[0],t=t[1];return"propagated"===n.type?e:e+'<tr class="error-row"><td class="error-passage">'+D.passage+'</td><td class="error-message" title="'+f(t)+'">'+n.message+"</td></tr>"},"")),500<(t=(e=N.panelRows.children()).length)&&I(Array.prototype.slice.call(N.panelRows[0].childNodes,0,t-500)).remove(),N.tabUpdate(Math.min(500,e.length)))},{batch:!0}),j=(H.on(d),N.panel.append("<div class='panel-errors-bottom'>\n\t\t\t<button class='panel-errors-clean'>\ud83e\uddf9 Clear this panel</button>\n\t\t</div>"),r.on("click",".panel-errors-clean",function(){N.panelRows.empty(),N.tabUpdate(0)}),W.create({className:"tools",tabName:"Tools",tabNameCounter:!1,rowWrite:function(e,t){var n=e.id,r=e.type,a=e.label,o=e.dropdownItems,i=e.dropdownValue;return"checkbox"===r?t?t.find("input").prop("checked",!1):I('<span><input id="debug-'.concat(n,'" type="checkbox"></input><label for="debug-').concat(n,'">').concat(a,"</label></span>")):"dropdown"===r?t?t.find("input").prop("checked",!1):I("<span>".concat(a,'<select style="width:3em" data-default="').concat(i,'" id="debug-').concat(n,'"></span>')).find("select").append(o.map(function(e){return"<option value='".concat(e,"' ").concat(e===i?"selected":"",">").concat(e,"x</option>")})).end():void 0},rowCheck:I.noop,columnHead:I.noop,tabUpdate:function(e){return j.tab.css({background:e?"hsla(210, 72%, 65%, .3)":""})}})),P=(r.on("click, change",'.panel-tools [type="checkbox"], .panel-tools select',function(e){var e=e.target,t=(e=I(e)).attr("id"),n=e.is(":checked")||e.is("select")&&e.val()!==+e.attr("data-default");"debug-peekBehindDialogs"===t&&r.toggleClass("debug-dialogs",n),"debug-ignoreClickEvents"===t&&(V.options.ignoreClickEvents=n),"debug-ignoreGotos"===t&&(V.options.ignoreGotos=n),"debug-speedMultiplier"===t&&(V.options.speedMultiplier=+e.val()),j.tabUpdate(n)}),j.update([{id:"peekBehindDialogs",type:"checkbox",label:"See through and click through <code>(dialog:)</code> boxes"},{id:"ignoreClickEvents",type:"checkbox",label:"Stop links, <code>(click:)</code> and <code>(hover-style:)</code> from activating"},{id:"ignoreGotos",type:"checkbox",label:"Stop <code>(go-to:)</code>, <code>(undo:)</code>, <code>(redirect:)</code> and <code>(restart:)</code> from activating<br><small>(Click 'GO' buttons in Debug View to activate later)</small>"},{id:"speedMultiplier",label:"Speed of timed events (<code>time</code>, <code>(live:)</code>, <code>(after:)</code>): ",type:"dropdown",dropdownValue:1,dropdownItems:[.25,.5,.75,1,1.25,1.5,1.75,2,3,5,10]}]),W.create({className:"options",tabName:"\u2699\ufe0f",tabNameCounter:!1,rowWrite:function(e,t){var n=e.name,e=e.label,r={darkMode:o.darkMode,fadePanel:o.fadePanel,evalReplay:o.evalReplay}[n];return t?t.find("input").prop("checked",r):I('<span><input id="debug-'.concat(n,'" type="checkbox" ').concat(r?"checked":"",'></input><label for="debug-').concat(n,'">').concat(e,"</label></span>"))},rowCheck:I.noop,tabUpdate:I.noop,columnHead:I.noop})),R=(r.on("click",'.panel-options [type="checkbox"]',function(e){var e=e.target,t=(e=I(e)).attr("id"),e=e.is(":checked");"debug-darkMode"===t&&(o.darkMode=e,h.toggleClass("theme-dark",e)),"debug-fadePanel"===t&&(o.fadePanel=e,h.toggleClass("fade-panel",e)),"debug-evalReplay"===t&&(V.options.evalReplay=o.evalReplay=e),c()}),P.update([{name:"darkMode",label:"Debug panel is dark"},{name:"fadePanel",label:"Debug panel is transparent unless the cursor is over it"},{name:"evalReplay",label:"Record expression replays (viewable via \ud83d\udd0d buttons in Debug View; slower)"}]),h.prepend(S.panel,x.panel,N.panel,A.panel,C.panel,j.panel,P.panel),s.prepend(S.tab,x.tab,N.tab,A.tab,C.tab,j.tab,P.tab),D.on("beforeForward",y).on("beforeBack",y).on("beforeLoad",y),l(function(){T(),v(),x.panelRows.empty(),x.tabUpdate(0),D.passage&&z.get(D.passage)&&(C.update(E.concat({name:D.passage,tag:""})),C.panel.find('[data-tag=""], [data-tag=""] + .panel-row-source').insertBefore(C.panel.find('[data-tag="footer"]').first()))}));D.on("forward",R).on("back",R).on("load",R);K=b,I(document.head).append(I("<style>").html(X)),b(),e&&d(e,t)};return F.registerDebugMode(function(e,t){return!V.options.debug&&K(e,t)}),K}),define("debugmode/panel",["jquery","utils/naturalsort"],function(d,e){var i=e();return Object.seal({create:function(e){var n,t=e.className,r=e.rowWrite,a=e.rowCheck,o=e.rowSort,i=e.columnHead,s=e.tabName,c=e.tabNameCounter,l=void 0===c||c,c=e.tabUpdate,u=d("<div class='panel panel-".concat(t,"' style='").concat(this.defaultMaxHeight?"max-height:"+this.defaultMaxHeight+"px":"","' hidden><div class=\"resizer-v\"></div><table class='panel-rows'></table></div>")),p=d("<button class='tab tab-".concat(t,"'>").concat(l?"0 ".concat(s,"s"):s,"</button>"));return p.click(function(){p.toggleClass("enabled"),p.parent().siblings(".panel").attr("hidden",""),p.is(".enabled")&&(p.siblings(".tab:not(.tab-"+t+")").removeClass("enabled"),u.removeAttr("hidden"))}),u.on("click","th",function(e){var e=e.target,t="desc"===(e=d(e)).attr("data-order")?"asc":"desc";n.sort(e.attr("data-col"),t),u.find("th[data-order]").removeAttr("data-order"),e.attr("data-order",t)}),c=c||function(e){return p.text(l?"".concat(e," ").concat(s).concat(1!==e?"s":""):s)},n=Object.assign(Object.create(this),{tabName:s,tab:p,panel:u,panelRows:u.find(".panel-rows"),rowWrite:r,rowSort:o,rowCheck:a,columnHead:i,tabUpdate:c})},sort:function(r,a){var o=this;this.panelRows.children(":not(.panel-head, .panel-row-source)").get().sort(function(e,t){var n;return"desc"===a&&(e=(n=[t,e])[0],t=n[1]),e=e.querySelector("."+r),t=t.querySelector("."+r),o.rowSort&&o.rowSort(r,d(e),d(t))||i(e.textContent,t.textContent)}).forEach(function(e){var t=d(e).next(".panel-row-source").get();o.panelRows.append(e,t)})},update:function(e,t){var r=this.rowCheck,a=this.rowWrite,o=this.panelRows,n=this.columnHead,i=this.panel,s=[],c=o.children(),e=(e.forEach(function(t){var e=c.get().filter(function(e){return r(t,d(e))}),n=a(t,e.length&&d(e));e.length||o.append(n),s.push.apply(s,_toConsumableArray(n.get()))}),c.filter(function(e,t){return!s.includes(t)&&!t.className.includes("panel-head")}).remove(),this.tabUpdate(t),0<t&&!o.find(".panel-head").length?o.prepend(n()):0===t&&o.find(".panel-head").remove(),i.find("th[data-order]"));e.length&&this.sort(e.attr("data-col"),e.attr("data-order"))},defaultMaxHeight:300})}),define("internaltypes/changedescriptor",["jquery","utils","renderer","datatypes/hookset","internaltypes/twineerror"],function(b,e,t,v,n){function w(e){return("string"==typeof e?e:e.map(function(e){return e.text}).join("")).split(/\n/g).reduce(function(e,t,n,r){r=r.length;return e.concat(document.createTextNode(t),n!==r-1&&document.createElement(t.length?"br":"tw-consecutive-br"))},[])}var k=e.impossible,S=e.transitionIn,T=t.exec,r=Object.assign,p=Object.keys,a=Object.create,e=Object.seal,_=Array.isArray,x={source:"",appendSource:null,enabled:!0,enablers:null,verbatim:!1,target:null,append:"",newTargets:null,transition:"",transitionTime:null,transitionDeferred:!1,transitionDelay:0,transitionSkip:0,transitionOrigin:null,loopVars:null,styles:null,attr:null,data:null,innerEnchantments:null,section:null,timestamp:0,output:!1,summary:function(){var t=this;return["source","appendSource","enabled","verbatim","target","append","newTargets","transition","transitionTime","transitionDeferred","transitionDelay","transitionSkip","transitionOrigin","innerEnchantments","enablers","output"].filter(function(e){return hasOwnProperty.call(t,e)}).concat([this.attr.length&&"attr",this.styles.length&&"styles",p(this.loopVars).length&&"loopVars",p(this.data).length&&"data"].filter(Boolean))},create:function(e,t){e=r(a(this),{attr:this.attr?this.attr.slice():[],styles:this.styles?this.styles.slice():[],loopVars:this.loopVars||{},data:this.data||{}},e);if(t){t=t.run(e);if(n.containsError(t))return t}return e},update:function(){function e(t){var e,n,r;_(a.styles)&&0<a.styles.length&&(n=(e=_slicedToArray(a.styles.reduce(function(n,r){return p(r).forEach(function(e){var t=r[e];n[+("function"==typeof t)].push(_defineProperty({},e,t))}),n},[[],[]]),2))[0],r=e[1],n.forEach(function(e){return t.css(e)}),setTimeout(function(){r.forEach(function(e){return t.css(e)})})),a.attr&&a.attr.forEach(function(e){return t.attr(e)}),a.data&&t.data(a.data)}var a=this,t=this.section,n=this.newTargets,r=this.transition,o=this.transitionDeferred,i=this.append,s=this.target;"function"==typeof s&&(s=s());if(_(n)&&n.length&&(s=n.map(function(e){return e.target})),_(s))for(var c=0;c<s.length;c+=1)v.isPrototypeOf(s[c])?s[c].forEach(t,e):e(s[c]);else v.isPrototypeOf(s)?s.forEach(t,e):e(s);if(r&&!o&&!i){for(var l,u=s;(l=u.data("timestamp"))||(u=u.parent()),!l&&u.length;);S(s,r,this.transitionTime,this.transitionDelay,this.transitionSkip,l?Date.now()-l:0,this.transitionOrigin)}},render:function(){var e,r=this,t=this.source,n=this.transition,a=this.transitionTime,o=this.transitionDeferred,i=this.enabled,s=this.enablers,c=this.data,l=this.section,u=this.newTargets,p=this.innerEnchantments,d=this.appendSource,f=this.output,h=this.target,m=this.target,g=this.append;if("function"==typeof h&&(h=h()),!g)return k("ChangeDescriptor.render","This doesn't have an 'append' method chosen."),b();if(f)return b();if(null!=s&&s.length)return s=(f=s[0]).descriptor,f=f.changer,s=s.render(),f&&(e=x.create({section:l,target:s}),f.run(e),e.update()),s;if(!i||void 0!==h.attr("hidden"))return x.create({target:h,attr:this.attr.filter(function(e){return!("style"in e)}),data:_objectSpread(_objectSpread({},c),{},{originalSource:t,hidden:!0})}).update(),b();if(!(h=_(u)&&u.length?u:h))return k("ChangeDescriptor.render","ChangeDescriptor has source but not a target!"),b();var y=b();if([].concat(h).filter(function(e){return!e.jquery}).map(function(e){var t,n,r=g;return e.target&&e.append&&(r=(t=e).append,n=t.before,e=e.target),{elements:e.hooks(l,m).filter(function(){return!(n&&1&this.compareDocumentPosition(document)&&2&this.compareDocumentPosition(m[0]))}),append:r}},[]).forEach(function(e){var t=e.elements,n=e.append;t.each(function(e,t){t=b(t),y=y.add(r.create({target:t,append:n,newTargets:null}).render()),t.filter("tw-pseudo-hook").contents().unwrap()})}),!(y.length||_(h)||v.isPrototypeOf(h))){f=g;if(!(f in h)){if("replace"!==f)return k("ChangeDescriptor.render","The target doesn't have a '"+f+"' method."),b();f=h[0]instanceof Text?"replaceWith":(h.empty(),"append")}h[0]instanceof Text&&"prepend"===(f="append"===f?"after":f)&&(f="before"),y=b(t&&(this.verbatim?w:T)(t)),_(d)&&d.forEach(function(e){var t=e.source,e=e.append,t=b((r.verbatim?w:T)(t));y="append"===e?y.add(t):"prepend"===e?t.add(y):t}),h[f](y.length?y:void 0),h.data("timestamp",Date.now()),this.update(),n&&!o&&S("replace"===g?h:y,n,a,this.transitionDelay,this.transitionSkip,this.expedite,this.transitionOrigin),p&&p.map(function(e){return e(h)}).forEach(function(e){return l.addEnchantment(e)})}return y}};return e(x)}),define("internaltypes/enchantment",["jquery","utils","internaltypes/changedescriptor","datatypes/changercommand","utils/operationutils","internaltypes/twineerror","utils/renderutils"],function(g,y,b,v,e,w,t){var k=e.objectName,S=e.toSource,T=t.collapse;return Object.freeze({create:function(e){return Object.assign(Object.create(this),{enchantments:g()},e)},enchantScope:function(){var i=this,s=this.attr,c=this.data,l=this.functions,u=this.section,p=this.scope,d=this.localHook,f=this.lambda,h=[],m=0;p.forEach(u,function(e,t){if(d){d=d.jquery?d:d.hooks(u);var n=e.find(d);if(n.length)e=n;else if(!d.has(e[0]).length)return}var r,a,o;(!e.is(":empty")||e.data("source")&&e.data("source").length)&&(m+=1,f?(o=f.apply(u,{loop:p.TwineScript_GetProperty(t),pos:m}),w.containsError(o)?(e.replaceWith(o.render()),f=o=null):v.isPrototypeOf(o)?o.canEnchant||(e.replaceWith(w.create("macrocall",'The lambda "'.concat(S(f),"\" can't be or include a revision, enchantment, or interaction changer like (replace:), (click:), or (link:).")).render()),f=o=null):(e.replaceWith(w.create("macrocall",'The lambda "'.concat(S(f),'" must return a changer, not ').concat(k(o),".")).render()),f=o=null)):o=i.changer,n=!s&&!c&&(!o||o.summary().every(function(e){return e.startsWith("transition")})),r=n?e:e.wrap("<tw-enchantment>").parent(),s&&r.attr(s),c&&r.data(c),l&&l.forEach(function(e){return e(r)}),o&&(t=b.create({section:u,target:r}),o.run(t),t.update(),e.is(y.storyElement)?(a=Object.keys(Object.assign.apply(Object,[{}].concat(_toConsumableArray(t.styles)))),e.css(a.reduce(function(e,t){return"background-color"===t||"background-image"===t?(e["background-color"]="transparent",e["background-image"]="none",a.push("background-".concat("background-color"===t?"image":"color"))):e[t]="inherit",e},{})),r.data({enchantedProperties:a})):e.is("tw-passage")&&t.styles.some(function(e){return"margin-left"in e||"margin"in e||"margin-right"in e})&&(o="padding-right",y.storyElement.css(t="padding-left","0px").css(o,"0px"),r.data({enchantedProperties:[t,o]}))),e.is(y.storyElement)&&r.css({"min-width":"100%","min-height":"100%"}),"true"===r.attr("collapsing")&&(r.find("[collapsing=false]").each(function(){g(this).removeAttr("collapsing")}),T(r)),n||h.push(r))}),this.enchantments=g(h)},disenchant:function(){this.enchantments.each(function(e,t){(t=g(t)).contents().unwrap();t=t.data("enchantedProperties");t&&y.storyElement.css(t.reduce(function(e,t){return e[t]="",e},{}))})}})}),define("internaltypes/twineerror",["jquery","utils"],function(i,s){var a=s.impossible,c=s.escape,l=(i(document.documentElement).on("click","tw-folddown",function(e){var t=e.target,e=((t=i(t)).toggleClass("open"),t.popData("folddown"));for("function"==typeof e&&e(t);t&&!t.next().length;)t=t.parent();null!=(e=t)&&e.next().toggle()}),{syntax:"The markup seems to contain a mistake.",saving:"I tried to save or load the game, but I couldn't do it.",operation:"I tried to perform an operation on some data, but the data's type was incorrect.",macrocall:"I tried to use a macro, but its call wasn't written correctly.",datatype:"I tried to use a macro, but was given the wrong type of data to it.",custommacro:"I tried to use a custom macro, but its code hook had a mistake in it.",infinite:"I almost ended up doing the same thing over and over, forever.",property:"I tried to access a value in a string/array/datamap, but I couldn't find it.",unimplemented:"I currently don't have this particular feature. I'm sorry.",propagated:"Click the 'Open' button to see the code hook as it was executed.",user:"This is a custom error created by (error:). It usually means you used a custom macro incorrectly.",assertion:"This command exists to provide a helpful error if a certain important condition wasn't true.",debugonly:"This macro is not meant to be used outside of debugging your story."}),u=[],n={TwineError:!0,create:function(e,t,n,r){return t&&"string"==typeof t||a("TwineError.create","has a bad message string"),n||e in l||a("TwineError.create","no error explanation given"),"user"!==e&&(t=t[0].toUpperCase()+t.slice(1)),Object.assign(Object.create(this),{type:e,message:t,explanation:n,source:void 0,innerDOM:r,appendTitleText:!1})},containsError:function(){for(var e=0;e<arguments.length;e+=1){var t=arguments[e];if(n.isPrototypeOf(t))return t;if(Array.isArray(t)){t=n.containsError.apply(n,t);if(t)return t}}return!1},createWarning:function(e,t){return Object.assign(this.create(e,t),{warning:!0})},render:function(t){var n=this,e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=(t="string"==typeof t?t:this.source||"",i("<tw-error class='"+(this.warning?"warning":"error")+"' title='"+c(t)+"'>"+c(this.message+(this.appendTitleText?" "+t:""))+"</tw-error>")),a=i("<tw-error-explanation>").text(this.explanation||l[this.type]).hide(),o=i("<tw-folddown tabindex=0>");return this.innerDOM&&i("<tw-open-button label='Open'>").on("click",function(){var e=i("<tw-backdrop><tw-dialog></tw-backdrop>");e.find("tw-dialog").prepend(n.innerDOM,i("<tw-link tabindex=0>OK</tw-link>").on("click",function(){n.innerDOM.detach(),e.remove()}).wrap("<tw-dialog-links>").parent()),s.storyElement.prepend(e)}).appendTo(r),r.append(o).append(a),r.data("TwineError",this),e||u.forEach(function(e){return e(n,t)}),r},on:function(e){return"function"!=typeof e||u.includes(e)||u.push(e),n}};return Object.preventExtensions(n)}),define("internaltypes/twinenotifier",["jquery","utils"],function(e,t){var n=t.impossible,r={create:function(e){return e||n("TwineNotifier.create","called with only 1 string."),Object.assign(Object.create(r),{message:e})},render:function(){return e("<tw-notifier>").attr("message",this.message)}};return Object.preventExtensions(r)}),define("internaltypes/varref",["state","internaltypes/twineerror","utils","utils/operationutils","datatypes/hookset"],function(u,p,e,t,i){var c,n=e.impossible,s=e.andList,r=e.nth,o=t.is,d=t.isObject,f=t.toSource,h=t.isSequential,m=t.objectName,l=t.typeName,g=t.clone,y=t.isValidDatamapName,b=t.subset,v=t.collectionType,w=t.unstorableValue,a=t.matches,k=Array.isArray,S={set:[],delete:[]},T="You can only access position strings/numbers ('4th', 'last', '2ndlast', (2), etc.), slices ('1stTo2ndlast', '3rdTo5th'), ",_="You can't access the '0th' or '0thlast' position of ";function x(e,t){if(p.containsError(t))return n;if(e instanceof Map&&(n=p.containsError(y(e,t))))return n;if(h(e))if("number"==typeof t){if(0===t)return p.create("property","You can't access elements at position 0 of ".concat(m(e),"."),"Only positive and negative position values exist.");0<t&&--t}else if("string"==typeof t&&(r=/^(\d+)(?:st|[nr]d|th)last$/i.exec(t))){if("0"===r[1])return p.create("property",_+m(e)+".");t=-r[1]}else if("string"==typeof t&&(r=/^(\d+)(?:st|[nr]d|th)$/i.exec(t))){if("0"===r[1])return p.create("property",_+m(e)+".");t=r[1]-1}else if("string"==typeof t&&(r=/^(?:(\d+)(?:st|[nr]d|th)(last)?|last)to(?:(\d+)(?:st|[nr]d|th)(last)?|last)$/i.exec(t))){var n=_slicedToArray(r,5),r=n[1],r=void 0===r?0:r,a=n[2],o=n[3],o=void 0===o?0:o;t={last:n[4]?-o:o-1,first:a?-r:r-1}}else if("last"===t)t=-1;else if("random"===t){if(!e.length)return p.create("property","I can't get a random value from ".concat(m(e),", because it's empty."));t=u.random()*Array.from(e).length|0}else{if(i.isPrototypeOf(e)&&!i.TwineScript_Properties.includes(t))return p.create("property","".concat(T+s(i.TwineScript_Properties.map(function(e){return"'"+e+"'"}))," of ").concat(m(e),", not ").concat(("string"==typeof t?f:m)(t),"."));if(!["length","some","any","all","start","end","random"].includes(t)&&!i.isPrototypeOf(e))return p.create("property","".concat(T,"'length', 'some', 'any', 'all', 'start', 'end', and 'random' of ").concat(m(e),", not ").concat(("string"==typeof t?f:m)(t),"."))}else if(e instanceof Set){if(!["length","some","any","all"].includes(t))return p.create("property","".concat(T,"'length', 'some', 'any', and 'all' of ").concat(m(e),"."),"You can't access specific individual data values from datasets.");"length"===t&&(t="size")}else{if(k(e.TwineScript_Properties)&&!e.TwineScript_Properties.includes(t))return p.create("property","You can only get the ".concat(s(e.TwineScript_Properties.map(function(e){return"'"+e+"'"}))," of ").concat(m(e),", not ").concat(("string"==typeof t?f:m)(t),"."));if("number"==typeof e||"boolean"==typeof e)return p.create("property","You can't get any data values, let alone ".concat(m(t),", from ").concat(m(e)))}return t}function O(e,t){return+t<0&&Math.abs(t)<=e.length?e.length+ +t:t}var A=/[^\uD801-\uDFFF]/,C=new Map;function E(e,t){var n,r,a;return void 0===e?e:e instanceof Map?e.get(t):"some"!==t&&"any"!==t&&"all"!==t&&"start"!==t&&"end"!==t||e.TwineScript_VariableStore?("string"==typeof e&&(C.has(e)?e=C.get(e):A.test(e)?(a=_toConsumableArray(e),C.set(e,a),e=a):C.set(e,e)),h(e)&&Number.isFinite(t)&&(t=O(e,t)),e.TwineScript_GetProperty?e.TwineScript_GetProperty(t):"function"!=typeof(a=e[t])?a:void 0):(n=e,r=t,a='"'.concat(r," value").concat("any"===r?"":"s",'" of '),{determiner:r,determined:n,array:_toConsumableArray(n),string:"string"==typeof n&&n,TwineScript_ObjectName:a+m(n),TwineScript_ToSource:function(){return"".concat(r," of ").concat(f(n))},TwineScript_TypeName:a+"a data structure",TwineScript_Unstorable:!0,TwineScript_Print:function(){return"`["+this.TwineScript_TypeName+"]`"}})}function N(e){var t;return e.computed?(t=e.value,"string"==typeof(t=c.isPrototypeOf(t)?t.get():t)?"('"+t+"')":"("+t+")"):"number"==typeof e?r(e):"'"+e+"'"}function j(t,e,n){if(t.TwineScript_VariableStore){if(t.TwineScript_TypeDefs&&e in t.TwineScript_TypeDefs){var r=t.TwineScript_TypeDefs[e];if("const"===r.name){if(void 0!==t[e])return p.create("operation","I can't alter ".concat(t===u.variables?"$":"_").concat(e," because it's been restricted to a constant value."),"This variable can't be changed for the rest of the story.")}else if(!a(r,n))return p.create("operation","I can't set ".concat(t===u.variables?"$":"_").concat(e," to ").concat(l(n)," because it's been restricted to ").concat(f(r),"-type data."),"You can restrict a variable or data name by giving a typed variable to (set:) or (put:).")}return!0}return k(e)?e.map(function(e){return j(t,e)}):t instanceof Map?"string"==typeof e||p.create("operation","".concat(m(t)," can only have string data names, not ").concat(m(e),".")):h(t)?["length","random","some","any","all","start","end"].includes(e)?p.create("operation","I can't forcibly alter the '"+e+"' of "+m(t)+".","start"===e||"end"===e?"Alter the values at actual positions, like 1st or 2ndlast, rather than just the '"+e+"'.":void 0):+e==(0|e)||p.create("property",m(t)+" can only have position keys ('3rd', '1st', (5), etc.), not "+N(e)+"."):t.TwineScript_Identifiers&&e in t?p.create("keyword","I can't alter the value of the '"+e+"' identifier.","You can only alter data in variables, not fixed identifiers."):p.create("operation","I can't modify "+m(t),t instanceof Set?"You should use an (array:) if you need to modify the data inside this dataset.":i.isPrototypeOf(t)?"You should alter hooks indirectly using macros like (replace:) or (enchant:).":void 0)}function P(t,e,n,r){var a=e;t instanceof Map?t.set(e,n):(h(t)&&(e=O(t,e)),t.TwineScript_Set?t.TwineScript_Set(e,n,r):t[e]=n),S.set.forEach(function(e){return e(t,a,n)})}function R(t,e){var n=e;h(t)&&(e=O(t,e)),k(t)&&/^(?:[1-9]\d*|0)$/.exec(e)?t.splice(e,1):t instanceof Map||t instanceof Set?t.delete(e):t.TwineScript_Delete?t.TwineScript_Delete(e):delete t[e],S.delete.forEach(function(e){return e(t,n)})}function I(t,e){var n,r,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:e,o=3<arguments.length&&void 0!==arguments[3]&&arguments[3];return e&&"object"===_typeof(e)&&"last"in e&&"first"in e?i.isPrototypeOf(t)?t.TwineScript_GetProperty(e):(n=e.first,r=e.last,b(t,n+(0<=n),r+(0<=r))):k(e)?i.isPrototypeOf(t)?t.TwineScript_GetProperty(e):e.map(function(e){return I(t,e,e)})["string"==typeof t?"join":"valueOf"](""):void 0!==(n=E(t,e))||o?n:t===u.variables?0:"temp"===(null==(r=t.TwineScript_VariableStore)?void 0:r.type)?p.create("property","There isn't a temp variable named _".concat(a," in this place."),"Temp variables only exist inside the same passage, hook, or lambda in which they're created."):k(t)&&"number"==typeof e?p.create("property","This array of ".concat(t.length," elements doesn't have a ").concat(N(a+("number"==typeof a?1:""))," element."),t.length?"It contains: ".concat(s(t.map(m)),"."):"The array is empty."):(o=Array.from("function"==typeof t.keys&&t.keys()),p.create("property","I can't find a ".concat(N(a)," data name in ").concat(m(t)),t instanceof Map&&o.length?"Its names include: ".concat(s(o),"."):void 0))}function V(e,t){var r=this,e=this.compiledPropertyChain.reduce(function(e,t){var n=0===e.length?r.object:I.apply(void 0,_toConsumableArray(e[e.length-1]));return e.push([n,t])&&e},[]).reduceRight(e,t);return p.containsError(e)?e:void 0}return c=Object.freeze({get:function(){for(var e=this.object,t=0;t<this.compiledPropertyChain.length-1;t+=1)if(e=I(e,this.compiledPropertyChain[t]),p.containsError(e))return e;return I(e,this.compiledPropertyChain.slice(-1)[0],this.propertyChain.slice(-1)[0])},has:function(){for(var e=this.object,t=0;t<this.compiledPropertyChain.length-1;t+=1)if(void 0===(e=I(e,this.compiledPropertyChain[t],void 0,!0))||p.containsError(e))return!1;return void 0!==I(e,this.compiledPropertyChain.slice(-1)[0],void 0,!0)},set:function(e,c){var l=this;return!this.object||this.object.TwineScript_VariableStore||this.object.TwineScript_Identifiers?V.call(this,function(n,e,t){var e=_slicedToArray(e,2),r=e[0],a=e[1];if(e=p.containsError(n,r,a)||p.containsError(j(r,a,n)))return e;if(e=w(n))return p.create("operation","".concat(m(n)," can't be stored").concat(!n.TwineScript_Unstorable&&v(n)?" because it holds ".concat(m(e)):"","."));if(0<t)r=g(r);else if("temp"===(null==(e=r.TwineScript_VariableStore)?void 0:e.type)&&r!==u.variables){for(var o=r;"temp"===(null==(i=o.TwineScript_VariableStore)?void 0:i.type)&&!hasOwnProperty.call(o,a);)var i,o=Object.getPrototypeOf(o);"temp"===(null==(t=o.TwineScript_VariableStore)?void 0:t.type)&&(r=o)}if("string"==typeof r){if("string"!=typeof n)return p.create("datatype","I can't put this non-string value, ".concat(m(n),", in a string."));if(n.length!==(k(a)?a.length:1))return p.create("datatype","".concat(m(n),"is not the right length to fit into this string location."));var r=_toConsumableArray(r),s=_toConsumableArray(n);[].concat(a).forEach(function(e){0+e<0&&(e=r.length+(0+e)),r=[].concat(_toConsumableArray(r.slice(0,e)),[s.shift()],_toConsumableArray(r.slice(e+1)))}),r=r.join("")}else d(r)&&(void 0!==n.TwineScript_KnownName&&((n=""!==n.TwineScript_KnownName?g(n):n).TwineScript_KnownName=f(l)),k(a)&&h(n)?("string"==typeof n&&(n=_toConsumableArray(n)),a.map(function(e,t){return[e,n[t]]}).forEach(function(e){var e=_slicedToArray(e,2),t=e[0],e=e[1];return P(r,t,e,c)})):P(r,a,n,c));return r},e):p.create("macrocall","I can't (set:) ".concat(m(this),", if the ").concat((m(this.object).match(/ (.+$)/)||["","value"])[1]," isn't stored in a variable."),"Modifying data structures that aren't in variables won't change the game state at all.")},delete:function(){return V.call(this,function(e,t,n){var r,t=_slicedToArray(t,2),a=t[0],t=t[1];return(r=p.containsError(e,a,t)||p.containsError(j(a,t)))||(0<n&&(a=g(a)),null===e?((r="string"==typeof a)&&(a=_toConsumableArray(a)),k(t)?(h(a)&&(t=_toConsumableArray(new Set(t))).sort(function(e,t){return O(a,t)-O(a,e)}),t.forEach(function(e){return R(a,e)})):R(a,t),r&&(a=a.join(""))):P(a,t,e,!1),a)},null)},defineType:function(e){var t=this.object,n=this.compiledPropertyChain[0],r=(hasOwnProperty.call(t,"TwineScript_TypeDefs")||(t.TwineScript_TypeDefs=Object.create(t.TwineScript_TypeDefs||null)),t.TwineScript_TypeDefs),a=r[n];if(a&&!o(a,e))return p.create("operation","I can't redefine the type of "+m(this)+" to "+(e.TwineScript_ObjectName||l(e))+", as it is already "+(a.TwineScript_ObjectName||l(a))+".");t.TwineScript_DefineType?t.TwineScript_DefineType(n,e):r[n]=e,"const"===e.name&&(t[n]=void 0)},matches:function(e,t){return this.object===e&&this.compiledPropertyChain[0]===t},getName:function(){return this.compiledPropertyChain[0]},create:function(e,t){var n;if(n=p.containsError(e))return n;Array.isArray(t)||(t=[].concat(t)),c.isPrototypeOf(e)&&(t=e.propertyChain.concat(t),e=e.object);var r=function(e,t){for(var n,r=[],a=0;a<t.length;a+=1){var o=t[a];if(o.computed&&(o=o.value),c.isPrototypeOf(o)&&(o=o.get()),k(o)){for(var i=[],s=0;s<o.length;s+=1)i[s]=x(e,o[s]);o=i}else o=x(e,o);if(n=p.containsError(o))return n;a<t.length-1&&(e=I(e,o)),r.push(o)}return r}(e,t);return(n=p.containsError(r))||Object.assign(Object.create(c),{object:e,propertyChain:t,compiledPropertyChain:r})},TwineScript_ToSource:function(){function r(e,t){return!t&&n.object.TwineScript_VariableStore?e:N(e)}var e,n=this;return(this.object===u.variables?"$":"temp"===(null==(e=this.object.TwineScript_VariableStore)?void 0:e.type)?"_":f(this.object)+"'s ")+(1===this.propertyChain.length?r(this.propertyChain[0]):this.propertyChain.reduce(function(e,t,n){return e+"'s "+r(t,n)}))},get TwineScript_ObjectName(){var e;return this.object.TwineScript_VariableStore?"the ".concat("temp"===(null==(e=this.object.TwineScript_VariableStore)?void 0:e.type)?"temp ":"","variable ").concat(this.TwineScript_ToSource()):m(this.object)+"'s "+(1===this.propertyChain.length?N(this.propertyChain[0]):this.propertyChain.reduce(function(e,t,n){return e+"'s "+N(t)}))},on:function(e,t){if(e in S)return"function"!=typeof t||S[e].includes(t)||S[e].push(t),c;n("VarRef.on","invalid event name")}})}),define("internaltypes/varscope",[],function(){return Object.seal({TwineScript_ObjectName:"the temporary variables",TwineScript_VariableStore:{type:"temp",name:"an unknown scope"},TwineScript_TypeDefs:Object.create(null)})}),define("macrolib/commands",["jquery","macros","utils","state","passages","engine","internaltypes/twineerror","internaltypes/twinenotifier","datatypes/assignmentrequest","datatypes/hookset","datatypes/codehook","datatypes/colour","datatypes/gradient","internaltypes/varref","datatypes/typedvar","datatypes/varbind","utils/operationutils","utils/renderutils"],function(u,n,b,c,l,a,y,M,e,o,t,p,d,i,s,v,r,f){var h=r.printBuiltinValue,m=r.objectName,g=r.clone,w=r.toSource,k=f.dialog,S=f.geomParse,D=f.geomStringRegExp,r=n.TypeSignature,f=r.Any,F=r.Everything,T=r.rest,_=r.either,x=r.optional,O=r.zeroOrMore,L=r.percent,H=r.nonNegativeInteger,A=r.positiveInteger,r=r.positiveNumber,C=Object.assign,E=Math.floor,N=Math.ceil,j=Math.abs,z=Math.max,q=Math.min,P=u.noop;function R(e){return"(".concat(e," ").concat(b.options.ifid,") ")}["set","put","unpack"].forEach(function(r){return n.add(r,"Instant",function(e){for(var t=0;t<(arguments.length<=1?0:arguments.length-1);t+=1){var n=t+1<1||arguments.length<=t+1?void 0:arguments[t+1];if("into"===n.operator&&"set"===r)return y.create("macrocall","Please say 'to' when using the (set:) macro.");if("to"===n.operator&&"set"!==r)return y.create("macrocall","Please say 'into' when using the (put:) or (unpack:) macro.");if((i.isPrototypeOf(n.dest)||s.isPrototypeOf(n.dest))===("unpack"===r))return y.create("macrocall","unpack"===r?"Please use the (unpack:) macro with arrays, datamaps or (p:) patterns containing variables to the right of 'into'.":"Please use the (".concat(r,":) macro with just single variables and typed variables to the ").concat("set"===r?"left of 'to'.":"right of 'into'."),"You may wish to change this to the (".concat("unpack"!==r?"unpack":"to"===n.operator?"set":"put",":) macro."));n=n.set();if(y.containsError(n))return n}return{TwineScript_TypeID:"instant",TwineScript_TypeName:"a (".concat(r,":) operation"),TwineScript_ObjectName:"a (".concat(r,":) operation"),TwineScript_Unstorable:!0,TwineScript_Print:function(){return b.options.debug,""}}},[T(e)])}),n.add("move","Instant",function(e){for(var t=0;t<(arguments.length<=1?0:arguments.length-1);t+=1){var n=t+1<1||arguments.length<=t+1?void 0:arguments[t+1];if("into"!==n.operator)return y.create("macrocall","Please say 'into' when using the (move:) macro.");n=n.set(!0);if(y.containsError(n))return n}return{TwineScript_TypeID:"instant",TwineScript_TypeName:"a (move:) operation",TwineScript_ObjectName:"a (move:) operation",TwineScript_Unstorable:!0,TwineScript_Print:function(){return b.options.debug,""}}},[T(e)]),n.addCommand("display",function(e){if(!l.hasValid(e))return y.create("macrocall","I can't (display:) the passage '".concat(e,"' because it doesn't exist."))},function(e,t,n){return e.source=l.getTree(n),e},[String])("print",P,function(e,t,n){return C(e,{source:h(n)})},[f])(["verbatim-print","v6m-print"],P,function(e,t,n){return C(e,{verbatim:!0,source:h(n)})},[f])(["verbatim-source","v6m-source"],function(e){if("command"===(null==e?void 0:e.TwineScript_TypeID)&&!e.TwineScript_ToSource)return y.create("datatype","I can't construct the source code of a command created by a custom macro.")},function(e,t,n){return C(e,{verbatim:!0,source:h(w(n))})},[f])("go-to",function(e){if(!l.hasValid(e))return y.create("macrocall","I can't (go-to:) to the passage '".concat(e,"' because it doesn't exist."),"Check that you didn't mistype the passage name, or rename the passage to something else.")},function(e,t,n){if(!b.options.ignoreGotos)return requestAnimationFrame(function(){return a.goToPassage(n,{transition:e.data.passageT8n})}),{blocked:!0}},[String])("redirect",function(e){if(!l.hasValid(e))return y.create("macrocall","I can't (redirect:) to the passage '".concat(e,"' because it doesn't exist."),"Check that you didn't mistype the passage name, or rename the passage to something else.")},function(e,t,n){if(!b.options.ignoreGotos)return requestAnimationFrame(function(){return a.redirect(n,{transition:e.data.passageT8n})}),{blocked:!0}},[String])("undo",P,function(e,t,n){return c.pastLength<1?C(e,{source:n}):b.options.ignoreGotos?void 0:(requestAnimationFrame(function(){return a.goBack({transition:e.data.passageT8n})}),{blocked:!0})},[x(String)])("debug",P,a.enableDebugMode,[],!1),b.onStartup(function(){return b.storyElement.on("click.icon","tw-icon",function(e){var t=u(this),n=t.data("clickEvent"),r=t.attr("alt");n&&n(t),"Undo"===r&&(e.stopPropagation(),a.goBack()),"Redo"===r&&(e.stopPropagation(),a.goForward()),"Fullscreen"===r&&(e.stopPropagation(),a.toggleFullscreen()),"Restart"===r&&(c.hasSessionStorage&&sessionStorage.removeItem("Saved Session"),window.location.reload())})}),[["Undo","&#8630;",function(){return 0<c.pastLength}],["Redo","&#8631;",function(){return 0<c.futureLength}],["Fullscreen","&#9974;",function(){return document.fullscreenEnabled||document.msFullscreenEnabled}],["Restart","&#10226;",Object]].forEach(function(e){var e=_slicedToArray(e,3),o=e[0],i=e[1],s=e[2];n.addCommand("icon-".concat(o.toLowerCase()),function(e,t){if("string"==typeof e&&"string"==typeof t)return e=_toConsumableArray(e).length,t=_toConsumableArray(t).length,1<e&&1<t?y.create("datatype","One of the two strings given to (icon-".concat(o.toLowerCase(),":) should be 1 character long, for its icon.")):1===e&&1===t?y.create("datatype","One of the two strings given to (icon-".concat(o.toLowerCase(),":) should be 2 or more characters long, for its label.")):void 0},function(t,e,n,r){var a;return("string"==typeof r&&1===_toConsumableArray(r).length||"string"==typeof n&&1<_toConsumableArray(n).length)&&(n=(a=[r,n])[0],r=a[1]),"Undo"===o&&(t.data.forgetUndosEvent=function(e){t.section.whenUnblocked(function(){return u(e).css("visibility","hidden")})}),C(t,{source:'<tw-icon tabindex=0 alt="'.concat(o,'" ').concat(r?'data-label="'.concat(r.replace('"',"&quot;"),'"'):"",' title="').concat(o,'" ').concat(s()?"":'style="visibility:hidden"',">").concat(n||i,"</tw-icon>")})},[x(String),x(String)])}),n.addCommand("icon-counter",function(e,t,n){var r=" label string given to (icon-counter:) can't be empty or only whitespace.";return t&&t.trim()?"string"!=typeof n||n.trim()?void 0:y.create("datatype","The 2nd "+r):y.create("datatype","The 1st "+r)},function(r,e,a,o,i){r.attr.push({"data-2bind":!0}),r.data.twoWayBindEvent=function(e,t,n){a.varRef.matches(t,n)&&"number"==typeof(t=a.varRef.get())&&r.target.children("tw-icon").text((0<t?E:N)(t)).attr("data-label",1!==j(t)&&void 0!==i?i:o)};var t=a.varRef.get();return"number"!=typeof t?y.create("datatype","(icon-counter:) can only be bound to a variable holding a number, not ".concat(m(t),".")):C(r,{source:'<tw-icon data-label="'.concat(b.escape(1!==j(t)&&void 0!==i?i:o),'">').concat((0<t?E:N)(t),"</tw-icon>")})},[v,String,x(String)]),n.addCommand("meter",function(e,t,n,r){return"two way"===e.bind?y.create("datatype","(meter:) shouldn't be given two-way bound variables.",'Change the "2bind" keyword to just "bind".'):"string"!=typeof r||r.trim()?-1===n.search(D)||!n.includes("=")&&1<n.length?y.create("datatype",'The (meter:) macro requires a sizing line("==X==", "==X", "=XXXX=" etc.) be provided, not '+JSON.stringify(n)+"."):void 0:y.create("datatype","The label string given to (meter:) can't be empty or only whitespace.")},function(r,e,a,n,t,o,i){o&&"string"!=typeof o&&(i=o,o=void 0),i=i||p.create({h:0,s:0,l:.5,a:.5}),p.isPrototypeOf(i)&&(i=d.create(90,[{colour:i,stop:0},{colour:i,stop:1}]));function s(e){var t=z(0,q(1,e/n)),e=i.repeating?i:i.multiply(n/e);return"height:100%;background-repeat:no-repeat;background-image:".concat((l?C(e,e.repeating?{}:{angle:270}).toLinearGradientString()+", ":"")+C(e,e.repeating?{}:{angle:l||0===c?90:270}).toLinearGradientString(),";background-size:").concat(l?Array(2).fill(50*t+"%"):100*t+"%",";background-position-x:").concat(l?-100/(2-t)+100+"%,"+100/(2-t)+"%":0===c?"left":"right",";text-align:").concat(l?"center":0===c?"left":"right")}var t=S(t),c=t.marginLeft,t=t.size,l=0<c&&Math.ceil(c+t)<100,u=(r.styles.push({"margin-left":c+"%",width:t+"%",height:"1.5em",display:"block"}),r.attr.push({"data-2bind":!0}),o&&e.stackTop.tempVariables),t=(r.data.twoWayBindEvent=function(e,t,n){a.varRef.matches(t,n)&&"number"==typeof(t=a.varRef.get())&&((n=r.target.children("tw-meter")).attr("style",s(t)),o)&&r.section.renderInto("",null,{source:o,target:n,append:"replace",transitionDeferred:!1},u)},a.varRef.get());return"number"!=typeof t?y.create("datatype","(meter:) can only be bound to a variable holding a number, not ".concat(m(t),".")):C(r,{source:'<tw-meter style="'.concat(s(t),'">').concat(o||"","</tw-meter>")})},[v,r,String,x(_(String,p,d)),x(_(p,d))]),[["cycling-link"],["seq-link","sequence-link"]].forEach(function(t,u){return n.addCommand(t,function(){var e;return""===(arguments.length<=0?void 0:arguments[0])?y.create("datatype","The first string in a ("+t[0]+":) can't be empty."):arguments.length<=(v.isPrototypeOf(arguments.length<=0?void 0:arguments[0])?2:1)?y.create("datatype","I need two or more strings to "+(u?"sequence":"cycle")+" through, not just '"+((e=arguments.length-1)<0||arguments.length<=e?void 0:arguments[e])+"'."):void 0},function(a,e){for(var o,t=arguments.length,i=new Array(2<t?t-2:0),n=2;n<t;n++)i[n-2]=arguments[n];v.isPrototypeOf(i[0])&&(o=i.shift());var s=0,c=("two way"===(null==(l=o)?void 0:l.bind)&&(a.attr.push({"data-2bind":!0}),-1<(l=i.indexOf(o.varRef.get())))&&(s=l),e.stackTop.tempVariables);function r(e,t){var n=s>=i.length-1&&u,r=""===i[s]?"":n?i[s]:"<tw-link>".concat(i[s],"</tw-link>");if(n&&(a.data.clickEvent=void 0),o&&!t){n=o.set(i[s]);if(y.containsError(n))return void e.replaceWith(n.render(i[s]))}t=_objectSpread(_objectSpread({},a),{},{source:r,transitionDeferred:!1});a.section.renderInto("",null,t,c)}i[s]&&(a.data.clickEvent=function(e){s=(s+1)%i.length,r(e,!1)},a.data.twoWayBindEvent=function(e,t,n){o.varRef.matches(t,n)&&(t=o.varRef.get(),-1<(n=i.indexOf(t)))&&n!==s&&(s=n,r(e,!0))});var l="<tw-link>".concat(i[s],"</tw-link>");if(o){e=o.set(i[s]);if(y.containsError(e))return e}return C(a,{source:l,append:"replace",transitionDeferred:!0})},[_(v,String),T(String)])}),b.onStartup(function(){return b.storyElement.on("change.dropdown-macro","select",function(){var e=u(this),t=e.closest("tw-expression, tw-hook").data("dropdownEvent");t&&t(e)})}),n.addCommand("dropdown",function(e){var t;return""===(arguments.length<=1?void 0:arguments[1])||""===((t=(arguments.length<=1?0:arguments.length-1)-1+1)<1||arguments.length<=t?void 0:arguments[t])?y.create("datatype","The first or last strings in a (dropdown:) can't be empty.","Because empty strings create separators within (dropdown:)s, having them at the start or end doesn't make sense."):(arguments.length<=1?0:arguments.length-1)<=1?y.create("datatype","I need two or more strings to create a (dropdown:) menu, not just "+(arguments.length<=1?0:arguments.length-1)+"."):void 0},function(e,t,r){for(var n=arguments.length,a=new Array(3<n?n-3:0),o=3;o<n;o++)a[o-3]=arguments[o];var i=0,s=("two way"===r.bind&&(e.attr.push({"data-2bind":!0}),-1<(c=a.indexOf(r.varRef.get())))&&(i=c),Math.max.apply(Math,_toConsumableArray(a.map(function(e){return _toConsumableArray(e).length})))),c="<select>"+a.map(function(e,t){return"<option".concat(t===i?" selected":"").concat(""===e?" disabled":"",">").concat(b.escape(e||"\u2500".repeat(s)),"</option>")}).join("\n")+"</select>",l=(e.data.dropdownEvent=function(e){var t=e.val(),n=r.set(t);y.containsError(n)&&e.replaceWith(n.render(t))},e.data.twoWayBindEvent=function(e,t,n){r.varRef.matches(t,n)&&(t=r.varRef.get(),-1<(n=a.indexOf(t)))&&n!==i&&(e.find("select").val(t),i=n)},e.styles.push({"background-color":function(){return b.parentColours(u(this)).backgroundColour}}),r.set(a[i]));return y.containsError(l)?l:C(e,{source:c,append:"replace"})},[v,String,T(String)]),b.onStartup(function(){return b.storyElement.on("input.checkbox-macro","input[type=checkbox]",function(){var e=u(this),t=e.closest("tw-expression").data("checkboxEvent");t&&t(e)})});function I(e){return["I can't use a dialog macro in "+e+".","Please rewrite this without putting such macros here."]}var V=1;n.addCommand("checkbox",function(){},function(e,t,r,n){var a=!1,o="checkbox-"+ ++V,i=("two way"===r.bind&&(e.attr.push({"data-2bind":!0}),"boolean"==typeof(i=r.varRef.get())&&(a=i),e.data.twoWayBindEvent=function(e,t,n){r.varRef.matches(t,n)&&"boolean"==typeof(t=r.varRef.get())&&e.children("input[type=checkbox]").prop("checked",t)}),e.data.checkboxEvent=function(e){var t=e.is(":checked"),t=r.set(t);y.containsError(t)&&e.replaceWith(t.render(""))},r.set(a));return y.containsError(i)?i:C(e,{source:'<input id="'.concat(o,'" type="checkbox" ').concat(a?"checked":"",'><label for="').concat(o,'">').concat(n,"</label>"),append:"replace"})},[v,String]),b.onStartup(function(){return u(document).on("fullscreenchange",function(){u("input[type=checkbox][id^=fullscreen]",b.storyElement).each(function(e,t){(u(t).closest("tw-expression").data("fullscreenEvent")||Object)(t)})})}),n.addCommand("checkbox-fullscreen",function(){},function(e,t,n){var r="fullscreenCheckbox-"+ ++V;return e.data.fullscreenEvent=function(e){return u(e).prop("checked",!(!document.fullscreenElement&&!document.msFullscreenElement))},e.data.checkboxEvent=function(){return a.toggleFullscreen()},C(e,{source:'<input id="'.concat(r,'" type="checkbox" ').concat(document.fullscreenEnabled||document.msFullscreenEnabled?" ":"disabled ").concat(document.fullscreenElement||document.msFullscreenElement?"checked":"",'><label for="').concat(r,'">').concat(n,"</label>"),append:"replace"})},[String]),b.onStartup(function(){return b.storyElement.on("input.input-box-macro","textarea, input[type=text]",function(){var e=u(this),t=e.closest("tw-expression").data("inputBoxEvent");t&&t(e)})}),["input","force-input","input-box","force-input-box"].forEach(function(g){return n.addCommand(g,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=g.endsWith("box"),a=v.isPrototypeOf(t[0]),o="string"==typeof t[+a],r=r&&"number"==typeof t[o+a],i=o?t[+a]:t[a+r],s=0<S(i).size,o=s?t[a+r+o]:i;return g.startsWith("force")&&"string"!=typeof o?y.create("datatype","The (".concat(g,":) macro requires a string of text to forcibly input.")):t.length>a+r+s+("string"==typeof o)?y.create("datatype","An incorrect combination of values was given to this (".concat(g,":) macro.")):void 0},function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];var o=g.startsWith("force"),i=g.endsWith("box"),s=v.isPrototypeOf(r[0]),c="string"==typeof r[+s],l=i&&"number"==typeof r[c+s],u=s&&r[0],p=l?r[1+s]:3,d=c?S(r[+s]):{},f=d.marginLeft,d=d.size,h=(d?r[s+l+c]:c&&r[+s])||"",l=o?"":h,c=!1;if("two way"===u.bind){e.attr.push({"data-2bind":!0});s=u.varRef.get();if("string"==typeof s){l=o?h.slice(0,s.length):s,s=u.set(l),c=!0;if(y.containsError(s))return s}e.data.twoWayBindEvent=function(e,t,n){u.varRef.matches(t,n)&&"string"==typeof(t=u.varRef.get())&&e.find(i?"textarea":"input").val(o?h.slice(0,t.length):t)}}if(u&&!c){s=u.set(o?"":h);if(y.containsError(s))return s}!o&&u&&(e.data.inputBoxEvent=function(e){var t=e.val(),t=u.set(t);y.containsError(t)&&e.replaceWith(t.render(""))});var m,c="<".concat(i?"textarea":"input type=text",' style="width:100%" ').concat(i?"rows=".concat(p,">"):'value="').concat(b.escape(l)).concat(i?"</textarea>":'">');return o&&(m=Array.from(h),e.data.inputBoxEvent=function(e){var t=e.val().length,t=m.slice(0,t).join("");return e.val(t),u&&(t=u.set(t),y.containsError(t))&&e.replaceWith(t.render("")),!0}),e.styles.push({display:"block","margin-left":d?f+"%":void 0,width:d?d+"%":"100%","border-style":function(){return this.style.borderStyle||"solid"}}),C(e,{source:c,append:"replace"})},g.endsWith("box")?[_(v,String),x(_(A,String)),x(_(A,String)),x(String)]:[x(_(v,String)),x(String),x(String)])}),["show","rerun"].forEach(function(s){return n.addCommand(s,function(){for(var r,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.some(function e(t){var n=t.selector,t=t.next;return"name"===n.type&&"page"===n.data?(r=y.create("macrocall","You can't (hide:) the ?page. Sorry."),!0):!!("base"===n.type&&e(n.data)||t&&e(t))||void 0}),r},function(o,i){for(var e=arguments.length,t=new Array(2<e?e-2:0),n=2;n<e;n++)t[n-2]=arguments[n];return t.forEach(function(e){return e.forEach(i,function(e){var t,n,r,a=e.data("hidden");void 0!==a!=("rerun"===s)&&(e.removeData("hidden"),a instanceof u?e.empty().append(a):(a=e.data("tempVariables"),n=(t="tw-passage"===e.tag())?l.getTree(c.passage):e.data("originalSource")||"",t&&(r=e.find("tw-sidebar").detach()),i.renderInto("",null,_objectSpread(_objectSpread({},o),{},{append:"replace",source:n,target:e}),a&&Object.create(a)),r&&e.prepend(r)))})}),o},[T(o)])});n.addCommand("hide",function(){for(var r,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.some(function e(t){var n=t.selector,t=t.next;return"name"===n.type&&"page"===n.data?(r=y.create("macrocall","You can't (hide:) the ?page. Sorry."),!0):!!("base"===n.type&&e(n.data)||t&&e(t))||void 0}),r},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0,o=n;a<o.length;a++)o[a].forEach(e,function(e){e.data("hidden")||e.data("hidden",e.contents().detach())})},[T(o)],!1)("scroll",P,function(m,e,g){var y="number"==typeof g&&g;requestAnimationFrame(function(){e.forEach(m,function(e){if(!1!==y){var t,n,r=e[0];null!=(t=(n=r=r===b.storyElement[0]&&r.scrollHeight===r.clientHeight?getComputedStyle(document.body).overflow.includes(" scroll")?document.body:document.documentElement:r).scrollTo)&&t.call(n,0,(r.scrollHeight-r.clientHeight)*y)}else{var a,o=_createForOfIteratorHelper(g.hooks(m).get());try{for(o.s();!(a=o.n()).done;){var i=a.value;if(e.find(i)){for(var s=[],c=e[0];(c=c.parentNode)&&c!==document.body;)s.push([c,c.scrollLeft,c.scrollTop]);i.scrollIntoView();for(var l=0,u=s;l<u.length;l++){var p=_slicedToArray(u[l],3),d=p[0],f=p[1],h=p[2];d.scrollLeft=f,d.scrollTop=h}break}}}catch(e){o.e(e)}finally{o.f()}}})})},[o,_(L,o)],!1)("stop",P,P,[],!1)("load-game",P,function(e,t){var n,r;return e.loadedGame?y.create("infinite","I can't use (load-game:) immediately after loading a game."):(n=localStorage.getItem(R("Saved Game")+t))?(n=c.deserialise(e,n))instanceof Error?{blocked:r=k({message:"Sorry to interrupt... The story tried to load saved data, but there was a problem.\n"+n.message+"\n\nThat data might have been saved from a different version of this story. Should I delete it?\n(Type 'delete' and choose Yes to delete it.)\n\nEither way, the story will now continue without loading the data.",defaultValue:"",buttons:[{name:"Yes",confirm:!0,callback:function(){"delete"===r.find("input").last().val()&&localStorage.removeItem(R("Saved Game")+t),e.unblock("")}},{name:"No",cancel:!0,callback:function(){return e.unblock()}}]})}:void requestAnimationFrame(a.showPassage.bind(a,c.passage,{loadedGame:!0})):y.create("saving","I can't find a save slot named '"+t+"'!")},[String],!1)("forget-undos",P,function(e,t){c.futureLength||c.forgetUndos(t)},[parseInt],!1)("forget-visits",P,function(e,t){c.forgetVisits(t)},[parseInt],!1)("mock-visits",function(){if(!b.options.debug)return y.create("debugonly","(mock-visits:) cannot be used outside of debug mode.");for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.find(function(e){return!l.hasValid(e)});return r?y.create("datatype","I can't mock-visit '"+r+"' because no passage with that name exists."):void 0},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];c.mockVisits=g(n)},[T(String)],!1)("mock-turns",function(){if(!b.options.debug)return y.create("debugonly","(mock-turns:) cannot be used outside of debug mode.")},function(e,t){c.mockTurns=t},[H],!1)("seed",P,function(e,t){c.setSeed(t)},[String],!1)(["dialog","alert"],function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(v.isPrototypeOf(e)){if("two way"===e.bind)return y.create("datatype","(dialog:) shouldn't be given two-way bound variables.",'Change the "2bind" keyword to just "bind".');if(void 0===t)return y.create("datatype","(dialog:) needs a message string or codehook to display.")}else void 0!==t&&r.unshift(t);e=r.findIndex(function(e){return""===e});if(-1<e)return y.create("datatype","(dialog:)'s ".concat(b.nth(e+1)," link text shouldn't be an empty string."))},function(e,n,r,t){for(var a=arguments.length,o=new Array(4<a?a-4:0),i=4;i<a;i++)o[i-4]=arguments[i];return v.isPrototypeOf(r)||(void 0!==t&&o.unshift(t),t=r,r=void 0),o.length||(o=["OK"]),{blocked:k({section:n,message:t,cd:e,buttons:o.map(function(t){return{name:t,callback:function(){var e;n.unblock((null==(e=r)?void 0:e.set(t))||"")}}})})}},[_(v,String,t),x(_(t,String)),O(String)])("open-url",P,function(e,t){window.open(t,"")},[String],!1)(["restart","reload"],P,function(){if(!b.options.ignoreGotos){if(c.turns<=1)return y.create("infinite","I mustn't (restart:) the story in the starting passage.");c.hasSessionStorage&&sessionStorage.removeItem("Saved Session"),window.location.reload()}},[],!1)("goto-url",P,function(e,t){window.location.assign(t)},[String],!1)("ignore",P,P,[O(F)])("assert-exists",function(e){if(""===e)return y.create("datatype","(assert-exists:) mustn't be given an empty string.")},function(e,t,n){var r=0;return("string"==typeof n?o.create({type:"string",data:n}):n).forEach(t,function(){++r}),r?e:y.create("assertion","I didn't see any ".concat("string"==typeof n?"text occurrences of":"hooks matching"," ").concat(w(n)," in this passage."))},[_(o,String)]),n.add("assert","Instant",function(e,t){return t?{TwineScript_TypeID:"instant",TwineScript_TypeName:"an (assert:) operation",TwineScript_ObjectName:"an (assert:) operation",TwineScript_Unstorable:!0,TwineScript_Print:function(){return""}}:C(y.create("assertion","An assertion failed: "),{appendTitleText:!0})},[Boolean])("save-game","Boolean",function(e,t,n){if(n=n||"",!c.hasStorage)return!1;var r=c.serialise(!1).pastAndPresent;if(y.containsError(r))return r;if(!1===r)return!1;try{return localStorage.setItem(R("Saved Game")+t,r),localStorage.setItem(R("Saved Game Filename")+t,n),!0}catch(e){return!1}},[String,x(String)])("prompt","String",function(e,t,n,r,a){var o,i;return null!=(o=e.stackTop)&&o.evaluateOnly?y.create.apply(y,["macrocall"].concat(_toConsumableArray(I(e.stackTop.evaluateOnly)))):""===a?y.create("datatype","The text for (prompt:)'s confirm link can't be blank."):(i=k({section:e,message:t,defaultValue:n,buttons:[{name:a||"OK",confirm:!0,callback:function(){return e.unblock(i.find("input").last().val())}}].concat(""===r?[]:{name:r||"Cancel",cancel:!0,callback:function(){return e.unblock(n)}})}),e.stackTop.blocked=i,0)},[_(String,t),String,x(String),x(String)])("confirm","Boolean",function(e,t,n,r){var a;return null!=(a=e.stackTop)&&a.evaluateOnly?y.create.apply(y,["macrocall"].concat(_toConsumableArray(I(e.stackTop.evaluateOnly)))):""===r?y.create("datatype","The text for (confirm:)'s confirm link can't be blank."):(a=k({section:e,message:t,defaultValue:!1,buttons:[{name:r||"OK",confirm:!0,callback:function(){return e.unblock(!0)}}].concat(""===n?[]:{name:n||"Cancel",cancel:!0,callback:function(){return e.unblock(!1)}})}),e.stackTop.blocked=a,0)},[_(String,t),x(String),x(String)])("page-url","String",function(){return window.location.href},[])}),define("macrolib/custommacros",["utils","macros","state","utils/operationutils","datatypes/changercommand","datatypes/custommacro","datatypes/codehook","datatypes/typedvar","internaltypes/twineerror"],function(c,l,u,e,t,p,n,d,f){function s(e,t,n){if(!t.some(function(e){if("function"==typeof e.output)return e.output(n),!0}))return f.create("macrocall","("+e+":) should only be used inside a code hook passed to (macro:).")}var h=e.objectName,m=e.toSource,e=l.add,r=l.addChanger,a=l.addCommand,o=l.TypeSignature,i=o.rest,g=o.either,y=o.Any,b=o.Everything,o=o.zeroOrMore;e("macro","CustomMacro",function(e){for(var t,n=[],r=arguments.length,a=new Array(1<r?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];for(t=0;t<a.length;t+=1){var i=t===a.length-1;if(d.isPrototypeOf(a[t])===i)return f.create("datatype","The "+(i?"":c.nth(a.length-t+1)+"-")+"last value given to (macro:) should be a "+(i?"code hook":"datatyped variable")+", not "+h(a[t]));if(!i){i="A custom macro";if(a[t].varRef.object===u.variables)return f.create("datatype",i+"'s typed variables must be temp variables (with a '_'), not global variables (with a '$').","Write them with a _ symbol at the start instead of a $ symbol.");if(1<a[t].varRef.propertyChain.length)return f.create("datatype",i+"'s typed variables can't be properties inside a data structure.");if(a[t].datatype.rest&&t!==a.length-2)return f.create("datatype",i+" can only have one spread variable, and it must be its last variable.");var s=a[t].varRef.propertyChain[0];if(n.includes(s))return f.create("datatype",i+"'s typed variables can't both be named '"+s+"'.");n.push(s)}}return p.create(a.slice(0,-1),a[a.length-1])},[i(g(d,n))]);a(["output-data","out-data"],function(){},function(e,t){e=e.stack;return s("output-data",e,t)||{blocked:!0}},[y],!1),r(["output","out"],function(){return Object.assign(t.create("output",[]))},function(e,t){if(e.section){var n,r=e.section,a=r.stack,o=r.stackTop,i={};for(n in o.tempVariables)n.startsWith("TwineScript_")||(i[n]=o.tempVariables[n]);s("output",a,{changer:t,variables:i,hook:Array.isArray(e.source)?"["+e.source.map(function(e){return e.text}).join("")+"]":e.source}),e.output=!0,o.blocked=!0}},[]),a("error",function(e){if(!e)return f.create("datatype","This (error:) macro was given an empty string.")},function(e,t){e=e.stack;return s("error",e,f.create("user",t))||{blocked:!0}},[String],!1),e("partial","CustomMacro",function(e,a){for(var t=arguments.length,o=new Array(2<t?t-2:0),n=2;n<t;n++)o[n-2]=arguments[n];var r="string"!=typeof a&&a,i=!r&&a;if(!r){if(!l.has(i))return f.create("macrocall",'The macro name given to (partial:), "'.concat(a,"\", isn't the name of a built-in macro."));if("Metadata"===l.get(i).returnType)return f.create("macrocall","(partial:) can't be used with metadata macros such as (".concat(a,":)"))}var s="(partial:".concat(m(a),",").concat(o.map(function(e){return m(e)}),")"),c=p.createFromFn(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e=l["string"==typeof a?"run":"runCustom"](a,e,o.concat(n));return f.containsError(e)&&(e.message="An error occurred while running the (partial:)-created macro, ".concat(c.TwineScript_ObjectName,":\n")+e.message),e},"a (partial:) custom macro of ".concat(i||r.TwineScript_KnownName?"(".concat(i||r.TwineScript_KnownName,":").concat(o.map(function(e){return m(e)}),")"):"another unnamed custom macro"),function(){return s},(i?l.get(i):r).typeSignature.filter(function(e,t){return t>=o.length||"rest"===e.pattern||"zero or more"===e.pattern}));return c},[g(String,p),o(b)])}),define("macrolib/datastructures",["utils","utils/naturalsort","macros","utils/operationutils","state","engine","passages","datatypes/lambda","datatypes/typedvar","internaltypes/twineerror"],function(e,i,t,n,s,r,a,c,o,l){var u=e.permutations,p=e.options,d=n.objectName,f=n.subset,h=n.collectionType,m=n.isValidDatamapName,g=n.is,y=n.unique,b=n.clone,v=n.range,e=t.TypeSignature,n=e.optional,w=e.rest,k=e.either,S=e.zeroOrMore,T=e.Any,e=e.nonNegativeInteger,_=i("en");t.add(["a","array"],"Array",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n},S(k(o,T)))("range","Array",function(e,t,n){return v(t,n)},[parseInt,parseInt])("subarray","Array",function(e,t,n,r){return f(t,n,r)},[Array,parseInt,parseInt])("reversed","Array",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.reverse().map(b)},S(T))("shuffled","Array",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return s.shuffled.apply(s,n).map(b)},[S(T)])("sorted","Array",function(e){for(var t,n=arguments.length,r=new Array(1<n?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];if(!c.isPrototypeOf(r[0]))return(t=r.filter(function(e){return"string"!=typeof e&&"number"!=typeof e}))&&t.length?1===t.length&&Array.isArray(t[0])?l.create("macrocall","Please give multiple numbers or strings to (sorted:), not a single array.","You can use the spread ... syntax to spread out the array's values into (sorted:)."):l.create("datatype","If (sorted:) isn't given a 'via' lambda, it must be given only numbers and strings, not ".concat(d(t[0]),".")):r.sort(_);var o=r.shift();if("making"in o||"where"in o||"when"in o||!("via"in o))return l.create("datatype","The optional lambda given to (sorted:) must be a 'via' lambda, not ".concat(d(o),"."));for(var i=0;i<r.length;i+=1){var s=o.apply(e,{loop:r[i],pos:i+1});if(l.containsError(s))return s;if("string"!=typeof s&&"number"!=typeof s)return l.create("datatype",'The "via" lambda given to (sorted:) couldn\'t convert '.concat(d(r[i])," into a string or number."));r[i]=[r[i],s]}return r.sort(function(e,t){return _(e[1],t[1])}).map(function(e){return e[0]})},[S(T)])("rotated","Array",function(e,t){if(0===t)return l.create("macrocall","I can't rotate these values by 0 positions.");for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];t=-1*(t=Math.abs(t)%r.length*Math.sign(t));return r.slice(t).concat(r.slice(0,t)).map(b)},[parseInt,S(T)])("rotated-to","Array",function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];t=t.filter(e,r);return l.containsError(t)?t:t.length?(e=r.indexOf(t[0]),r.slice(e).concat(r.slice(0,e)).map(b)):l.create("macrocall","None of these "+r.length+" values matched the lambda, so I can't rotate them.")},[c.TypeSignature("where"),w(T)])("repeated","Array",function(e,t){for(var n=[],r=arguments.length,a=new Array(2<r?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];if(!a.length)return n;for(;0<t--;)n.push.apply(n,a);return n.map(b)},[e,w(T)])("interlaced","Array",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=Math.min.apply(Math,_toConsumableArray(n.map(function(e){return e.length}))),o=[],i=0;i<a;i+=1)for(var s=0;s<n.length;s+=1)o.push(b(n[s][i]));return o},[Array,w(Array)])("permutations","Array",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.length?u.apply(void 0,n):[]},[S(T)])("unique","Array",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.filter(y)},[S(T)])("altered","Array",function(n,r){for(var e=arguments.length,t=new Array(2<e?e-2:0),a=2;a<e;a++)t[a-2]=arguments[a];return t.map(function(e,t){t=r.apply(n,{loop:e,pos:t+1});return null===t?e:t})},[k(c.TypeSignature("via"),c.TypeSignature("where","via")),S(T)])("find","Array",function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return t.filter(e,r)},[c.TypeSignature("where"),S(T)])(["all-pass","pass"],"Boolean",function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];t=t.filter(e,r);return l.containsError(t)||t.length===r.length},[c.TypeSignature("where"),S(T)])("some-pass","Boolean",function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];t=t.filter(e,r);return l.containsError(t)||0<t.length},[c.TypeSignature("where"),S(T)])("none-pass","Boolean",function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];t=t.filter(e,r);return l.containsError(t)||0===t.length},[c.TypeSignature("where"),S(T)])("folded","Any",function(r,a){for(var e=arguments.length,t=new Array(2<e?e-2:0),n=2;n<e;n++)t[n-2]=arguments[n];return"where"in a&&(t=[t[0]].concat(_toConsumableArray(a.filter(r,t.slice(1))))),l.containsError(t)||t.reduce(function(e,t,n){return a.apply(r,{making:e,loop:t,pos:n+1})})},[k(c.TypeSignature("where","via","making"),c.TypeSignature("via","making")),w(T)])(["dm-names","datamap-names","datanames"],"Array",function(e,t){return Array.from(t.keys()).sort(i("en"))},[Map])(["dm-values","datamap-values","datavalues"],"Array",function(e,t){return Array.from(t.entries()).sort(i("en",function(e){return String(e[0])})).map(function(e){return b(e[1])})},[Map])(["dm-entries","datamap-entries","dataentries"],"Array",function(e,t){return Array.from(t.entries()).sort(function(e,t){return[e[0],t[0]].sort(i("en"))[0]===e[0]?-1:1}).map(function(e){return new Map([["name",e[0]],["value",b(e[1])]])})},[Map])(["dm-altered","datamap-altered"],"Datamap",function(a,o,e){return Array.from(e.entries()).sort(function(e,t){return[e[0],t[0]].sort(i("en"))[0]===e[0]?-1:1}).reduce(function(e,t,n){if(!l.containsError(e)){var r=new Map([["name",t[0]],["value",b(t[1])]]),r=o.apply(a,{loop:r,pos:n+1});if(l.containsError(r))return r;e.set(t[0],null===r?t[1]:r)}return e},new Map)},[k(c.TypeSignature("via"),c.TypeSignature("where","via")),Map])("history","Array",function(e,t){var n=s.history();return t?(t=t.filter(e,n.map(function(e){return a.get(e)})),l.containsError(t)?t:t.map(function(e){return e.get("name")})):n},[n(c.TypeSignature("where"))])("visited","Boolean",function(e,t){var n;return"string"==typeof t?a.has(t)?0<s.passageNameVisited(t)||s.passage===t:l.create("macrocall","There's no passage named '"+t+"' in this story."):(n=s.history(),n=t.filter(e,n.concat(s.passage).map(function(e){return a.get(e)})),l.containsError(n)?n:0<n.length)},[k(String,c.TypeSignature("where"))])("passage","Datamap",function(e,t){return b(a.get(t||s.passage))||l.create("macrocall","There's no passage named '"+t+"' in this story.")},[n(String)])("passages","Array",function(e,t){var n=i("en"),r=_toConsumableArray(a.values()).map(function(e){return b(e)}),t=t?t.filter(e,r):r,e=l.containsError(t);return e||t.sort(function(e,t){return n(e.get("name"),t.get("name"))})},[n(c.TypeSignature("where"))])("open-storylets","Array",function(e,t){return e.stackTop.evaluateOnly?l.create("macrocall","(open-storylets:) can't be used in "+e.stackTop.evaluateOnly+"."):(e=a.getStorylets(e,t),l.containsError(e)||e.map(b))},[n(c.TypeSignature("where"))])("savedgames","Datamap",function(){function e(e){return"("+e+" "+p.ifid+") "}var t,n,r=0,a=new Map;do{if(!s.hasStorage)break;t=localStorage.key(r),r+=1;var o=e("Saved Game")}while(null!=(n=t)&&n.startsWith(o)&&(t=t.slice(o.length),a.set(t,localStorage.getItem(e("Saved Game Filename")+t))),t);return a},[])(["datamap","dm"],"Datamap",function(e){for(var r,a=new Map,t=arguments.length,n=new Array(1<t?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];var i=n.reduce(function(e,t){var n;if(!l.containsError(e))if(void 0===r)r=t;else{if(n=l.containsError(m(a,r)))return n;if(a.has(r))return l.create("macrocall","You used the same data name ("+d(r)+") twice in the same (datamap:) call.");a.set(r,b(t)),r=void 0}return e},!0);return l.containsError(i)?i:void 0!==r?l.create("macrocall","This datamap has a data name without a value."):a},S(k(o,T)))(["dataset","ds"],"Dataset",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new Set(n.filter(y).map(b))},S(T))("count","Number",function t(n,r){for(var e,a=arguments.length,o=new Array(2<a?a-2:0),i=2;i<a;i++)o[i-2]=arguments[i];if(1<o.length)return e=o.map(function(e){return t(n,r,e)}),l.containsError(e)||e.reduce(function(e,t){return e+t},0);var s=o[0];switch(h(r)){case"dataset":case"datamap":return l.create("macrocall","(count:) shouldn't be given a datamap or dataset.","You should use the 'contains' operator instead. For instance, write: $variable contains 'value'.");case"string":return"string"!=typeof s?l.create("macrocall",d(r)+" can't contain  "+d(s)+" because it isn't also a string."):s?r.split(s).length-1:0;case"array":return r.reduce(function(e,t){return e+g(t,s)},0);default:return l.create("macrocall",d(r)+" can't contain values, let alone "+d(s)+".")}},[T,w(T)])}),define("macrolib/enchantments",["jquery","utils","utils/operationutils","engine","state","passages","macros","datatypes/hookset","datatypes/codehook","datatypes/changercommand","datatypes/lambda","internaltypes/changedescriptor","internaltypes/enchantment","internaltypes/twineerror"],function(c,r,e,l,s,n,u,p,a,d,t,i,f,h){var m=e.is,e=u.TypeSignature,g=e.either,y=e.rest,o=e.optional,b=Object.assign;function v(e,t){if(d.isPrototypeOf(t)&&!t.canEnchant)return h.create("datatype","The changer given to (".concat(e,":) can't include a revision, enchantment, or interaction changer like (replace:), (click:), or (link:)."))}["enchant","change"].forEach(function(o){u.addCommand(o,function(e,t){t=v(o,t);if(t)return t},function(t,n,e){n=p.from(n);var r,a=[];return d.isPrototypeOf(e)&&(r=i.create({section:t}),e.run(r),0<(r.innerEnchantments||[]).length)&&(r=r.innerEnchantments.map(function(e){return e(n)}),a.push.apply(a,_toConsumableArray(r))),a.push(f.create(_defineProperty(_defineProperty({scope:n},d.isPrototypeOf(e)?"changer":"lambda",e),"section",t))),a.forEach(function(e){"enchant"===o?(t.addEnchantment(e),t.updateEnchantments()):e.enchantScope()}),""},[g(p,String),g(d,t.TypeSignature("via"))],!1)}),u.addChanger("enchant-in",function(e,t,n){var r=v("enchant-in",n);return r||d.create("enchant-in",[t,n])},function(t,n,r){return t.innerEnchantments=(t.innerEnchantments||[]).concat(function(e){return f.create(_defineProperty(_defineProperty({scope:p.from(n),localHook:e},d.isPrototypeOf(r)?"changer":"lambda",r),"section",t.section))}),t},[g(p,String),g(d,t.TypeSignature("via"))]),[["link-style",p.create({type:"name",data:"link"})],["line-style",p.create({type:"base",data:p.create({type:"name",data:"page"})},"lines",void 0)],["char-style",p.create({type:"base",data:p.create({type:"name",data:"page"})},"chars",void 0)]].forEach(function(e){var e=_slicedToArray(e,2),r=e[0],a=e[1];u.addChanger(r,function(e,t){var n=v(r,t);return n||d.create(r,[t])},function(t,n){return t.innerEnchantments=(t.innerEnchantments||[]).concat(function(e){return f.create(_defineProperty(_defineProperty({scope:a,localHook:e},d.isPrototypeOf(n)?"changer":"lambda",n),"section",t.section))}),t},[g(d,t.TypeSignature("via"))])});e=["replace","append","prepend"];function w(i,s){return r.onStartup(function(){var e=i.classList.replace(/ /g,"."),t=i.blockClassList?i.blockClassList.replace(/ /g,"."):"",n="."+e+(t?",."+t:"");r.storyElement.on(i.event.map(function(e){return e+".enchantment"}).join(" "),n,function(){var e,t=c(this);r.options.debug&&r.options.ignoreClickEvents&&!t.is("tw-backdrop.eval-replay *, tw-backdrop.harlowe-crash *")||t.is("tw-open-button")||(e=(t=c(Array.from(t.parents(n).add(this)).sort(function(e,t){return 8&e.compareDocumentPosition(t)?1:-1})[0])).data("enchantmentEvent"))&&e(t)})}),[function(e,t,n){if(!t)return h.create("datatype","A string given to this ("+s+":) macro was empty.");if(n){var r=v(s,n);if(r)return r}return d.create(s,[p.from(t)].concat(n?[n]:[]))},function(t,e,n){t.enabled=!1,t.transitionDeferred=!0,i.rerender&&(t.newTargets=(t.newTargets||[]).concat({target:e,append:i.rerender}));var r,a=null!=(r=t.section)&&r.stackTop?t.section.stackTop.tempVariables:Object.create(null),o=f.create(_defineProperty({functions:[function(e){e.attr("class",e.children().is("tw-story, tw-sidebar, tw-passage")||["block","flex"].includes(e.children().css("display"))?i.blockClassList:i.classList),e.attr({tabIndex:"0"})}],data:{enchantmentEvent:function(){var e;null!=(e=t.section.stackTop)&&e.blocked||(i.once&&t.section.removeEnchantment(o),i.goto?l.goToPassage(i.goto,{transition:i.transition}):i.undo?l.goBack({transition:i.transition}):t.section.renderInto(t.source,null,_objectSpread(_objectSpread({},t),{},{append:i.once?"append":"replace",enabled:!0,transitionDeferred:!1}),a))}},scope:e,section:t.section,name:s},d.isPrototypeOf(n)?"changer":"lambda",n));return t.section&&(t.section.addEnchantment(o),o.enchantScope()),t},[g(p,String),o(g(d,t.TypeSignature("via")))]]}e.forEach(function(o){u.addChanger(o,function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.every(Boolean)?d.create(o,n.map(p.from),null,!1):h.create("datatype","A string given to this (".concat(o,":) macro was empty."))},function(e){var t;0<c(e.target).parents().filter("tw-collapsed,[collapsing=true]").length||e.attr.some(function(e){return e.collapsing})||(e.attr=[].concat(_toConsumableArray(e.attr),[{collapsing:!1}])),e.newTargets=e.newTargets||[];for(var n=arguments.length,r=new Array(1<n?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return(t=e.newTargets).push.apply(t,_toConsumableArray(r.filter(function(n){return!e.newTargets.some(function(e){var t=e.target,e=e.append;return m(n,t)&&o===e})}).map(function(e){return{target:e,append:o,before:!0}}))),e},y(g(p,String)))(o+"-with",function(e,t){return d.create(o+"-with",[t],null,!1)},function(e,t){return a.isPrototypeOf(t)&&(t=t.code),e.appendSource=(e.appendSource||[]).concat({source:t,append:o}),e},g(a,String))});var k="ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints,S=[{name:"click",enchantDesc:{event:["click"],once:!0,rerender:"",classList:"link enchantment-link",blockClassList:"enchantment-clickblock"}},{name:"mouseover",enchantDesc:{event:["mouseenter",k?"click":""].filter(Boolean),once:!0,rerender:"",classList:"link enchantment-mouseover",blockClassList:"enchantment-mouseoverblock"}},{name:"mouseout",enchantDesc:{event:["mouseleave",k?"click":""].filter(Boolean),once:!0,rerender:"",classList:"link enchantment-mouseout",blockClassList:"enchantment-mouseoutblock"}},{name:"doubleclick",enchantDesc:{event:["dblclick"],once:!0,rerender:"",classList:"link enchantment-dblclick",blockClassList:"enchantment-dblclickblock"}}];S.forEach(function(e){"doubleclick"!==e.name&&(u.addChanger.apply(u,[e.name].concat(_toConsumableArray(w(e.enchantDesc,e.name)))),"click"===e.name)&&u.addChanger.apply(u,[e.name+"-rerun"].concat(_toConsumableArray(w(_objectSpread(_objectSpread({},e.enchantDesc),{},{once:!1}),e.name+"-rerun"))))}),r.onStartup(function(){S.forEach(function(e){var n=e.enchantDesc;n.blockClassList&&r.storyElement.on(n.event.map(function(e){return e+".enchantment"}).join(" "),function(){var e,t=c(this);r.options.debug&&r.options.ignoreClickEvents&&!t.is("tw-backdrop.eval-replay *, tw-backdrop.harlowe-crash *")||t.is("tw-open-button")||(e=(t=c(Array.from(t.parents("."+n.blockClassList.replace(/ /g,"."))).sort(function(e,t){return 8&e.compareDocumentPosition(t)?1:-1})[0])).data("enchantmentEvent"))&&e(t)})})}),e.forEach(function(n){S.forEach(function(e){var t;"doubleclick"!==e&&(t=_objectSpread(_objectSpread({},e.enchantDesc),{},{rerender:n}),e=e.name+"-"+n,u.addChanger.apply(u,[e].concat(_toConsumableArray(w(t,e)))))})}),S.forEach(function(i){"doubleclick"!==i&&["goto","undo"].forEach(function(a){var o=i.name+"-"+a;u.addCommand(o,function(e,t){return!e||!t&&"goto"===a?h.create("datatype","A string given to this ("+o+":) macro was empty."):"goto"!==a||n.hasValid(t)?void 0:h.create("macrocall","I can't ("+o+":) the passage '"+t+"' because it doesn't exist.")},function(e,t,n,r){return"undo"===a&&s.pastLength<1?h.create("macrocall","I can't (undo:) on the first turn."):((0,_slicedToArray(w(_objectSpread(_objectSpread({},i.enchantDesc),{},{transition:e.data.passageT8n},"undo"===a?{undo:!0}:{goto:r}),o),2)[1])({section:t},p.from(n)),b(e,{source:""}))},[g(p,String)].concat("undo"===a?[]:String))})})}),define("macrolib/links",["jquery","macros","utils","state","passages","engine","datatypes/changercommand","internaltypes/changedescriptor","datatypes/hookset","datatypes/lambda","internaltypes/twineerror"],function(i,e,c,l,u,p,a,d,t,f,h){var n=e.TypeSignature,r=n.optional,o=n.rest,n=n.either,m=["Links can't have empty strings for their displayed text.","In the link syntax, a link's displayed text is inside the [[ and ]], and on the non-pointy side of the -> or <- arrow if it's there."],g=Object.assign;function s(e,t,n){n=n||t;var r,a=u.hasValid(t)&&t===n,e=e.evaluateTwineMarkup(c.unescape(n),"a link's passage name");return a?t=(a=0<e.children().length?"`".repeat((n.match(/`+/)||[]).reduce(function(e,t){return Math.max(e,t.length+1)},1)):"")+"\0".repeat(!!a)+t+"\0".repeat(!!a)+a:(e.findAndFilter("tw-error").length&&(r=e.findAndFilter("tw-error").data("TwineError")),n=e.text()),{text:t,passage:n,error:r}}c.onStartup(function(){var e="ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints;function t(e){var t=i(this),n=t.closest("tw-expression"),r=t.closest("tw-expression, tw-hook"),a=r.data("clickEvent"),r=r.data("section");if((!c.options.debug||!c.options.ignoreClickEvents||t.is("tw-backdrop.eval-replay *, tw-backdrop.harlowe-crash *"))&&!t.is("tw-open-button")&&(null==r||!r.stackTop||!r.stackTop.blocked||r.stackTop.blocked instanceof i&&r.stackTop.blocked.find(t).length)){if(a)return 0<t.find("tw-error").length?void 0:(e.stopPropagation(),void a(t));var r=n.data("linkPassageName"),o=_objectSpread({},n.data("passageT8n")||{});n.find("tw-enchantment").each(function(e,t){Object.assign(o,i(t).data("passageT8n")||{})}),r?(e.stopPropagation(),p.goToPassage(r,{transition:o})):t.is("[undo]")?(e.stopPropagation(),p.goBack({transition:o})):t.is("[fullscreen]")&&(e.stopPropagation(),p.toggleFullscreen())}}c.storyElement.on("click.passage-link","tw-link"+(e?"":":not(.enchantment-mouseover):not(.enchantment-mouseout):not(.enchantment-dblclick)"),t).on("mouseover.passage-link","tw-link.enchantment-mouseover, tw-expression.enchantment-mouseover > tw-link",t).on("mouseout.passage-link","tw-link.enchantment-mouseout, tw-expression.enchantment-mouseout > tw-link",t).on("dblclick.passage-link","tw-link.enchantment-dblclick, tw-expression.enchantment-dblclick > tw-link",t),i(document).on("fullscreenchange",function(){i("tw-link[fullscreen]",c.storyElement).each(function(e,t){(i(t).closest("tw-expression, tw-hook").data("fullscreenEvent")||Object)(t)})})}),[["link","link-replace"],["link-reveal","link-append"],["link-repeat"],["link-rerun"]].forEach(function(s){return e.addChanger(s,function(e,t,n){return t?n&&!n.canEnchant?h.create("datatype","The changer given to (".concat(s[0],":) can't be (or include) a revision, enchantment, or interaction changer like (replace:), (click:), or (link:).")):a.create(s[0],[t].concat(n||[]),null,!0):h.create("datatype",m[0])},function(r,e,t){var n,a=s[0],o=null!=(n=r.section)&&n.stackTop?r.section.stackTop.tempVariables:Object.create(null),i=d.create({source:"<tw-link tabindex=0>"+e+"</tw-link>",target:function(){return r.target},append:"replace",data:{section:r.section,clickEvent:function(e){r.enablers=r.enablers.filter(function(e){return e.descriptor!==i}),"link-reveal"===a&&e.contents().unwrap();var t,n=e.parentsUntil(":not(tw-enchantment)").parent();n.length||(n=e.parent()),"link-rerun"===a&&(t=e.parentsUntil(":not(tw-enchantment)"),e.detach(),t.remove()),"link"!==a&&"link-rerun"!==a||n.empty(),r.section.renderInto("",null,r,o),"link-rerun"===a&&n.prepend(e)}}});return r.enablers=(r.enablers||[]).concat({descriptor:i,changer:t}),r},[String,r(a)])}),e.addCommand("link-goto",function(e){if(!e)return h.create.apply(h,["datatype"].concat(m))},function(e,t,n,r){var a,o=s(t,n,r);return n=o.text,r=o.passage,(o=o.error)||(e.transition?h.create("datatype","Please attach ("+(o="transition")+"-depart:) or ("+o+"-arrive:) to a passage link, not ("+o+":)."):(a=(a=u.hasValid(r)?a:'<tw-broken-link passage-name="'+c.escape(r)+'">'+n+"</tw-broken-link>")||"<tw-link tabindex=0 "+(0<l.passageNameVisited(r)?'class="visited" ':"")+">"+n+"</tw-link>",e.data.linkPassageName=r,e.data.section=t,g(e,{source:a,transitionDeferred:!0})))},[String,r(String)])("link-storylet",function(){var e=(e=1===arguments.length||"string"!=typeof(arguments.length<=0?void 0:arguments[0])?0:1)<0||arguments.length<=e?void 0:arguments[e];if(!e||"string"==typeof e)return h.create("datatype","(link-storylet:) should be given one index number or one 'where' lambda, after the optional link text string.")},function(e,t){var n=(n=2+("string"==typeof(arguments.length<=2?void 0:arguments[2])?1:0))<2||arguments.length<=n?void 0:arguments[n],r="string"==typeof(arguments.length<=2?void 0:arguments[2])&&(arguments.length<=2?void 0:arguments[2]),a=((a=(arguments.length<=2?0:arguments.length-2)-1+2)<2||arguments.length<=a?void 0:arguments[a])!==n&&((a=(arguments.length<=2?0:arguments.length-2)-1+2)<2||arguments.length<=a?void 0:arguments[a]);if(e.transition)return h.create("datatype","Please attach (".concat(o="transition","-depart:) or (").concat(o,"-arrive:) to (link-storylet:), not (").concat(o,":)."));var o=f.isPrototypeOf(n),i=u.getStorylets(t,o&&n),s=h.containsError(i);if(s)return s;var c,s=i[o?0:n<0?i.length+n:n-1];if(s)s=s.get("name"),r=r||s,c=c||"<tw-link tabindex=0 "+(0<l.passageNameVisited(s)?'class="visited" ':"")+">"+r+"</tw-link>",e.data.linkPassageName=s,e.data.section=t;else{if(!a)return e;c=a}return g(e,{source:c,transitionDeferred:!0})},[n(parseInt,String,f.TypeSignature("where")),r(n(parseInt,String,f.TypeSignature("where"))),r(String)])("link-undo",function(e){if(!e)return h.create("datatype",m[0])},function(t,e,n){var r,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"";return l.pastLength<1?g(t,{source:a}):(r=(t.data.section=e).stackTop.tempVariables,t.data.forgetUndosEvent=function(){return t.data.section.whenUnblocked(function(){var e=_objectSpread(_objectSpread({},t),{},{append:"replace",source:a,transitionDeferred:!1});t.section.renderInto("",null,e,r)})},g(t,{source:"<tw-link tabindex=0 undo>"+n+"</tw-link>",transitionDeferred:!0}))},[String,r(String)])("link-show",function(e){if(!e)return h.create("datatype",m[0])},function(r,a,e){for(var t=arguments.length,n=new Array(3<t?t-3:0),o=3;o<t;o++)n[o-3]=arguments[o];return r.data.section=a,r.data.clickEvent=function(e){e.contents().unwrap(),n.forEach(function(e){return e.forEach(a,function(e){var t=e.data("originalSource")||"",n=e.data("hidden");n&&(e.removeData("hidden"),n instanceof i?e.empty().append(n):(n=e.data("tempVariables"),a.renderInto("",null,_objectSpread(_objectSpread({},r),{},{source:t,target:e,transitionDeferred:!1}),n&&Object.create(n))))})})},g(r,{source:"<tw-link tabindex=0>"+e+"</tw-link>",transitionDeferred:!0})},[String,o(t)])("link-fullscreen",function(e,t){if(!e||!t)return h.create("datatype",m[0])},function(t,e,n,r){function a(){return document.fullscreenEnabled||document.msFullscreenEnabled?"<tw-link tabindex=0 fullscreen>"+(document.fullscreenElement||document.msFullscreenElement?r:n)+"</tw-link>":r?"<tw-broken-link>"+r+"</tw-broken-link>":""}var o=e.stackTop.tempVariables;return t.data.section=e,t.data.fullscreenEvent=function(){(document.fullscreenEnabled||document.msFullscreenEnabled)&&t.data.section.whenUnblocked(function(){var e=_objectSpread(_objectSpread({},t),{},{append:"replace",source:a(),transitionDeferred:!1});t.section.renderInto("",null,e,o)})},g(t,{source:a(),transitionDeferred:!0})},[String,String,r(String)]),e.addChanger(["link-reveal-goto"],function(e,t,n,r){if(!t)return h.create.apply(h,["datatype"].concat(m));if(a.isPrototypeOf(n)){if(a.isPrototypeOf(r))return h.create("datatype","You mustn't give two changers to (link-reveal-goto:)");r=n,n=void 0}return r&&!r.canEnchant?h.create("datatype","The changer given to (link-reveal-goto:) can't include a revision, enchantment, or interaction changer like (replace:), (click:), or (link:)."):(t=(e=s(e,t,n)).text,n=e.passage,e.error||a.create("link-reveal-goto",[t,n,r].filter(function(e){return void 0!==e}),null,!1))},function(t,e,n,r){var a,o,i,s;if(u.hasValid(n))return o=l.passageNameVisited(n),i=null!=(a=t.section)&&a.stackTop?t.section.stackTop.tempVariables:Object.create(null),s=d.create({source:"<tw-link tabindex=0 "+(0<o?'class="visited" ':"")+">"+e+"</tw-link>",target:t.target,append:"replace",data:{section:t.section,append:"replace",clickEvent:function(e){t.enablers=t.enablers.filter(function(e){return e.descriptor!==s}),e.contents().unwrap(),t.section.renderInto("",null,t,i),t.section.whenUnblocked(function(){return p.goToPassage(n,{transition:t.data.passageT8n})})}}}),t.enablers=(t.enablers||[]).concat({descriptor:s,changer:r}),t;t.source='<tw-broken-link passage-name="'+c.escape(n)+'">'+e+"</tw-broken-link>"},[String,r(n(a,String)),r(a)])}),define("macrolib/metadata",["macros","utils/operationutils","datatypes/lambda","internaltypes/twineerror"],function(t,e,n,s){function c(e){return{TwineScript_TypeName:"a ("+e+":) macro",TwineScript_ObjectName:"a ("+e+":) macro",TwineScript_Unstorable:!0,TwineScript_Print:function(){return""}}}var l=e.clone,u=e.objectName,p=e.isValidDatamapName,e=t.TypeSignature,r=e.zeroOrMore,e=e.Any;[["storylet",n.TypeSignature("when")],["urgency",Number],["exclusivity",Number]].forEach(function(e){var e=_slicedToArray(e,2),n=e[0],e=e[1];t.add(n,"Metadata",function(e,t){return e.stackTop.speculativePassage?t:c(n)},e)}),t.add("metadata","Metadata",function(e){for(var r,a=new Map,t=arguments.length,n=new Array(1<t?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];var i=n.reduce(function(e,t){var n;if(!s.containsError(e))if(void 0===r)r=t;else{if(n=s.containsError(p(a,r)))return n;if(a.has(r))return s.create("macrocall","You used the same data name ("+u(r)+") twice in the same (metadata:) call.");a.set(r,l(t)),r=void 0}return e},!0);return s.containsError(i)?i:void 0!==r?s.create("macrocall","This (metadata:) macro has a data name without a value."):e.stackTop.speculativePassage?a:c("metadata")},r(e))}),define("macrolib/patterns",["macros","utils","utils/operationutils","datatypes/lambda","datatypes/datatype","datatypes/typedvar","internaltypes/twineerror","internaltypes/varscope"],function(e,t,n,y,b,h,v,w){function k(e){var r,t,a=e.name,n=e.fullArgs,o=e.args,i=e.makeRegExpString,s=void 0===i?function(e){return e.join("")}:i,c=void 0!==(i=e.insensitive)&&i,l=void 0===(i=e.canContainTypedVars)||i,u=void 0===(i=e.canBeUsedAlone)||i,p=void 0===(i=e.canContainTypedGlobals)||i,d=o||n,f=E(null),e=d.map(function e(t){if(h.isPrototypeOf(t)){var n=t.varRef;if(!l)return v.create("operation","Optional string patterns, like (".concat(a,":)").concat("p-many"===a?" with a minimum of 0 matches":"",", can't have typed variables inside them."));if(!p&&!w.isPrototypeOf(n.object))return v.create("operation","Only typed temp variables can be used in patterns given to (".concat(a,":)"));n=n.getName();if(n in f)return v.create("operation","There's already a typed temp variable named _".concat(n," inside this (").concat(a,":) call."));f[n]=!0;n=e(t.datatype);return v.containsError(n)?n:"("+n+")"}if(b.isPrototypeOf(t)){if(!(l&&p||"function"!=typeof t.typedVars)){n=t.typedVars();if(!l&&n.length)return v.create("operation","(".concat(a,":) can't have typed variables inside its pattern."));if(!p&&n.some(function(e){return!w.isPrototypeOf(e.varRef.object)}))return v.create("operation","Only typed temp variables can be used in patterns given to (".concat(a,":)"))}var r;return t.regExp?(t.rest?"(?:":"")+(c?t.insensitive():t).regExp+(t.rest?")*":""):(n=t.name,r=t.rest?"*":"","alnum"===n?m+r:"whitespace"===n?_+r:"uppercase"===n?(c?T:g)+r:"lowercase"===n?(c?T:S)+r:"anycase"===n?T+r:"digit"===n?"\\d"+r:"linebreak"===n?"(?:\\r|\\n|\\r\\n)"+r:"str"===n?".*?":["even","odd","int","num"].includes(n)?v.create("datatype","Please use string datatypes like 'digit' in (".concat(a,":) instead of number datatypes.")):v.create("datatype","The (".concat(a,":) macro must only be given string-related datatypes, not ").concat(O(t),".")))}return"string"==typeof t?(t=t.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&"),c?t.replace(RegExp("(".concat(g,"|").concat(S,")"),"g"),function(e){return"["+e.toUpperCase()+e.toLowerCase()+"]"}):t):(x("createPattern","mapper() was given a non-string non-datatype "+t),"")});return(i=v.containsError(e))||(r=s(e),t=C(E(b),{name:a,regExp:r,insensitive:function(){return c?t:k({name:a,fullArgs:n,args:d.map(function(e){return b.isPrototypeOf(e)&&"function"==typeof e.insensitive?e.insensitive():e}),makeRegExpString:s,insensitive:!0,canContainTypedVars:l,canBeUsedAlone:u})},typedVars:function(){return d.reduce(function(e,t){return h.isPrototypeOf(t)&&(e=e.concat(c?h.create(k({name:"p-ins",fullArgs:[t.datatype],insensitive:!0}),t.varRef):t),t=t.datatype),e=b.isPrototypeOf(t)&&"function"==typeof t.typedVars?e.concat(t.typedVars()):e},[])},destructure:function(e){var n,t;return"string"!=typeof e?[v.create("operation","I can't put ".concat(O(e)," into ").concat(this.TwineScript_ToSource()," because it isn't a string."))]:(n=this.typedVars()).length?(t=(RegExp("^"+(this.rest?"(?:":"")+r+(this.rest?")*":"")+"$").exec(e)||[]).slice(1)).length?t.map(function(e,t){t=n[t];if(t)return t.datatype.rest&&!t.datatype.regExp&&((t=t.TwineScript_Clone()).datatype=k({name:"p",fullArgs:[t.datatype]})),{dest:t,value:e||"",src:void 0}}).filter(Boolean):[v.create("operation","I can't put ".concat(O(e)," because it doesn't match the pattern ").concat(this.TwineScript_ToSource(),"."))]:[]},TwineScript_IsTypeOf:function(e){return u?"string"==typeof e&&!!e.match("^"+(this.rest?"(?:":"")+r+(this.rest?")*":"")+"$"):v.create("operation","A (".concat(a,":) datatype must only be used with a (p:) macro."))},TwineScript_toTypeSignatureObject:function(){var t=this;return{pattern:"range",name:a,range:function(e){return t.TwineScript_IsTypeOf(e)}}},TwineScript_ToSource:function(){return(this.rest?"...":"")+"("+a+":"+n.map(A)+")"}}),Object.defineProperty(t,"TwineScript_ObjectName",{get:function(){return"a (".concat(a,":) datatype")}}),t)}var m=t.anyRealLetter,g=t.anyUppercase,S=t.anyLowercase,T=t.anyCasedLetter,_=t.realWhitespace,x=t.impossible,O=n.objectName,A=n.toSource,t=e.TypeSignature,n=t.rest,r=t.either,a=t.optional,t=t.nonNegativeInteger,C=Object.assign,E=Object.create,o=n(r(String,b,h));e.add(["p","pattern"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p",fullArgs:n})},o)(["p-either","pattern-either"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-either",fullArgs:n,canContainTypedVars:!1,makeRegExpString:function(e){return"(?:"+e.join("|")+")"}})},o)(["p-opt","pattern-opt","p-optional","pattern-optional"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-opt",fullArgs:n,canContainTypedVars:!1,makeRegExpString:function(e){return"(?:"+e.join("")+")?"}})},o)(["p-not","pattern-not"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.find(function(e){return"string"==typeof e?1!==_toConsumableArray(e).length:e.rest||e.regExp||["str","empty"].includes(e.name)})?v.create("datatype","(p-not:) should only be given single characters, or datatypes that match single characters"):k({name:"p-not",fullArgs:n,canContainTypedVars:!1,makeRegExpString:function(e){return"[^"+e.map(function(e){return e.startsWith("[")&&e.endsWith("]")?e.slice(1,-1):e}).join("")+"]"}})},o)(["p-not-before","pattern-not-before"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-not-before",fullArgs:n,canContainTypedVars:!1,makeRegExpString:function(e){return"(?!"+e.join("")+")"}})},o)(["p-before","pattern-before"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-before",fullArgs:n,canContainTypedVars:!1,makeRegExpString:function(e){return"(?="+e.join("")+")"}})},o)(["p-start","pattern-start"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-start",fullArgs:n,makeRegExpString:function(e){return"^(?:"+e.join("")+")"}})},o)(["p-end","pattern-end"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-end",fullArgs:n,makeRegExpString:function(e){return"(?:"+e.join("")+")$"}})},o)(["p-many","pattern-many"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a,o,i,s=n.slice();return"number"==typeof n[0]&&(a=n.shift(),o="number"==typeof n[0]?n.shift():1/0),!(void 0!==o&&o<a)&&n.length?(i=n.find(function(e){return"string"!=typeof e&&!b.isPrototypeOf(e)&&!h.isPrototypeOf(e)}))?v.create("datatype","This (p-many:) macro can only be given a min and max number followed by datatypes or strings, but was also given "+O(i)+"."):k({name:"p-many",args:n,fullArgs:s,canContainTypedVars:0<a,makeRegExpString:function(e){return"(?:"+e.join("")+")"+(void 0!==a?"{"+a+(o===1/0?",":o!==a?","+o:"")+"}":"+")}}):v.create("datatype","The (p-many:) macro needs to be given string patterns, not just min and max numbers.")},[n(r(t,String,b,h))])(["p-ins","pattern-ins","p-insensitive","pattern-insensitive"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-ins",fullArgs:n,insensitive:!0})},o)(["split","splitted"],"Array",function(e,t,n){if(t=k({name:"split",fullArgs:[t],canContainTypedVars:!1}),v.containsError(t))return t;if(!n)return[""];if(!t.regExp)return _toConsumableArray(n);for(var r,a=RegExp(t.regExp),o=[];n&&(r=a.exec(n));){if(r.index+r[0].length===0)return o;o.push(n.slice(0,r.index)),n=n.slice(r.index+r[0].length)}return o.concat(n||[])},[r(String,b),String])("trimmed","String",function(e,t,n){return void 0===n||b.isPrototypeOf(t)&&"whitespace"===t.name?t.trim():(t=k({name:"trimmed",fullArgs:[t],canContainTypedVars:!1}),v.containsError(t)?t:t.regExp?n.replace(RegExp("^("+t.regExp+")*|("+t.regExp+")*$","g"),""):n)},[r(String,b),a(String)])(["str-find","string-find"],"String",function(e,t,n){if(t=k({name:"str-find",fullArgs:[t],canContainTypedGlobals:!1}),v.containsError(t))return t;for(var r,a=t.typedVars(),o=RegExp(t.regExp,"g"),i=[],s=o.lastIndex;(r=o.exec(n))&&s!==o.lastIndex;)if(s=o.lastIndex,a.length){for(var c=new Map,l=0;l<a.length;l+=1){if("match"===a[l].varRef.getName())return v.create("macrocall","There was a typed temp variable named _match in the pattern given to (str-find:)","The variable _match is reserved, and can't be used inside (str-find:)'s pattern.");c.set(a[l].varRef.getName(),r[l+1]),c.set("match",r[0])}i.push(c)}else i.push(r[0]);return i},[b,String])(["str-replaced","string-replaced","replaced"],"String",function(e,t,n,r,a){if("number"!=typeof t){if(void 0!==a)return v.create("macrocall","1 too many values were given to (str-replaced:).","If this is given 5 values, the first value must be a number of replacements.");a=r,r=n,n=t,t=1/0}else if(void 0===a)return v.create("macrocall","The (str-replaced:) macro needs 1 more value.","The final string seems to be missing.");if(b.isPrototypeOf(r))return v.create("datatype","The replacement value for (str-replaced:) must be a string or lambda, not ".concat(O(r)));if(y.isPrototypeOf(a)||y.isPrototypeOf(n))return v.create("datatype","The ".concat(y.isPrototypeOf(a)?"final string":"search pattern"," given to (str-replaced:) can't be a lambda."),"Only the replacement value (after the search pattern) can be a 'via' lambda.");if(n=k({name:"str-replaced",fullArgs:[n],canContainTypedGlobals:!1}),v.containsError(n))return n;if(!n.regExp)return a;for(var o,i=RegExp(n.regExp,"g"),s=y.isPrototypeOf(r)?n.typedVars():[],c=1,l=0,u="",p=i.lastIndex;a&&(o=i.exec(a))&&0<t&&p!==i.lastIndex;){for(var p=i.lastIndex,d=Object.create(e.stack.length?e.stackTop.tempVariables:w),f=0;f<s.length;f+=1){var h=s[f],m=h.varRef.create(d,h.varRef.propertyChain);if(v.containsError(m))return m;h=m.defineType(h.datatype);if(v.containsError(h))return h;m.set(o[f+1])}var g=y.isPrototypeOf(r)?r.apply(e,{loop:o[0],pos:c,tempVariables:d}):r;if(v.containsError(g))return g;if("string"!=typeof g)return v.create("datatype","(str-replaced:)'s lambda must produce a string, but it produced ".concat(O(g),' when given "').concat(o[0],'".'));u+=a.slice(l,o.index)+g,c+=1,--t,l=o.index+o[0].length}return u+=a.slice(l)},[r(t,String,b),r(b,String,y.TypeSignature("via")),r(String,y.TypeSignature("via")),a(String)])}),define("macrolib/stylechangers",["jquery","macros","utils","utils/renderutils","datatypes/colour","datatypes/hookset","datatypes/gradient","datatypes/changercommand","datatypes/lambda","internaltypes/changedescriptor","internaltypes/twineerror"],function(s,e,c,t,a,n,r,o,i,l,u){var p,d,f=t.geomParse,h=t.geomStringRegExp,m=Object.assign,t=e.TypeSignature,g=t.either,y=t.wrapped,b=t.optional,v=t.Any,w=t.Everything,k=t.zeroOrMore,S=t.rest,T=t.insensitiveSet,_=t.positiveNumber,x=t.positiveInteger,O=t.nonNegativeNumber,t=t.percent,y=[y(Boolean,'If you gave a number, you may instead want to check that the number is not 0. If you gave a string, you may instead want to check that the string is not "".')],A=(c.onStartup(function(){return c.storyElement.on("mouseenter.hover-macro","[hover=false]",function(){var e=s(this),t=e.data("hoverChanger");c.options.debug&&c.options.ignoreClickEvents&&!e.is("tw-backdrop.eval-replay *, tw-backdrop.harlowe-crash *")||(e.data({mouseoutStyle:e.attr("style")||""}),l.create({target:e},t).update(),e.attr("hover",!0))}).on("mouseleave.hover-macro","[hover=true]",function(){var e=s(this),t=e.data("mouseoutStyle");e.attr("style",t).removeData("mouseoutStyle").attr("hover",!1)})}),u.on(function(){s("tw-expression, tw-hook",c.storyElement).each(function(e,t){((t=s(t)).data("errorEvent")||Object)(t)})}),T("instant","dissolve","fade","rumble","shudder","pulse","zoom","flicker","slideleft","slideright","slideup","slidedown","fadeleft","faderight","fadeup","fadedown","blur")),C=T("dotted","dashed","solid","double","groove","ridge","inset","outset","none");e.addChanger("if",function(e,t){return o.create("if",[t])},function(e,t){return e.enabled=e.enabled&&t},y)("unless",function(e,t){return o.create("unless",[t])},function(e,t){return e.enabled=e.enabled&&!t},y)("elseif",function(e,t){return"lastHookShown"in e.stack[0]?o.create("elseif",[!1===e.stack[0].lastHookShown&&!!t]):u.create("macrocall","There's no (if:) or something else before this to do (else-if:) with.")},function(e,t){return e.enabled=e.enabled&&t},y)("else",function(e){return"lastHookShown"in e.stack[0]?o.create("else",[!1===e.stack[0].lastHookShown]):u.create("macrocall","There's nothing before this to do (else:) with.")},function(e,t){return e.enabled=e.enabled&&t},null)("hidden",function(){return o.create("hidden")},function(e){return e.enabled=!1},null)(["verbatim","v6m"],function(){return o.create("verbatim")},function(e){return e.verbatim=!0},null)("live",function(e,t){return o.create("live",t?[t]:[])},function(e,t){e.enabled=!1,e.transitionDeferred=!0,e.data.live={delay:t}},b(Number))("event",function(e,t){return o.create("event",[t])},function(e,t){e.enabled=!1,e.transitionDeferred=!0,e.data.live={event:t}},i.TypeSignature("when"))("more",function(){return o.create("more")},function(e){e.enabled=!1,e.transitionDeferred=!0,e.data.live={event:{when:!0,filter:function(e){return 0!==e.Identifiers.exits?[]:[!0]}}}},null)("after",function(e,t,n){return o.create("after",[t].concat(void 0!==n?[n]:[]))},function(e,t,n){e.enabled=!1,e.transitionDeferred=!0,e.data.live={event:{when:!0,filter:function(e){return c.anyInputDown()&&n&&(t-=n),e.Identifiers.time>t?[!0]:[]}}}},[_,b(O)])("after-error",function(){return o.create("after-error",[])},function(n){n.enabled=!1,n.transitionDeferred=!0;var r=n.section.stackTop.tempVariables;n.data.errorEvent=function(e){e.removeData("errorEvent");var t=_objectSpread(_objectSpread({},n),{},{enabled:!0,transitionDeferred:!1});t.data&&(t.data.errorEvent=void 0),n.section.whenUnblocked(function(){return n.section.renderInto("",null,t,r)})}},[])("hook",function(e,t){var n;return t?(n=c.insensitiveName(t))?o.create("hook",[n]):u.create("datatype",'The string given to (hook:), "'.concat(t,'", contained only dashes and underscores.')):u.create("datatype","The string given to (hook:) was empty.")},function(e,t){return e.attr.push({name:t})},[String])(["for","loop"],function(e,t){if(!t.loop)return u.create("datatype","The lambda provided to (for:) must refer to a temp variable, not just 'it'.");for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return o.create("for",[t].concat(r))},function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];var o,i=t.filter(e.section,r);if(o=u.containsError(i))return o;e.loopVars[t.loop.getName()]=i||[]},[i.TypeSignature("where"),k(v)])(["transition","t8n"],function(e,t){return o.create("transition",[c.insensitiveName(t)])},function(e,t){return"zoom"===(e.transition=t)&&(e.transitionOrigin=function(){var e=s(this).offset(),t=e.left,e=e.top;return c.mouseCoords.x-t+"px "+(c.mouseCoords.y-e)+"px"}),e},[A])(["transition-time","t8n-time"],function(e,t){return o.create("transition-time",[t])},function(e,t){return e.transitionTime=t,e.data.passageT8n=m(e.data.passageT8n||{},{time:t}),e},[_])(["transition-delay","t8n-delay"],function(e,t){return o.create("transition-delay",[t])},function(e,t){return e.transitionDelay=t,e},[O])(["transition-skip","t8n-skip"],function(e,t){return o.create("transition-skip",[t])},function(e,t){return e.transitionSkip=t,e},[_])(["transition-depart","t8n-depart"],function(e,t){return o.create("transition-depart",[c.insensitiveName(t)])},function(e,t){return e.data.passageT8n=m(e.data.passageT8n||{},{depart:t}),"zoom"===t&&(e.data.passageT8n.departOrigin=function(){var e=s(this).offset(),t=e.left,e=e.top;return c.mouseCoords.x-t+"px "+(c.mouseCoords.y-e)+"px"}),e},[A])(["transition-arrive","t8n-arrive"],function(e,t){return o.create("transition-arrive",[c.insensitiveName(t)])},function(e,t){return e.data.passageT8n=m(e.data.passageT8n||{},{arrive:t}),"zoom"===t&&(e.data.passageT8n.arriveOrigin=function(){var e=s(this),t=e.offset(),n=t.left,t=t.top,r=e.height();return{"transform-origin":100*(c.mouseCoords.x-n)/e.width()+"% "+100*(c.mouseCoords.y-t)/r+"%",height:r+"px"}}),e},[A])("button",function(e,t){return void 0===t||f(t).size?o.create("button",t?[t]:[]):u.create("datatype",'The string given to (button:) should be a sizing line ("==X==", "==X", "=XXXX=" etc.), not '.concat(JSON.stringify(t),"."))},function(e,t){var t=f(t),n=t.marginLeft,t=t.size;return e.attr.push({class:function(){return this.className+(this.classList.contains("enchantment-button")?"":" ".repeat(0<this.className.length)+"enchantment-button")}}),e.styles.push({"margin-left":t?n+"%":void 0,width:t?t+"%":"100%"}),e},[b(String)]).apply(void 0,_toConsumableArray((d={click:{className:"enchantment-link",blockClassName:"enchantment-clickblock"},doubleclick:{className:"enchantment-dblclick",blockClassName:"enchantment-dblclickblock"},mouseover:{className:"enchantment-mouseover",blockClassName:"enchantment-mouseoverblock"},mouseout:{className:"enchantment-mouseout",blockClassName:"enchantment-mouseoutblock"}},["action",function(e,t){return o.create("action",[c.insensitiveName(t)])},function(e,t){return e.attr.push({class:function(){var e=function e(t){return(t=s(t)).is("tw-story, tw-sidebar, tw-passage")||["block","flex"].includes(t.css("display"))||t.children().get().some(e)}(this);return Array.from(this.classList).filter(function(t){return!Object.keys(d).some(function(e){return d[e].className===t||d[e].blockClassName===t})}).concat(d[t][e?"blockClassName":"className"]).join(" ")}}),e},[T.apply(void 0,_toConsumableArray(Object.keys(d)))]])))(["border","b4r"],function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return o.create("border",n.map(c.insensitiveName))},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.styles.push({display:function(){var e=s(this).css("display");return n.every(function(e){return"none"===e})||!e.includes("inline")?e:"inline-block"},"border-style":n.join(" "),"border-width":function(){return this.style.borderWidth||"2px"}}),e},[C].concat(_toConsumableArray(Array(3).fill(b(C)))))(["border-size","b4r-size"],function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return o.create("border-size",n)},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.styles.push({"border-width":n.map(function(e){return e+"px"}).join(" ")}),e},[O].concat(_toConsumableArray(Array(3).fill(b(O)))))("corner-radius",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return o.create("corner-radius",n)},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.styles.push({"border-radius":n.map(function(e){return e+"px"}).join(" "),padding:function(){return this.style.padding||n.map(function(e){return e+"px"}).join(" ")}}),e},[O].concat(_toConsumableArray(Array(3).fill(b(O)))))(["border-colour","b4r-colour","border-color","b4r-color"],function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return o.create("border-colour",n.map(function(e){return a.isPrototypeOf(e)?e.toRGBAString(e):e}))},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.styles.push({"border-color":n.join(" ")}),e},[g(String,a)].concat(_toConsumableArray(Array(3).fill(b(g(String,a))))))("opacity",function(e,t){return o.create("opacity",[t])},function(e,t){return e.styles.push({opacity:t})},[t])("font",function(e,t){return o.create("font",[t])},function(e,t){return e.styles.push({"font-family":t}),e},[String])("align",function(e,t){var n=t.indexOf("><");return/^(==+>|<=+|=+><=+|<==+>)$/.test(t)?((n=~n?_objectSpread({"text-align":"center","max-width":"50%"},25===(n=Math.round(n/(t.length-2)*50))?{"margin-left":"auto","margin-right":"auto"}:{"margin-left":n+"%"}):"<"===t[0]&&">"===t.slice(-1)?{"text-align":"justify","max-width":"50%"}:t.includes(">")?{"text-align":"right"}:{"text-align":"left"}).display="block",o.create("align",[n])):u.create("datatype",'The (align:) macro requires an alignment arrow ("==>", "<==", "==><=" etc.) be provided, not "'+t+'"')},function(e,t){e.styles.push(t)},[String])(["text-colour","text-color","color","colour"],function(e,t){return o.create("text-colour",[t])},function(e,t){return a.isPrototypeOf(t)&&(t=t.toRGBAString(t)),e.styles.push({color:t}),e},[g(String,a)])(["text-size","size"],function(e,t){return o.create("text-size",[t])},function(e,t){return e.styles.push({"font-size":24*t+"px","line-height":36*t+"px"}),e},[O])("text-indent",function(e,t){return o.create("text-indent",[t])},function(e,t){return e.styles.push({"text-indent":t+"px",display:"inline-block"}),e},[O])(["text-rotate-z","text-rotate"],function(e,t){return o.create("text-rotate-z",[t])},function(e,t){return e.styles.push({display:"inline-block",transform:function(){var e=s(this).css("transform")||"";return(e="none"===e?"":e)+" rotate("+t+"deg)"}}),e},[Number])("text-rotate-y",function(e,t){return o.create("text-rotate-y",[t])},function(e,t){return e.styles.push({display:"inline-block",transform:function(){var e=s(this).css("transform")||"";return(e="none"===e?"":e)+" perspective(50vw) rotateY("+t+"deg)"}}),e},[Number])("text-rotate-x",function(e,t){return o.create("text-rotate-x",[t])},function(e,t){return e.styles.push({display:"inline-block",transform:function(){var e=s(this).css("transform")||"";return(e="none"===e?"":e)+" perspective(50vw) rotateX("+t+"deg)"}}),e},[Number])(["background","bg"],function(e,t){return o.create("background",[t])},function(e,t){return a.isPrototypeOf(t)?t=t.toRGBAString():r.isPrototypeOf(t)&&(t=t.toLinearGradientString()),t=a.isHexString(t)||a.isCSS3Function(t)?{"background-color":t}:t.startsWith("linear-gradient(")||t.startsWith("repeating-linear-gradient(")?{"background-image":t}:{"background-size":"cover","background-image":"url(".concat(t,")"),"background-attachment":"fixed"},e.styles.push(t,{display:function(){var e=s(this);return!e.children().length||c.childrenProbablyInline(e)?s(this).css("display"):"block"}}),e},[g(String,a,r)]).apply(void 0,_toConsumableArray((y={color:function(){return"transparent"}},p=m(Object.create(null),{none:{},bold:{"font-weight":"bold"},italic:{"font-style":"italic"},underline:{"text-decoration":"underline"},doubleunderline:{"text-decoration":"underline","text-decoration-style":"double"},wavyunderline:{"text-decoration":"underline","text-decoration-style":"wavy"},strike:{"text-decoration":"line-through"},doublestrike:{"text-decoration":"line-through","text-decoration-style":"double"},wavystrike:{"text-decoration":"line-through","text-decoration-style":"wavy"},superscript:{"vertical-align":"super","font-size":".83em"},subscript:{"vertical-align":"sub","font-size":".83em"},blink:{animation:"fade-in-out 1s steps(1,end) infinite alternate"},shudder:{animation:"shudder linear 0.1s 0s infinite"},mark:{"background-color":"hsla(60, 100%, 50%, 0.6)"},condense:{"letter-spacing":"-0.08em"},expand:{"letter-spacing":"0.1em"},outline:[{"text-shadow":function(){var e=s(this).css("color");return"-1px -1px 0 "+e+", 1px -1px 0 "+e+",-1px  1px 0 "+e+", 1px  1px 0 "+e}},{color:function(){return c.parentColours(s(this)).backgroundColour}}],shadow:{"text-shadow":function(){return"0.08em 0.08em 0.08em "+s(this).css("color")}},emboss:{"text-shadow":function(){return"0.04em 0.04em 0em "+s(this).css("color")}},smear:[{"text-shadow":function(){var e=s(this).css("color");return"0em   0em 0.02em "+e+",-0.2em 0em  0.5em "+e+", 0.2em 0em  0.5em "+e}},y],blur:[{"text-shadow":function(){return"0em 0em 0.08em "+s(this).css("color")}},y],blurrier:[{"text-shadow":function(){return"0em 0em 0.2em "+s(this).css("color")},"user-select":"none"},y],mirror:{display:"inline-block",transform:"scaleX(-1)"},upsidedown:{display:"inline-block",transform:"scaleY(-1)"},tall:{display:"inline-block",transform:"scaleY(1.5) translateY(-0.25ex)"},flat:{display:"inline-block",transform:"scaleY(0.5) translateY(0.25ex)"},fadeinout:{animation:"fade-in-out 2s ease-in-out infinite alternate"},rumble:{animation:"rumble linear 0.1s 0s infinite"},sway:{animation:"sway linear 2.5s 0s infinite"},buoy:{animation:"buoy linear 2.5s 0s infinite"},fidget:{animation:function(){return"fidget step-end 60s "+60*-Math.random()+"s infinite"+(Math.random()<.5?" reverse":"")}}}),["text-style",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return o.create("text-style",n.map(c.insensitiveName))},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0;a<n.length;a+=1)"none"===n[a]?e.styles=[]:e.styles=e.styles.concat(p[n[a]]);return e},[S(T.apply(void 0,_toConsumableArray(Object.keys(p))))]])))("collapse",function(){return o.create("collapse")},function(e){return e.attr.push({collapsing:!0}),e},[])("hover-style",function(e,t){var n=l.create(),r=(t.run(n),n.summary());return r+""=="styles"||r.every(function(e){return"styles"===e||"attr"===e})&&n.attr.every(function(e){return Object.keys(e)+""=="style"})?o.create("hover-style",[t]):u.create("datatype","The changer given to (hover-style:) must only change the hook's style.")},function(e,t){return e.data.hoverChanger=t,e.attr.push({hover:function(e,t){return void 0!==t&&t}}),e},[o])("css",function(e,t){return t.trim().endsWith(";")||(t+=";"),o.create("css",[t])},function(e,t){return e.attr.push({style:function(){return(s(this).attr("style")||"")+t}}),e},[String])("test-true",function(){return o.create("test-true",[])},function(e){return e.enabled=!0},k(w))("test-false",function(){return o.create("test-false",[])},function(e){return e.enabled=!1},k(w)),e.addCommand("animate",s.noop,function(r,e,t,a,o){t.forEach(e,function(e){var t,n;"zoom"===name&&(n=(t=e.offset()).left,t=t.top,n=c.mouseCoords.x-n+"px "+(c.mouseCoords.y-t)+"px"),c.transitionIn(e,a,r.transitionTime||o,r.transitionDelay,r.transitionSkip,0,n)})},[S(n),T.apply(void 0,_toConsumableArray(A.innerType.filter(function(e){return"instant"!==e}))),b(_)]),["box","float-box"].forEach(function(i){return e.addChanger(i,function(e,t,n){var r=-1===t.search(h)||1<t.length&&!t.includes("="),a="float-box"===i&&(-1===n.search(h)||1<n.length&&!n.includes("="));return r||a?u.create("datatype","The ("+i+':) macro requires a sizing line("==X==", "==X", "=XXXX=" etc.) be provided, not "'+(r?t:n)+'".'):o.create(i,[t,n].filter(function(e){return void 0!==e}))},function(e,t,n){var r,t=f(t),a=t.marginLeft,t=t.size,o=("float-box"===i&&(r=(o=f(n)).marginLeft,n=o.size),"box"===i?"%":"vw"),t=_defineProperty(_defineProperty(_defineProperty({display:"block",width:t+o,"max-width":t+o},"box"===i?"margin-left":"left",a+o),"overflow-y","auto"),"padding",function(){var e=s(this).css("padding");return e&&"0px"!==e?e:"1em"});return void 0!==n&&(t.height="box"===i?1.5*n+2+"em":n+"vh"),"float-box"===i&&m(t,{position:"fixed",top:r+"vh","background-color":function(){return c.parentColours(s(this)).backgroundColour}}),e.styles.push(t),e},[String,"box"===i?b(x):String])})}),define("macrolib/values",["macros","state","utils","utils/operationutils","datatypes/colour","datatypes/gradient","datatypes/datatype","datatypes/hookset","datatypes/codehook","internaltypes/twineerror"],function(t,r,e,n,l,c,a,o,i,f){var s=e.realWhitespace,u=e.nth,p=e.anyRealLetter,d=e.plural,h=n.subset,m=n.objectName,g=n.clone,y=n.toSource,e=t.TypeSignature,n=e.rest,b=e.zeroOrMore,v=e.either,w=e.optional,k=e.insensitiveSet,S=e.numberRange,T=e.percent,_=e.nonNegativeInteger,x=e.positiveInteger,e=e.Any,O=Math.max,A=Math.min,C=Math.round,E=Math.floor,N=Math.ceil;function j(t){return function(){var e=t.apply(void 0,arguments);return"number"!=typeof e||isNaN(e)?f.create("macrocall","This mathematical expression doesn't compute!"):e}}t.add(["str","string","text"],"String",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.map(function(e){return i.isPrototypeOf(e)?e.source:e}).join("")},[b(t.TypeSignature.either(String,Number,Boolean,Array,i))])("source","String",function(e,t){return"command"!==(null==t?void 0:t.TwineScript_TypeID)||t.TwineScript_ToSource?y(t):f.create("datatype","I can't construct the source code of a command created by a custom macro.")},[e])("substring","String",function(e,t,n,r){return h(t,n,r)},[String,parseInt,parseInt])("lowercase","String",function(e,t){return t.toLowerCase()},[String])("uppercase","String",function(e,t){return t.toUpperCase()},[String])("lowerfirst","String",function(e,t){return t.replace(RegExp(p+"+"),function(e){return(e=Array.from(e))[0].toLowerCase()+e.slice(1).join("").toLowerCase()})},[String])("upperfirst","String",function(e,t){return t.replace(RegExp(p+"+"),function(e){return(e=Array.from(e))[0].toUpperCase()+e.slice(1).join("").toLowerCase()})},[String])("words","Array",function(e,t){return t.split(RegExp(s+"+")).filter(Boolean)},[String])(["str-repeated","string-repeated"],"String",function(e,t,n){return 0===n.length?f.create("macrocall","I can't repeat an empty string."):n.repeat(t)},[_,String])(["str-reversed","string-reversed"],"String",function(e,t){return _toConsumableArray(t).reverse().join("")},[String])("joined","String",function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return r.join(t)},[n(String)])("plural","String",function(e,t,n,r){return n&&""!==r?d(t,n,r):f.create("macrocall","The (plural:) macro can't be given empty strings.")},[parseInt,String,w(String)])(["str-nth","string-nth"],"String",function(e,t){return u(t)},[parseInt])("digit-format","String",function(e,t,n){if(1e21<=Math.abs(n))return f.create("macrocall","The number given to (digit-format:) is too big.");for(var r=/([^#0])(?=[#0]*$)/g,a=(r.exec(t)||[])[1],o=(/^[#0]*([^#0])/g.exec(t)||[])[1],i=(t=_toConsumableArray(t)).length,s=(a&&(","!==a||o&&","!==o)&&(i=r.lastIndex-1),Math.abs(n).toFixed(16).replace(/(\.\d*?)0+$/,function(e,t){return t}).replace(/^0+/,"")),c=s.includes(".")?s.indexOf("."):s.length,l=0,u="",p=t.length-1;0<=p;--p){var d=t[p];"0"===d||"#"===d?u=(s[c-i+p+l]||("0"===d?"0":""))+u:p<t.length-1&&0<p&&(u=d+u,l+=p===i?0:1)}return(n<0?"-":"")+u},[String,Number])(["num","number"],"Number",function(e,t){return Number.isNaN(+t)?f.create("macrocall","I couldn't convert "+m(t)+" to a number."):+t},[String])("datatype","Datatype",function(e,t){return a.from(t)},[e])("datapattern","Any",function(e,t){return function n(e){var r;return Array.isArray(e)?r=e.map(n):e instanceof Map?(r=new Map,_toConsumableArray(e).forEach(function(e){var e=_slicedToArray(e,2),t=e[0],e=e[1];return r.set(t,n(e))})):r=a.from(e),(e=f.containsError(r))||r}(t)},[e])(["rgb","rgba"],"Colour",function(e){return l.create({r:arguments.length<=1?void 0:arguments[1],g:arguments.length<=2?void 0:arguments[2],b:arguments.length<=3?void 0:arguments[3],a:arguments.length<=4?void 0:arguments[4]})},[S(0,255),S(0,255),S(0,255),w(T)])(["hsl","hsla"],"Colour",function(e,t,n,r,a){return(t=C(t)%360)<0&&(t+=360),l.create({h:t,s:n,l:r,a:a})},[Number,T,T,w(T)])(["lch","lcha"],"Colour",function(e,t,n,r,a){return(r=C(r)%360)<0&&(r+=360),l.create({l:t,c:n,h:r,a:a})},[T,S(0,132),Number,w(T)])("complement","Colour",function(e,t){return t.LCHRotate(180)},[l])("mix","Colour",function(e,t,n,r,a){n=n.toLCHA(),a=a.toLCHA();var o=1,i=(t+r!==1&&(t+r<1&&(o=t+r),t=(i=[t/(t+r),r/(t+r)])[0],r=i[1]),n.c<2||n.l<.01||.99<n.l?n.h=a.h:(a.c<2||a.l<.01||.99<a.l)&&(a.h=n.h),n.l*=n.a,n.c*=n.a,a.l*=a.a,a.c*=a.a,180<a.h-n.h?n.h+=360:a.h-n.h<-180&&(a.h+=360),n.a*t+a.a*r),s=(n.l*t+a.l*r)/i,c=(n.c*t+a.c*r)/i,n=(n.h*t+a.h*r)/i;return l.create({l:s,c:c,h:n,a:i*o})},[T,l,T,l])("palette","Array",function(e,t,n){var r,a=n.toLCHA(),o=a.l,a={l:o<=.75?.75+o/3:.75-3*(1-o),c:80,h:a.h,a:1},i=l.create(a);return a.l+=o<=.75?-.1:.1,a.l<.5&&(a.l*=.5/a.l),r=l.create(a),a.l+=o<=.85?.15:-.15,o=l.create(a),"adjacent"===t?(r=(i=i.LCHRotate(-30)).LCHRotate(30),o=i.LCHRotate(60)):"triad"===t&&(o=i.LCHRotate(180),r=i.LCHRotate(140),i=i.LCHRotate(-140)),[n,i,r,o]},[k("mono","adjacent","triad"),l])("gradient","Gradient",function(e,t){(t=C(t)%360)<0&&(t+=360);for(var n,r,a,o=arguments.length,i=new Array(2<o?o-2:0),s=2;s<o;s++)i[s-2]=arguments[s];return i.length<4?f.create("datatype","(gradient:) must be given at least 2 colour-stop pairs of numbers and colours."):(r=[],a=i.reduce(function(e,t){if(!f.containsError(e))if(void 0===n)n=t;else{if("number"!=typeof n||!l.isPrototypeOf(t))return f.create("datatype","(gradient:) colour-stops should be pairs of numbers and colours, not colours and numbers.");r.push({stop:n,colour:g(t)}),n=void 0}return e},!0),f.containsError(a)?a:void 0!==n?f.create("macrocall","This gradient has a colour-stop percent without a colour."):c.create(t,r))},[Number,n(v(T,l))])("stripes","Gradient",function(e,t,n){(t=C(t)%360)<0&&(t+=360);for(var r=0,a=[],o=arguments.length,i=new Array(3<o?o-3:0),s=3;s<o;s++)i[s-3]=arguments[s];return i.forEach(function(e){a.push({stop:r,colour:g(e)}),r+=n,a.push({stop:r,colour:g(e)})}),c.create(t,a,!0)},[Number,x,l,n(l)])("hooks-named","HookName",function(e,t){return t?o.create({type:"name",data:t}):f.create("datatype","(hooks-named:) can't be given an empty string.")},[String])("cond","Any",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0;a<n.length;a+=2){var o=n[a];if(a===n.length-1||f.containsError(o))return o;if("boolean"!=typeof o)return f.create("datatype","(cond:)'s "+u(a+1)+" value is "+m(o)+", but should be a boolean.");if(o)return n[a+1]}return f.create("macrocall","An odd number of values must be given to (cond:), not "+n.length,"(cond:) must be given one or more pairs of booleans and values, as well as one final value.")},[Boolean,e,n(e)]);({weekday:[function(){return["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur"][(new Date).getDay()]+"day"},null],monthday:[function(){return(new Date).getDate()},null],currenttime:[function(){var e=new Date,t=e.getHours()<12;return(e.getHours()%12||12)+":"+((e.getMinutes()<10?"0":"")+e.getMinutes())+" "+(t?"A":"P")+"M"},null],currentdate:[function(){return(new Date).toDateString()},null],min:[A,n(Number)],max:[O,n(Number)],abs:[Math.abs,Number],sign:[Math.sign,Number],sin:[Math.sin,Number],cos:[Math.cos,Number],tan:[Math.tan,Number],floor:[E,Number],round:[C,Number],trunc:[function(e){return(0<e?E:N)(e)},Number],ceil:[N,Number],pow:[j(Math.pow),[Number,Number]],exp:[Math.exp,Number],sqrt:[j(Math.sqrt),Number],log:[j(Math.log),Number],log10:[j(Math.log10),Number],log2:[j(Math.log2),Number],random:[function(e,t){var n,t=t?(n=A(e,t),O(e,t)):(n=0,e);return t+=1,~~(r.random()*(t-n))+n},[parseInt,t.TypeSignature.optional(parseInt)]],"":function(){for(var e in this)e&&hasOwnProperty.call(this,e)&&t.add(e,"Number",function(a){return function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a.apply(void 0,n)}}(this[e][0]),this[e][1])}})[""](),t.add("either","Any",function(e){var t=1+~~(r.random()*(arguments.length<=1?0:arguments.length-1));return t<1||arguments.length<=t?void 0:arguments[t]},n(e))("nth","Any",function(e,t){return t<=0?f.create("datatype","(nth:)'s first value should be a positive whole number, not "+t):(t=(t-1)%(arguments.length<=2?0:arguments.length-2)+2)<2||arguments.length<=t?void 0:arguments[t]},[parseInt,n(e)])}),!function(){var a,k={};function o(e){for(var t in e)this[t]=e[t]}function i(e,t){for(var n,r,a=e.innerText,o=null,i=0,s=i,c=a.length,l=null;i<c;){for(var u=a.slice(i),p=(o&&o.length?o[0]:e).innerMode,d=0,f=p.length;d<f;d+=1){var h=k[p[d]];if(!(h.constraint&&!h.constraint(l)||h.cannotFollowText&&("text"===(null==(w=l)?void 0:w.type)||s<i))&&(h.plainCompare?u.startsWith(h.pattern):h.pattern.test(u))){var m=h.fn(h.plainCompare?h.pattern:h.pattern.exec(u)),g=!1,y=0;if(m.matches){for(;o&&y<o.length;y+=1){var b=o[y],v=b.type,b=b.aka;if(v in m.matches){g=!0;break}b&&(v=b),-1<(null==(b=m.cannotCross)?void 0:b.indexOf(v))&&(y=o.length-1)}if((!o||y>=o.length)&&!m.isFront)continue}s<i&&e.addChild({type:"text",text:a.slice(s,i),innerMode:p});var s=i+=(l=e.addChild(m)).text.length,w=!1;g&&(t&&S(e,l,o[y]),o=o.slice(y+1),w=!0),!w&&l.isFront&&(o?o.unshift(l):o=[l]);break}}d===f&&(i+=1,null===l)&&(l={type:"text"})}for(s<i&&e.addChild({type:"text",text:a.slice(s,i),innerMode:(null!=(n=o)&&n.length?o[0]:e).innerMode});0<(null==(r=o)?void 0:r.length);)o.shift().demote();return e}function S(e,t,n){var r=e.children.indexOf(t),a=e.children.indexOf(n);t.children=e.children.splice(a+1,r-(a+1)),t.type=t.matches[n.type],t.innerText="";for(var o,i=0,s=t.children.length;i<s;i++)t.innerText+=t.children[i].text;for(o in t.start=n.start,t.text=n.text+t.innerText+t.text,n)hasOwnProperty.call(n,o)&&!hasOwnProperty.call(t,o)&&(t[o]=n[o]);t.isFront&&(t.isFront=!1),e.children.splice(a,1)}o.prototype={constructor:o,addChild:function(e){var t=this.lastChildEnd(),n=new o(e);return n.start=t,n.end=e.text&&t+e.text.length,n.place=this.place,n.children=[],n.innerText&&i(n),this.children.push(n),n},lastChildEnd:function(){var e=this.children&&this.children[this.children.length-1]||null;return e?e.end:this.start+Math.max(0,this.text.indexOf(this.innerText))},tokenAt:function(e){if(e<this.start||e>=this.end)return null;if(this.children.length)for(var t=0;t<this.children.length;t+=1)if(e>=this.children[t].start&&e<this.children[t].end){var n=this.children[t].tokenAt(e);if(n)return n}return this},pathAt:function(e){if(e<this.start||e>=this.end)return[];var t=[];if(this.children.length)for(var n=0;n<this.children.length;n+=1)if(e>=this.children[n].start&&e<this.children[n].end){var r=this.children[n].pathAt(e);if(r.length){t=t.concat(r);break}}return t.concat(this)},nearestTokenAt:function(n){return n<this.start||n>=this.end?null:this.children?this.children.reduce(function(e,t){return e||(n>=t.start&&n<t.end?t:null)},null):this},everyLeaf:function(n){return this.children&&0!==this.children.length?this.children.reduce(function(e,t){return e&&t.everyLeaf(n)},!0):!!n(this)},demote:function(){this.type="text"},error:function(e){this.type="error",this.message=e},toString:function(){var e=this.type+"("+this.start+"\u2192"+this.end+")";return this.children&&0<this.children.length&&(e+="["+this.children+"]"),e},copy:function(){var e=new o(this);return e.children=e.children.slice(),e},foldChildren:function(){for(var e=[],t=this.children.slice(),n=0;n<t.length;n+=1){var r=t[n],a=!1;if(r.matches)for(var o=0;o<e.length;o+=1)e[o].type in r.matches&&(S(this,r,e[o]),e=e.slice(o+1),a=!0);!a&&r.isFront&&e.unshift(r)}}},a={lex:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"start",r=3<arguments.length&&void 0!==arguments[3]&&arguments[3];return i(new o({type:"root",place:t,start:0,end:e.length,text:e,innerText:e,children:[],innerMode:a.modes[n]}),!r)},rules:k,modes:{}},"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports=a:"function"==typeof define&&define.amd?define("lexer",[],function(){return a}):this&&null!=this&&this.loaded?(this.modules||(this.modules={}),this.modules.Lexer=a):this.Lexer=a}.call(eval("this")||("undefined"!=typeof global?global:window)),!function(){Object.assign=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var m,g=Object.keys,y=Object.assign;function t(e){function t(n){return n=n||"innerText",function(e){var e=e.reduceRight(function(e,t,n){return e||(n?t:"")},""),t={};return t[n]=e,t}}function n(e,t){var n={};return n[e]=t,function(){return{isFront:!0,matches:n,cannotCross:["verbatimOpener"]}}}var r=Object.bind(0,null);function a(a,e){return Object.keys(e).forEach(function(n){var r=e[n].fn;e[n].fn=function(e){var t=r(e);return t.text||(t.text="string"==typeof e?e:e[0]),t.type||(t.type=n),t.innerMode||(t.innerMode=a),t}}),e}function o(e){switch(e&&e.type){case null:case"br":case"hr":case"bulleted":case"numbered":case"heading":case"align":case"column":case"escapedLine":return!0}return!1}var i=[],s=[],c=[],l=a(i,{hr:{fn:r},bulleted:{fn:function(e){return{depth:e[1].length}}},numbered:{fn:function(e){return{depth:e[1].length/2}}},heading:{fn:function(e){return{depth:e[1].length}}},align:{fn:function(e){var t,e=e[1],n=e.indexOf("><");return~n?25===(t=Math.round(n/(e.length-2)*50))&&(t="center"):"<"===e[0]&&">"===e.slice(-1)?t="justify":-1<e.indexOf(">")?t="right":-1<e.indexOf("<")&&(t="left"),{align:t}}},column:{fn:function(e){var t,e=e[1],n=e.indexOf("|");return n&&n<e.length-1?t="center":"|"===e[0]&&"|"===e.slice(-1)?t="none":n===e.length-1?t="right":n||(t="left"),{column:t,width:/\|+/.exec(e)[0].length,marginLeft:/^=*/.exec(e)[0].length,marginRight:/=*$/.exec(e)[0].length}}}}),u=(g(l).forEach(function(e){l[e].constraint=o,l[e].cannotFollowText=!0}),a(i,{twine1Macro:{fn:function(){return{type:"error",message:"Harlowe macros use a different syntax to Twine 1, SugarCube, and Yarn macros."}}},emBack:{fn:function(){return{matches:{emFront:"em"},cannotCross:["verbatimOpener"]}}},strongBack:{fn:function(){return{matches:{strongFront:"strong"},cannotCross:["verbatimOpener"]}}},strongFront:{fn:function(){return{isFront:!0}}},emFront:{fn:function(){return{isFront:!0}}},boldOpener:{fn:n("boldOpener","bold")},italicOpener:{fn:n("italicOpener","italic")},strikeOpener:{fn:n("strikeOpener","strike")},supOpener:{fn:n("supOpener","sup")},commentFront:{fn:function(){return{isFront:!0}}},commentBack:{fn:function(){return{matches:{commentFront:"comment"}}}},scriptStyleTag:{fn:r},tag:{fn:r},url:{fn:r},hookPrependedFront:{fn:function(e){return{name:e[1],hidden:")"===e[2],isFront:!0,tagPosition:"prepended"}}},hookFront:{fn:function(){return{isFront:!0}}},hookBack:{fn:function(){return{matches:{hookPrependedFront:"hook",hookFront:"hook"},cannotCross:["verbatimOpener"]}}},hookAppendedBack:{fn:function(e){return{name:e[2],hidden:"("===e[1],tagPosition:"appended",matches:{hookFront:"hook"},cannotCross:["verbatimOpener"]}}},unclosedHook:{fn:r},unclosedHookPrepended:{fn:function(e){return{type:"unclosedHook",name:e[1],hidden:")"===e[2]}}},verbatimOpener:{fn:function(e){var e=e[0].length,t={};return{type:(t["verbatim"+e]="verbatim")+e,isFront:!0,matches:t,aka:"verbatimOpener"}}},unclosedCollapsed:{fn:r},collapsedFront:{fn:function(){return{isFront:!0}}},collapsedBack:{fn:function(){return{matches:{collapsedFront:"collapsed"},cannotCross:["verbatimOpener"]}}},escapedLine:{fn:r},legacyLink:{fn:function(e){return{type:"twineLink",innerText:e[1],passage:e[2],innerMode:i}}},br:{fn:r}})),p=y(a(s,{macroFront:{fn:function(e){return{isFront:!0,name:e[1]}}},groupingBack:{fn:function(){return{matches:{groupingFront:"grouping",macroFront:"macro"},cannotCross:["singleStringOpener","doubleStringOpener","hookFront"]}}},passageLink:{fn:function(e){var t=e[1]||"",n=e[2]||"",e=e[3]||"";return{type:"twineLink",innerText:n?e:t,passage:t?e:n,innerMode:i}}},simpleLink:{fn:function(e){return{type:"twineLink",innerText:e[1]||"",passage:e[1]||"",innerMode:i}}},variable:{constraint:function(e){return!e||"macroFront"!==e.type},fn:t("name")},tempVariable:{constraint:function(e){return!e||"macroFront"!==e.type},fn:t("name")}}),{hookFront:u.hookFront,hookBack:u.hookBack}),d=a(s,_objectSpread(_objectSpread({commentBack:{fn:function(){return{matches:{commentFront:"comment"}}}},macroName:{constraint:function(e){return e&&"macroFront"===e.type},fn:t("name")},groupingFront:{fn:function(){return{isFront:!0}}},property:{fn:t("name"),constraint:function(e){if(e)switch(e.type){case"variable":case"hookName":case"property":case"tempVariable":case"colour":case"itsProperty":case"belongingItProperty":case"macro":case"grouping":case"string":case"datatype":case"hook":case"boolean":case"number":return!0}}},possessiveOperator:{fn:r},itsProperty:{cannotFollowText:!0,fn:t("name")},itsOperator:{cannotFollowText:!0,fn:r},belongingItProperty:{cannotFollowText:!0,fn:t("name")},belongingItOperator:{cannotFollowText:!0,fn:r},belongingProperty:{cannotFollowText:!0,fn:t("name")},belongingOperator:{cannotFollowText:!0,fn:r},escapedStringChar:{fn:function(){return{type:"text"}}},singleStringOpener:{fn:function(){return{isFront:!0,matches:{singleStringOpener:"string"},innerMode:c}}},doubleStringOpener:{fn:function(){return{isFront:!0,matches:{doubleStringOpener:"string"},innerMode:c}}},hookName:{fn:t("name")},cssTime:{fn:function(e){return{value:+e[1]*("s"===e[2].toLowerCase()?1e3:1)}}},datatype:{cannotFollowText:!0,fn:function(e){return{name:e[0].toLowerCase()}}},colour:{cannotFollowText:!0,fn:function(e){var e=e[0].toLowerCase(),t={red:"e61919",orange:"e68019",yellow:"e5e619",lime:"80e619",green:"19e619",cyan:"19e5e6",aqua:"19e5e6",blue:"197fe6",navy:"1919e6",purple:"7f19e6",fuchsia:"e619e5",magenta:"e619e5",white:"fff",black:"000",gray:"888",grey:"888"},t=hasOwnProperty.call(t,e)?"#"+t[e]:e;return{colour:t}}},number:{fn:function(e){return{value:parseFloat(e[0])}}},inequality:{fn:function(e){return{operator:e[2],negate:-1<e[1].indexOf("not")}}},augmentedAssign:{fn:function(e){return{operator:e[0][0]}}},identifier:{fn:t("name"),cannotFollowText:!0},whitespace:{fn:r,cannotFollowText:!0},incorrectOperator:{fn:function(e){var t={"=>":">=","=<":"<=",gte:">=",lte:"<=",gt:">",lt:"<",eq:"is",isnot:"is not",neq:"is not",isa:"is a",are:"is",x:"*","or a":"or"}[e[0].toLowerCase().replace(/\s+/g," ")];return{type:"error",message:"Please say "+(t?"'"+t+"'":"something else")+" instead of '"+e[0]+"'.",explanation:"In the interests of readability, I want certain operators to be in a specific form."}},cannotFollowText:!0}},["boolean","is","to","into","where","when","via","making","each","and","or","not","isNot","contains","doesNotContain","isIn","isA","isNotA","isNotIn","matches","doesNotMatch","bind"].reduce(function(e,t){return e[t]={fn:r,cannotFollowText:!0},e},{})),["comma","spread","typeSignature","addition","subtraction","multiplication","division"].reduce(function(e,t){return e[t]={fn:r},e},{}))),f=a(c,{singleStringCloser:d.singleStringOpener,doubleStringCloser:d.doubleStringOpener,escapedStringChar:d.escapedStringChar}),h=(i.push.apply(i,_toConsumableArray(g(l)).concat(_toConsumableArray(g(p)),_toConsumableArray(g(u)))),s.push.apply(s,_toConsumableArray(g(p)).concat(_toConsumableArray(g(d)))),c.push.apply(c,_toConsumableArray(g(f))),_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread({},l),u),p),d),f)),u=(g(h).forEach(function(e){m.PlainCompare[e]?(h[e].pattern=m.PlainCompare[e],h[e].plainCompare=!0):h[e].pattern=RegExp("^(?:"+m[e]+")","i")}),y(e.rules,h),e.modes);return u.start=u.markup=i,u.macro=s,u.string=c,e}function n(e){return Object.freeze({lex:t(e).lex,Patterns:m})}"object"===("undefined"==typeof module?"undefined":_typeof(module))?(m=require("./patterns"),module.exports=n(require("./lexer"))):"function"==typeof define&&define.amd?define("markup",["lexer","patterns"],function(e,t){return m=t,n(e)}):this&&this.loaded&&this.modules?(m=this.modules.Patterns,this.modules.Markup=n(this.modules.Lexer)):(m=this.Patterns,this.Markup=n(this.Lexer))}.call(eval("this")||("undefined"!=typeof global?global:window)),!function(){var e;function n(t){return t&&"object"===_typeof(t)?(Object.keys(t).forEach(function(e){t[e]=n(t[e])}),t):(t+"").replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")}function t(e){return function(){return"("+e+Array.apply(0,arguments).join("|")+")"}}var r=t("?:"),a=t("?!"),o=t("?="),i="[ \\f\\t\\v\\u00a0\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000]*",s=i.replace("*","+"),c="\\b",l="[\\w\\-\\u00c0-\\u00de\\u00df-\\u00ff\\u0150\\u0170\\u0151\\u0171\\uD800-\\uDFFF]",u=l.replace("\\-",""),p=r("\\n","$"),d=i+"(\\*+)"+s,f=i+"((?:0\\.)+)"+s,h=i+"-{3,}"+i+p,m=i+"(==+>|<=+|=+><=+|<==+>)"+i+p,p=i+"(=+\\|+|\\|+=+|=+\\|+=+|\\|=+\\|)"+i+p,g={opener:"\\[\\[(?!\\[)",text:"("+function(){return"[^"+Array.apply(0,arguments).map(n).join("")+"]*"}("]")+")",rightSeparator:r("\\->","\\|"),leftSeparator:"<\\-",closer:"\\]\\]",legacySeparator:"\\|",legacyText:"("+r("[^\\|\\]]","\\]"+a("\\]"))+"+)"},y=u+"*"+u.replace("\\w","a-zA-Z")+u+"*",b="\\$("+y+")",v="_("+y+")",w="'s"+s+a("_")+"("+y+")",k="("+y+")"+s+"of"+c+a("it\\b"),S="'s"+s,T=r("it","time","turns?","visits?","exits?","pos")+c,_="its"+s+"("+y+")",x="("+y+")"+s+"of"+s+"it"+c,O="of"+s+"it"+c,A={opener:"\\(",name:"("+r("\\$","_")+"?"+l+"+):"+a("\\/"),closer:"\\)"},C=r("=<","=>","[gl]te?\\b","n?eq\\b","isnot\\b","are\\b","x\\b","isa\\b","or"+s+"a"+c),E="[a-zA-Z][\\w\\-]*",N="(?:\"[^\"]*\"|'[^']*'|[^'\">])*?",j="\\|("+l+"+)(>|\\))",P="(<|\\()("+l+"+)\\|",R="((?:\\b\\d+(?:\\.\\d+)?|\\.\\d+)(?:[eE][+\\-]?\\d+)?)"+a("m?s")+c;g.main=g.opener+r(g.text+g.rightSeparator,g.text.replace("*","*?")+g.leftSeparator)+g.text,e={upperLetter:"[A-Z\\u00c0-\\u00de\\u0150\\u0170]",lowerLetter:"[a-z0-9_\\-\\u00df-\\u00ff\\u0151\\u0171]",anyLetter:l,anyLetterStrict:u,whitespace:s.replace("[","[\\n\\r"),escapedLine:"\\\\\\n\\\\?|\\n\\\\",br:"\\n(?!\\\\)",tag:"<\\/?"+E+N+">",scriptStyleTag:"<("+r("script","style","textarea")+")"+N+">[^]*?<\\/\\1>",scriptStyleTagOpener:"<",url:"("+r("https?","mailto","javascript","ftp","data")+":\\/\\/[^\\s<]+[^<.,:;\"')\\]\\s])",bullet:"\\*",hr:h,heading:"[ \\f\\t\\v\\u00a0\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000]*(#{1,6})[ \\f\\t\\v\\u00a0\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000]*",align:m,column:p,bulleted:d,numbered:f,verbatimOpener:"`+",hookAppendedFront:"\\["+a("=+"),hookPrependedFront:j+"\\["+a("=+"),hookFront:"\\["+a("=+"),hookBack:"\\]"+a(P),hookAppendedBack:"\\]"+P,unclosedHook:"\\[=+",unclosedHookPrepended:j+"\\[=+",unclosedCollapsed:"\\{=+",passageLink:g.main+g.closer,legacyLink:g.opener+g.legacyText+g.legacySeparator+g.legacyText+g.closer,simpleLink:g.opener+g.legacyText+g.closer,macroFront:A.opener+o(A.name),macroName:A.name,groupingFront:"\\("+a(A.name),twine1Macro:"<<[^>\\s]+\\s*(?:\\\\.|'(?:[^'\\\\]*\\\\.)*[^'\\\\]*'|\"(?:[^\"\\\\]*\\\\.)*[^\"\\\\]*\"|[^'\"\\\\>]|>(?!>))*>>",validPropertyName:y,property:w,belongingProperty:k,possessiveOperator:S,belongingOperator:"of\\b",itsOperator:"its\\b",belongingItOperator:O,variable:b,tempVariable:v,hookName:"\\?("+l+"+)\\b",cssTime:"(\\d+\\.?\\d*|\\d*\\.?\\d+)(m?s)\\b",colour:r(r("Red","Orange","Yellow","Lime","Green","Cyan","Aqua","Blue","Navy","Purple","Fuchsia","Magenta","White","Gray","Grey","Black","Transparent"),"#[\\dA-Fa-f]{3}(?:[\\dA-Fa-f]{3})?"),datatype:r("alnum","alphanumeric","any(?:case)?","array","bool(?:ean)?","changer","codehook","colou?r","const","command","dm","data"+r("map","type","set"),"ds","digit","gradient","empty","even","int"+a("o")+"(?:eger)?","lambda","lowercase","macro","linebreak","newline","num(?:ber)?","odd","str(?:ing)?","uppercase","whitespace")+c,number:R,boolean:r("true","false")+c,identifier:T,itsProperty:_,belongingItProperty:x,escapedStringChar:"\\\\[^\\n]",singleStringOpener:"'",doubleStringOpener:'"',singleStringCloser:"'",doubleStringCloser:'"',is:"is"+a(s+"not"+c,s+"an?"+c,s+"in"+c,s+"<",s+">")+c,isNot:"is"+s+"not"+a(s+r("an?","in")+c)+c,isA:"is"+s+"an?"+c,isNotA:"is"+s+"not"+s+"an?"+c,matches:"matches\\b",doesNotMatch:"does"+s+"not"+s+"match"+c,and:"and\\b",or:"or\\b",not:"not\\b",inequality:"((?:is(?:"+s+"not)?"+i+")*)("+r("<(?!=)","<=",">(?!=)",">=")+")",isIn:"is"+s+"in"+c,contains:"contains\\b",doesNotContain:"does"+s+"not"+s+"contain"+c,isNotIn:"is"+s+"not"+s+"in"+c,addition:n("+")+a("="),subtraction:n("-")+a("=","type"),multiplication:n("*")+a("="),division:r("/","%")+a("="),spread:"\\.\\.\\."+a("\\."),to:r("to\\b","="),into:"into\\b",making:"making\\b",where:"where\\b",when:"when\\b",via:"via\\b",each:"each\\b",augmentedAssign:r("\\+","\\-","\\*","\\/","%")+"=",bind:"2?bind\\b",typeSignature:n("-type")+c,incorrectOperator:C,PlainCompare:{comma:",",commentFront:"\x3c!--",commentBack:"--\x3e",strikeOpener:"~~",italicOpener:"//",boldOpener:"''",supOpener:"^^",strongFront:"**",strongBack:"**",emFront:"*",emBack:"*",collapsedFront:"{",collapsedBack:"}",groupingBack:")"}},"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports=e:"function"==typeof define&&define.amd?define("patterns",[],function(){return e}):this&&this.loaded?(this.modules||(this.modules={}),this.modules.Patterns=e):this.Patterns=e}.call(eval("this")||("undefined"!=typeof global?global:window)),define("twinescript/operations",["utils","utils/operationutils","datatypes/typedvar","datatypes/datatype","internaltypes/twineerror"],function(e,t,n,r,m){var a=e.plural,o=t.isObject,i=t.collectionType,s=t.is,c=t.isA,l=t.clone,u=t.unique,p=t.contains,e=t.matches,g=t.objectName,d=t.toSource;function f(r,a,o,i){return o=o||"do this to",function(e,t){var n;return 1===a.length&&(t=e),(n=m.containsError(e,t))||(_typeof(e)!==r||_typeof(t)!==r?m.create("operation","I can only ".concat(o," ").concat(r,"s, not ").concat(g(_typeof(e)!==r?e:t),"."),i):a(e,t))}}function h(a){return function(e,t){var n,r;return(n=m.containsError(e,t))||(_typeof(e)!==_typeof(t)||o(e)&&"TwineScript_TypeName"in e&&o(t)&&"TwineScript_TypeName"in t&&e.TwineScript_TypeName!==t.TwineScript_TypeName||i(e)!==i(t)?(n="".concat(g(e)," isn't the same type of data as ").concat(g(t)),_typeof(e)+_typeof(t)!=="stringnumber"&&_typeof(e)+_typeof(t)!=="numberstring"||(r="You might want to convert one side to a number using (num:), or to a string using (str:)."),m.create("operation",n[0].toUpperCase()+n.slice(1),r)):a(e,t))}}function y(d,f,e){var h=2<arguments.length&&void 0!==e&&e;return function r(a,o){var e;if(e=m.containsError(a,o))return e;var t=_slicedToArray(a.determiner?[a,o]:o.determiner?[o,a]:[],2),i=t[0],t=t[1];if(i){var n=i,s=n.determiner,n=n.determined;if("start"===s||"end"===s){if(f)return m.create("operation","I can't use '".concat(f,"' with the 'start' or 'end' of ").concat(g(n),"."));if(t.determiner){if("start"===t.determiner||"end"===t.determiner)return m.create("operation","I can't compare one value's 'start' or 'end' with another value's 'start' or 'end'.","Please change one of them to use an exact range, such as '1stto4th' or '2ndlasttolast'.");n=[t,i],i=n[0]}for(var c=i.string||i.array,l=0;l<c.length+1;l+=1){var u=l?"end"===s?c.slice(-l):c.slice(0,l):c.constructor(),u=i===a?r(u,o):r(a,u);if(e=m.containsError(u))return e;if(u!==h)return u}return h}var p="all"===s;return i.array.reduce(function(e,t){var n,t=i===a?r(t,o):r(a,t);return(n=m.containsError(e,t))||(p?e&&t:e||t)},p)}return d(a,o)}}function b(n,e){return y(function(e,t){e=n(e,t);return m.containsError(e)?e:!e},e,!0)}t="If one of these values is a number, you may want to write a check that it 'is not 0'. Also, if one is a string, you may want to write a check that it 'is not \"\" '.",t={and:f("boolean",h(function(e,t){return e&&t}),"use 'and' to join",t),or:f("boolean",h(function(e,t){return e||t}),"use 'or' to join",t),not:f("boolean",function(e){return!e},"use 'not' to invert",t),"+":h(function(e,t){var n;return Array.isArray(e)?[].concat(_toConsumableArray(e),_toConsumableArray(t)):e instanceof Map?(n=new Map(e),t.forEach(function(e,t){return n.set(t,e)}),n):e instanceof Set?new Set([].concat(_toConsumableArray(e),_toConsumableArray(t)).filter(u).map(l)):"function"==typeof e["TwineScript_+"]?e["TwineScript_+"](t):"string|number|boolean".includes(_typeof(e))?e+t:m.create("operation","I can't use + on ".concat(g(e),"."))}),"-":h(function(e,n){var r;return Array.isArray(e)?e.filter(function(t){return!n.some(function(e){return s(t,e)})}):e instanceof Set?(r=_toConsumableArray(n),new Set(_toConsumableArray(e).filter(function(t){return!r.some(function(e){return s(t,e)})}))):"string"==typeof e?e.split(n).join(""):"number"==typeof e?e-n:m.create("operation","I can't use - on ".concat(g(e),"."))}),"*":f("number",h(function(e,t){return e*t}),"multiply"),"/":f("number",h(function(e,t){return 0===t?m.create("operation","I can't divide ".concat(g(e)," by zero.")):e/t}),"divide"),"%":f("number",h(function(e,t){return 0===t?m.create("operation","I can't modulo ".concat(g(e)," by zero.")):e%t}),"modulus"),"<":y(f("number",h(function(e,t){return e<t}),"do < to"),"<"),">":y(f("number",h(function(e,t){return t<e}),"do > to"),">"),"<=":y(f("number",h(function(e,t){return e<=t}),"do <= to"),"<="),">=":y(f("number",h(function(e,t){return t<=e}),"do >= to"),">="),is:y(s),isNot:b(s),contains:y(p,"contains"),doesNotContain:b(p,"does not contain"),isIn:y(function(e,t){return p(t,e)},"is in"),isNotIn:b(function(e,t){return p(t,e)},"is not in"),isA:y(c,"is a"),isNotA:b(c,"is not a"),typifies:y(function(e,t){return c(t,e)}),untypifies:b(function(e,t){return c(t,e)}),matches:y(e),doesNotMatch:b(e),makeSpreader:function(e){var t;return m.containsError(e)?e:n.isPrototypeOf(e)||r.isPrototypeOf(e)?(t=l(e),(n.isPrototypeOf(e)?t.datatype:t).rest=!0,t):{value:e,spreader:!0,TwineScript_TypeName:"a spreaded '...' value",TwineScript_ObjectName:a("string"==typeof e||Array.isArray(e)?_toConsumableArray(e).length:1,"spreaded '...' value"),TwineScript_Unstorable:!0,TwineScript_ToSource:function(){return""+_toConsumableArray(e).map(d)}}}};return Object.freeze(t)}),define("twinescript/runner",["macros","state","utils","utils/operationutils","twinescript/operations","datatypes/colour","datatypes/hookset","datatypes/lambda","datatypes/datatype","datatypes/varbind","datatypes/codehook","datatypes/typedvar","datatypes/assignmentrequest","internaltypes/varref","internaltypes/twineerror"],function(Macros,State,Utils,_ref127,Operations,Colour,HookSet,Lambda,Datatype,VarBind,CodeHook,TypedVar,AssignmentRequest,VarRef,TwineError){var toSource=_ref127.toSource,typeName=_ref127.typeName,objectName=_ref127.objectName,insensitiveName=Utils.insensitiveName,impossible=Utils.impossible,hash=Utils.hash;function addFreeVariable(e,t){var n,r=e.freeVariables;"macro"===t.type?"current-time"===(n=insensitiveName(t.name))||"current-date"===n||"monthday"===n||"weekday"===n||"history"===n||"visited"===n||"passage"===n?e.freeVariables=!0:t.blockedValue&&!r.blockedValues?r.blockedValues=e.stackTop.blockedValues.concat():"random"!==n&&"either"!==n&&"shuffled"!==n||r.seed||(r.seed=State.seed,r.seedIter=State.seedIter):"identifier"===t.type?"time"!==(n=insensitiveName(t.text))&&"exits"!==n&&"it"!==n&&"visits"!==n&&"turns"!==n||(e.freeVariables=!0):"property"===t.type||"belongingProperty"===t.type?"random"!==insensitiveName(t.name)||r.seed||(r.seed=State.seed,r.seedIter=State.seedIter):"variable"!==t.type&&"tempVariable"!==t.type||(e.freeVariables=!0)}var precedenceTable=[["error","text"],["comma"],["to","into"],["where","when","via","making","each"],["typeSignature"],["augmentedAssign"],["and","or"],["is","isNot"],["contains","doesNotContain","isIn","isNotIn"],["isA","isNotA","matches","doesNotMatch"],["inequality"],["addition","subtraction"],["multiplication","division"],{rightAssociative:["spread","bind"]},{rightAssociative:["not","positive","negative"]},{rightAssociative:["belongingProperty","belongingItProperty","belongingOperator","belongingItOperator"]},["property","itsProperty","possessiveOperator","itsOperator"],["twineLink","macro","identifier","variable","tempVariable","hookName","number","cssTime","boolean","string","hook","colour","datatype","root"],["grouping"]];function precedentToken(e,t){var n,r,a,o=[];if(e.length)for("most"===t?(n=precedenceTable.length-1,r=a=-1):(n=0,r=precedenceTable.length,a=1);n!==r;n+=a){var i=precedenceTable[n],s=NaN;if(i.rightAssociative){for(var c=0;c<e.length;c+=1)if(i.rightAssociative.includes(e[c].type)){s=c;break}}else for(var l=e.length-1;0<=l;--l)if(i.includes(e[l].type)){s=l;break}if(!Number.isNaN(s)&&-1<s){o=[e[s],s];break}}return o}var comparisonOpTypes=["inequality","is","isNot","isIn","contains","doesNotContain","isNotIn","isA","typifies","isNotA","untypifies","matches","doesNotMatch"],inequalityNegator={">":"<=","<":">=",">=":"<","<=":">"};function compileComparisonOperator(e){return"inequality"===e.type?e.negate?inequalityNegator[e.operator]:e.operator:e.type}var comparisonReverser={">":"<","<":">",">=":"<=","<=":">=",contains:"isIn",doesNotContain:"isNotIn",isIn:"contains",isA:"typifies",typifies:"isA",isNotA:"untypifies",untypifies:"isNotA"};function reverseComparisonOperator(e){e=compileComparisonOperator(e);return comparisonReverser[e]||e}var tokenSides={error:"neither",identifier:"neither",variable:"neither",tempVariable:"neither",hookName:"neither",number:"neither",boolean:"neither",string:"neither",hook:"neither",colour:"neither",datatype:"neither",root:"neither",twineLink:"neither",macro:"neither",grouping:"neither",itsProperty:"neither",belongingItProperty:"neither",to:"both",into:"both",typeSignature:"both",augmentedAssign:"both",and:"both",or:"both",belongingOperator:"both",possessiveOperator:"both",multiplication:"both",division:"both",spread:"after",bind:"after",not:"after",belongingProperty:"after",each:"after",itsOperator:"after",positive:"after",negative:"after",belongingItOperator:"before",property:"before"};function missingSideError(e,t,n){return TwineError.create("syntax","I need usable code to be ".concat(e?"left ":"").concat(e&&t?"and ":"").concat(t?"right ":"","of ").concat(n.text,"."))}function wrongSideError(e,t,n){return TwineError.create("syntax","There can't be a ".concat(e&&t?e.map(function(e){return e.text}).join("")+" or "+t.map(function(e){return e.text}).join(""):(e||t).map(function(e){return e.text}).join("")," to the ").concat(e?"left ":"").concat(e&&t?"or ":"").concat(t?"right ":"","of ").concat(n.text,"."),"There could be a comma missing between them.")}function makeEvalReplayFrame(e,t){var n=t.val,r=t.fromCode,a=t.toCode,o=t.toDesc,i=t.reason,s=t.it,c=t.tokens,t=t.i;if(!(200<=e.length)){var l=c[t],u=c.slice(0,t),t=c.slice(t+1);if(1===c.length&&(u=t=!1,l=c[0]),!e[e.length-1].error){var p,d,c=TwineError.containsError(n),f=e[e.length-1].code,h=e[0].basis,m=(null!=(p=u)&&p.length&&null!=(p=t)&&p.length&&u[0].start>t[0].start&&(u=(p=[t,u])[0],t=p[1]),p=a||"".concat(null!=(p=u)&&p.length&&"whitespace"===u[u.length-1].type?" ":"").concat(c?" \ud83d\udc1e ":(n&&!n.TwineScript_ToSource&&n.TwineScript_Unstorable?objectName:toSource)(n)).concat(null==(p=t)||!p.length||"whitespace"!==t[0].type&&"addition"!==l.type&&"subtraction"!==l.type?"":" "),(u.length?u[0]:l).start-h),g=(t.length?t[t.length-1]:l).end-h,y=_createForOfIteratorHelper(e);try{for(y.s();!(d=y.n()).done;){var b=d.value;b.start<m?(m+=b.diff,g+=b.diff):b.start<g&&(g+=b.diff)}}catch(e){y.e(e)}finally{y.f()}!r&&(r=f.slice(m,g),a)&&a.trim()===r.trim()||(u=p.length-(g-m),e.push({code:f.slice(0,m)+p+f.slice(g),fromCode:r,toCode:!c&&a,toDesc:!c&&!a&&(o||objectName(n)),start:m,end:g,diff:u,reason:i,itIdentifier:void 0!==s&&objectName(s),error:c&&c.render(f.slice(m,g),!0)}))}}}function setIt(e,t){return(VarRef.isPrototypeOf(t)||TypedVar.isPrototypeOf(t))&&(e.Identifiers.it=t.get()),t}return function run(section,tokens){var isVarRef=2<arguments.length&&void 0!==arguments[2]&&arguments[2],isTypedVar=3<arguments.length&&void 0!==arguments[3]&&arguments[3],evalReplay=section.evalReplay,hasEvalReplay=null==evalReplay?void 0:evalReplay.length,evalReplayReason,evalReplaySkip=!1,evalReplayIt,ops=Operations,token,ret,i,before,after,_precedentToken,_precedentToken2,token,i,before,after;if(Array.isArray(tokens)||(tokens=[tokens]),!tokens.length||!tokens[0])return impossible("Runner.run","No tokens to run!"),0;1===tokens.length?token=tokens[0]:(_precedentToken=precedentToken(tokens,"least"),_precedentToken2=_slicedToArray(_precedentToken,2),token=_precedentToken2[0],i=_precedentToken2[1],before=tokens.slice(0,i),after=tokens.slice(i+1),before.length&&(1!==before.length||"whitespace"!==before[0].type)||(before=!1),after.length&&(1!==after.length||"whitespace"!==after[0].type)||(after=!1));var type=token.type;if(!type)return impossible("Runner.run","Token has no type!"),0;var sides=tokenSides[type]||"",VARREF=("both"!==sides||before&&after?"neither"===sides&&(before||after)?ret=wrongSideError(before,after,token):"before"===sides?before?after&&(ret=wrongSideError(null,after,token)):ret=missingSideError(!0,!1,token):"after"===sides&&(after?before&&(ret=wrongSideError(before,null,token)):ret=missingSideError(!1,!0,token)):ret=missingSideError(!before,!after,token),section.freeVariables&&"object"===_typeof(section.freeVariables)&&addFreeVariable(section,token),!0),TYPEDVAR=!0,_ret4,val,evalReplayReason,ret,source,_source4,_value4,msg;if(!ret){if("comma"===type)return impossible("Section.run","a comma token was run() somehow."),0;if("root"===type)ret=run(section,token.children);else if("identifier"===type)ret=isVarRef?VarRef.create(section.Identifiers,token.text.toLowerCase()):section.Identifiers[token.text.toLowerCase()];else if("variable"===type||"tempVariable"===type){ret=VarRef.create("tempVariable"===type?section.stackTop.tempVariables:State.variables,token.name),isTypedVar?(ret=TypedVar.create(Datatype.create("any"),ret),evalReplayReason=hasEvalReplay&&"Variables in 'to' or 'into' expressions with no -type to their left are considered to be 'any-type' variables that can store any storable value."):isVarRef||TwineError.containsError(ret)?evalReplaySkip=!0:(val=ret.get(),evalReplayReason=hasEvalReplay&&((null==(_ret4=ret)?void 0:_ret4.object)!==State.variables||hasOwnProperty.call(ret.object,ret.compiledPropertyChain[0])?"":"This variable didn't exist; for story-wide $ variables, a default value of 0 is used if they don't exist."),ret=val)}else if("hookName"===type)ret=HookSet.create({type:"name",data:token.name}),evalReplaySkip=!0;else if("number"===type||"cssTime"===type)ret=token.value,evalReplayReason=hasEvalReplay&&"cssTime"===type&&(token.text.endsWith("ms")?"The letters 'ms' at the end of numbers are ignored, so you can use them to indicate that a number represents milliseconds.":"The letter 's' at the end of numbers represents 'seconds'. Harlowe converts them to milliseconds (multiplies them by 1000)."),evalReplaySkip=!evalReplayReason;else if("boolean"===type)ret="true"===token.text.toLowerCase(),evalReplaySkip=!0;else if("string"===type){var t=token.text.replace(/(.?)\n/g,function(e,t){return("\\"===t?"\\\\":"\n"===t?"\\n":t)+"\\n"}).replace(/(\\*)\\0/g,function(e,t){return(t?"\\".repeat(2*t.length):"")+"0"});ret=eval(t),evalReplaySkip=!0}else if("hook"===type)ret=CodeHook.create(token.children,token.text),evalReplaySkip=!0;else if("colour"===type)ret=Colour.create(token.colour),evalReplaySkip=!0;else if("datatype"===type)ret=Datatype.create(token.name),evalReplaySkip=!0;else if("spread"===type)ret=ops.makeSpreader(run(section,after,!1,isTypedVar));else if("bind"===type)ret=VarBind.create(run(section,after,VARREF),token.text.startsWith("2")?"two way":""),evalReplaySkip=!0;else if("to"===type||"into"===type){var dest="to"===type?setIt(section,run(section,before,VARREF,TYPEDVAR)):run(section,after,VARREF,TYPEDVAR);if(TwineError.containsError(dest))ret=dest;else{(VarRef.isPrototypeOf(dest)&&dest.propertyChain.length<=1||TypedVar.isPrototypeOf(dest)&&dest.varRef.propertyChain.length<=1)&&(section.freeVariables=Object.create(null));var src="to"===type?run(section,after,VARREF):setIt(section,run(section,before,VARREF));if(TwineError.containsError(src))return src;var freeVariables=section.freeVariables,srcRef;section.freeVariables=null,token.place&&freeVariables&&"object"===_typeof(freeVariables)&&"boolean"!=typeof src&&"number"!=typeof src&&!Utils.options.uncompressedPureValues&&(srcRef=freeVariables,srcRef.at=token.place,srcRef.from=after[0].start,srcRef.to=after[after.length-1].end,srcRef.hash=hash(after.reduce(function(e,t){return e+t.text},"")).toString(16),JSON.stringify(srcRef).length>=toSource(src).length)&&(srcRef=void 0),ret=AssignmentRequest.create(dest,src,type,srcRef),evalReplaySkip=!0,evalReplayIt=section.Identifiers.it}}else if("typeSignature"===type){var datatype=run(section,before),free=section.freeVariables,variable=(section.freeVariables=null,run(section,after,VARREF));section.freeVariables=free,ret=TypedVar.create(datatype,variable),evalReplaySkip=!0}else if("where"===type||"when"===type||"via"===type){after?(source=tokens.map(function(e){return e.text}).join(""),ret=Lambda.create(before?run(section,before,VARREF):void 0,token.type,after,source),evalReplaySkip=!0):ret=missingSideError(!1,!0,token)}else if("making"===type||"each"===type){after?(_source4=[].concat(tokens).map(function(e){return e.text}).join(""),ret="each"===type?Lambda.create(run(section,after,VARREF),"each",null,_source4):Lambda.create(before?run(section,before,VARREF):void 0,token.type,run(section,after,VARREF),_source4),evalReplaySkip=!0):ret=missingSideError(!1,!0,token)}else if("augmentedAssign"===type)ret=ops.makeAssignmentRequest(run(section,before,VARREF),ops[token.operator](run(section,before),run(section,after)),token.operator),evalReplaySkip=!0;else if("and"===type||"or"===type){var isComparisonOp=function e(t){var n=_slicedToArray(precedentToken(t,"least"),2),r=n[0],n=n[1];if(r&&"whitespace"!==r.type)return comparisonOpTypes.includes(r.type)?r:r.type===type?e(t.slice(0,n))||e(t.slice(n+1)):void 0},leftIsComparison=isComparisonOp(before),rightIsComparison=isComparisonOp(after),ambiguityError=TwineError.create("operation",'This use of "is not" and "'.concat(type,'" is grammatically ambiguous.'),'Maybe try rewriting this as "__ is not __ '.concat(type,' __ is not __"')),operator,getElisionOperands=function e(t){var n,r=_slicedToArray(precedentToken(t,"least"),2),a=r[0],r=r[1];return a&&"whitespace"!==a.type?a.type===type?[].concat(_toConsumableArray(e(t.slice(0,r))),_toConsumableArray(e(t.slice(r+1)))):(a=run(section,t),hasEvalReplay&&"boolean"!=typeof a&&(n=operator.replace(/[A-Z]/g,function(e){return" "+e.toLowerCase()}),makeEvalReplayFrame(evalReplay,{toCode:" it ".concat(n," ").concat(toSource(a)," "),reason:"A missing 'it ".concat(n,"' was inferred to correct the '").concat(type,"' operation."),tokens:t,i:r}),makeEvalReplayFrame(evalReplay,{toCode:" ".concat(toSource(section.Identifiers.it)," ").concat(n," ").concat(toSource(a)," "),tokens:t,i:r})),[{val:a,tokens:t,i:r}]):[]},elidedComparisonOperator=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(function(e,t){var n=t.val,r=t.tokens,t=t.i;return"boolean"==typeof n?n:(e=Operations[token.type](e,Operations[operator](section.Identifiers.it,n)),hasEvalReplay&&makeEvalReplayFrame(evalReplay,{val:e,tokens:r,i:t}),e)},"and"===token.type)},leftSide,evalBefore,operator,rightSide,rightIndex,swappedSides,evalAfter;ret=leftIsComparison&&!rightIsComparison?(leftSide=leftIsComparison,operator=compileComparisonOperator(leftSide),"isNot"===leftSide.type||"isNotA"===leftSide.type||"untypifies"===leftSide.type?ambiguityError:(evalBefore=run(section,before),ops[type](evalBefore,elidedComparisonOperator.apply(void 0,_toConsumableArray(getElisionOperands(after)))))):!leftIsComparison&&rightIsComparison?(rightSide=rightIsComparison,rightIndex=tokens.indexOf(rightSide),operator=reverseComparisonOperator(rightSide),"isNot"===rightSide.type||"isNotA"===rightSide.type||"untypifies"===rightSide.type?ambiguityError:(swappedSides=[].concat(_toConsumableArray(tokens.slice(rightIndex+1)),[Object.assign(Object.create(rightSide),_defineProperty({},"inequality"===rightSide.type?"operator":"type",reverseComparisonOperator(rightSide)))],_toConsumableArray(tokens.slice(i+1,rightIndex))),evalAfter=run(section,swappedSides),ops[type](evalAfter,elidedComparisonOperator.apply(void 0,_toConsumableArray(getElisionOperands(before)))))):ops[type](run(section,before),run(section,after))}else if(comparisonOpTypes.includes(type)){after||missingSideError(!1,!0,token);var leftOp=before?run(section,before):section.Identifiers.it;ret=ops[compileComparisonOperator(token)](leftOp,run(section,after)),section.Identifiers.it=leftOp,evalReplayIt=leftOp,evalReplayReason=hasEvalReplay&&!before&&"A missing 'it' was inferred to complete the operation."}else if("addition"===type||"subtraction"===type){after||missingSideError(!1,!0,token);var convert=!before,_precedentToken7,_precedentToken8,previousPrecedentToken,_i10,_sides,pType,convert;before&&(_precedentToken7=precedentToken(before,"least"),_precedentToken8=_slicedToArray(_precedentToken7,2),previousPrecedentToken=_precedentToken8[0],_i10=_precedentToken8[1],_sides=tokenSides[previousPrecedentToken.type],pType=previousPrecedentToken.type,convert=("both"===_sides||"after"===_sides||"addition"===pType||"subtraction"===pType)&&(_i10===before.length-1||_i10===before.length-2&&"whitespace"===before[before.length-1].type)),convert?(token.type="addition"===type?"positive":"negative",ret=run(section,tokens),token.type=type,evalReplaySkip=!0):ret=ops[token.text](run(section,before),run(section,after))}else if("multiplication"===type||"division"===type)ret=ops[token.text](run(section,before),run(section,after));else if("positive"===type||"negative"===type)ret=ops["*"]("negative"===type?-1:1,run(section,after)),evalReplaySkip=!0;else if("not"===type)ret=ops.not(run(section,after));else if("belongingProperty"===type){var container=run(section,after,isVarRef),isRef=(ret=VarRef.create(container,token.name),isVarRef||TwineError.containsError(ret));ret=isRef?ret:ret.get(),isRef=isVarRef||TwineError.containsError(ret),hasEvalReplay&&!isRef?makeEvalReplayFrame(evalReplay,{toCode:" ".concat(token.name," of ").concat(toSource(VarRef.isPrototypeOf(container)?container.get():container)," "),tokens:tokens,i:i}):isRef||(evalReplayReason="The value to the right of 'of', ".concat(typeName(container),', had a "').concat(token.name,'" data name corresponding to that data value.'))}else if("belongingOperator"===type||"belongingItOperator"===type){var value=run(section,before);"random"===value&&section.freeVariables&&"object"===_typeof(section.freeVariables)&&!section.freeVariables.seed&&(section.freeVariables.seed=State.seed,section.freeVariables.seedIter=State.seedIter),ret=VarRef.create("belongingItOperator"===type?section.Identifiers.it:run(section,after,isVarRef),{computed:!0,value:value}),ret=isVarRef||TwineError.containsError(ret)?ret:ret.get(),"belongingItOperator"===type&&hasEvalReplay&&makeEvalReplayFrame(evalReplay,{toCode:" ".concat(toSource(value)," of ").concat(toSource(section.Identifiers.it)," "),tokens:tokens,i:i})}else if("property"===type){var _container=run(section,before,VARREF),_isRef=(ret=VarRef.create(_container,token.name),isVarRef||TwineError.containsError(ret));ret=_isRef?ret:ret.get(),_isRef=isVarRef||TwineError.containsError(ret),hasEvalReplay&&VarRef.isPrototypeOf(_container)&&!_isRef?makeEvalReplayFrame(evalReplay,{toCode:" ".concat(toSource(_container.get()),"'s ").concat(token.name," "),tokens:tokens,i:i}):_isRef||(evalReplayReason="The value to the left of 's, ".concat(typeName(_container),', had a "').concat(token.name,'" data name corresponding to that data value.'))}else if("itsProperty"===type||"belongingItProperty"===type)ret=VarRef.create(section.Identifiers.it,token.name),ret=isVarRef||TwineError.containsError(ret)?ret:ret.get(),hasEvalReplay&&makeEvalReplayFrame(evalReplay,{toCode:"itsProperty"===type?" ".concat(toSource(section.Identifiers.it),"'s ").concat(token.name," "):" ".concat(token.name," of ").concat(toSource(section.Identifiers.it)," "),tokens:tokens,i:i});else if("possessiveOperator"===type||"itsOperator"===type){!after||!before&&"itsOperator"!==token.type?ret=missingSideError(!before,!after,token):(_value4=run(section,after),"random"===_value4&&section.freeVariables&&"object"===_typeof(section.freeVariables)&&!section.freeVariables.seed&&(section.freeVariables.seed=State.seed,section.freeVariables.seedIter=State.seedIter),ret=VarRef.create("itsOperator"===token.type?section.Identifiers.it:run(section,before,isVarRef),{computed:!0,value:_value4}),ret=isVarRef||TwineError.containsError(ret)?ret:ret.get(),"itsOperator"===type&&hasEvalReplay&&makeEvalReplayFrame(evalReplay,{toCode:" ".concat(toSource(section.Identifiers.it),"'s ").concat(toSource(_value4)," "),tokens:tokens,i:i}))}else if("twineLink"===type)ret=Macros.run("link-goto",section,[token.innerText,token.passage]),evalReplayReason=hasEvalReplay&&"Passage links are the same as (link-goto:) macro calls.";else if("macro"===type)if(token.blockedValue&&!section.blocked){if(ret=section.blockedValue(),void 0===ret)return impossible("Runner.run","section.blockedValue() returned undefined"),0}else{var macroNameToken=token.children[0],variableCall="$"===macroNameToken.text[0]||"_"===macroNameToken.text[0],macroRef;if("macroName"!==macroNameToken.type&&!variableCall)return impossible("Runner.run","macro token had no macroName child token"),0;variableCall?(macroRef=VarRef.create("_"===macroNameToken.text[0]?section.stackTop.tempVariables:State.variables,macroNameToken.text.trim().slice(1,-1)),TwineError.containsError(macroRef)||(macroRef=macroRef.get())):macroRef=token.name,ret=Macros[variableCall?"runCustom":"run"](macroRef,section,token.children.slice(1).reduce(function(e,t){return"comma"===t.type?e.push([]):e[e.length-1].push(t),e},[[]]).filter(function(e){return e.length&&(1<e.length||"whitespace"!==e[0].type)}).map(function(e){return run(section,e,!1,isTypedVar)})),evalReplayReason=hasEvalReplay&&variableCall&&"I called ".concat(objectName(macroRef),".")}else if("grouping"===type)ret=run(section,token.children,isVarRef),evalReplaySkip=!0;else if("error"===type)ret=TwineError.create("syntax",token.message,token.explanation||"");else{if("text"!==type)return impossible("Section.run","unknown syntax token type: ".concat(type,"!!")),0;token.text.trim().match(/^\d+(?:th|nd|st|rd)(?:last)?(?:to\d+(?:nth|nd|st|rd)(?:last)?)?$/g)&&(msg='Position data names like "'.concat(token.text,'" need to be either left of "of" or right of "\'s".')),ret=TwineError.create("syntax",msg||'"'.concat(token.text,"\" isn't valid Harlowe syntax for the inside of a macro call."),"Maybe you misspelled something? Also, as of 3.3.0, Javascript syntax is not allowed inside macro calls.")}}return void 0===ret?(impossible("Section.run","token ".concat(type).concat(token.name?" (".concat(token.name,":)"):""," produced undefined")),0):ret===section?(impossible("Section.run","token ".concat(type).concat(token.name?" (".concat(token.name,":)"):""," produced the section")),0):(hasEvalReplay&&!evalReplaySkip&&makeEvalReplayFrame(evalReplay,{val:ret,reason:evalReplayReason,it:evalReplayIt,tokens:tokens,i:i}),ret)}}),define("utils/jqueryplugins",["jquery"],function(e){e.prototype.extend({popAttr:function(e){var t=this.attr(e);return this.removeAttr(e),t},popData:function(e){var t=this.data(e);return this.removeData(e),t},tag:function(){return this[0]&&this[0].tagName&&this[0].tagName.toLowerCase()},textNodes:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"*";return 1===this.length&&this[0]&&this[0].nodeType===Node.TEXT_NODE?[this[0]]:this.get().concat(this.contents().get(),this.find(e).contents().get()).filter(function(e,t,n){return(null==e?void 0:e.nodeType)===Node.TEXT_NODE&&n.indexOf(e)===t}).sort(function(e,t){return 2&e.compareDocumentPosition(t)?1:-1})},findAndFilter:function(e){var t=this.find(e),e=this.filter(e);return e.length?t.add(e):t}})}),define("utils/naturalsort",[],function(){return function(h){var m=1<arguments.length&&void 0!==arguments[1]?arguments[1]:String;return function(e,t){var n,r,a,o,i=/(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,s=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[/-]\d{1,4}[/-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,c=/^0x[0-9a-f]+$/i,l=/^0/,e=m(e).trim(),t=m(t).trim(),u=e.replace(i,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),p=t.replace(i,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),i=parseInt(e.match(c))||1!==u.length&&e.match(s)&&Date.parse(e),e=parseInt(t.match(c))||i&&t.match(s)&&Date.parse(t)||null;if(h&&window.Intl&&window.Intl.Collator&&(a=window.Intl.Collator(h)),e){if(i<e)return-1;if(e<i)return 1}for(var d=0,f=Math.max(u.length,p.length);d<f;d++){if(n=!(u[d]||"").match(l)&&parseFloat(u[d])||u[d]||0,r=!(p[d]||"").match(l)&&parseFloat(p[d])||p[d]||0,isNaN(n)!==isNaN(r))return isNaN(n)?1:-1;if(_typeof(n)!==_typeof(r))n+="",r+="";else if("string"==typeof n&&a&&0!==(o=a.compare(n,r)))return o;if(n<r)return-1;if(r<n)return 1}return 0}}}),define("utils/operationutils",["utils/naturalsort","utils","internaltypes/twineerror","patterns"],function(f,e,h,t){var m=e.impossible,g=e.nth,u=e.permutations,s=e.plural,y=t.validPropertyName,r="object",n="boolean",b="string",v="number",w="function";function a(e){return!!e&&(_typeof(e)===r||_typeof(e)===w)}var k=Array.isArray;function S(e){return e&&Object.getPrototypeOf(e)===Object.prototype}function i(e){return k(e)?"array":e instanceof Map?"datamap":e instanceof Set?"dataset":_typeof(e)===b?b:e&&_typeof(e)===r?r:""}function c(e){if(a(e)){if(_typeof(e.TwineScript_Clone)===w)return e.TwineScript_Clone();if(k(e))return _toConsumableArray(e);if(e instanceof Map)return new Map(e);if(e instanceof Set)return new Set(e);if(_typeof(e)===w)return Object.assign(e.bind(),e);switch(Object.getPrototypeOf(e)){case Object.prototype:return _objectSpread({},e);case null:return Object.assign(Object.create(null),e)}m("OperationUtils.clone","The value "+e+" cannot be cloned!")}return e}function o(e,t,n,r){for(var a="",o=0;a.length<=t&&o<e.length;){var i=r(e[o]);if(!(i.length+a.length<=t)){a+=(0<o?" and ":"")+s(e.length-o,(0<o?"other ":"")+n);break}a+=(0<o&&o===e.length-1?" and ":"")+i+(o<e.length-1?", ":""),o+=1}return a}function l(e){var t;return a(e)&&"TwineScript_ObjectName"in e?e.TwineScript_ObjectName:k(e)?0===e.length?"an empty array":"an array (with "+o(e,48,"item",l)+")":e instanceof Map?0===e.size?"an empty datamap":"a datamap (with "+o(_toConsumableArray(e.keys()),48,"dataname",_)+")":e instanceof Set?0===e.size?"an empty dataset":"a dataset (with "+o(_toConsumableArray(e.values()),48,"item",l)+")":_typeof(e)===b?0===e.length?"an empty string":48<(t=_toConsumableArray(e)).length?"a ".concat(t.length,"-character string starting with ").concat(JSON.stringify(t.slice(0,48).join(""))):"the string ".concat(JSON.stringify(e)):_typeof(e)===n?"the boolean value '"+e+"'":_typeof(e)===v?"the number "+JSON.stringify(e):void 0===e?"an empty variable":"...whatever this is"}function T(e,t){return[e[0],t[0]].sort(f("en"))[0]===e[0]?-1:1}function _(e,t){var n=h.containsError(e);if(n&&m("toSource","received a TwineError: "+n.message),_typeof(e.TwineScript_ToSource)===w)return e.TwineScript_ToSource();if(S(e)&&"first"in e&&"last"in e)return(e.first<0?(-1!==e.first?g(-e.first):"")+"last":g(e.first+1))+"to"+(e.last<0?(-1!==e.last?g(-e.last):"")+"last":g(e.last+1));if(k(e)){var r,a="",o=_createForOfIteratorHelper(e);try{for(o.s();!(r=o.n()).done;)var i=r.value,a=(a+=a?",":"(a:")+("property"===t?i+(0<i):_(i))}catch(e){o.e(e)}finally{o.f()}return a+(a?")":"(a:)")}if(e instanceof Map){var s,c="",l=_createForOfIteratorHelper(Array.from(e.entries()).sort(T));try{for(l.s();!(s=l.n()).done;){var u=_slicedToArray(s.value,2),p=u[0],d=u[1];c+=(c?",":"(dm:")+_(p)+","+_(d)}}catch(e){l.e(e)}finally{l.f()}return c+(c?")":"(dm:)")}return e instanceof Set?"(ds:"+Array.from(e).sort(f("en")).map(_)+")":_typeof(e)===v&&"property"===t?e<0?-1===e?"last":g(-e)+"last":g(e+1):_typeof(e)===b&&"property"===t?RegExp(y).test(e)?e:"("+JSON.stringify(e)+")":JSON.stringify(e)}function p(t,n){return _typeof(t)!==r&&_typeof(n)!==r?t===n:k(t)&&k(n)?t.length===n.length&&t.every(function(e,t){return p(n[t],e)}):t instanceof Map&&n instanceof Map?p(Array.from(t.entries()).sort(),Array.from(n.entries()).sort()):t instanceof Set&&n instanceof Set?p(_toConsumableArray(t),_toConsumableArray(n)):t&&_typeof(t.TwineScript_is)===w?t.TwineScript_is(n):t&&_typeof(t)===r&&n&&_typeof(n)===r&&S(t)&&S(n)?p(Object.getOwnPropertyNames(t).map(function(e){return[e,t[e]]}),Object.getOwnPropertyNames(n).map(function(e){return[e,n[e]]})):Object.is(t,n)}return Object.freeze({isObject:a,isValidDatamapName:function(e,t){var n;return e instanceof Map||m("isValidDatamapName","called with non-Map"),h.containsError(t)?t:_typeof(t)!==b&&_typeof(t)!==v?h.create("property","Only strings and numbers can be used as data names for "+l(e)+", not "+l(t)+"."):(n=_typeof(t)===b?+t:""+t,!(!Number.isNaN(n)&&e.has(n))||h.create("property","You mustn't use both "+l(t)+" and "+l(n)+" as data names in the same datamap."))},collectionType:i,isSequential:function(e){return _typeof(e)===b||k(e)||_typeof(e.hooks)===w},unstorableValue:function e(t){return(null==t?void 0:t.TwineScript_Unstorable)&&t||k(t)&&t.find(e)||t instanceof Map&&_toConsumableArray(t.values()).find(e)||t instanceof Set&&_toConsumableArray(t).find(e)},isHarloweJSValue:function e(t){return _typeof(t)===b||_typeof(t)===n||_typeof(t)===v&&!Number.isNaN(t)&&Math.abs(t)!==1/0||Array.isArray(t)&&t.every(e)||t instanceof Set&&_toConsumableArray(t).every(e)||t instanceof Map&&_toConsumableArray(t.values()).every(e)&&_toConsumableArray(t.keys()).every(function(e){return _typeof(e)===b})},clone:c,objectName:l,typeName:function e(t){var n,r=S(t);return r&&t.innerType?t.typeName||("insensitive set"===t.pattern?"a case-insensitive string name":"either"===t.pattern?(k(t.innerType)||m("typeName",'"either" pattern had non-array inner type'),t.innerType.map(e).join(" or ")):"optional"===t.pattern?"(optional) "+e(t.innerType):e(t.innerType)):r&&"range"===t.pattern?t.name||(r=t.min,n=t.max,"a"+(0<r?" positive":"")+(t.integer?" whole":"")+" number"+(0===r?" between 0 and "+n:n<1/0?" up to "+n:"")):t===String||t===Number||t===Boolean?"a "+_typeof(t()):t===parseInt?"a whole number":t===Map?"a datamap":t===Set?"a dataset":t===Array?"an array":a(t)&&"TwineScript_TypeName"in t?t.TwineScript_TypeName:l(t)},typeID:function(e){var t=_typeof(e);return[n,b,v].includes(t)?t:k(e)?"array":e instanceof Map?"datamap":e instanceof Set?"dataset":e.TwineScript_TypeID||""},toSource:_,is:p,contains:function(e,t){if(e||""===e){if(_typeof(e)===b)return _typeof(t)!==b?h.create("operation",l(e)+" can only contain strings, not "+l(t)+"."):e.includes(t);if(k(e))return e.some(function(e){return p(e,t)});if(e instanceof Set||e instanceof Map)return Array.from(e.keys()).some(function(e){return p(e,t)})}return h.create("operation",l(e)+" cannot contain any values, let alone "+l(t))},isA:function(e,t){return _typeof(t.TwineScript_IsTypeOf)===w?t.TwineScript_IsTypeOf(e):h.create("operation",'"is a" should only be used to compare type names, not '+l(t)+".")},matches:function t(n,e){var r=!1;if(n&&_typeof(n.TwineScript_IsTypeOf)===w){var a=n.TwineScript_IsTypeOf(e);if(h.containsError(a))return a;r|=a}if(e&&_typeof(e.TwineScript_IsTypeOf)===w){if(a=e.TwineScript_IsTypeOf(n),h.containsError(a))return a;r|=a}if(r)return!0;if(k(n)&&k(e)){for(var o=0,i=0,s=!0;s&&o<n.length&&i<e.length;){var c=n[o],l=e[i];if(c.rest){for(;i<e.length&&t(c,l);)l=e[i+=1];o+=1}else if(l.rest){for(;o<n.length&&t(c,l);)c=n[o+=1];i+=1}else t(c,l)?(o+=1,i+=1):s=!1}return s&&o>=n.length&&i>=e.length}return n instanceof Map&&e instanceof Map?t(Array.from(n.entries()).sort(),Array.from(e.entries()).sort()):n instanceof Set&&e instanceof Set?(n=_toConsumableArray(n),u.apply(void 0,_toConsumableArray(e)).some(function(e){return t(n,e)})):p(n,e)},subset:function e(t,n,r){var a,o;return n&&r?((a=_typeof(t)===b)&&(t=Array.from(t)),n<0&&(n=Math.max(0,t.length+n+1)),(r=r<0?Math.max(0,t.length+r+1):r)<n?e(arguments[0],r,n):(o=t.slice(0<n?n-1:n,r).map(c),a?o.join(""):o)):h.create("macrocall","The sub"+i(t)+" index value must not be "+(n&&r)+".")},range:function e(t,n){if(n<t)return e(n,t);var r=[t];for(n-=t;0<n--;)r.push(++t);return r},printBuiltinValue:function r(e){return h.containsError(e)?e:e&&_typeof(e.TwineScript_Print)===w?e.TwineScript_Print():e instanceof Map?(e=Array.from(e.entries()),h.containsError(e)?e:e.reduce(function(e,t){var n=(t=_slicedToArray(t,2))[0],t=t[1];return e+"<tr><td>`"+r(n)+"`</td><td>`"+r(t)+"`</td></tr>"},"<table class=datamap>")+"</table>"):e instanceof Set?Array.from(e.values()).map(r)+"":k(e)?e.map(r)+"":e&&_typeof(e.jquery)===b?e:a(e)?h.create("unimplemented","I don't know how to print this value yet."):e+""},unique:function(t,e,n){return n.findIndex(function(e){return p(t,e)})===e}})}),define("utils/polyfills",[],function(){var o=Array.prototype;"function"!=typeof o.includes&&(o.includes=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(!Number.isNaN(e)&&Number.isFinite(t)&&void 0!==e)return-1<o.indexOf.call(this,e,t);var n=Object(this),r=parseInt(n.length);if(!(r<=0))for(var a=0<=t?t:Math.max(0,r+t);a<r;){if(Object.is(e,n[a]))return!0;a+=1}return!1}),window.Symbol||(window.Symbol={iterator:"_es6-shim iterator_"})}),define("utils/renderutils",["jquery","utils","renderer"],function(l,u,p){var n=RegExp(u.realWhitespace+"+"),s=RegExp(u.realWhitespace+"+","g");function d(e,t,n){var r,a=e.textContent.length;if(!(a<=t))return r=[e=0===t?e:e.splitText(t)],n&&(n=n<=0?a-n:n)<a&&r.push(e.splitText(n-t)),r}var t,c=function(){var e;return void 0!==t?t:(e=l("<p>"),t=!!e[0].normalize&&(e.append(document.createTextNode("0-"),document.createTextNode("2"),document.createTextNode(""))[0].normalize(),1===e.contents().length))};var f="tw-collapsed,[collapsing=true]";var o=/^(=*)([^=]+)=*$/;return Object.freeze({dialog:function(){var e,t=(c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).section,n=void 0===(n=c.parent)?u.storyElement:n,r=c.cd,a=void 0===(a=c.message)?"":a,o=c.defaultValue,i=void 0===(c=c.buttons)?[{name:"OK",confirm:!0,callback:Object}]:c,s=("a code hook"===a.TwineScript_TypeName&&(a=a.code),l("<tw-backdrop><tw-dialog>"+(o||""===o?"<input type=text style='display:block;margin:0 auto'></input>\n":"")+"<tw-dialog-links>"+(i.length?i.reduce(function(e,t,n){t=t.name;return e+"<tw-link style='margin:0 "+(n===i.length-1?"0 0 0.5em":0===n?"0.5em 0 0":"0.5em")+"' tabindex=0>"+t+"</tw-link>"},""):"<tw-link tabindex=0>"+i[0].name+"</tw-link>")+"</tw-dialog-links></tw-dialog></tw-backdrop>")),c=s.find("tw-dialog");return n.append(s),t?(t.renderInto(a,c,_objectSpread(_objectSpread({},r),{},{append:"prepend"})),null!=(n=(null==r?void 0:r.transition)&&s.find("tw-dialog > tw-transition-container"))&&n.length&&n.appendTo(s).append(c.prepend(n.contents().detach()))):c.prepend(p.exec(a)),o&&((e=s.find("input").last()).val(o).on("keypress",function(e){13===e.which&&(s.remove(),i.filter(function(e){return e.confirm}).forEach(function(e){return e.callback()}))}),setTimeout(function(){return e.focus()},100)),i.reverse().forEach(function(e,t){l(s.find("tw-link").get(-t-1)).on("click",function(){u.options.debug&&u.options.ignoreClickEvents&&!l(s).is(".eval-replay, .harlowe-crash")||(s.remove(),e.callback())})}),s},realWhitespace:n,textNodeToChars:function(r){var e=_toConsumableArray(r.textContent);return 1===e.length?[r]:e.reduce(function(e,t){return t.match(n)&&e.length&&e[e.length-1].match(n)?e[e.length-1]+=t:e.push(t),e},[]).reduce(function(e,t){var n=r;return t.length<r.textContent.length&&(r=r.splitText(t.length)),e.concat(n)},[])},findTextInNodes:function e(t,n){var r=[],a="",o=[];if(!t.length||!n)return o;for(;0<t.length;){r.push(t[0]),a+=t[0].textContent,t.shift();var i=a.indexOf(n);if(-1<i){for(var s=a.length-(i+n.length);i>=r[0].textContent.length;)i-=r[0].textContent.length,r.shift();if(1===r.length){var c=d(r[0],i,i+n.length);o.push(c[0]),c[1]&&t.unshift(c[1]);break}o.push(d(r[0],i,r[0].length)[0]),o.push.apply(o,_toConsumableArray(r.slice(1,-1))),c=d(r[r.length-1],0,r[r.length-1].textContent.length-s),o.push(c[0]),c[1]&&t.unshift(c[1]),o=o.filter(Boolean);break}}return[o].concat(_toConsumableArray(e(t,n)))},collapse:function(e){function n(e){return 0===l(this||e).parentsUntil(f).filter("tw-verbatim, tw-expression, [collapsing=false]").length}var t=function e(t){var n=t[0],r=t.parent();return!r.length||t.findAndFilter("tw-story").length?null:(t=(t=r.textNodes().filter(function(e){return 4&(e=e.compareDocumentPosition(n))&&!(8&e)}))[t.length-1])||e(r)}(e),r=(l(t).parents(f).length||(t=null),function e(t){var n=t[0],r=t.parent();return!r.length||t.findAndFilter("tw-story").length?null:r.textNodes().filter(function(e){return 2&(e=e.compareDocumentPosition(n))&&!(8&e)})[0]||e(r)}(e)),a=(l(r).parents(f).length||(r=null),"br:not([data-raw]),tw-consecutive-br:not([data-raw])"),o=(e.find(a).filter(n).replaceWith(document.createTextNode(" ")),(e=l(e.get().map(function(e){return l(e).filter(n).is(a)?l(document.createTextNode(" ")).replaceAll(e)[0]:e}))).textNodes()),i=0;o.reduce(function(e,t){return n(t)?(t.textContent=t.textContent.replace(s," ")," "!==t.textContent[0]||e&&e.textContent&&!(-1<e.textContent.search(/\s$/))||(t.textContent=t.textContent.slice(1)),t):document.createTextNode("A")},t),_toConsumableArray(o).reverse().every(function(e){return!(!n(e)||(e.textContent.match(/^\s*$/)?(i+=e.textContent.length,e.textContent=""):(e.textContent=e.textContent.replace(/\s+$/,function(e){return i+=e.length,""}),1)))}),0<i&&r&&(o[o.length-1].textContent+=" "),e[0]&&c()&&e[0].normalize()},geomStringRegExp:o,geomParse:function(e){var t,n,r,a;return!e||(t=e.length,n=(a=_slicedToArray(o.exec(e)||[],3))[0],r=a[1],a=a[2],!n)||a===e&&1<a.length?{marginLeft:0,size:0}:{marginLeft:r.length/t*100,size:a.length/t*100}}})}),define("utils/scripttag",["state","utils/operationutils","internaltypes/varref","internaltypes/twineerror"],function(a,o,i,s){return function(e,r){Function("script","scope","with(scope){var scope=void 0,arguments=void 0;eval([script,script=void 0][0]);}")(e,Object.create(null,Object.keys(a.variables).map(function(e){return!e.startsWith("TwineScript_")&&"$"+e}).concat(Object.keys(r).map(function(e){return!e.startsWith("TwineScript_")&&"_"+e})).reduce(function(e,n){return n&&(e[n]={get:function(){var e=("$"===n[0]?a.variables:r)[n.slice(1)];if(o.isHarloweJSValue(e))return o.clone(e);throw s.create("","The contents of the variable ".concat(n,", ").concat(o.objectName(e),", couldn't be converted to a Javascript value."),"Only booleans, strings, numbers, datamaps, datasets and arrays can be converted to Javascript values.")},set:function(e){var t="$"===n[0]?a.variables:r;if(!o.isHarloweJSValue(e))throw s.create("","The Javascript value, ".concat(e,", couldn't be converted to a Harlowe value and assigned to the variable ").concat(n,"."),"Only booleans, strings, numbers (except NaN and Infinity), Maps, Sets and Arrays can be converted to Harlowe values.");e=o.clone(e);t=i.create(t,n.slice(1)).set(e);if(s.containsError(t))throw t}}),e},{})))}}),!function(){function e(t,n,r){return function(e){return"background-color: hsla(".concat(t,",").concat(n,"%,").concat(r,"%,").concat(e,");")}}var t={boolean:"color:hsla(0,0%,30%,1.0)",array:"color:hsla(0,100%,30%,1.0)",dataset:"color:hsla(30,100%,40%,1.0)",number:"color:hsla(30,100%,30%,1.0)",datamap:"color:hsla(60,100%,30%,1.0)",changer:"color:hsla(90,100%,30%,1.0)",lambda:"color:hsla(120,100%,40%,1.0)",hookName:"color:hsla(160,100%,30%,1.0)",string:"color:hsla(180,100%,30%,1.0)",identifier:"color:hsla(200,80%,40%,1.0)",variable:"color:hsla(200,100%,30%,1.0)",tempVariable:"color:hsla(200,70%,20%,1.0)",datatype:"color:hsla(220,100%,30%,1.0)",colour:"color:hsla(280,100%,30%,1.0)",macro:"color:hsla(320,80%,30%,1.0)",twineLink:"color:hsla(240,100%,20%,1.0)"},o=(t.gradient=t.colour,t.command=t.twineLink,t.instant=t.metadata=t.any=t.customMacro=t.macro,Math.min),n=e(40,100,50),r=e(220,100,50),i=/hsla\((\d+),\s*(\d+)%,\s*(\d+)%,\s*(\d+\.\d+)\)/g,s="cm-harlowe-3-",a=(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(n={root:"box-sizing:border-box;",hook:n(.05),"hook-2":n(.1),"hook-3":n(.15),"hook-4":n(.2),"hook-5":n(.25),"hook-6":n(.3),"hook-7":n(.35),"hook-8":n(.4),"^=hook , ^=hook-":"font-weight:bold;",unclosedHook:n(.05)+"font-weight:bold;"},"error:not([class*='"+s+"string'])","background-color: hsla(17,100%,50%,0.5) !important;"),"^=macroName","font-style:italic;"),"macroName-boolean",t.boolean),"macroName-array",t.array),"macroName-dataset",t.dataset),"macroName-datatype",t.datatype),"macroName-number",t.number),"macroName-datamap",t.datamap),"macroName-changer",t.changer),"macroName-string",t.string),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(n,"macroName-colour, macroName-gradient",t.colour),"macroName-command, macroName-instant, macroName-metadata",t.command),"macroName-custommacro, macroName-macro, macroName-any",t.macro),"^=macro ","font-weight:bold;"+t.macro),"comma, spread",t.macro),"addition",t.any),"subtraction, multiplication, division",t.number),"is, and, or, not, isNot, contains, doesNotContain, isIn, isA, isNotA, isNotIn, matches, doesNotMatch",t.boolean),"bold, strong","font-weight:bold;"),"italic, em","font-style:italic;"),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(n,"sup","vertical-align: super;font-size:0.8em;"),"strike","text-decoration: line-through;"),"verbatim","background-color: hsla(0,0%,50%,0.1);font:var(--font-monospaced)"),"^=bold, ^=strong, ^=italic, ^=em, ^=sup, ^=verbatim, ^=strike","font-weight:100; color: hsla(0,0%,0%,0.5)"),"^=collapsed","font-weight:bold; color: hsla(201,100%,30%,1.0);"),"unclosedCollapsed",r(.025)+"font-weight:bold; color: hsla(201,100%,30%,1.0);"),"collapsed",r(.025)),"collapsed.hook",r(.05)),"collapsed.hook-2",r(.1)),"collapsed.hook-3",r(.15)),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(n,"collapsed.hook-4",r(.2)),"collapsed.hook-5",r(.25)),"collapsed.hook-6",r(.3)),"collapsed.hook-7",r(.35)),"collapsed.hook-8",r(.4)),"twineLink:not(.text)",t.twineLink),"tag, scriptStyleTag, comment","color: hsla(240,34%,25%,1.0);"),"boolean",t.boolean),"string",t.string),"number",t.number),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(n,"variable",t.variable),"tempVariable",t.tempVariable),"hookName",t.hookName),"datatype",t.datatype),"colour",t.colour),"cssTime",t.number),"passageString",t.variable+";text-decoration:underline 1px;"),"tagString",t.variable+";text-decoration:underline 1px dotted;"),"variableOccurrence, hookOccurrence","background: hsla(159,50%,75%,1.0) !important;"),"^=where, ^=via, ^=with, ^=making, ^=each, ^=when",t.lambda+"; font-style:italic;"),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(n,"heading","font-weight:bold;"),"hr","background-image: linear-gradient(0deg, transparent, transparent 45%, hsla(0,0%,75%,1.0) 45%, transparent 55%, transparent);"),"align","color: hsla(14,99%,37%,1.0); background-color: hsla(14,99%,87%,0.1);"),"column","color: hsla(204,99%,37%,1.0); background-color: hsla(204,99%,87%,0.1);"),"escapedLine","font-weight:bold; color: hsla(51,100%,30%,1.0);"),"identifier, property, belongingProperty, itsProperty, belongingItProperty, belongingItOperator, possessiveOperator, belongingOperator",t.identifier),"toString",function(){var a=this;return Object.keys(this).reduce(function(e,n){var r;return"toString"!==n&&(r=n.split(", ").map(function e(t){return-1<t.indexOf(".")?t.split(/\./g).map(e).join(""):0===t.indexOf("^=")?"[class^='"+s+t.slice(2)+"']":"."+s+t}),e+=r.join(", ")+"{"+a[n]+"}",a[n].match(i))&&[".theme-dark","[data-app-theme=dark]"].forEach(function(t){e+=r.map(function(e){return t+" "+e}).join(", ")+"{"+a[n].replace(i,function(e,t,n,r,a){return"hsla("+t+","+o(100,1.5*+n)+"%,"+(100-r)+"%,"+a+")"})+"}"}),e},"")})+"");"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports={Colours:t,CSS:a,versionClass:s}:"function"==typeof define&&define.amd&&define("utils/typecolours",[],function(){return{Colours:t,CSS:a,versionClass:s}})}.call(void 0);
;require("harlowe")}());
</script>

</body>
</html>
